X_train[0].shape = (7032, 40, 23)

training beijing
Train on 7032 samples, validate on 1392 samples
Before training:
             beijing  9932.0      0.03  -nan  0.03      0.03  -nan  0.03      0.02  -nan  0.02
forget mean min: 0.731058 0.731059
delta_x = 3.88361 delta_h = 2.50208 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.88361 3.88361 nan 3.88361
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
             beijing 41365.2      0.06  -nan  0.06      0.07  -nan  0.07      0.06  -nan  0.06
forget mean min: 0.731059 0.731059
delta_x = 8.46576 delta_h = 5.06293 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -8.46576 8.46576 nan 8.46576
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 5993.9812 - val_loss: 13497.6246
Epoch 00000: val_loss improved from inf to 13497.62460, saving model to beijing_weights.hdf5
             beijing  2583.1      0.84  0.29  0.63      0.84  0.27  0.64      0.84  0.26  0.65
forget mean min: 0.920362 0.792436
delta_x = 5.79767 delta_h = 2.65564 U_c = [[-0.06158251]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.936579 5.79767 5.74417 5.87345
W_c max, min, mean, abs_mean: 0.147221 0.144208 0.146443 0.146443
W_f max, min, mean, abs_mean: 0.119142 0.11351 0.118102 0.118102
             beijing 13497.6      0.89  0.17  0.75      0.89  0.14  0.78      0.91  0.11  0.82
forget mean min: 0.932948 0.792436
delta_x = 8.122 delta_h = 4.49024 U_c = [[-0.06158251]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.420693 8.122 6.06176 11.7099
W_c max, min, mean, abs_mean: 0.147221 0.144208 0.146443 0.146443
W_f max, min, mean, abs_mean: 0.119142 0.11351 0.118102 0.118102
Epoch 2/300
1s - loss: 2295.4322 - val_loss: 12913.4188
Epoch 00001: val_loss improved from 13497.62460 to 12913.41882, saving model to beijing_weights.hdf5
             beijing  1999.8      0.87  0.27  0.65      0.87  0.26  0.67      0.88  0.24  0.69
forget mean min: 0.905214 0.749299
delta_x = 6.5733 delta_h = 1.63491 U_c = [[-0.0316633]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.704315 6.5733 6.38052 6.82917
W_c max, min, mean, abs_mean: 0.157752 0.154825 0.156987 0.156987
W_f max, min, mean, abs_mean: 0.118943 0.112046 0.117724 0.117724
             beijing 12913.4      0.86  0.14  0.75      0.86  0.11  0.78      0.87  0.09  0.81
forget mean min: 0.923923 0.749299
delta_x = 8.36192 delta_h = 2.61429 U_c = [[-0.0316633]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.92891 8.36192 6.20308 11.5886
W_c max, min, mean, abs_mean: 0.157752 0.154825 0.156987 0.156987
W_f max, min, mean, abs_mean: 0.118943 0.112046 0.117724 0.117724
Epoch 3/300
1s - loss: 2043.0055 - val_loss: 13262.6345
Epoch 00002: val_loss did not improve
Epoch 4/300
1s - loss: 1951.3098 - val_loss: 13260.5412
Epoch 00003: val_loss did not improve
Epoch 5/300
1s - loss: 1873.1277 - val_loss: 12593.6511
Epoch 00004: val_loss improved from 12913.41882 to 12593.65109, saving model to beijing_weights.hdf5
             beijing  1726.0      0.87  0.25  0.67      0.88  0.23  0.69      0.88  0.21  0.72
forget mean min: 0.897724 0.683001
delta_x = 6.62312 delta_h = 1.07438 U_c = [[-0.02050397]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.481985 6.62312 5.81044 7.90179
W_c max, min, mean, abs_mean: 0.162264 0.159361 0.161521 0.161521
W_f max, min, mean, abs_mean: 0.176023 0.168208 0.174668 0.174668
             beijing 12593.7      0.85  0.13  0.75      0.85  0.10  0.78      0.86  0.07  0.81
forget mean min: 0.916151 0.683001
delta_x = 8.93497 delta_h = 1.80732 U_c = [[-0.02050397]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.07524 8.93497 6.09665 14.0828
W_c max, min, mean, abs_mean: 0.162264 0.159361 0.161521 0.161521
W_f max, min, mean, abs_mean: 0.176023 0.168208 0.174668 0.174668
Epoch 6/300
1s - loss: 1802.0016 - val_loss: 12233.9041
Epoch 00005: val_loss improved from 12593.65109 to 12233.90406, saving model to beijing_weights.hdf5
             beijing  1657.1      0.89  0.25  0.68      0.89  0.23  0.70      0.90  0.21  0.73
forget mean min: 0.893855 0.664648
delta_x = 7.05564 delta_h = 0.993747 U_c = [[-0.01824445]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.536087 7.05564 6.11989 8.58401
W_c max, min, mean, abs_mean: 0.168912 0.16595 0.168153 0.168153
W_f max, min, mean, abs_mean: 0.204716 0.19677 0.203254 0.203254
             beijing 12233.9      0.85  0.13  0.76      0.85  0.10  0.78      0.87  0.08  0.81
forget mean min: 0.914468 0.664648
delta_x = 9.35017 delta_h = 1.67362 U_c = [[-0.01824445]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.908734 9.35017 6.41822 14.9815
W_c max, min, mean, abs_mean: 0.168912 0.16595 0.168153 0.168153
W_f max, min, mean, abs_mean: 0.204716 0.19677 0.203254 0.203254
Epoch 7/300
1s - loss: 1751.0577 - val_loss: 12173.0456
Epoch 00006: val_loss improved from 12233.90406 to 12173.04564, saving model to beijing_weights.hdf5
             beijing  1599.8      0.87  0.24  0.69      0.89  0.21  0.71      0.89  0.19  0.74
forget mean min: 0.889177 0.645448
delta_x = 7.04464 delta_h = 1.12615 U_c = [[-0.0213534]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.443718 7.04464 5.9849 8.81543
W_c max, min, mean, abs_mean: 0.170881 0.167802 0.17008 0.17008
W_f max, min, mean, abs_mean: 0.234978 0.226972 0.233452 0.233452
             beijing 12173.0      0.86  0.13  0.76      0.86  0.09  0.79      0.88  0.07  0.82
forget mean min: 0.910678 0.645448
delta_x = 9.3876 delta_h = 1.93241 U_c = [[-0.0213534]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.911656 9.3876 6.37741 15.3505
W_c max, min, mean, abs_mean: 0.170881 0.167802 0.17008 0.17008
W_f max, min, mean, abs_mean: 0.234978 0.226972 0.233452 0.233452
Epoch 8/300
1s - loss: 1703.8949 - val_loss: 12222.1807
Epoch 00007: val_loss did not improve
Epoch 9/300
1s - loss: 1660.4585 - val_loss: 11817.1473
Epoch 00008: val_loss improved from 12173.04564 to 11817.14726, saving model to beijing_weights.hdf5
             beijing  1513.0      0.88  0.22  0.70      0.89  0.20  0.73      0.90  0.17  0.76
forget mean min: 0.882187 0.607307
delta_x = 7.35557 delta_h = 0.93374 U_c = [[-0.01722591]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.422753 7.35557 6.04358 9.72396
W_c max, min, mean, abs_mean: 0.182467 0.179114 0.181573 0.181573
W_f max, min, mean, abs_mean: 0.283651 0.275398 0.28182 0.28182
             beijing 11817.1      0.85  0.12  0.76      0.85  0.09  0.79      0.87  0.07  0.82
forget mean min: 0.903403 0.607307
delta_x = 9.90906 delta_h = 1.65166 U_c = [[-0.01722591]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.876151 9.90906 6.61223 17.0138
W_c max, min, mean, abs_mean: 0.182467 0.179114 0.181573 0.181573
W_f max, min, mean, abs_mean: 0.283651 0.275398 0.28182 0.28182
Epoch 10/300
1s - loss: 1627.2165 - val_loss: 11656.9265
Epoch 00009: val_loss improved from 11817.14726 to 11656.92645, saving model to beijing_weights.hdf5
             beijing  1481.8      0.88  0.22  0.71      0.89  0.19  0.74      0.90  0.16  0.77
forget mean min: 0.876533 0.587361
delta_x = 7.50058 delta_h = 0.904053 U_c = [[-0.01644418]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.417474 7.50058 6.14106 9.96726
W_c max, min, mean, abs_mean: 0.188763 0.185279 0.187841 0.187841
W_f max, min, mean, abs_mean: 0.302384 0.293396 0.299812 0.299812
             beijing 11656.9      0.85  0.12  0.77      0.85  0.09  0.79      0.87  0.06  0.83
forget mean min: 0.897929 0.587361
delta_x = 10.0667 delta_h = 1.60636 U_c = [[-0.01644418]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.907918 10.0667 6.67663 17.469
W_c max, min, mean, abs_mean: 0.188763 0.185279 0.187841 0.187841
W_f max, min, mean, abs_mean: 0.302384 0.293396 0.299812 0.299812
Epoch 11/300
1s - loss: 1595.1924 - val_loss: 11679.1455
Epoch 00010: val_loss did not improve
Epoch 12/300
1s - loss: 1569.1436 - val_loss: 11665.6988
Epoch 00011: val_loss did not improve
Epoch 13/300
1s - loss: 1551.1806 - val_loss: 11492.3913
Epoch 00012: val_loss improved from 11656.92645 to 11492.39133, saving model to beijing_weights.hdf5
             beijing  1407.9      0.89  0.21  0.72      0.90  0.18  0.75      0.91  0.14  0.79
forget mean min: 0.867289 0.536363
delta_x = 7.79824 delta_h = 0.822186 U_c = [[-0.01475697]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.411187 7.79824 6.26798 10.7019
W_c max, min, mean, abs_mean: 0.203527 0.199541 0.202498 0.202498
W_f max, min, mean, abs_mean: 0.352084 0.340102 0.346694 0.346694
             beijing 11492.4      0.85  0.10  0.78      0.86  0.07  0.81      0.88  0.05  0.84
forget mean min: 0.882854 0.536363
delta_x = 10.3565 delta_h = 1.47512 U_c = [[-0.01475697]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.986777 10.3565 6.79235 18.2795
W_c max, min, mean, abs_mean: 0.203527 0.199541 0.202498 0.202498
W_f max, min, mean, abs_mean: 0.352084 0.340102 0.346694 0.346694
Epoch 14/300
1s - loss: 1527.1216 - val_loss: 11786.4960
Epoch 00013: val_loss did not improve
Epoch 15/300
1s - loss: 1511.5454 - val_loss: 12005.9246
Epoch 00014: val_loss did not improve
Epoch 16/300
1s - loss: 1484.4269 - val_loss: 12175.0280
Epoch 00015: val_loss did not improve
Epoch 17/300
1s - loss: 1459.7961 - val_loss: 12407.3726
Epoch 00016: val_loss did not improve
Epoch 18/300
1s - loss: 1418.2975 - val_loss: 12552.6654
Epoch 00017: val_loss did not improve
Epoch 19/300
1s - loss: 1387.3396 - val_loss: 13042.0148
Epoch 00018: val_loss did not improve
Epoch 20/300
1s - loss: 1373.4039 - val_loss: 12953.8228
Epoch 00019: val_loss did not improve
Epoch 21/300
1s - loss: 1365.4104 - val_loss: 13298.3181
Epoch 00020: val_loss did not improve
Epoch 22/300
1s - loss: 1348.5567 - val_loss: 12928.2214
Epoch 00021: val_loss did not improve
Epoch 23/300
1s - loss: 1338.8141 - val_loss: 13335.1015
Epoch 00022: val_loss did not improve
Epoch 24/300
1s - loss: 1327.0557 - val_loss: 12807.1752
Epoch 00023: val_loss did not improve
Epoch 25/300
1s - loss: 1317.2322 - val_loss: 14230.7545
Epoch 00024: val_loss did not improve
Epoch 26/300
1s - loss: 1309.0909 - val_loss: 13882.9336
Epoch 00025: val_loss did not improve
Epoch 27/300
1s - loss: 1304.5994 - val_loss: 14104.1631
Epoch 00026: val_loss did not improve
Epoch 28/300
1s - loss: 1295.0800 - val_loss: 14322.1804
Epoch 00027: val_loss did not improve
Epoch 29/300
1s - loss: 1283.9466 - val_loss: 13796.3301
Epoch 00028: val_loss did not improve
Epoch 30/300
1s - loss: 1288.4032 - val_loss: 15394.2452
Epoch 00029: val_loss did not improve
Epoch 31/300
1s - loss: 1277.5243 - val_loss: 15012.2368
Epoch 00030: val_loss did not improve
Epoch 32/300
1s - loss: 1275.9730 - val_loss: 14885.4026
Epoch 00031: val_loss did not improve
Epoch 33/300
1s - loss: 1269.5973 - val_loss: 16225.8033
Epoch 00032: val_loss did not improve
Epoch 34/300
1s - loss: 1253.9935 - val_loss: 15132.6997
Epoch 00033: val_loss did not improve
X_train[0].shape = (5274, 40, 23)

training tianjin
Train on 5274 samples, validate on 1044 samples
Before training:
             tianjin  5027.5      0.02  -nan  0.02      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.34315 delta_h = 2.15246 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.34315 3.34315 nan 3.34315
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
             tianjin 20395.0      0.04  -nan  0.04      0.04  -nan  0.04      0.03  -nan  0.03
forget mean min: 0.731059 0.731059
delta_x = 6.06087 delta_h = 3.62437 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -6.06087 6.06087 nan 6.06087
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 3450.5260 - val_loss: 9073.2245
Epoch 00000: val_loss improved from inf to 9073.22449, saving model to tianjin_weights.hdf5
             tianjin  1500.5      0.43  0.16  0.39      0.45  0.08  0.43      0.45  0.04  0.43
forget mean min: 0.933252 0.787256
delta_x = 3.27535 delta_h = 2.18241 U_c = [[-0.10303783]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.189269 3.27535 2.73803 3.96915
W_c max, min, mean, abs_mean: 0.119967 0.115827 0.11867 0.11867
W_f max, min, mean, abs_mean: 0.112347 0.109535 0.111579 0.111579
             tianjin  9073.2      0.78  0.26  0.61      0.78  0.25  0.62      0.77  0.22  0.63
forget mean min: 0.948953 0.787256
delta_x = 3.37978 delta_h = 2.63016 U_c = [[-0.10303783]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.09539 3.37978 1.95652 5.37607
W_c max, min, mean, abs_mean: 0.119967 0.115827 0.11867 0.11867
W_f max, min, mean, abs_mean: 0.112347 0.109535 0.111579 0.111579
Epoch 2/300
0s - loss: 1305.5572 - val_loss: 6404.3764
Epoch 00001: val_loss improved from 9073.22449 to 6404.37642, saving model to tianjin_weights.hdf5
             tianjin  1114.0      0.79  0.26  0.61      0.82  0.21  0.67      0.82  0.17  0.70
forget mean min: 0.930575 0.76713
delta_x = 4.91315 delta_h = 2.67382 U_c = [[-0.0855934]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.935424 4.91315 4.49457 5.69264
W_c max, min, mean, abs_mean: 0.148097 0.143988 0.146779 0.146779
W_f max, min, mean, abs_mean: 0.124792 0.121254 0.123678 0.123678
             tianjin  6404.4      0.91  0.25  0.70      0.92  0.24  0.71      0.93  0.22  0.74
forget mean min: 0.948427 0.76713
delta_x = 6.58778 delta_h = 3.64256 U_c = [[-0.0855934]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.967221 6.58778 5.43136 9.22911
W_c max, min, mean, abs_mean: 0.148097 0.143988 0.146779 0.146779
W_f max, min, mean, abs_mean: 0.124792 0.121254 0.123678 0.123678
Epoch 3/300
0s - loss: 1189.7343 - val_loss: 6415.1245
Epoch 00002: val_loss did not improve
Epoch 4/300
0s - loss: 1151.5840 - val_loss: 6313.0680
Epoch 00003: val_loss improved from 6404.37642 to 6313.06799, saving model to tianjin_weights.hdf5
             tianjin  1037.3      0.78  0.25  0.62      0.81  0.19  0.68      0.80  0.15  0.70
forget mean min: 0.918994 0.712572
delta_x = 5.32101 delta_h = 2.93012 U_c = [[-0.09314457]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.781316 5.32101 4.73575 6.38106
W_c max, min, mean, abs_mean: 0.159147 0.155393 0.158015 0.158015
W_f max, min, mean, abs_mean: 0.140031 0.134999 0.138201 0.138201
             tianjin  6313.1      0.91  0.24  0.71      0.91  0.24  0.71      0.93  0.22  0.74
forget mean min: 0.937864 0.712572
delta_x = 7.2057 delta_h = 4.06106 U_c = [[-0.09314457]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.854579 7.2057 5.80861 10.3716
W_c max, min, mean, abs_mean: 0.159147 0.155393 0.158015 0.158015
W_f max, min, mean, abs_mean: 0.140031 0.134999 0.138201 0.138201
Epoch 5/300
0s - loss: 1129.5971 - val_loss: 6115.0376
Epoch 00004: val_loss improved from 6313.06799 to 6115.03756, saving model to tianjin_weights.hdf5
             tianjin  1010.1      0.79  0.27  0.62      0.83  0.21  0.68      0.82  0.18  0.70
forget mean min: 0.91832 0.699814
delta_x = 5.55939 delta_h = 2.94028 U_c = [[-0.09037112]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.909893 5.55939 5.00554 6.57104
W_c max, min, mean, abs_mean: 0.167841 0.164151 0.166664 0.166664
W_f max, min, mean, abs_mean: 0.145092 0.139723 0.143022 0.143022
             tianjin  6115.0      0.92  0.24  0.71      0.92  0.24  0.71      0.92  0.22  0.73
forget mean min: 0.938065 0.699814
delta_x = 7.31769 delta_h = 4.06784 U_c = [[-0.09037112]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.02202 7.31769 5.91063 10.6881
W_c max, min, mean, abs_mean: 0.167841 0.164151 0.166664 0.166664
W_f max, min, mean, abs_mean: 0.145092 0.139723 0.143022 0.143022
Epoch 6/300
0s - loss: 1104.1813 - val_loss: 5773.9615
Epoch 00005: val_loss improved from 6115.03756 to 5773.96155, saving model to tianjin_weights.hdf5
             tianjin   988.2      0.79  0.25  0.63      0.82  0.20  0.69      0.81  0.16  0.70
forget mean min: 0.9164 0.68658
delta_x = 5.50126 delta_h = 2.80821 U_c = [[-0.08669646]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.830071 5.50126 4.97685 6.41784
W_c max, min, mean, abs_mean: 0.176124 0.172482 0.174905 0.174905
W_f max, min, mean, abs_mean: 0.146104 0.140024 0.143588 0.143588
             tianjin  5774.0      0.92  0.24  0.71      0.92  0.23  0.72      0.92  0.21  0.74
forget mean min: 0.936106 0.68658
delta_x = 7.42195 delta_h = 4.06575 U_c = [[-0.08669646]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.05246 7.42195 5.92922 11.1601
W_c max, min, mean, abs_mean: 0.176124 0.172482 0.174905 0.174905
W_f max, min, mean, abs_mean: 0.146104 0.140024 0.143588 0.143588
Epoch 7/300
0s - loss: 1081.5795 - val_loss: 5866.6619
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 1060.3542 - val_loss: 5577.6633
Epoch 00007: val_loss improved from 5773.96155 to 5577.66328, saving model to tianjin_weights.hdf5
             tianjin   945.3      0.80  0.25  0.63      0.83  0.20  0.69      0.83  0.17  0.71
forget mean min: 0.914616 0.660957
delta_x = 5.7064 delta_h = 2.48432 U_c = [[-0.07522434]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.839136 5.7064 5.26832 6.42488
W_c max, min, mean, abs_mean: 0.199363 0.195575 0.198076 0.198076
W_f max, min, mean, abs_mean: 0.146956 0.139378 0.143576 0.143576
             tianjin  5577.7      0.92  0.24  0.71      0.91  0.24  0.71      0.93  0.22  0.73
forget mean min: 0.934734 0.660957
delta_x = 7.50622 delta_h = 3.67509 U_c = [[-0.07522434]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.05284 7.50622 6.18449 10.4755
W_c max, min, mean, abs_mean: 0.199363 0.195575 0.198076 0.198076
W_f max, min, mean, abs_mean: 0.146956 0.139378 0.143576 0.143576
Epoch 9/300
0s - loss: 1035.2575 - val_loss: 5673.5157
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 1001.8668 - val_loss: 5592.6159
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 967.6472 - val_loss: 5521.0177
Epoch 00010: val_loss improved from 5577.66328 to 5521.01772, saving model to tianjin_weights.hdf5
             tianjin   835.2      0.83  0.21  0.68      0.86  0.16  0.74      0.84  0.12  0.75
forget mean min: 0.910918 0.625566
delta_x = 6.36197 delta_h = 1.52487 U_c = [[-0.04576593]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.591936 6.36197 5.70656 7.38405
W_c max, min, mean, abs_mean: 0.237611 0.233537 0.236159 0.236159
W_f max, min, mean, abs_mean: 0.163936 0.154064 0.159561 0.159561
             tianjin  5521.0      0.91  0.23  0.71      0.91  0.23  0.72      0.92  0.20  0.74
forget mean min: 0.931178 0.625566
delta_x = 7.56458 delta_h = 2.34123 U_c = [[-0.04576593]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.477538 7.56458 6.06865 10.5023
W_c max, min, mean, abs_mean: 0.237611 0.233537 0.236159 0.236159
W_f max, min, mean, abs_mean: 0.163936 0.154064 0.159561 0.159561
Epoch 12/300
0s - loss: 934.9631 - val_loss: 5480.3708
Epoch 00011: val_loss improved from 5521.01772 to 5480.37080, saving model to tianjin_weights.hdf5
             tianjin   801.8      0.82  0.20  0.68      0.85  0.15  0.74      0.82  0.12  0.74
forget mean min: 0.909659 0.614082
delta_x = 6.54244 delta_h = 1.27112 U_c = [[-0.03857955]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.471118 6.54244 5.69135 7.90865
W_c max, min, mean, abs_mean: 0.246081 0.241829 0.244523 0.244523
W_f max, min, mean, abs_mean: 0.174525 0.164003 0.16986 0.16986
             tianjin  5480.4      0.90  0.24  0.70      0.91  0.23  0.71      0.92  0.21  0.74
forget mean min: 0.933144 0.614082
delta_x = 7.68656 delta_h = 2.05328 U_c = [[-0.03857955]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.471202 7.68656 6.03508 11.1301
W_c max, min, mean, abs_mean: 0.246081 0.241829 0.244523 0.244523
W_f max, min, mean, abs_mean: 0.174525 0.164003 0.16986 0.16986
Epoch 13/300
0s - loss: 911.6545 - val_loss: 5738.3663
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 890.9804 - val_loss: 5616.7262
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 875.0198 - val_loss: 5799.3061
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 859.2268 - val_loss: 5739.8218
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 845.5791 - val_loss: 5826.4981
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 836.6673 - val_loss: 5893.9218
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 829.3038 - val_loss: 5995.4584
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 822.3262 - val_loss: 6023.6736
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 811.8936 - val_loss: 6015.8936
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 806.5098 - val_loss: 6079.5852
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 795.1551 - val_loss: 6080.0080
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 786.7645 - val_loss: 6099.0287
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 781.2582 - val_loss: 6148.0856
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 780.7645 - val_loss: 6178.7130
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 771.8564 - val_loss: 6203.8471
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 764.3275 - val_loss: 6165.2832
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 757.1527 - val_loss: 6188.6206
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 756.3298 - val_loss: 6239.1415
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 744.1580 - val_loss: 6310.1778
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 749.4606 - val_loss: 6342.1886
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 743.1344 - val_loss: 6301.6780
Epoch 00032: val_loss did not improve
X_train[0].shape = (3516, 40, 23)

training tangshan
Train on 3516 samples, validate on 696 samples
Before training:
            tangshan  6899.9      0.02  -nan  0.02      0.02  -nan  0.02      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.65438 delta_h = 2.28435 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.65438 3.65438 nan 3.65438
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
            tangshan 22742.7      0.04  -nan  0.04      0.04  -nan  0.04      0.04  -nan  0.04
forget mean min: 0.731058 0.731059
delta_x = 6.64496 delta_h = 4.08002 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -6.64496 6.64496 nan 6.64496
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 5655.3929 - val_loss: 13132.3287
Epoch 00000: val_loss improved from inf to 13132.32871, saving model to tangshan_weights.hdf5
            tangshan  3393.7      0.12  0.02  0.11      0.12  0.01  0.12      0.14  0.01  0.13
forget mean min: 0.889564 0.769638
delta_x = 2.87721 delta_h = 2.56166 U_c = [[-0.10810737]]
delta mean, abs_mean, abs_mean+, abs_mean-: -2.74096 2.87721 0.465917 3.29016
W_c max, min, mean, abs_mean: 0.0913994 0.0839502 0.0904249 0.0904249
W_f max, min, mean, abs_mean: 0.0902061 0.0837964 0.0893882 0.0893882
            tangshan 13132.3      0.22  0.03  0.21      0.22  0.01  0.21      0.21  0.02  0.20
forget mean min: 0.887528 0.769638
delta_x = 5.68471 delta_h = 4.87301 U_c = [[-0.10810737]]
delta mean, abs_mean, abs_mean+, abs_mean-: -5.68392 5.68471 0.238976 5.69372
W_c max, min, mean, abs_mean: 0.0913994 0.0839502 0.0904249 0.0904249
W_f max, min, mean, abs_mean: 0.0902061 0.0837964 0.0893882 0.0893882
Epoch 2/300
0s - loss: 2127.0674 - val_loss: 6663.2255
Epoch 00001: val_loss improved from 13132.32871 to 6663.22548, saving model to tangshan_weights.hdf5
            tangshan  1338.3      0.80  0.23  0.64      0.84  0.21  0.69      0.87  0.18  0.72
forget mean min: 0.949656 0.795021
delta_x = 4.9699 delta_h = 2.49964 U_c = [[-0.07744618]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.3301 4.9699 4.44854 6.23464
W_c max, min, mean, abs_mean: 0.143055 0.135942 0.142097 0.142097
W_f max, min, mean, abs_mean: 0.123877 0.117837 0.123068 0.123068
            tangshan  6663.2      0.91  0.19  0.75      0.93  0.15  0.80      0.93  0.13  0.81
forget mean min: 0.956847 0.795021
delta_x = 5.28617 delta_h = 2.83654 U_c = [[-0.07744618]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.1222 5.28617 4.15707 7.38771
W_c max, min, mean, abs_mean: 0.143055 0.135942 0.142097 0.142097
W_f max, min, mean, abs_mean: 0.123877 0.117837 0.123068 0.123068
Epoch 3/300
0s - loss: 1374.9815 - val_loss: 5818.4279
Epoch 00002: val_loss improved from 6663.22548 to 5818.42794, saving model to tangshan_weights.hdf5
            tangshan  1224.8      0.82  0.26  0.63      0.86  0.24  0.68      0.89  0.21  0.72
forget mean min: 0.93794 0.769344
delta_x = 5.84805 delta_h = 2.79442 U_c = [[-0.07620842]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.4419 5.84805 5.22015 7.30101
W_c max, min, mean, abs_mean: 0.155695 0.148528 0.15471 0.15471
W_f max, min, mean, abs_mean: 0.118428 0.111938 0.11763 0.11763
            tangshan  5818.4      0.93  0.13  0.81      0.95  0.10  0.86      0.94  0.09  0.86
forget mean min: 0.942352 0.769344
delta_x = 6.43665 delta_h = 3.29042 U_c = [[-0.07620842]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0382734 6.43665 4.74873 10.0525
W_c max, min, mean, abs_mean: 0.155695 0.148528 0.15471 0.15471
W_f max, min, mean, abs_mean: 0.118428 0.111938 0.11763 0.11763
Epoch 4/300
0s - loss: 1306.2365 - val_loss: 5778.7899
Epoch 00003: val_loss improved from 5818.42794 to 5778.78990, saving model to tangshan_weights.hdf5
            tangshan  1184.6      0.82  0.27  0.63      0.87  0.24  0.68      0.90  0.22  0.72
forget mean min: 0.932144 0.746395
delta_x = 6.32201 delta_h = 2.95504 U_c = [[-0.07639418]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.54285 6.32201 5.62638 7.93686
W_c max, min, mean, abs_mean: 0.16346 0.156255 0.162459 0.162459
W_f max, min, mean, abs_mean: 0.118093 0.111417 0.117302 0.117302
            tangshan  5778.8      0.93  0.13  0.82      0.95  0.09  0.87      0.95  0.09  0.86
forget mean min: 0.935792 0.746395
delta_x = 7.01518 delta_h = 3.40455 U_c = [[-0.07639418]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.00727937 7.01518 5.2389 10.6252
W_c max, min, mean, abs_mean: 0.16346 0.156255 0.162459 0.162459
W_f max, min, mean, abs_mean: 0.118093 0.111417 0.117302 0.117302
Epoch 5/300
0s - loss: 1269.0252 - val_loss: 5836.5856
Epoch 00004: val_loss did not improve
Epoch 6/300
0s - loss: 1255.6112 - val_loss: 6360.0512
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 1235.7749 - val_loss: 6396.9052
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 1224.9729 - val_loss: 6227.0428
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 1209.4795 - val_loss: 5932.2936
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 1188.4961 - val_loss: 6147.7995
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 1181.1973 - val_loss: 6100.5833
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 1167.6001 - val_loss: 5932.6487
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 1155.1893 - val_loss: 6111.0591
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 1146.3798 - val_loss: 6118.3936
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 1135.2146 - val_loss: 6114.2655
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 1125.2077 - val_loss: 6037.1808
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 1115.2716 - val_loss: 5865.0069
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 1105.1724 - val_loss: 5928.6523
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 1093.7211 - val_loss: 5903.0109
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 1083.1116 - val_loss: 6004.9408
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 1079.3891 - val_loss: 5937.9844
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 1067.8102 - val_loss: 6021.7333
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 1062.0516 - val_loss: 5955.3734
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 1051.8162 - val_loss: 6150.2767
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 1044.0804 - val_loss: 5979.3316
Epoch 00024: val_loss did not improve
X_train[0].shape = (3516, 40, 23)

training baoding
Train on 3516 samples, validate on 696 samples
Before training:
             baoding  8572.4      0.02  -nan  0.02      0.02  -nan  0.02      0.01  -nan  0.01
forget mean min: 0.731058 0.731059
delta_x = 4.56139 delta_h = 3.01106 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -4.56139 4.56139 nan 4.56139
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
             baoding 73348.6      0.07  -nan  0.07      0.08  -nan  0.07      0.08  -nan  0.08
forget mean min: 0.731058 0.731059
delta_x = 9.97129 delta_h = 5.27359 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -9.97129 9.97129 nan 9.97129
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 6917.7305 - val_loss: 55643.0997
Epoch 00000: val_loss improved from inf to 55643.09968, saving model to baoding_weights.hdf5
             baoding  4299.7      0.20  0.19  0.19      0.21  0.16  0.20      0.19  0.15  0.19
forget mean min: 0.884671 0.769334
delta_x = 3.91011 delta_h = 3.41048 U_c = [[-0.10653676]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.52223 3.91011 0.870535 4.78137
W_c max, min, mean, abs_mean: 0.0916768 0.0871998 0.0903633 0.0903633
W_f max, min, mean, abs_mean: 0.0891727 0.0849124 0.0884783 0.0884783
             baoding 55643.1      0.27  0.15  0.26      0.28  0.06  0.27      0.27  0.05  0.26
forget mean min: 0.878112 0.769334
delta_x = 8.99633 delta_h = 7.08435 U_c = [[-0.10653676]]
delta mean, abs_mean, abs_mean+, abs_mean-: -8.98258 8.99633 0.406443 9.14416
W_c max, min, mean, abs_mean: 0.0916768 0.0871998 0.0903633 0.0903633
W_f max, min, mean, abs_mean: 0.0891727 0.0849124 0.0884783 0.0884783
Epoch 2/300
0s - loss: 3072.8019 - val_loss: 39815.9221
Epoch 00001: val_loss improved from 55643.09968 to 39815.92212, saving model to baoding_weights.hdf5
             baoding  2083.5      0.82  0.26  0.64      0.85  0.24  0.67      0.84  0.24  0.66
forget mean min: 0.936842 0.799199
delta_x = 5.40317 delta_h = 2.56844 U_c = [[-0.06721988]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.391875 5.40317 4.56817 6.85139
W_c max, min, mean, abs_mean: 0.141504 0.137068 0.140136 0.140136
W_f max, min, mean, abs_mean: 0.124473 0.120278 0.12371 0.12371
             baoding 39815.9      0.85  0.12  0.76      0.85  0.08  0.79      0.85  0.07  0.80
forget mean min: 0.951536 0.799199
delta_x = 6.12709 delta_h = 3.67796 U_c = [[-0.06721988]]
delta mean, abs_mean, abs_mean+, abs_mean-: -2.38596 6.12709 3.49882 9.14647
W_c max, min, mean, abs_mean: 0.141504 0.137068 0.140136 0.140136
W_f max, min, mean, abs_mean: 0.124473 0.120278 0.12371 0.12371
Epoch 3/300
0s - loss: 2043.9723 - val_loss: 37911.7232
Epoch 00002: val_loss improved from 39815.92212 to 37911.72320, saving model to baoding_weights.hdf5
             baoding  1874.1      0.84  0.24  0.66      0.87  0.22  0.70      0.86  0.21  0.70
forget mean min: 0.930459 0.788852
delta_x = 5.33734 delta_h = 1.94677 U_c = [[-0.04441932]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.326221 5.33734 4.49069 6.78257
W_c max, min, mean, abs_mean: 0.150026 0.145505 0.148562 0.148562
W_f max, min, mean, abs_mean: 0.117936 0.113596 0.117096 0.117096
             baoding 37911.7      0.81  0.08  0.76      0.81  0.04  0.78      0.82  0.03  0.79
forget mean min: 0.940699 0.788852
delta_x = 7.51473 delta_h = 3.13554 U_c = [[-0.04441932]]
delta mean, abs_mean, abs_mean+, abs_mean-: -2.42337 7.51473 4.36295 11.9298
W_c max, min, mean, abs_mean: 0.150026 0.145505 0.148562 0.148562
W_f max, min, mean, abs_mean: 0.117936 0.113596 0.117096 0.117096
Epoch 4/300
0s - loss: 1956.9269 - val_loss: 36344.8810
Epoch 00003: val_loss improved from 37911.72320 to 36344.88104, saving model to baoding_weights.hdf5
             baoding  1819.5      0.85  0.24  0.66      0.88  0.22  0.71      0.88  0.22  0.71
forget mean min: 0.928056 0.783196
delta_x = 5.61301 delta_h = 1.79298 U_c = [[-0.03889058]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.420646 5.61301 4.86735 6.82864
W_c max, min, mean, abs_mean: 0.156234 0.1517 0.154753 0.154753
W_f max, min, mean, abs_mean: 0.115351 0.110963 0.11453 0.11453
             baoding 36344.9      0.83  0.09  0.77      0.83  0.05  0.80      0.84  0.04  0.81
forget mean min: 0.943725 0.783196
delta_x = 7.99256 delta_h = 2.88215 U_c = [[-0.03889058]]
delta mean, abs_mean, abs_mean+, abs_mean-: -2.05436 7.99256 4.82938 13.0411
W_c max, min, mean, abs_mean: 0.156234 0.1517 0.154753 0.154753
W_f max, min, mean, abs_mean: 0.115351 0.110963 0.11453 0.11453
Epoch 5/300
0s - loss: 1896.3885 - val_loss: 36531.2613
Epoch 00004: val_loss did not improve
Epoch 6/300
0s - loss: 1836.8326 - val_loss: 35805.2074
Epoch 00005: val_loss improved from 36344.88104 to 35805.20740, saving model to baoding_weights.hdf5
             baoding  1713.4      0.86  0.24  0.68      0.90  0.22  0.72      0.89  0.22  0.71
forget mean min: 0.931324 0.769937
delta_x = 5.80551 delta_h = 1.49977 U_c = [[-0.03168671]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.490046 5.80551 5.12074 6.89802
W_c max, min, mean, abs_mean: 0.159253 0.154692 0.157726 0.157726
W_f max, min, mean, abs_mean: 0.125991 0.121255 0.125099 0.125099
             baoding 35805.2      0.89  0.12  0.79      0.89  0.08  0.82      0.89  0.07  0.83
forget mean min: 0.957007 0.769937
delta_x = 7.92977 delta_h = 2.34398 U_c = [[-0.03168671]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.55534 7.92977 5.13258 12.5126
W_c max, min, mean, abs_mean: 0.159253 0.154692 0.157726 0.157726
W_f max, min, mean, abs_mean: 0.125991 0.121255 0.125099 0.125099
Epoch 7/300
0s - loss: 1790.9666 - val_loss: 36193.9683
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 1735.1683 - val_loss: 36267.6589
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 1701.7429 - val_loss: 36361.8416
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 1659.1685 - val_loss: 36209.7874
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 1626.3900 - val_loss: 35884.4970
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 1611.3039 - val_loss: 35377.1437
Epoch 00011: val_loss improved from 35805.20740 to 35377.14372, saving model to baoding_weights.hdf5
             baoding  1474.9      0.86  0.22  0.69      0.89  0.19  0.73      0.89  0.18  0.75
forget mean min: 0.931522 0.695863
delta_x = 6.20936 delta_h = 1.06848 U_c = [[-0.02293092]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.310353 6.20936 5.35898 7.52996
W_c max, min, mean, abs_mean: 0.160515 0.155891 0.158964 0.158964
W_f max, min, mean, abs_mean: 0.184446 0.178686 0.183354 0.183354
             baoding 35377.1      0.96  0.16  0.81      0.96  0.11  0.85      0.95  0.09  0.86
forget mean min: 0.968631 0.695863
delta_x = 8.16507 delta_h = 1.8098 U_c = [[-0.02293092]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.932687 8.16507 5.32079 14.199
W_c max, min, mean, abs_mean: 0.160515 0.155891 0.158964 0.158964
W_f max, min, mean, abs_mean: 0.184446 0.178686 0.183354 0.183354
Epoch 13/300
0s - loss: 1588.2006 - val_loss: 34156.1961
Epoch 00012: val_loss improved from 35377.14372 to 34156.19606, saving model to baoding_weights.hdf5
             baoding  1447.2      0.87  0.22  0.70      0.91  0.20  0.74      0.91  0.19  0.75
forget mean min: 0.931795 0.689162
delta_x = 6.36796 delta_h = 1.09069 U_c = [[-0.02333372]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.360632 6.36796 5.50359 7.72729
W_c max, min, mean, abs_mean: 0.163577 0.158967 0.162055 0.162055
W_f max, min, mean, abs_mean: 0.19184 0.186081 0.190744 0.190744
             baoding 34156.2      0.97  0.16  0.81      0.97  0.12  0.86      0.96  0.09  0.87
forget mean min: 0.970842 0.689162
delta_x = 8.2369 delta_h = 1.86564 U_c = [[-0.02333372]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.591064 8.2369 5.50652 14.4367
W_c max, min, mean, abs_mean: 0.163577 0.158967 0.162055 0.162055
W_f max, min, mean, abs_mean: 0.19184 0.186081 0.190744 0.190744
Epoch 14/300
0s - loss: 1557.2167 - val_loss: 33687.7060
Epoch 00013: val_loss improved from 34156.19606 to 33687.70602, saving model to baoding_weights.hdf5
             baoding  1406.3      0.86  0.21  0.70      0.90  0.18  0.75      0.90  0.17  0.76
forget mean min: 0.928972 0.681622
delta_x = 6.47426 delta_h = 0.995521 U_c = [[-0.02148989]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.254324 6.47426 5.59581 7.79863
W_c max, min, mean, abs_mean: 0.16641 0.161824 0.164931 0.164931
W_f max, min, mean, abs_mean: 0.198737 0.192973 0.197616 0.197616
             baoding 33687.7      0.97  0.16  0.81      0.96  0.12  0.85      0.96  0.09  0.87
forget mean min: 0.971483 0.681622
delta_x = 8.31306 delta_h = 1.74248 U_c = [[-0.02148989]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.549938 8.31306 5.57024 14.6177
W_c max, min, mean, abs_mean: 0.16641 0.161824 0.164931 0.164931
W_f max, min, mean, abs_mean: 0.198737 0.192973 0.197616 0.197616
Epoch 15/300
0s - loss: 1517.6481 - val_loss: 33692.9755
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 1494.9210 - val_loss: 32791.7461
Epoch 00015: val_loss improved from 33687.70602 to 32791.74607, saving model to baoding_weights.hdf5
             baoding  1349.3      0.88  0.22  0.71      0.92  0.19  0.75      0.92  0.18  0.77
forget mean min: 0.927336 0.668018
delta_x = 6.92042 delta_h = 0.885568 U_c = [[-0.01830183]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.345893 6.92042 5.98505 8.36538
W_c max, min, mean, abs_mean: 0.174038 0.169489 0.172622 0.172622
W_f max, min, mean, abs_mean: 0.214129 0.208321 0.212961 0.212961
             baoding 32791.7      0.97  0.16  0.81      0.97  0.12  0.86      0.96  0.09  0.88
forget mean min: 0.972985 0.668018
delta_x = 8.77688 delta_h = 1.58098 U_c = [[-0.01830183]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.283964 8.77688 5.9238 15.9999
W_c max, min, mean, abs_mean: 0.174038 0.169489 0.172622 0.172622
W_f max, min, mean, abs_mean: 0.214129 0.208321 0.212961 0.212961
Epoch 17/300
0s - loss: 1470.0945 - val_loss: 32487.9244
Epoch 00016: val_loss improved from 32791.74607 to 32487.92443, saving model to baoding_weights.hdf5
             baoding  1317.3      0.86  0.21  0.70      0.90  0.18  0.75      0.91  0.16  0.77
forget mean min: 0.926203 0.660767
delta_x = 6.87628 delta_h = 0.845979 U_c = [[-0.01834491]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.195286 6.87628 5.90304 8.32992
W_c max, min, mean, abs_mean: 0.174147 0.169619 0.172762 0.172762
W_f max, min, mean, abs_mean: 0.221099 0.215281 0.219904 0.219904
             baoding 32487.9      0.97  0.16  0.82      0.97  0.11  0.86      0.96  0.09  0.88
forget mean min: 0.971441 0.660767
delta_x = 8.85568 delta_h = 1.52643 U_c = [[-0.01834491]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.552445 8.85568 5.87004 16.0689
W_c max, min, mean, abs_mean: 0.174147 0.169619 0.172762 0.172762
W_f max, min, mean, abs_mean: 0.221099 0.215281 0.219904 0.219904
Epoch 18/300
0s - loss: 1436.0087 - val_loss: 31888.7876
Epoch 00017: val_loss improved from 32487.92443 to 31888.78761, saving model to baoding_weights.hdf5
             baoding  1285.9      0.88  0.21  0.71      0.91  0.19  0.75      0.92  0.18  0.77
forget mean min: 0.925591 0.653102
delta_x = 7.25074 delta_h = 0.918028 U_c = [[-0.019364]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.315181 7.25074 6.21508 8.86162
W_c max, min, mean, abs_mean: 0.179225 0.174709 0.177867 0.177867
W_f max, min, mean, abs_mean: 0.232772 0.22694 0.231531 0.231531
             baoding 31888.8      0.97  0.16  0.82      0.97  0.11  0.86      0.97  0.09  0.88
forget mean min: 0.972055 0.653102
delta_x = 9.19428 delta_h = 1.64289 U_c = [[-0.019364]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.278636 9.19428 6.17841 17.008
W_c max, min, mean, abs_mean: 0.179225 0.174709 0.177867 0.177867
W_f max, min, mean, abs_mean: 0.232772 0.22694 0.231531 0.231531
Epoch 19/300
0s - loss: 1417.9757 - val_loss: 31306.4491
Epoch 00018: val_loss improved from 31888.78761 to 31306.44912, saving model to baoding_weights.hdf5
             baoding  1255.9      0.88  0.21  0.71      0.91  0.19  0.75      0.92  0.17  0.77
forget mean min: 0.925342 0.645458
delta_x = 7.29975 delta_h = 0.840092 U_c = [[-0.01770573]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.290244 7.29975 6.24441 8.93484
W_c max, min, mean, abs_mean: 0.179949 0.175443 0.178615 0.178615
W_f max, min, mean, abs_mean: 0.244009 0.238191 0.242749 0.242749
             baoding 31306.4      0.97  0.16  0.82      0.97  0.11  0.86      0.97  0.09  0.88
forget mean min: 0.972204 0.645458
delta_x = 9.37787 delta_h = 1.53006 U_c = [[-0.01770573]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.292164 9.37787 6.2428 17.7558
W_c max, min, mean, abs_mean: 0.179949 0.175443 0.178615 0.178615
W_f max, min, mean, abs_mean: 0.244009 0.238191 0.242749 0.242749
Epoch 20/300
0s - loss: 1385.9672 - val_loss: 30399.2985
Epoch 00019: val_loss improved from 31306.44912 to 30399.29855, saving model to baoding_weights.hdf5
             baoding  1246.1      0.89  0.22  0.71      0.93  0.20  0.75      0.94  0.19  0.77
forget mean min: 0.926531 0.638131
delta_x = 7.53627 delta_h = 0.853141 U_c = [[-0.01757305]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.406652 7.53627 6.4501 9.27661
W_c max, min, mean, abs_mean: 0.1833 0.178791 0.181975 0.181975
W_f max, min, mean, abs_mean: 0.2552 0.2494 0.253923 0.253923
             baoding 30399.3      0.97  0.15  0.83      0.97  0.10  0.87      0.97  0.08  0.89
forget mean min: 0.971658 0.638131
delta_x = 9.73102 delta_h = 1.54355 U_c = [[-0.01757305]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.223265 9.73102 6.48034 18.6819
W_c max, min, mean, abs_mean: 0.1833 0.178791 0.181975 0.181975
W_f max, min, mean, abs_mean: 0.2552 0.2494 0.253923 0.253923
Epoch 21/300
0s - loss: 1366.6831 - val_loss: 30184.4706
Epoch 00020: val_loss improved from 30399.29855 to 30184.47058, saving model to baoding_weights.hdf5
             baoding  1221.1      0.88  0.22  0.71      0.92  0.20  0.75      0.93  0.18  0.77
forget mean min: 0.923173 0.630632
delta_x = 7.741 delta_h = 0.839348 U_c = [[-0.01729081]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.352216 7.741 6.62516 9.49211
W_c max, min, mean, abs_mean: 0.186003 0.181496 0.184693 0.184693
W_f max, min, mean, abs_mean: 0.264186 0.258398 0.262882 0.262882
             baoding 30184.5      0.97  0.15  0.83      0.97  0.10  0.87      0.97  0.08  0.89
forget mean min: 0.970603 0.630632
delta_x = 9.97945 delta_h = 1.49897 U_c = [[-0.01729081]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.33415 9.97945 6.65424 18.7349
W_c max, min, mean, abs_mean: 0.186003 0.181496 0.184693 0.184693
W_f max, min, mean, abs_mean: 0.264186 0.258398 0.262882 0.262882
Epoch 22/300
0s - loss: 1344.2131 - val_loss: 29871.0560
Epoch 00021: val_loss improved from 30184.47058 to 29871.05600, saving model to baoding_weights.hdf5
             baoding  1184.3      0.87  0.20  0.71      0.91  0.18  0.75      0.92  0.17  0.78
forget mean min: 0.921356 0.622876
delta_x = 7.77294 delta_h = 0.823268 U_c = [[-0.01750373]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.23331 7.77294 6.60417 9.57171
W_c max, min, mean, abs_mean: 0.1875 0.182995 0.186209 0.186209
W_f max, min, mean, abs_mean: 0.273687 0.267854 0.272304 0.272304
             baoding 29871.1      0.97  0.15  0.83      0.97  0.10  0.87      0.97  0.08  0.89
forget mean min: 0.970635 0.622876
delta_x = 10.0288 delta_h = 1.52067 U_c = [[-0.01750373]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.306815 10.0288 6.73217 18.5929
W_c max, min, mean, abs_mean: 0.1875 0.182995 0.186209 0.186209
W_f max, min, mean, abs_mean: 0.273687 0.267854 0.272304 0.272304
Epoch 23/300
0s - loss: 1330.6057 - val_loss: 29469.2952
Epoch 00022: val_loss improved from 29871.05600 to 29469.29521, saving model to baoding_weights.hdf5
             baoding  1166.4      0.87  0.20  0.72      0.91  0.18  0.76      0.91  0.16  0.78
forget mean min: 0.920241 0.615393
delta_x = 7.8727 delta_h = 0.939181 U_c = [[-0.02025468]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.219264 7.8727 6.69349 9.6748
W_c max, min, mean, abs_mean: 0.190224 0.185716 0.188943 0.188943
W_f max, min, mean, abs_mean: 0.282267 0.276364 0.28078 0.28078
             baoding 29469.3      0.97  0.14  0.83      0.97  0.09  0.88      0.97  0.07  0.90
forget mean min: 0.969436 0.615393
delta_x = 10.1172 delta_h = 1.74201 U_c = [[-0.02025468]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.240061 10.1172 6.88824 18.296
W_c max, min, mean, abs_mean: 0.190224 0.185716 0.188943 0.188943
W_f max, min, mean, abs_mean: 0.282267 0.276364 0.28078 0.28078
Epoch 24/300
0s - loss: 1314.1938 - val_loss: 29407.6212
Epoch 00023: val_loss improved from 29469.29521 to 29407.62119, saving model to baoding_weights.hdf5
             baoding  1147.9      0.88  0.20  0.72      0.92  0.18  0.76      0.92  0.17  0.78
forget mean min: 0.918928 0.607858
delta_x = 8.04843 delta_h = 0.889073 U_c = [[-0.01884216]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.23378 8.04843 6.80929 9.97163
W_c max, min, mean, abs_mean: 0.192926 0.188424 0.191662 0.191662
W_f max, min, mean, abs_mean: 0.29045 0.28448 0.288866 0.288866
             baoding 29407.6      0.97  0.14  0.84      0.97  0.09  0.88      0.97  0.07  0.90
forget mean min: 0.968955 0.607858
delta_x = 10.3559 delta_h = 1.64615 U_c = [[-0.01884216]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.318239 10.3559 7.03757 18.6055
W_c max, min, mean, abs_mean: 0.192926 0.188424 0.191662 0.191662
W_f max, min, mean, abs_mean: 0.29045 0.28448 0.288866 0.288866
Epoch 25/300
0s - loss: 1302.8717 - val_loss: 28650.1118
Epoch 00024: val_loss improved from 29407.62119 to 28650.11183, saving model to baoding_weights.hdf5
             baoding  1136.1      0.89  0.21  0.72      0.93  0.19  0.77      0.94  0.17  0.79
forget mean min: 0.920841 0.600056
delta_x = 8.14501 delta_h = 0.866259 U_c = [[-0.01797173]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.32431 8.14501 6.84224 10.2607
W_c max, min, mean, abs_mean: 0.195147 0.190645 0.193894 0.193894
W_f max, min, mean, abs_mean: 0.302103 0.29606 0.300392 0.300392
             baoding 28650.1      0.97  0.14  0.84      0.96  0.09  0.88      0.96  0.07  0.90
forget mean min: 0.970776 0.600056
delta_x = 10.3505 delta_h = 1.65842 U_c = [[-0.01797173]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.001398 10.3505 7.0848 19.2053
W_c max, min, mean, abs_mean: 0.195147 0.190645 0.193894 0.193894
W_f max, min, mean, abs_mean: 0.302103 0.29606 0.300392 0.300392
Epoch 26/300
0s - loss: 1285.4029 - val_loss: 29062.0871
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 1273.1229 - val_loss: 28365.4757
Epoch 00026: val_loss improved from 28650.11183 to 28365.47568, saving model to baoding_weights.hdf5
             baoding  1105.3      0.88  0.20  0.72      0.92  0.18  0.77      0.93  0.17  0.78
forget mean min: 0.91903 0.58511
delta_x = 8.36018 delta_h = 0.947362 U_c = [[-0.02010893]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.279848 8.36018 7.00479 10.5411
W_c max, min, mean, abs_mean: 0.19837 0.193881 0.197143 0.197143
W_f max, min, mean, abs_mean: 0.318295 0.312129 0.316397 0.316397
             baoding 28365.5      0.97  0.13  0.84      0.96  0.09  0.88      0.96  0.06  0.90
forget mean min: 0.968674 0.58511
delta_x = 10.511 delta_h = 1.76418 U_c = [[-0.02010893]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.164423 10.511 7.24325 18.678
W_c max, min, mean, abs_mean: 0.19837 0.193881 0.197143 0.197143
W_f max, min, mean, abs_mean: 0.318295 0.312129 0.316397 0.316397
Epoch 28/300
0s - loss: 1260.2857 - val_loss: 28914.5813
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 1250.2089 - val_loss: 28677.9308
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 1235.4396 - val_loss: 28270.5382
Epoch 00029: val_loss improved from 28365.47568 to 28270.53819, saving model to baoding_weights.hdf5
             baoding  1067.5      0.88  0.19  0.73      0.93  0.17  0.77      0.93  0.16  0.79
forget mean min: 0.917009 0.563813
delta_x = 8.72174 delta_h = 0.972663 U_c = [[-0.02047163]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.29912 8.72174 7.28548 11.0562
W_c max, min, mean, abs_mean: 0.205162 0.200687 0.203955 0.203955
W_f max, min, mean, abs_mean: 0.340813 0.334456 0.338643 0.338643
             baoding 28270.5      0.96  0.12  0.85      0.95  0.07  0.88      0.95  0.05  0.90
forget mean min: 0.965563 0.563813
delta_x = 10.9769 delta_h = 1.811 U_c = [[-0.02047163]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.322026 10.9769 7.59116 18.945
W_c max, min, mean, abs_mean: 0.205162 0.200687 0.203955 0.203955
W_f max, min, mean, abs_mean: 0.340813 0.334456 0.338643 0.338643
Epoch 31/300
0s - loss: 1232.0973 - val_loss: 28254.0232
Epoch 00030: val_loss improved from 28270.53819 to 28254.02325, saving model to baoding_weights.hdf5
             baoding  1064.6      0.88  0.19  0.73      0.93  0.18  0.77      0.94  0.16  0.79
forget mean min: 0.916913 0.557416
delta_x = 8.77221 delta_h = 0.837456 U_c = [[-0.01720298]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.305602 8.77221 7.28205 11.2379
W_c max, min, mean, abs_mean: 0.206215 0.201716 0.204985 0.204985
W_f max, min, mean, abs_mean: 0.347785 0.341392 0.345562 0.345562
             baoding 28254.0      0.96  0.12  0.85      0.95  0.07  0.88      0.95  0.05  0.90
forget mean min: 0.965848 0.557416
delta_x = 11.1495 delta_h = 1.60221 U_c = [[-0.01720298]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.379248 11.1495 7.63696 19.5492
W_c max, min, mean, abs_mean: 0.206215 0.201716 0.204985 0.204985
W_f max, min, mean, abs_mean: 0.347785 0.341392 0.345562 0.345562
Epoch 32/300
0s - loss: 1223.5258 - val_loss: 28269.9556
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 1215.1644 - val_loss: 28215.5312
Epoch 00032: val_loss improved from 28254.02325 to 28215.53124, saving model to baoding_weights.hdf5
             baoding  1036.7      0.88  0.18  0.74      0.92  0.17  0.78      0.93  0.15  0.80
forget mean min: 0.915817 0.54456
delta_x = 8.82787 delta_h = 0.948901 U_c = [[-0.01996557]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.262686 8.82787 7.29935 11.3505
W_c max, min, mean, abs_mean: 0.208473 0.203929 0.207195 0.207195
W_f max, min, mean, abs_mean: 0.359348 0.352848 0.356985 0.356985
             baoding 28215.5      0.95  0.11  0.85      0.95  0.07  0.88      0.95  0.05  0.90
forget mean min: 0.964566 0.54456
delta_x = 11.1495 delta_h = 1.82301 U_c = [[-0.01996557]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.359343 11.1495 7.70606 19.1883
W_c max, min, mean, abs_mean: 0.208473 0.203929 0.207195 0.207195
W_f max, min, mean, abs_mean: 0.359348 0.352848 0.356985 0.356985
Epoch 34/300
0s - loss: 1204.9042 - val_loss: 28332.2020
Epoch 00033: val_loss did not improve
Epoch 35/300
0s - loss: 1192.9660 - val_loss: 28350.5223
Epoch 00034: val_loss did not improve
Epoch 36/300
0s - loss: 1181.5974 - val_loss: 28802.1978
Epoch 00035: val_loss did not improve
Epoch 37/300
0s - loss: 1178.8733 - val_loss: 28516.6598
Epoch 00036: val_loss did not improve
Epoch 38/300
0s - loss: 1166.9435 - val_loss: 29191.5523
Epoch 00037: val_loss did not improve
Epoch 39/300
0s - loss: 1153.2784 - val_loss: 28538.3150
Epoch 00038: val_loss did not improve
Epoch 40/300
0s - loss: 1138.6355 - val_loss: 28814.4252
Epoch 00039: val_loss did not improve
Epoch 41/300
0s - loss: 1138.5643 - val_loss: 28654.1800
Epoch 00040: val_loss did not improve
Epoch 42/300
0s - loss: 1132.3467 - val_loss: 28709.4607
Epoch 00041: val_loss did not improve
Epoch 43/300
0s - loss: 1123.8343 - val_loss: 29336.3772
Epoch 00042: val_loss did not improve
Epoch 44/300
0s - loss: 1119.3255 - val_loss: 29211.7787
Epoch 00043: val_loss did not improve
Epoch 45/300
0s - loss: 1112.8907 - val_loss: 29318.1697
Epoch 00044: val_loss did not improve
Epoch 46/300
0s - loss: 1111.0493 - val_loss: 28856.8392
Epoch 00045: val_loss did not improve
Epoch 47/300
0s - loss: 1097.9589 - val_loss: 29159.4518
Epoch 00046: val_loss did not improve
Epoch 48/300
0s - loss: 1103.4006 - val_loss: 29437.8064
Epoch 00047: val_loss did not improve
Epoch 49/300
0s - loss: 1098.4605 - val_loss: 29287.7719
Epoch 00048: val_loss did not improve
Epoch 50/300
0s - loss: 1088.5086 - val_loss: 28690.8597
Epoch 00049: val_loss did not improve
Epoch 51/300
0s - loss: 1082.0198 - val_loss: 29369.7882
Epoch 00050: val_loss did not improve
Epoch 52/300
0s - loss: 1084.6204 - val_loss: 29223.4281
Epoch 00051: val_loss did not improve
Epoch 53/300
0s - loss: 1079.1761 - val_loss: 29032.6126
Epoch 00052: val_loss did not improve
Epoch 54/300
0s - loss: 1066.0753 - val_loss: 30006.8521
Epoch 00053: val_loss did not improve
X_train[0].shape = (4102, 40, 23)

training shijiazhuang
Train on 4102 samples, validate on 812 samples
Before training:
        shijiazhuang  5274.8      0.02  -nan  0.02      0.02  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.20914 delta_h = 2.07563 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.20914 3.20914 nan 3.20914
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
        shijiazhuang 46785.1      0.07  -nan  0.07      0.08  -nan  0.08      0.10  -nan  0.10
forget mean min: 0.731058 0.731059
delta_x = 8.75727 delta_h = 4.9514 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -8.75727 8.75727 nan 8.75727
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 4123.2343 - val_loss: 24174.4464
Epoch 00000: val_loss improved from inf to 24174.44645, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  2207.2      0.19  0.04  0.19      0.20  0.04  0.19      0.20  0.03  0.19
forget mean min: 0.91068 0.777814
delta_x = 2.5169 delta_h = 1.87319 U_c = [[-0.11023902]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.41489 2.5169 1.36581 3.29534
W_c max, min, mean, abs_mean: 0.104064 0.10025 0.103403 0.103403
W_f max, min, mean, abs_mean: 0.100439 0.0978584 0.100137 0.100137
        shijiazhuang 24174.4      0.74  0.06  0.70      0.75  0.05  0.72      0.76  0.03  0.74
forget mean min: 0.910964 0.777814
delta_x = 5.69928 delta_h = 5.40135 U_c = [[-0.11023902]]
delta mean, abs_mean, abs_mean+, abs_mean-: -5.12807 5.69928 1.40786 6.7914
W_c max, min, mean, abs_mean: 0.104064 0.10025 0.103403 0.103403
W_f max, min, mean, abs_mean: 0.100439 0.0978584 0.100137 0.100137
Epoch 2/300
0s - loss: 1717.3178 - val_loss: 17742.4435
Epoch 00001: val_loss improved from 24174.44645 to 17742.44351, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  1373.7      0.63  0.27  0.51      0.65  0.25  0.54      0.64  0.24  0.54
forget mean min: 0.934086 0.784915
delta_x = 4.00998 delta_h = 1.53074 U_c = [[-0.05859087]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.443726 4.00998 3.62525 4.62263
W_c max, min, mean, abs_mean: 0.133107 0.129333 0.132487 0.132487
W_f max, min, mean, abs_mean: 0.11761 0.115016 0.117329 0.117329
        shijiazhuang 17742.4      0.88  0.08  0.82      0.89  0.07  0.84      0.89  0.05  0.86
forget mean min: 0.940314 0.784915
delta_x = 5.70783 delta_h = 3.24573 U_c = [[-0.05859087]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.6761 5.70783 3.67075 8.18924
W_c max, min, mean, abs_mean: 0.133107 0.129333 0.132487 0.132487
W_f max, min, mean, abs_mean: 0.11761 0.115016 0.117329 0.117329
Epoch 3/300
0s - loss: 1401.5163 - val_loss: 16896.2853
Epoch 00002: val_loss improved from 17742.44351 to 16896.28534, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  1273.9      0.76  0.34  0.54      0.78  0.33  0.56      0.79  0.32  0.57
forget mean min: 0.935821 0.770008
delta_x = 4.41987 delta_h = 1.10092 U_c = [[-0.03386768]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.663272 4.41987 3.96295 5.2369
W_c max, min, mean, abs_mean: 0.139515 0.135713 0.138875 0.138875
W_f max, min, mean, abs_mean: 0.12761 0.124732 0.127289 0.127289
        shijiazhuang 16896.3      0.89  0.09  0.82      0.89  0.07  0.84      0.90  0.05  0.86
forget mean min: 0.942166 0.770008
delta_x = 5.99604 delta_h = 2.19163 U_c = [[-0.03386768]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.4536 5.99604 3.97399 8.69312
W_c max, min, mean, abs_mean: 0.139515 0.135713 0.138875 0.138875
W_f max, min, mean, abs_mean: 0.12761 0.124732 0.127289 0.127289
Epoch 4/300
0s - loss: 1341.1029 - val_loss: 17528.5136
Epoch 00003: val_loss did not improve
Epoch 5/300
0s - loss: 1301.3549 - val_loss: 17998.4178
Epoch 00004: val_loss did not improve
Epoch 6/300
0s - loss: 1264.8747 - val_loss: 19043.8511
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 1232.6217 - val_loss: 17760.0023
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 1209.7432 - val_loss: 18248.0740
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 1191.5336 - val_loss: 17787.2564
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 1169.6604 - val_loss: 17060.8481
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 1157.4880 - val_loss: 17184.8481
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 1145.1040 - val_loss: 16305.6841
Epoch 00011: val_loss improved from 16896.28534 to 16305.68413, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  1043.6      0.75  0.31  0.56      0.78  0.30  0.59      0.79  0.28  0.61
forget mean min: 0.918477 0.686127
delta_x = 6.18133 delta_h = 0.524564 U_c = [[-0.01533141]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.441906 6.18133 5.59622 7.02948
W_c max, min, mean, abs_mean: 0.189889 0.186142 0.189232 0.189232
W_f max, min, mean, abs_mean: 0.17201 0.168317 0.171158 0.171158
        shijiazhuang 16305.7      0.83  0.07  0.78      0.83  0.06  0.79      0.83  0.04  0.81
forget mean min: 0.927855 0.686127
delta_x = 7.08522 delta_h = 1.12158 U_c = [[-0.01533141]]
delta mean, abs_mean, abs_mean+, abs_mean-: -2.05683 7.08522 4.41483 10.6177
W_c max, min, mean, abs_mean: 0.189889 0.186142 0.189232 0.189232
W_f max, min, mean, abs_mean: 0.17201 0.168317 0.171158 0.171158
Epoch 13/300
0s - loss: 1130.3631 - val_loss: 17763.9173
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 1123.8382 - val_loss: 16696.2312
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 1117.0110 - val_loss: 15614.2785
Epoch 00014: val_loss improved from 16305.68413 to 15614.27845, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  1002.8      0.73  0.29  0.57      0.76  0.27  0.59      0.77  0.25  0.61
forget mean min: 0.916039 0.670309
delta_x = 6.31474 delta_h = 0.698924 U_c = [[-0.02166951]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.41617 6.31474 5.67481 7.24733
W_c max, min, mean, abs_mean: 0.197804 0.194051 0.197196 0.197196
W_f max, min, mean, abs_mean: 0.189514 0.185787 0.188493 0.188493
        shijiazhuang 15614.3      0.84  0.06  0.80      0.85  0.05  0.82      0.87  0.03  0.84
forget mean min: 0.927681 0.670309
delta_x = 6.97573 delta_h = 1.51909 U_c = [[-0.02166951]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.9242 6.97573 4.39475 10.4637
W_c max, min, mean, abs_mean: 0.197804 0.194051 0.197196 0.197196
W_f max, min, mean, abs_mean: 0.189514 0.185787 0.188493 0.188493
Epoch 16/300
0s - loss: 1110.7927 - val_loss: 15259.8641
Epoch 00015: val_loss improved from 15614.27845 to 15259.86407, saving model to shijiazhuang_weights.hdf5
        shijiazhuang   993.4      0.73  0.28  0.57      0.76  0.26  0.60      0.77  0.24  0.62
forget mean min: 0.914528 0.665524
delta_x = 6.45664 delta_h = 0.629245 U_c = [[-0.01917792]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.409691 6.45664 5.76386 7.47712
W_c max, min, mean, abs_mean: 0.20094 0.197115 0.200295 0.200295
W_f max, min, mean, abs_mean: 0.195391 0.191655 0.194332 0.194332
        shijiazhuang 15259.9      0.84  0.06  0.79      0.84  0.05  0.81      0.86  0.04  0.83
forget mean min: 0.926564 0.665524
delta_x = 7.21602 delta_h = 1.41015 U_c = [[-0.01917792]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.857 7.21602 4.56853 10.9714
W_c max, min, mean, abs_mean: 0.20094 0.197115 0.200295 0.200295
W_f max, min, mean, abs_mean: 0.195391 0.191655 0.194332 0.194332
Epoch 17/300
0s - loss: 1104.1774 - val_loss: 15162.3978
Epoch 00016: val_loss improved from 15259.86407 to 15162.39781, saving model to shijiazhuang_weights.hdf5
        shijiazhuang   989.8      0.72  0.25  0.58      0.74  0.24  0.60      0.74  0.21  0.62
forget mean min: 0.910415 0.660546
delta_x = 6.39031 delta_h = 0.581828 U_c = [[-0.01797202]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.290591 6.39031 5.66197 7.43833
W_c max, min, mean, abs_mean: 0.201198 0.197322 0.200523 0.200523
W_f max, min, mean, abs_mean: 0.199131 0.195394 0.198039 0.198039
        shijiazhuang 15162.4      0.83  0.07  0.78      0.83  0.05  0.80      0.84  0.03  0.82
forget mean min: 0.925382 0.660546
delta_x = 7.17599 delta_h = 1.35272 U_c = [[-0.01797202]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.86775 7.17599 4.49644 11.0362
W_c max, min, mean, abs_mean: 0.201198 0.197322 0.200523 0.200523
W_f max, min, mean, abs_mean: 0.199131 0.195394 0.198039 0.198039
Epoch 18/300
0s - loss: 1103.9505 - val_loss: 14667.7611
Epoch 00017: val_loss improved from 15162.39781 to 14667.76112, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  1024.4      0.76  0.32  0.56      0.79  0.31  0.58      0.81  0.30  0.60
forget mean min: 0.915866 0.65694
delta_x = 6.69721 delta_h = 0.62496 U_c = [[-0.01774946]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.531546 6.69721 5.94283 7.8682
W_c max, min, mean, abs_mean: 0.206778 0.202852 0.206067 0.206067
W_f max, min, mean, abs_mean: 0.20574 0.201986 0.204588 0.204588
        shijiazhuang 14667.8      0.85  0.06  0.80      0.86  0.05  0.82      0.87  0.03  0.85
forget mean min: 0.928809 0.65694
delta_x = 7.26555 delta_h = 1.32728 U_c = [[-0.01774946]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.69914 7.26555 4.59763 11.358
W_c max, min, mean, abs_mean: 0.206778 0.202852 0.206067 0.206067
W_f max, min, mean, abs_mean: 0.20574 0.201986 0.204588 0.204588
Epoch 19/300
0s - loss: 1096.1616 - val_loss: 15076.5918
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 1091.4155 - val_loss: 14427.6400
Epoch 00019: val_loss improved from 14667.76112 to 14427.63997, saving model to shijiazhuang_weights.hdf5
        shijiazhuang   971.9      0.73  0.27  0.57      0.76  0.26  0.60      0.77  0.24  0.62
forget mean min: 0.91267 0.647643
delta_x = 6.57637 delta_h = 0.643845 U_c = [[-0.01955285]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.387501 6.57637 5.77939 7.78424
W_c max, min, mean, abs_mean: 0.208239 0.204185 0.207459 0.207459
W_f max, min, mean, abs_mean: 0.213028 0.209259 0.211773 0.211773
        shijiazhuang 14427.6      0.85  0.07  0.80      0.86  0.05  0.83      0.87  0.03  0.84
forget mean min: 0.928212 0.647643
delta_x = 7.22914 delta_h = 1.47634 U_c = [[-0.01955285]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.6599 7.22914 4.52426 11.5588
W_c max, min, mean, abs_mean: 0.208239 0.204185 0.207459 0.207459
W_f max, min, mean, abs_mean: 0.213028 0.209259 0.211773 0.211773
Epoch 21/300
0s - loss: 1089.5856 - val_loss: 14860.6355
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 1082.9851 - val_loss: 15445.3693
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 1078.8593 - val_loss: 15308.0745
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 1075.9191 - val_loss: 15213.1813
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 1071.5663 - val_loss: 14642.5242
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 1066.6973 - val_loss: 13605.8076
Epoch 00025: val_loss improved from 14427.63997 to 13605.80756, saving model to shijiazhuang_weights.hdf5
        shijiazhuang   965.8      0.76  0.29  0.58      0.79  0.27  0.61      0.81  0.26  0.63
forget mean min: 0.911809 0.622067
delta_x = 6.91704 delta_h = 0.602242 U_c = [[-0.01736631]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.47912 6.91704 6.00268 8.38426
W_c max, min, mean, abs_mean: 0.222197 0.217747 0.221222 0.221222
W_f max, min, mean, abs_mean: 0.239554 0.235498 0.237709 0.237709
        shijiazhuang 13605.8      0.86  0.06  0.81      0.87  0.05  0.84      0.88  0.03  0.86
forget mean min: 0.927403 0.622067
delta_x = 7.43728 delta_h = 1.40063 U_c = [[-0.01736631]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.41523 7.43728 4.70863 12.2771
W_c max, min, mean, abs_mean: 0.222197 0.217747 0.221222 0.221222
W_f max, min, mean, abs_mean: 0.239554 0.235498 0.237709 0.237709
Epoch 27/300
0s - loss: 1063.9505 - val_loss: 13689.4045
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 1057.6339 - val_loss: 14883.1380
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 1054.0370 - val_loss: 13193.0341
Epoch 00028: val_loss improved from 13605.80756 to 13193.03415, saving model to shijiazhuang_weights.hdf5
        shijiazhuang   956.8      0.77  0.29  0.59      0.80  0.27  0.61      0.82  0.26  0.63
forget mean min: 0.909824 0.609641
delta_x = 6.99167 delta_h = 0.686662 U_c = [[-0.01947683]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.493384 6.99167 6.03738 8.54796
W_c max, min, mean, abs_mean: 0.228579 0.2239 0.22749 0.22749
W_f max, min, mean, abs_mean: 0.25191 0.247743 0.249737 0.249737
        shijiazhuang 13193.0      0.86  0.06  0.82      0.88  0.05  0.84      0.89  0.03  0.86
forget mean min: 0.927335 0.609641
delta_x = 7.5305 delta_h = 1.59038 U_c = [[-0.01947683]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.2635 7.5305 4.73025 13.0258
W_c max, min, mean, abs_mean: 0.228579 0.2239 0.22749 0.22749
W_f max, min, mean, abs_mean: 0.25191 0.247743 0.249737 0.249737
Epoch 30/300
0s - loss: 1050.3343 - val_loss: 13551.1936
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 1046.3818 - val_loss: 13838.0995
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 1044.4302 - val_loss: 13303.5369
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 1044.5124 - val_loss: 13619.4653
Epoch 00032: val_loss did not improve
Epoch 34/300
0s - loss: 1033.5634 - val_loss: 12678.7452
Epoch 00033: val_loss improved from 13193.03415 to 12678.74518, saving model to shijiazhuang_weights.hdf5
        shijiazhuang   968.6      0.79  0.29  0.60      0.82  0.27  0.63      0.84  0.26  0.65
forget mean min: 0.912468 0.589369
delta_x = 7.01509 delta_h = 0.582974 U_c = [[-0.01624194]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.55178 7.01509 6.02465 8.68707
W_c max, min, mean, abs_mean: 0.239727 0.23469 0.238467 0.238467
W_f max, min, mean, abs_mean: 0.27081 0.266083 0.268114 0.268114
        shijiazhuang 12678.7      0.88  0.06  0.83      0.89  0.05  0.85      0.89  0.03  0.87
forget mean min: 0.928544 0.589369
delta_x = 7.69245 delta_h = 1.46551 U_c = [[-0.01624194]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.899954 7.69245 4.90551 13.9638
W_c max, min, mean, abs_mean: 0.239727 0.23469 0.238467 0.238467
W_f max, min, mean, abs_mean: 0.27081 0.266083 0.268114 0.268114
Epoch 35/300
0s - loss: 1029.6111 - val_loss: 13346.8477
Epoch 00034: val_loss did not improve
Epoch 36/300
0s - loss: 1028.3617 - val_loss: 14144.0493
Epoch 00035: val_loss did not improve
Epoch 37/300
0s - loss: 1020.4991 - val_loss: 13877.3671
Epoch 00036: val_loss did not improve
Epoch 38/300
0s - loss: 1020.0780 - val_loss: 14241.5005
Epoch 00037: val_loss did not improve
Epoch 39/300
0s - loss: 1011.9207 - val_loss: 13382.6022
Epoch 00038: val_loss did not improve
Epoch 40/300
0s - loss: 1014.2280 - val_loss: 13268.6153
Epoch 00039: val_loss did not improve
Epoch 41/300
0s - loss: 1011.8969 - val_loss: 12926.5191
Epoch 00040: val_loss did not improve
Epoch 42/300
0s - loss: 1007.2626 - val_loss: 13368.9554
Epoch 00041: val_loss did not improve
Epoch 43/300
0s - loss: 1000.1767 - val_loss: 13460.1174
Epoch 00042: val_loss did not improve
Epoch 44/300
0s - loss: 1000.7609 - val_loss: 14755.4926
Epoch 00043: val_loss did not improve
Epoch 45/300
0s - loss: 1000.9388 - val_loss: 13860.0964
Epoch 00044: val_loss did not improve
Epoch 46/300
0s - loss: 998.1748 - val_loss: 13363.8684
Epoch 00045: val_loss did not improve
Epoch 47/300
0s - loss: 991.2383 - val_loss: 12866.0838
Epoch 00046: val_loss did not improve
Epoch 48/300
0s - loss: 990.8388 - val_loss: 14097.7425
Epoch 00047: val_loss did not improve
Epoch 49/300
0s - loss: 989.8694 - val_loss: 14511.1437
Epoch 00048: val_loss did not improve
Epoch 50/300
0s - loss: 986.8516 - val_loss: 13398.5618
Epoch 00049: val_loss did not improve
Epoch 51/300
0s - loss: 982.4989 - val_loss: 13385.8727
Epoch 00050: val_loss did not improve
Epoch 52/300
0s - loss: 981.0727 - val_loss: 13013.4567
Epoch 00051: val_loss did not improve
Epoch 53/300
0s - loss: 974.1454 - val_loss: 13010.2122
Epoch 00052: val_loss did not improve
Epoch 54/300
0s - loss: 980.4288 - val_loss: 13259.7750
Epoch 00053: val_loss did not improve
Epoch 55/300
0s - loss: 976.0379 - val_loss: 13432.9182
Epoch 00054: val_loss did not improve
X_train[0].shape = (4688, 40, 23)

training xingtai+handan
Train on 4688 samples, validate on 928 samples
Before training:
      xingtai+handan  5986.6      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 4.03616 delta_h = 2.64132 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -4.03616 4.03616 nan 4.03616
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
      xingtai+handan 48915.3      0.06  -nan  0.06      0.06  -nan  0.06      0.06  -nan  0.06
forget mean min: 0.731058 0.731059
delta_x = 8.9562 delta_h = 4.89343 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -8.9562 8.9562 nan 8.9562
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 4329.9738 - val_loss: 25751.1597
Epoch 00000: val_loss improved from inf to 25751.15967, saving model to xingtai+handan_weights.hdf5
      xingtai+handan  2108.4      0.18  0.22  0.17      0.19  0.18  0.18      0.19  0.13  0.18
forget mean min: 0.938556 0.783507
delta_x = 2.3185 delta_h = 1.95355 U_c = [[-0.11685395]]
delta mean, abs_mean, abs_mean+, abs_mean-: -1.22225 2.3185 1.31239 3.04006
W_c max, min, mean, abs_mean: 0.111221 0.107068 0.110408 0.110408
W_f max, min, mean, abs_mean: 0.107891 0.105647 0.10735 0.10735
      xingtai+handan 25751.2      0.74  0.21  0.62      0.74  0.18  0.64      0.74  0.15  0.66
forget mean min: 0.945983 0.783507
delta_x = 3.79591 delta_h = 4.11968 U_c = [[-0.11685395]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.55251 3.79591 0.828294 4.30704
W_c max, min, mean, abs_mean: 0.111221 0.107068 0.110408 0.110408
W_f max, min, mean, abs_mean: 0.107891 0.105647 0.10735 0.10735
Epoch 2/300
0s - loss: 1693.1387 - val_loss: 18506.6908
Epoch 00001: val_loss improved from 25751.15967 to 18506.69080, saving model to xingtai+handan_weights.hdf5
      xingtai+handan  1377.3      0.70  0.31  0.53      0.73  0.28  0.57      0.73  0.26  0.58
forget mean min: 0.94931 0.793467
delta_x = 4.15139 delta_h = 1.74705 U_c = [[-0.0638539]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.499551 4.15139 3.53716 5.3302
W_c max, min, mean, abs_mean: 0.142158 0.138026 0.141365 0.141365
W_f max, min, mean, abs_mean: 0.129275 0.127012 0.128778 0.128778
      xingtai+handan 18506.7      0.92  0.18  0.77      0.93  0.14  0.81      0.93  0.11  0.84
forget mean min: 0.972088 0.793467
delta_x = 5.07185 delta_h = 3.3543 U_c = [[-0.0638539]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.360735 5.07185 3.67814 9.00775
W_c max, min, mean, abs_mean: 0.142158 0.138026 0.141365 0.141365
W_f max, min, mean, abs_mean: 0.129275 0.127012 0.128778 0.128778
Epoch 3/300
0s - loss: 1440.5608 - val_loss: 18717.2875
Epoch 00002: val_loss did not improve
Epoch 4/300
0s - loss: 1387.6588 - val_loss: 18051.5148
Epoch 00003: val_loss improved from 18506.69080 to 18051.51478, saving model to xingtai+handan_weights.hdf5
      xingtai+handan  1258.2      0.74  0.30  0.57      0.78  0.26  0.61      0.79  0.24  0.63
forget mean min: 0.951055 0.775073
delta_x = 4.29257 delta_h = 1.45882 U_c = [[-0.04906559]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.493467 4.29257 3.59584 5.67874
W_c max, min, mean, abs_mean: 0.139631 0.13548 0.13876 0.13876
W_f max, min, mean, abs_mean: 0.152537 0.149945 0.152059 0.152059
      xingtai+handan 18051.5      0.94  0.18  0.78      0.94  0.14  0.82      0.95  0.11  0.84
forget mean min: 0.976904 0.775073
delta_x = 5.23664 delta_h = 2.85756 U_c = [[-0.04906559]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.563559 5.23664 3.75643 10.2496
W_c max, min, mean, abs_mean: 0.139631 0.13548 0.13876 0.13876
W_f max, min, mean, abs_mean: 0.152537 0.149945 0.152059 0.152059
Epoch 5/300
0s - loss: 1343.3086 - val_loss: 17705.9707
Epoch 00004: val_loss improved from 18051.51478 to 17705.97074, saving model to xingtai+handan_weights.hdf5
      xingtai+handan  1220.9      0.76  0.29  0.58      0.79  0.26  0.62      0.80  0.24  0.64
forget mean min: 0.948751 0.757461
delta_x = 4.60839 delta_h = 1.46434 U_c = [[-0.04814346]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.52469 4.60839 3.89623 5.983
W_c max, min, mean, abs_mean: 0.147975 0.143785 0.147054 0.147054
W_f max, min, mean, abs_mean: 0.159757 0.156958 0.159226 0.159226
      xingtai+handan 17706.0      0.94  0.18  0.78      0.95  0.14  0.82      0.95  0.11  0.85
forget mean min: 0.976986 0.757461
delta_x = 5.52318 delta_h = 2.8799 U_c = [[-0.04814346]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.71748 5.52318 4.02525 10.6883
W_c max, min, mean, abs_mean: 0.147975 0.143785 0.147054 0.147054
W_f max, min, mean, abs_mean: 0.159757 0.156958 0.159226 0.159226
Epoch 6/300
0s - loss: 1312.9488 - val_loss: 17555.9464
Epoch 00005: val_loss improved from 17705.97074 to 17555.94642, saving model to xingtai+handan_weights.hdf5
      xingtai+handan  1198.6      0.70  0.26  0.56      0.74  0.22  0.61      0.74  0.20  0.63
forget mean min: 0.94393 0.735941
delta_x = 4.68382 delta_h = 1.49086 U_c = [[-0.0521164]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.297395 4.68382 3.91174 6.03692
W_c max, min, mean, abs_mean: 0.153481 0.149237 0.152508 0.152508
W_f max, min, mean, abs_mean: 0.163934 0.161022 0.163374 0.163374
      xingtai+handan 17555.9      0.94  0.17  0.79      0.95  0.12  0.83      0.95  0.10  0.86
forget mean min: 0.974642 0.735941
delta_x = 5.56587 delta_h = 2.98424 U_c = [[-0.0521164]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.54288 5.56587 4.00857 10.5508
W_c max, min, mean, abs_mean: 0.153481 0.149237 0.152508 0.152508
W_f max, min, mean, abs_mean: 0.163934 0.161022 0.163374 0.163374
Epoch 7/300
0s - loss: 1284.1911 - val_loss: 17029.6863
Epoch 00006: val_loss improved from 17555.94642 to 17029.68629, saving model to xingtai+handan_weights.hdf5
      xingtai+handan  1163.1      0.75  0.28  0.58      0.79  0.24  0.63      0.79  0.22  0.65
forget mean min: 0.944459 0.718977
delta_x = 5.00657 delta_h = 1.49402 U_c = [[-0.05005492]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.46826 5.00657 4.2202 6.4583
W_c max, min, mean, abs_mean: 0.16277 0.158472 0.161747 0.161747
W_f max, min, mean, abs_mean: 0.175569 0.172524 0.174938 0.174938
      xingtai+handan 17029.7      0.95  0.16  0.80      0.95  0.12  0.84      0.96  0.10  0.87
forget mean min: 0.974427 0.718977
delta_x = 6.05941 delta_h = 3.03683 U_c = [[-0.05005492]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.741827 6.05941 4.41259 11.5934
W_c max, min, mean, abs_mean: 0.16277 0.158472 0.161747 0.161747
W_f max, min, mean, abs_mean: 0.175569 0.172524 0.174938 0.174938
Epoch 8/300
0s - loss: 1261.0178 - val_loss: 17008.3027
Epoch 00007: val_loss improved from 17029.68629 to 17008.30270, saving model to xingtai+handan_weights.hdf5
      xingtai+handan  1138.8      0.75  0.27  0.58      0.79  0.23  0.63      0.80  0.21  0.66
forget mean min: 0.941128 0.711907
delta_x = 5.3139 delta_h = 1.43113 U_c = [[-0.04637505]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.413608 5.3139 4.41563 6.97153
W_c max, min, mean, abs_mean: 0.169329 0.164959 0.168246 0.168246
W_f max, min, mean, abs_mean: 0.185529 0.182311 0.184788 0.184788
      xingtai+handan 17008.3      0.95  0.16  0.80      0.95  0.12  0.84      0.95  0.09  0.86
forget mean min: 0.972675 0.711907
delta_x = 6.34219 delta_h = 2.89026 U_c = [[-0.04637505]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.582259 6.34219 4.51843 12.3204
W_c max, min, mean, abs_mean: 0.169329 0.164959 0.168246 0.168246
W_f max, min, mean, abs_mean: 0.185529 0.182311 0.184788 0.184788
Epoch 9/300
0s - loss: 1238.9814 - val_loss: 17005.4406
Epoch 00008: val_loss improved from 17008.30270 to 17005.44060, saving model to xingtai+handan_weights.hdf5
      xingtai+handan  1117.8      0.78  0.28  0.60      0.82  0.24  0.65      0.83  0.22  0.68
forget mean min: 0.945369 0.705629
delta_x = 5.40574 delta_h = 1.40719 U_c = [[-0.04586265]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.581214 5.40574 4.51969 7.1436
W_c max, min, mean, abs_mean: 0.174161 0.1697 0.17301 0.17301
W_f max, min, mean, abs_mean: 0.197634 0.194265 0.196768 0.196768
      xingtai+handan 17005.4      0.96  0.16  0.81      0.96  0.12  0.85      0.96  0.09  0.87
forget mean min: 0.974243 0.705629
delta_x = 6.33386 delta_h = 2.83261 U_c = [[-0.04586265]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.694719 6.33386 4.57898 12.1263
W_c max, min, mean, abs_mean: 0.174161 0.1697 0.17301 0.17301
W_f max, min, mean, abs_mean: 0.197634 0.194265 0.196768 0.196768
Epoch 10/300
0s - loss: 1224.0702 - val_loss: 17196.7860
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 1207.0407 - val_loss: 17160.8548
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 1197.3910 - val_loss: 17151.5946
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 1184.2668 - val_loss: 17207.0786
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 1175.3530 - val_loss: 17442.9950
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 1166.5830 - val_loss: 17234.3840
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 1162.6347 - val_loss: 17126.0932
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 1149.6143 - val_loss: 17444.2128
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 1140.8360 - val_loss: 17501.3711
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 1134.3108 - val_loss: 17347.3654
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 1123.2979 - val_loss: 16843.1455
Epoch 00019: val_loss improved from 17005.44060 to 16843.14551, saving model to xingtai+handan_weights.hdf5
      xingtai+handan   997.5      0.80  0.28  0.61      0.84  0.23  0.67      0.86  0.20  0.70
forget mean min: 0.935542 0.638502
delta_x = 6.66555 delta_h = 1.3073 U_c = [[-0.0412065]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.541273 6.66555 5.53513 8.77423
W_c max, min, mean, abs_mean: 0.222595 0.216842 0.220684 0.220684
W_f max, min, mean, abs_mean: 0.280758 0.276859 0.279322 0.279322
      xingtai+handan 16843.1      0.95  0.14  0.82      0.96  0.10  0.87      0.95  0.08  0.87
forget mean min: 0.966745 0.640402
delta_x = 7.64176 delta_h = 2.61821 U_c = [[-0.0412065]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.227896 7.64176 5.14009 15.809
W_c max, min, mean, abs_mean: 0.222595 0.216842 0.220684 0.220684
W_f max, min, mean, abs_mean: 0.280758 0.276859 0.279322 0.279322
Epoch 21/300
0s - loss: 1118.0217 - val_loss: 17091.8421
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 1106.6037 - val_loss: 16939.2052
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 1099.7177 - val_loss: 17036.5457
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 1094.0941 - val_loss: 17037.6918
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 1085.3301 - val_loss: 17188.1924
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 1075.6760 - val_loss: 17277.2196
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 1070.7793 - val_loss: 17040.2860
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 1065.7432 - val_loss: 16916.5093
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 1052.5221 - val_loss: 17242.3462
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 1047.9928 - val_loss: 17095.9437
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 1042.4462 - val_loss: 17610.2838
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 1031.9546 - val_loss: 17041.9166
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 1025.8246 - val_loss: 17119.3555
Epoch 00032: val_loss did not improve
Epoch 34/300
0s - loss: 1023.2080 - val_loss: 17509.4527
Epoch 00033: val_loss did not improve
Epoch 35/300
0s - loss: 1021.1254 - val_loss: 17385.3175
Epoch 00034: val_loss did not improve
Epoch 36/300
0s - loss: 1017.2294 - val_loss: 16921.0231
Epoch 00035: val_loss did not improve
Epoch 37/300
0s - loss: 1007.9810 - val_loss: 17079.3253
Epoch 00036: val_loss did not improve
Epoch 38/300
0s - loss: 1005.1372 - val_loss: 17034.6526
Epoch 00037: val_loss did not improve
Epoch 39/300
0s - loss: 999.5881 - val_loss: 17197.0966
Epoch 00038: val_loss did not improve
Epoch 40/300
0s - loss: 992.3182 - val_loss: 17313.3905
Epoch 00039: val_loss did not improve
Epoch 41/300
0s - loss: 982.4164 - val_loss: 17495.7637
Epoch 00040: val_loss did not improve
X_train[0].shape = (2930, 40, 23)

training jinan
Train on 2930 samples, validate on 580 samples
Before training:
               jinan  9041.7      0.02  -nan  0.02      0.02  -nan  0.02      0.01  -nan  0.01
forget mean min: 0.731058 0.731059
delta_x = 4.98674 delta_h = 3.17803 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -4.98674 4.98674 nan 4.98674
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
               jinan 22928.3      0.04  -nan  0.04      0.04  -nan  0.04      0.03  -nan  0.03
forget mean min: 0.731058 0.731059
delta_x = 7.41915 delta_h = 4.81271 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -7.41915 7.41915 nan 7.41915
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 7732.6172 - val_loss: 14881.7964
Epoch 00000: val_loss improved from inf to 14881.79636, saving model to jinan_weights.hdf5
               jinan  5460.5      0.06  -nan  0.06      0.06  -nan  0.06      0.06  -nan  0.06
forget mean min: 0.863837 0.762957
delta_x = 4.96926 delta_h = 4.04542 U_c = [[-0.10281074]]
delta mean, abs_mean, abs_mean+, abs_mean-: -4.96925 4.96926 0.0288773 4.9693
W_c max, min, mean, abs_mean: 0.0798269 0.078518 0.0795775 0.0795775
W_f max, min, mean, abs_mean: 0.0798907 0.0795489 0.0796861 0.0796861
               jinan 14881.8      0.11  -nan  0.10      0.11  -nan  0.10      0.11  -nan  0.11
forget mean min: 0.863489 0.764969
delta_x = 7.82776 delta_h = 6.46961 U_c = [[-0.10281074]]
delta mean, abs_mean, abs_mean+, abs_mean-: -7.82776 7.82776 nan 7.82776
W_c max, min, mean, abs_mean: 0.0798269 0.078518 0.0795775 0.0795775
W_f max, min, mean, abs_mean: 0.0798907 0.0795489 0.0796861 0.0796861
Epoch 2/300
0s - loss: 3852.0533 - val_loss: 7744.1157
Epoch 00001: val_loss improved from 14881.79636 to 7744.11571, saving model to jinan_weights.hdf5
               jinan  2740.0      0.60  0.30  0.48      0.61  0.26  0.51      0.62  0.22  0.53
forget mean min: 0.956723 0.792445
delta_x = 3.04268 delta_h = 2.12823 U_c = [[-0.11740607]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.103435 3.04268 2.28926 4.39355
W_c max, min, mean, abs_mean: 0.126574 0.125285 0.126319 0.126319
W_f max, min, mean, abs_mean: 0.117672 0.117274 0.117433 0.117433
               jinan  7744.1      0.95  0.29  0.68      0.95  0.25  0.72      0.94  0.21  0.75
forget mean min: 0.965189 0.792445
delta_x = 2.69805 delta_h = 2.4773 U_c = [[-0.11740607]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.891312 2.69805 1.62152 4.05222
W_c max, min, mean, abs_mean: 0.126574 0.125285 0.126319 0.126319
W_f max, min, mean, abs_mean: 0.117672 0.117274 0.117433 0.117433
Epoch 3/300
0s - loss: 2574.0571 - val_loss: 6071.6241
Epoch 00002: val_loss improved from 7744.11571 to 6071.62406, saving model to jinan_weights.hdf5
               jinan  2265.1      0.76  0.33  0.55      0.77  0.29  0.58      0.78  0.26  0.61
forget mean min: 0.957528 0.791258
delta_x = 4.48442 delta_h = 2.47651 U_c = [[-0.09628335]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.93004 4.48442 3.86347 5.93832
W_c max, min, mean, abs_mean: 0.157539 0.156278 0.157297 0.157297
W_f max, min, mean, abs_mean: 0.122178 0.121777 0.121937 0.121937
               jinan  6071.6      0.97  0.21  0.76      0.97  0.18  0.80      0.96  0.15  0.82
forget mean min: 0.965942 0.791258
delta_x = 5.02527 delta_h = 3.27518 U_c = [[-0.09628335]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.674474 5.02527 3.90232 8.06605
W_c max, min, mean, abs_mean: 0.157539 0.156278 0.157297 0.157297
W_f max, min, mean, abs_mean: 0.122178 0.121777 0.121937 0.121937
Epoch 4/300
0s - loss: 2249.9897 - val_loss: 5431.2017
Epoch 00003: val_loss improved from 6071.62406 to 5431.20170, saving model to jinan_weights.hdf5
               jinan  2055.9      0.77  0.33  0.56      0.79  0.29  0.59      0.80  0.26  0.62
forget mean min: 0.942517 0.76953
delta_x = 5.4097 delta_h = 2.54771 U_c = [[-0.08756313]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.800099 5.4097 4.71524 6.74868
W_c max, min, mean, abs_mean: 0.188534 0.187249 0.188255 0.188255
W_f max, min, mean, abs_mean: 0.102529 0.102075 0.102288 0.102288
               jinan  5431.2      0.95  0.17  0.80      0.95  0.13  0.83      0.94  0.10  0.85
forget mean min: 0.952407 0.76953
delta_x = 6.51332 delta_h = 3.88296 U_c = [[-0.08756313]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.877626 6.51332 5.24887 9.52143
W_c max, min, mean, abs_mean: 0.188534 0.187249 0.188255 0.188255
W_f max, min, mean, abs_mean: 0.102529 0.102075 0.102288 0.102288
Epoch 5/300
0s - loss: 2113.6593 - val_loss: 5240.3525
Epoch 00004: val_loss improved from 5431.20170 to 5240.35246, saving model to jinan_weights.hdf5
               jinan  1959.1      0.78  0.33  0.56      0.80  0.29  0.60      0.82  0.26  0.63
forget mean min: 0.932822 0.755071
delta_x = 6.05651 delta_h = 2.73235 U_c = [[-0.08889527]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.92844 6.05651 5.34072 7.40907
W_c max, min, mean, abs_mean: 0.215785 0.21447 0.215463 0.215463
W_f max, min, mean, abs_mean: 0.0876375 0.0871958 0.0874149 0.0874149
               jinan  5240.4      0.96  0.16  0.82      0.97  0.12  0.85      0.95  0.09  0.86
forget mean min: 0.947373 0.755071
delta_x = 7.15451 delta_h = 4.24638 U_c = [[-0.08889527]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.36377 7.15451 6.21929 9.18663
W_c max, min, mean, abs_mean: 0.215785 0.21447 0.215463 0.215463
W_f max, min, mean, abs_mean: 0.0876375 0.0871958 0.0874149 0.0874149
Epoch 6/300
0s - loss: 2040.2143 - val_loss: 5303.5464
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 1974.6783 - val_loss: 5265.4687
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 1930.8633 - val_loss: 5314.5593
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 1901.7778 - val_loss: 5491.7038
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 1871.0090 - val_loss: 5362.3161
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 1845.6820 - val_loss: 5529.9577
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 1825.9786 - val_loss: 5738.9027
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 1801.0153 - val_loss: 5622.2740
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 1774.9249 - val_loss: 5710.2228
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 1756.9626 - val_loss: 5447.8032
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 1745.3605 - val_loss: 5660.2475
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 1717.0931 - val_loss: 5398.9276
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 1704.3688 - val_loss: 5632.1122
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 1686.8012 - val_loss: 5270.6784
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 1671.0653 - val_loss: 5268.7161
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 1647.2464 - val_loss: 5248.0567
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 1634.0662 - val_loss: 5387.1501
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 1621.9962 - val_loss: 5491.7340
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 1615.1225 - val_loss: 5558.5078
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 1605.2789 - val_loss: 5637.2689
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 1593.2149 - val_loss: 5615.1286
Epoch 00025: val_loss did not improve
X_train[0].shape = (7032, 40, 23)

training xian
Train on 7032 samples, validate on 1392 samples
Before training:
                xian  3308.6      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.25825 delta_h = 2.15008 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.25825 3.25825 nan 3.25825
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
                xian 14538.7      0.03  -nan  0.03      0.03  -nan  0.03      0.01  -nan  0.01
forget mean min: 0.731059 0.731059
delta_x = 4.83852 delta_h = 2.66873 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -4.83852 4.83852 nan 4.83852
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 1926.2568 - val_loss: 4906.7491
Epoch 00000: val_loss improved from inf to 4906.74911, saving model to xian_weights.hdf5
                xian   913.1      0.44  0.42  0.34      0.48  0.41  0.36      0.48  0.40  0.37
forget mean min: 0.932793 0.797756
delta_x = 3.40764 delta_h = 2.13176 U_c = [[-0.11360724]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0438598 3.40764 3.02312 3.88983
W_c max, min, mean, abs_mean: 0.128476 0.124706 0.127606 0.127606
W_f max, min, mean, abs_mean: 0.11852 0.116423 0.117954 0.117954
                xian  4906.7      0.58  0.14  0.54      0.59  0.12  0.54      0.58  0.11  0.54
forget mean min: 0.955442 0.797756
delta_x = 4.1143 delta_h = 2.81321 U_c = [[-0.11360724]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.630907 4.1143 3.47384 5.49417
W_c max, min, mean, abs_mean: 0.128476 0.124706 0.127606 0.127606
W_f max, min, mean, abs_mean: 0.11852 0.116423 0.117954 0.117954
Epoch 2/300
1s - loss: 935.9648 - val_loss: 3758.9697
Epoch 00001: val_loss improved from 4906.74911 to 3758.96971, saving model to xian_weights.hdf5
                xian   788.3      0.47  0.38  0.37      0.51  0.38  0.39      0.53  0.36  0.41
forget mean min: 0.944726 0.805132
delta_x = 2.74034 delta_h = 1.26475 U_c = [[-0.06278285]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.199184 2.74034 2.42037 3.23504
W_c max, min, mean, abs_mean: 0.131753 0.127892 0.13084 0.13084
W_f max, min, mean, abs_mean: 0.124354 0.122561 0.123936 0.123936
                xian  3759.0      0.74  0.13  0.67      0.76  0.10  0.70      0.76  0.09  0.71
forget mean min: 0.963034 0.805132
delta_x = 3.46732 delta_h = 1.95437 U_c = [[-0.06278285]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.528596 3.46732 2.71286 5.57582
W_c max, min, mean, abs_mean: 0.131753 0.127892 0.13084 0.13084
W_f max, min, mean, abs_mean: 0.124354 0.122561 0.123936 0.123936
Epoch 3/300
1s - loss: 874.0085 - val_loss: 3682.8970
Epoch 00002: val_loss improved from 3758.96971 to 3682.89700, saving model to xian_weights.hdf5
                xian   755.7      0.45  0.36  0.36      0.48  0.35  0.38      0.51  0.33  0.41
forget mean min: 0.939222 0.793461
delta_x = 2.66217 delta_h = 1.01045 U_c = [[-0.0490883]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.00567541 2.66217 2.33994 3.08945
W_c max, min, mean, abs_mean: 0.139566 0.135604 0.138597 0.138597
W_f max, min, mean, abs_mean: 0.119653 0.117858 0.119201 0.119201
                xian  3682.9      0.73  0.11  0.67      0.75  0.08  0.71      0.76  0.07  0.72
forget mean min: 0.958694 0.793461
delta_x = 3.46157 delta_h = 1.52874 U_c = [[-0.0490883]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.135398 3.46157 2.59658 5.41082
W_c max, min, mean, abs_mean: 0.139566 0.135604 0.138597 0.138597
W_f max, min, mean, abs_mean: 0.119653 0.117858 0.119201 0.119201
Epoch 4/300
1s - loss: 845.7708 - val_loss: 3414.7904
Epoch 00003: val_loss improved from 3682.89700 to 3414.79040, saving model to xian_weights.hdf5
                xian   733.7      0.54  0.39  0.40      0.59  0.38  0.43      0.62  0.37  0.46
forget mean min: 0.942282 0.784023
delta_x = 2.8291 delta_h = 0.978926 U_c = [[-0.04544758]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.226662 2.8291 2.61426 3.13126
W_c max, min, mean, abs_mean: 0.149945 0.145857 0.14892 0.14892
W_f max, min, mean, abs_mean: 0.121336 0.119511 0.120839 0.120839
                xian  3414.8      0.78  0.13  0.70      0.80  0.10  0.74      0.81  0.08  0.76
forget mean min: 0.961266 0.784023
delta_x = 3.67443 delta_h = 1.50087 U_c = [[-0.04544758]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.363689 3.67443 2.87986 5.53812
W_c max, min, mean, abs_mean: 0.149945 0.145857 0.14892 0.14892
W_f max, min, mean, abs_mean: 0.121336 0.119511 0.120839 0.120839
Epoch 5/300
1s - loss: 827.0395 - val_loss: 3424.1904
Epoch 00004: val_loss did not improve
Epoch 6/300
1s - loss: 813.1603 - val_loss: 3663.8233
Epoch 00005: val_loss did not improve
Epoch 7/300
1s - loss: 800.7196 - val_loss: 3542.7674
Epoch 00006: val_loss did not improve
Epoch 8/300
1s - loss: 792.0442 - val_loss: 3426.5873
Epoch 00007: val_loss did not improve
Epoch 9/300
1s - loss: 782.5346 - val_loss: 3351.0919
Epoch 00008: val_loss improved from 3414.79040 to 3351.09194, saving model to xian_weights.hdf5
                xian   679.4      0.61  0.39  0.44      0.66  0.38  0.47      0.69  0.37  0.49
forget mean min: 0.93847 0.716749
delta_x = 3.22532 delta_h = 0.879802 U_c = [[-0.03892464]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.257616 3.22532 2.92679 3.66391
W_c max, min, mean, abs_mean: 0.176575 0.171622 0.175139 0.175139
W_f max, min, mean, abs_mean: 0.137752 0.135589 0.136926 0.136926
                xian  3351.1      0.79  0.12  0.71      0.81  0.10  0.74      0.82  0.08  0.76
forget mean min: 0.958608 0.716749
delta_x = 4.17054 delta_h = 1.29943 U_c = [[-0.03892464]]
delta mean, abs_mean, abs_mean+, abs_mean-: 0.261192 4.17054 3.26643 6.07752
W_c max, min, mean, abs_mean: 0.176575 0.171622 0.175139 0.175139
W_f max, min, mean, abs_mean: 0.137752 0.135589 0.136926 0.136926
Epoch 10/300
1s - loss: 776.9325 - val_loss: 3814.7226
Epoch 00009: val_loss did not improve
Epoch 11/300
1s - loss: 768.2889 - val_loss: 3490.4300
Epoch 00010: val_loss did not improve
Epoch 12/300
1s - loss: 762.4760 - val_loss: 3567.5199
Epoch 00011: val_loss did not improve
Epoch 13/300
1s - loss: 754.4308 - val_loss: 3486.1202
Epoch 00012: val_loss did not improve
Epoch 14/300
1s - loss: 747.5557 - val_loss: 3361.5015
Epoch 00013: val_loss did not improve
Epoch 15/300
1s - loss: 739.9524 - val_loss: 3846.9491
Epoch 00014: val_loss did not improve
Epoch 16/300
1s - loss: 730.2819 - val_loss: 3722.1187
Epoch 00015: val_loss did not improve
Epoch 17/300
1s - loss: 723.2611 - val_loss: 3732.0798
Epoch 00016: val_loss did not improve
Epoch 18/300
1s - loss: 716.3427 - val_loss: 3849.8610
Epoch 00017: val_loss did not improve
Epoch 19/300
1s - loss: 711.7171 - val_loss: 3821.6052
Epoch 00018: val_loss did not improve
Epoch 20/300
1s - loss: 704.4440 - val_loss: 3715.5957
Epoch 00019: val_loss did not improve
Epoch 21/300
1s - loss: 701.7191 - val_loss: 3740.3398
Epoch 00020: val_loss did not improve
Epoch 22/300
1s - loss: 698.0743 - val_loss: 3741.2425
Epoch 00021: val_loss did not improve
Epoch 23/300
1s - loss: 690.6326 - val_loss: 3687.4087
Epoch 00022: val_loss did not improve
Epoch 24/300
1s - loss: 685.3941 - val_loss: 3739.5738
Epoch 00023: val_loss did not improve
Epoch 25/300
1s - loss: 685.2433 - val_loss: 3860.9768
Epoch 00024: val_loss did not improve
Epoch 26/300
1s - loss: 680.0183 - val_loss: 3702.7523
Epoch 00025: val_loss did not improve
Epoch 27/300
1s - loss: 679.0506 - val_loss: 3639.8838
Epoch 00026: val_loss did not improve
Epoch 28/300
1s - loss: 676.7703 - val_loss: 3953.2906
Epoch 00027: val_loss did not improve
Epoch 29/300
1s - loss: 674.2223 - val_loss: 3966.3582
Epoch 00028: val_loss did not improve
Epoch 30/300
1s - loss: 669.2280 - val_loss: 3756.7136
Epoch 00029: val_loss did not improve

beijing
             beijing  1407.9      0.89  0.21  0.72      0.90  0.18  0.75      0.91  0.14  0.79
forget mean min: 0.867289 0.536363
delta_x = 7.79824 delta_h = 0.822186 U_c = [[-0.01475697]]
             beijing 11492.4      0.85  0.10  0.78      0.86  0.07  0.81      0.88  0.05  0.84
forget mean min: 0.882854 0.536363
delta_x = 10.3565 delta_h = 1.47512 U_c = [[-0.01475697]]

tianjin
             tianjin   801.8      0.82  0.20  0.68      0.85  0.15  0.74      0.82  0.12  0.74
forget mean min: 0.909659 0.614082
delta_x = 6.54244 delta_h = 1.27112 U_c = [[-0.03857955]]
             tianjin  5480.4      0.90  0.24  0.70      0.91  0.23  0.71      0.92  0.21  0.74
forget mean min: 0.933144 0.614082
delta_x = 7.68656 delta_h = 2.05328 U_c = [[-0.03857955]]

tangshan
            tangshan  1184.6      0.82  0.27  0.63      0.87  0.24  0.68      0.90  0.22  0.72
forget mean min: 0.932144 0.746395
delta_x = 6.32201 delta_h = 2.95504 U_c = [[-0.07639418]]
            tangshan  5778.8      0.93  0.13  0.82      0.95  0.09  0.87      0.95  0.09  0.86
forget mean min: 0.935792 0.746395
delta_x = 7.01518 delta_h = 3.40455 U_c = [[-0.07639418]]

baoding
             baoding  1036.7      0.88  0.18  0.74      0.92  0.17  0.78      0.93  0.15  0.80
forget mean min: 0.915817 0.54456
delta_x = 8.82787 delta_h = 0.948901 U_c = [[-0.01996557]]
             baoding 28215.5      0.95  0.11  0.85      0.95  0.07  0.88      0.95  0.05  0.90
forget mean min: 0.964566 0.54456
delta_x = 11.1495 delta_h = 1.82301 U_c = [[-0.01996557]]

shijiazhuang
        shijiazhuang   968.6      0.79  0.29  0.60      0.82  0.27  0.63      0.84  0.26  0.65
forget mean min: 0.912468 0.589369
delta_x = 7.01509 delta_h = 0.582974 U_c = [[-0.01624194]]
        shijiazhuang 12678.7      0.88  0.06  0.83      0.89  0.05  0.85      0.89  0.03  0.87
forget mean min: 0.928544 0.589369
delta_x = 7.69245 delta_h = 1.46551 U_c = [[-0.01624194]]

xingtai+handan
      xingtai+handan   997.5      0.80  0.28  0.61      0.84  0.23  0.67      0.86  0.20  0.70
forget mean min: 0.935542 0.638502
delta_x = 6.66555 delta_h = 1.3073 U_c = [[-0.0412065]]
      xingtai+handan 16843.1      0.95  0.14  0.82      0.96  0.10  0.87      0.95  0.08  0.87
forget mean min: 0.966745 0.640402
delta_x = 7.64176 delta_h = 2.61821 U_c = [[-0.0412065]]

jinan
               jinan  1959.1      0.78  0.33  0.56      0.80  0.29  0.60      0.82  0.26  0.63
forget mean min: 0.932822 0.755071
delta_x = 6.05651 delta_h = 2.73235 U_c = [[-0.08889527]]
               jinan  5240.4      0.96  0.16  0.82      0.97  0.12  0.85      0.95  0.09  0.86
forget mean min: 0.947373 0.755071
delta_x = 7.15451 delta_h = 4.24638 U_c = [[-0.08889527]]

xian
                xian   679.4      0.61  0.39  0.44      0.66  0.38  0.47      0.69  0.37  0.49
forget mean min: 0.93847 0.716749
delta_x = 3.22532 delta_h = 0.879802 U_c = [[-0.03892464]]
                xian  3351.1      0.79  0.12  0.71      0.81  0.10  0.74      0.82  0.08  0.76
forget mean min: 0.958608 0.716749
delta_x = 4.17054 delta_h = 1.29943 U_c = [[-0.03892464]]
