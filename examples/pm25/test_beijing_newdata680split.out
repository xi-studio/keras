X_train[0].shape = (3618, 40, 23)

training bj_newdata680split0
Train on 3618 samples, validate on 1098 samples
Before training:
 bj_newdata680split0 10875.7      0.03  -nan  0.03      0.06  -nan  0.05      0.09  -nan  0.09
forget mean min: 0.731058 0.731059
delta_x = 4.27293
delta_h = 2.69643
delta mean, abs_mean, abs_mean+, abs_mean-: -4.27293 4.27293 nan 4.27293
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
 bj_newdata680split0 52149.9      0.06  -nan  0.06      0.08  -nan  0.08      0.14  -nan  0.14
forget mean min: 0.731059 0.731059
delta_x = 9.22632
delta_h = 5.61792
delta mean, abs_mean, abs_mean+, abs_mean-: -9.22632 9.22632 nan 9.22632
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/500
0s - loss: 8965.2366 - val_loss: 30837.0833
Epoch 00000: val_loss improved from inf to 30837.08329, saving model to bj_newdata680split0_weights.hdf5
 bj_newdata680split0  5802.1      0.30  0.20  0.28      0.29  0.12  0.28      0.29  0.06  0.29
forget mean min: 0.87984 0.770192
delta_x = 3.46807
delta_h = 3.1307
delta mean, abs_mean, abs_mean+, abs_mean-: -2.96792 3.46807 1.10747 4.15658
U_c = [[-0.10555816]] U_f = [[ 0.]] b_f = [ 1.06440353]
W_c max, min, mean, abs_mean: 0.0940138 0.0924109 0.0935049 0.0935049
W_f max, min, mean, abs_mean: 0.0908739 0.0897425 0.0903177 0.0903177
 bj_newdata680split0 30837.1      0.71  0.13  0.64      0.71  0.07  0.67      0.73  0.05  0.70
forget mean min: 0.891107 0.770192
delta_x = 7.16802
delta_h = 6.61342
delta mean, abs_mean, abs_mean+, abs_mean-: -6.76786 7.16802 1.28137 8.2573
U_c = [[-0.10555816]] U_f = [[ 0.]] b_f = [ 1.06440353]
W_c max, min, mean, abs_mean: 0.0940138 0.0924109 0.0935049 0.0935049
W_f max, min, mean, abs_mean: 0.0908739 0.0897425 0.0903177 0.0903177
Epoch 2/500
0s - loss: 4155.5725 - val_loss: 21387.4321
Epoch 00001: val_loss improved from 30837.08329 to 21387.43209, saving model to bj_newdata680split0_weights.hdf5
 bj_newdata680split0  2834.5      0.83  0.28  0.63      0.80  0.22  0.65      0.80  0.17  0.69
forget mean min: 0.920774 0.789796
delta_x = 5.78188
delta_h = 2.83388
delta mean, abs_mean, abs_mean+, abs_mean-: 0.658325 5.78188 5.52286 6.14408
U_c = [[-0.06499363]] U_f = [[ 0.]] b_f = [ 1.07122362]
W_c max, min, mean, abs_mean: 0.149561 0.147979 0.149046 0.149046
W_f max, min, mean, abs_mean: 0.116037 0.114817 0.115447 0.115447
 bj_newdata680split0 21387.4      0.87  0.17  0.74      0.87  0.10  0.79      0.88  0.07  0.83
forget mean min: 0.930724 0.789796
delta_x = 8.4016
delta_h = 4.67961
delta mean, abs_mean, abs_mean+, abs_mean-: -1.5824 8.4016 5.40417 13.5255
U_c = [[-0.06499363]] U_f = [[ 0.]] b_f = [ 1.07122362]
W_c max, min, mean, abs_mean: 0.149561 0.147979 0.149046 0.149046
W_f max, min, mean, abs_mean: 0.116037 0.114817 0.115447 0.115447
Epoch 3/500
0s - loss: 2425.0305 - val_loss: 19718.1936
Epoch 00002: val_loss improved from 21387.43209 to 19718.19363, saving model to bj_newdata680split0_weights.hdf5
 bj_newdata680split0  2058.1      0.87  0.27  0.66      0.85  0.21  0.70      0.86  0.17  0.73
forget mean min: 0.908195 0.762787
delta_x = 7.10329
delta_h = 1.9149
delta mean, abs_mean, abs_mean+, abs_mean-: 0.667575 7.10329 6.8724 7.40363
U_c = [[-0.03544896]] U_f = [[ 0.]] b_f = [ 1.02155721]
W_c max, min, mean, abs_mean: 0.168431 0.166836 0.167909 0.167909
W_f max, min, mean, abs_mean: 0.107665 0.106352 0.107027 0.107027
 bj_newdata680split0 19718.2      0.85  0.16  0.73      0.85  0.10  0.78      0.87  0.07  0.81
forget mean min: 0.926053 0.762787
delta_x = 9.41026
delta_h = 3.03416
delta mean, abs_mean, abs_mean+, abs_mean-: -1.31188 9.41026 6.50882 14.1868
U_c = [[-0.03544896]] U_f = [[ 0.]] b_f = [ 1.02155721]
W_c max, min, mean, abs_mean: 0.168431 0.166836 0.167909 0.167909
W_f max, min, mean, abs_mean: 0.107665 0.106352 0.107027 0.107027
Epoch 4/500
0s - loss: 2090.4482 - val_loss: 19797.6780
Epoch 00003: val_loss did not improve
Epoch 5/500
0s - loss: 1991.5289 - val_loss: 20205.7628
Epoch 00004: val_loss did not improve
Epoch 6/500
0s - loss: 1944.5521 - val_loss: 19810.1030
Epoch 00005: val_loss did not improve
Epoch 7/500
0s - loss: 1917.9987 - val_loss: 20423.9620
Epoch 00006: val_loss did not improve
Epoch 8/500
0s - loss: 1891.3522 - val_loss: 19653.8831
Epoch 00007: val_loss improved from 19718.19363 to 19653.88315, saving model to bj_newdata680split0_weights.hdf5
 bj_newdata680split0  1777.7      0.88  0.26  0.67      0.86  0.19  0.72      0.87  0.16  0.74
forget mean min: 0.894573 0.702023
delta_x = 7.54196
delta_h = 1.11596
delta mean, abs_mean, abs_mean+, abs_mean-: 0.463694 7.54196 6.76922 8.66009
U_c = [[-0.01927838]] U_f = [[ 0.]] b_f = [ 0.85695052]
W_c max, min, mean, abs_mean: 0.181107 0.179436 0.180565 0.180565
W_f max, min, mean, abs_mean: 0.119975 0.118543 0.119316 0.119316
 bj_newdata680split0 19653.9      0.83  0.12  0.74      0.83  0.07  0.78      0.84  0.05  0.81
forget mean min: 0.910117 0.702023
delta_x = 10.5158
delta_h = 1.75496
delta mean, abs_mean, abs_mean+, abs_mean-: -1.832 10.5158 7.38388 14.986
U_c = [[-0.01927838]] U_f = [[ 0.]] b_f = [ 0.85695052]
W_c max, min, mean, abs_mean: 0.181107 0.179436 0.180565 0.180565
W_f max, min, mean, abs_mean: 0.119975 0.118543 0.119316 0.119316
Epoch 9/500
0s - loss: 1857.7682 - val_loss: 19888.2482
Epoch 00008: val_loss did not improve
Epoch 10/500
0s - loss: 1834.7229 - val_loss: 19864.4227
Epoch 00009: val_loss did not improve
Epoch 11/500
0s - loss: 1786.0898 - val_loss: 19929.6892
Epoch 00010: val_loss did not improve
Epoch 12/500
0s - loss: 1735.8736 - val_loss: 18993.7165
Epoch 00011: val_loss improved from 19653.88315 to 18993.71652, saving model to bj_newdata680split0_weights.hdf5
 bj_newdata680split0  1605.4      0.89  0.25  0.69      0.87  0.19  0.72      0.87  0.16  0.75
forget mean min: 0.893642 0.674046
delta_x = 7.64716
delta_h = 0.974226
delta mean, abs_mean, abs_mean+, abs_mean-: 0.437304 7.64716 6.71108 9.06493
U_c = [[-0.01687584]] U_f = [[ 0.]] b_f = [ 0.72654259]
W_c max, min, mean, abs_mean: 0.191372 0.189677 0.190866 0.190866
W_f max, min, mean, abs_mean: 0.148116 0.146031 0.146977 0.146977
 bj_newdata680split0 18993.7      0.83  0.13  0.74      0.83  0.07  0.78      0.85  0.05  0.81
forget mean min: 0.911094 0.674046
delta_x = 10.9689
delta_h = 1.59245
delta mean, abs_mean, abs_mean+, abs_mean-: -1.62704 10.9689 7.65734 16.1485
U_c = [[-0.01687584]] U_f = [[ 0.]] b_f = [ 0.72654259]
W_c max, min, mean, abs_mean: 0.191372 0.189677 0.190866 0.190866
W_f max, min, mean, abs_mean: 0.148116 0.146031 0.146977 0.146977
Epoch 13/500
0s - loss: 1685.0142 - val_loss: 19434.2754
Epoch 00012: val_loss did not improve
Epoch 14/500
0s - loss: 1646.7450 - val_loss: 19019.2437
Epoch 00013: val_loss did not improve
Epoch 15/500
0s - loss: 1612.8951 - val_loss: 19136.1505
Epoch 00014: val_loss did not improve
Epoch 16/500
0s - loss: 1580.2172 - val_loss: 19297.1993
Epoch 00015: val_loss did not improve
Epoch 17/500
0s - loss: 1554.3090 - val_loss: 19417.0022
Epoch 00016: val_loss did not improve
Epoch 18/500
0s - loss: 1529.3711 - val_loss: 19254.5451
Epoch 00017: val_loss did not improve
Epoch 19/500
0s - loss: 1513.2977 - val_loss: 19451.9096
Epoch 00018: val_loss did not improve
Epoch 20/500
0s - loss: 1497.9389 - val_loss: 19485.3093
Epoch 00019: val_loss did not improve
Epoch 21/500
0s - loss: 1470.0270 - val_loss: 19471.7912
Epoch 00020: val_loss did not improve
Epoch 22/500
0s - loss: 1451.2959 - val_loss: 19697.5106
Epoch 00021: val_loss did not improve
Epoch 23/500
0s - loss: 1441.7136 - val_loss: 19739.0705
Epoch 00022: val_loss did not improve
Epoch 24/500
0s - loss: 1430.1083 - val_loss: 19732.9132
Epoch 00023: val_loss did not improve
Epoch 25/500
0s - loss: 1411.5914 - val_loss: 19877.8652
Epoch 00024: val_loss did not improve
Epoch 26/500
0s - loss: 1401.6377 - val_loss: 19713.6965
Epoch 00025: val_loss did not improve
Epoch 27/500
0s - loss: 1383.4451 - val_loss: 19760.0947
Epoch 00026: val_loss did not improve
Epoch 28/500
0s - loss: 1370.8367 - val_loss: 19603.9579
Epoch 00027: val_loss did not improve
Epoch 29/500
0s - loss: 1370.5851 - val_loss: 19773.5263
Epoch 00028: val_loss did not improve
Epoch 30/500
0s - loss: 1354.6249 - val_loss: 19691.4506
Epoch 00029: val_loss did not improve
Epoch 31/500
0s - loss: 1344.7857 - val_loss: 19704.9936
Epoch 00030: val_loss did not improve
Epoch 32/500
0s - loss: 1332.9482 - val_loss: 19639.8527
Epoch 00031: val_loss did not improve
Epoch 33/500
0s - loss: 1318.2881 - val_loss: 20027.3062
Epoch 00032: val_loss did not improve
X_train[0].shape = (3618, 40, 23)

training bj_newdata680split1
Train on 3618 samples, validate on 1098 samples
Before training:
 bj_newdata680split1 10875.7      0.03  -nan  0.03      0.06  -nan  0.05      0.09  -nan  0.09
forget mean min: 0.731058 0.731059
delta_x = 4.27293
delta_h = 2.69643
delta mean, abs_mean, abs_mean+, abs_mean-: -4.27293 4.27293 nan 4.27293
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
 bj_newdata680split1 52149.9      0.06  -nan  0.06      0.08  -nan  0.08      0.14  -nan  0.14
forget mean min: 0.731059 0.731059
delta_x = 9.22632
delta_h = 5.61792
delta mean, abs_mean, abs_mean+, abs_mean-: -9.22632 9.22632 nan 9.22632
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/500
0s - loss: 9009.7909 - val_loss: 30850.9265
Epoch 00000: val_loss improved from inf to 30850.92654, saving model to bj_newdata680split1_weights.hdf5
 bj_newdata680split1  5794.6      0.30  0.21  0.28      0.29  0.13  0.28      0.29  0.07  0.29
forget mean min: 0.879054 0.769835
delta_x = 3.48784
delta_h = 3.15029
delta mean, abs_mean, abs_mean+, abs_mean-: -2.98689 3.48784 1.12187 4.16792
U_c = [[-0.10627127]] U_f = [[ 0.]] b_f = [ 1.0642606]
W_c max, min, mean, abs_mean: 0.0941874 0.08987 0.0936145 0.0936145
W_f max, min, mean, abs_mean: 0.090554 0.0862176 0.0898023 0.0898023
 bj_newdata680split1 30850.9      0.71  0.13  0.64      0.71  0.07  0.67      0.73  0.05  0.70
forget mean min: 0.890474 0.769835
delta_x = 7.21797
delta_h = 6.65372
delta mean, abs_mean, abs_mean+, abs_mean-: -6.8163 7.21797 1.29678 8.30305
U_c = [[-0.10627127]] U_f = [[ 0.]] b_f = [ 1.0642606]
W_c max, min, mean, abs_mean: 0.0941874 0.08987 0.0936145 0.0936145
W_f max, min, mean, abs_mean: 0.090554 0.0862176 0.0898023 0.0898023
Epoch 2/500
0s - loss: 4180.0646 - val_loss: 21400.6768
Epoch 00001: val_loss improved from 30850.92654 to 21400.67681, saving model to bj_newdata680split1_weights.hdf5
 bj_newdata680split1  2821.9      0.83  0.27  0.63      0.79  0.21  0.65      0.80  0.16  0.69
forget mean min: 0.91971 0.789211
delta_x = 5.7956
delta_h = 2.81273
delta mean, abs_mean, abs_mean+, abs_mean-: 0.63674 5.7956 5.52765 6.16844
U_c = [[-0.06426752]] U_f = [[ 0.]] b_f = [ 1.07185912]
W_c max, min, mean, abs_mean: 0.149595 0.145364 0.149018 0.149018
W_f max, min, mean, abs_mean: 0.115107 0.110857 0.114368 0.114368
 bj_newdata680split1 21400.7      0.87  0.17  0.74      0.87  0.10  0.79      0.88  0.07  0.82
forget mean min: 0.929543 0.789211
delta_x = 8.47458
delta_h = 4.67107
delta mean, abs_mean, abs_mean+, abs_mean-: -1.63207 8.47458 5.44268 13.6061
U_c = [[-0.06426752]] U_f = [[ 0.]] b_f = [ 1.07185912]
W_c max, min, mean, abs_mean: 0.149595 0.145364 0.149018 0.149018
W_f max, min, mean, abs_mean: 0.115107 0.110857 0.114368 0.114368
Epoch 3/500
0s - loss: 2419.2344 - val_loss: 19665.6359
Epoch 00002: val_loss improved from 21400.67681 to 19665.63589, saving model to bj_newdata680split1_weights.hdf5
 bj_newdata680split1  2078.1      0.87  0.28  0.65      0.85  0.21  0.69      0.86  0.18  0.73
forget mean min: 0.907787 0.762983
delta_x = 7.25653
delta_h = 1.87811
delta mean, abs_mean, abs_mean+, abs_mean-: 0.756511 7.25653 7.06172 7.512
U_c = [[-0.03377532]] U_f = [[ 0.]] b_f = [ 1.02139437]
W_c max, min, mean, abs_mean: 0.168632 0.164405 0.168037 0.168037
W_f max, min, mean, abs_mean: 0.108921 0.104157 0.108169 0.108169
 bj_newdata680split1 19665.6      0.84  0.17  0.72      0.85  0.10  0.77      0.86  0.07  0.81
forget mean min: 0.924917 0.762983
delta_x = 9.85466
delta_h = 3.0126
delta mean, abs_mean, abs_mean+, abs_mean-: -1.18818 9.85466 6.84491 15.0472
U_c = [[-0.03377532]] U_f = [[ 0.]] b_f = [ 1.02139437]
W_c max, min, mean, abs_mean: 0.168632 0.164405 0.168037 0.168037
W_f max, min, mean, abs_mean: 0.108921 0.104157 0.108169 0.108169
Epoch 4/500
0s - loss: 2108.3242 - val_loss: 19916.4620
Epoch 00003: val_loss did not improve
Epoch 5/500
0s - loss: 1999.2715 - val_loss: 19742.8483
Epoch 00004: val_loss did not improve
Epoch 6/500
0s - loss: 1945.1107 - val_loss: 19938.4422
Epoch 00005: val_loss did not improve
Epoch 7/500
0s - loss: 1910.0619 - val_loss: 19744.7245
Epoch 00006: val_loss did not improve
Epoch 8/500
0s - loss: 1867.1262 - val_loss: 19916.0765
Epoch 00007: val_loss did not improve
Epoch 9/500
0s - loss: 1827.1105 - val_loss: 19828.7198
Epoch 00008: val_loss did not improve
Epoch 10/500
0s - loss: 1763.5584 - val_loss: 19411.4100
Epoch 00009: val_loss improved from 19665.63589 to 19411.40996, saving model to bj_newdata680split1_weights.hdf5
 bj_newdata680split1  1621.3      0.89  0.24  0.69      0.87  0.18  0.73      0.88  0.15  0.76
forget mean min: 0.897159 0.681663
delta_x = 7.53137
delta_h = 1.16446
delta mean, abs_mean, abs_mean+, abs_mean-: 0.461197 7.53137 6.62386 8.91161
U_c = [[-0.02041919]] U_f = [[ 0.]] b_f = [ 0.76142275]
W_c max, min, mean, abs_mean: 0.182496 0.178202 0.181866 0.181866
W_f max, min, mean, abs_mean: 0.157165 0.151275 0.156182 0.156182
 bj_newdata680split1 19411.4      0.82  0.15  0.72      0.82  0.08  0.76      0.84  0.07  0.79
forget mean min: 0.916089 0.681663
delta_x = 10.7229
delta_h = 1.91984
delta mean, abs_mean, abs_mean+, abs_mean-: -1.52481 10.7229 7.26423 16.691
U_c = [[-0.02041919]] U_f = [[ 0.]] b_f = [ 0.76142275]
W_c max, min, mean, abs_mean: 0.182496 0.178202 0.181866 0.181866
W_f max, min, mean, abs_mean: 0.157165 0.151275 0.156182 0.156182
Epoch 11/500
0s - loss: 1714.6201 - val_loss: 19580.8161
Epoch 00010: val_loss did not improve
Epoch 12/500
0s - loss: 1662.9244 - val_loss: 19216.2617
Epoch 00011: val_loss improved from 19411.40996 to 19216.26174, saving model to bj_newdata680split1_weights.hdf5
 bj_newdata680split1  1522.2      0.89  0.23  0.70      0.87  0.17  0.73      0.88  0.14  0.76
forget mean min: 0.892696 0.660612
delta_x = 7.69297
delta_h = 1.05147
delta mean, abs_mean, abs_mean+, abs_mean-: 0.393522 7.69297 6.65187 9.30662
U_c = [[-0.01830176]] U_f = [[ 0.]] b_f = [ 0.66602474]
W_c max, min, mean, abs_mean: 0.189891 0.185653 0.18934 0.18934
W_f max, min, mean, abs_mean: 0.183819 0.177872 0.182715 0.182715
 bj_newdata680split1 19216.3      0.81  0.15  0.71      0.81  0.09  0.75      0.83  0.07  0.78
forget mean min: 0.914412 0.660612
delta_x = 11.2281
delta_h = 1.79334
delta mean, abs_mean, abs_mean+, abs_mean-: -1.38742 11.2281 7.52782 18.2105
U_c = [[-0.01830176]] U_f = [[ 0.]] b_f = [ 0.66602474]
W_c max, min, mean, abs_mean: 0.189891 0.185653 0.18934 0.18934
W_f max, min, mean, abs_mean: 0.183819 0.177872 0.182715 0.182715
Epoch 13/500
0s - loss: 1626.5173 - val_loss: 19212.0737
Epoch 00012: val_loss improved from 19216.26174 to 19212.07366, saving model to bj_newdata680split1_weights.hdf5
 bj_newdata680split1  1481.3      0.88  0.22  0.71      0.86  0.17  0.73      0.87  0.14  0.76
forget mean min: 0.889134 0.649743
delta_x = 7.72864
delta_h = 0.969037
delta mean, abs_mean, abs_mean+, abs_mean-: 0.305073 7.72864 6.63001 9.41741
U_c = [[-0.01694559]] U_f = [[ 0.]] b_f = [ 0.61790943]
W_c max, min, mean, abs_mean: 0.193321 0.189107 0.192798 0.192798
W_f max, min, mean, abs_mean: 0.194222 0.188249 0.193045 0.193045
 bj_newdata680split1 19212.1      0.81  0.15  0.71      0.81  0.09  0.75      0.83  0.07  0.78
forget mean min: 0.912255 0.649743
delta_x = 11.3328
delta_h = 1.6743
delta mean, abs_mean, abs_mean+, abs_mean-: -1.44329 11.3328 7.58233 18.3638
U_c = [[-0.01694559]] U_f = [[ 0.]] b_f = [ 0.61790943]
W_c max, min, mean, abs_mean: 0.193321 0.189107 0.192798 0.192798
W_f max, min, mean, abs_mean: 0.194222 0.188249 0.193045 0.193045
Epoch 14/500
0s - loss: 1587.5595 - val_loss: 19006.0766
Epoch 00013: val_loss improved from 19212.07366 to 19006.07662, saving model to bj_newdata680split1_weights.hdf5
 bj_newdata680split1  1460.0      0.89  0.23  0.70      0.87  0.18  0.73      0.88  0.15  0.76
forget mean min: 0.887382 0.638351
delta_x = 8.0236
delta_h = 0.964645
delta mean, abs_mean, abs_mean+, abs_mean-: 0.399624 8.0236 6.86595 9.86042
U_c = [[-0.01645431]] U_f = [[ 0.]] b_f = [ 0.56821507]
W_c max, min, mean, abs_mean: 0.19884 0.194646 0.19834 0.19834
W_f max, min, mean, abs_mean: 0.207108 0.20114 0.205875 0.205875
 bj_newdata680split1 19006.1      0.81  0.15  0.71      0.81  0.09  0.75      0.83  0.07  0.78
forget mean min: 0.910412 0.638351
delta_x = 11.7646
delta_h = 1.67114
delta mean, abs_mean, abs_mean+, abs_mean-: -1.3223 11.7646 7.88962 19.3462
U_c = [[-0.01645431]] U_f = [[ 0.]] b_f = [ 0.56821507]
W_c max, min, mean, abs_mean: 0.19884 0.194646 0.19834 0.19834
W_f max, min, mean, abs_mean: 0.207108 0.20114 0.205875 0.205875
Epoch 15/500
0s - loss: 1564.3279 - val_loss: 19216.7092
Epoch 00014: val_loss did not improve
Epoch 16/500
0s - loss: 1530.6177 - val_loss: 19351.5143
Epoch 00015: val_loss did not improve
Epoch 17/500
0s - loss: 1501.6135 - val_loss: 19272.3322
Epoch 00016: val_loss did not improve
Epoch 18/500
0s - loss: 1479.3791 - val_loss: 19342.6996
Epoch 00017: val_loss did not improve
Epoch 19/500
0s - loss: 1461.5703 - val_loss: 19397.6144
Epoch 00018: val_loss did not improve
Epoch 20/500
0s - loss: 1437.8408 - val_loss: 19282.4122
Epoch 00019: val_loss did not improve
Epoch 21/500
0s - loss: 1423.7921 - val_loss: 19594.7222
Epoch 00020: val_loss did not improve
Epoch 22/500
0s - loss: 1404.9314 - val_loss: 19613.2508
Epoch 00021: val_loss did not improve
Epoch 23/500
0s - loss: 1403.3451 - val_loss: 19509.4087
Epoch 00022: val_loss did not improve
Epoch 24/500
0s - loss: 1377.7723 - val_loss: 19822.9378
Epoch 00023: val_loss did not improve
Epoch 25/500
0s - loss: 1365.3939 - val_loss: 19515.6985
Epoch 00024: val_loss did not improve
Epoch 26/500
0s - loss: 1355.8208 - val_loss: 19622.8220
Epoch 00025: val_loss did not improve
Epoch 27/500
0s - loss: 1342.6380 - val_loss: 19653.0948
Epoch 00026: val_loss did not improve
Epoch 28/500
0s - loss: 1335.8109 - val_loss: 19865.0177
Epoch 00027: val_loss did not improve
Epoch 29/500
0s - loss: 1322.3132 - val_loss: 19973.7866
Epoch 00028: val_loss did not improve
Epoch 30/500
0s - loss: 1310.5356 - val_loss: 20824.8365
Epoch 00029: val_loss did not improve
Epoch 31/500
0s - loss: 1303.1284 - val_loss: 19986.8474
Epoch 00030: val_loss did not improve
Epoch 32/500
0s - loss: 1288.8263 - val_loss: 20501.9892
Epoch 00031: val_loss did not improve
Epoch 33/500
0s - loss: 1285.7965 - val_loss: 20221.0015
Epoch 00032: val_loss did not improve
Epoch 34/500
0s - loss: 1269.0967 - val_loss: 20784.3053
Epoch 00033: val_loss did not improve
Epoch 35/500
0s - loss: 1266.1716 - val_loss: 20550.9514
Epoch 00034: val_loss did not improve
X_train[0].shape = (3618, 40, 23)

training bj_newdata680split2
Train on 3618 samples, validate on 1098 samples
Before training:
 bj_newdata680split2 10875.7      0.03  -nan  0.03      0.06  -nan  0.05      0.09  -nan  0.09
forget mean min: 0.731058 0.731059
delta_x = 4.27293
delta_h = 2.69643
delta mean, abs_mean, abs_mean+, abs_mean-: -4.27293 4.27293 nan 4.27293
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
 bj_newdata680split2 52149.9      0.06  -nan  0.06      0.08  -nan  0.08      0.14  -nan  0.14
forget mean min: 0.731059 0.731059
delta_x = 9.22632
delta_h = 5.61792
delta mean, abs_mean, abs_mean+, abs_mean-: -9.22632 9.22632 nan 9.22632
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/500
0s - loss: 9030.9613 - val_loss: 31061.1201
Epoch 00000: val_loss improved from inf to 31061.12014, saving model to bj_newdata680split2_weights.hdf5
 bj_newdata680split2  5891.0      0.30  0.20  0.28      0.28  0.12  0.27      0.29  0.06  0.28
forget mean min: 0.877229 0.769469
delta_x = 3.53284
delta_h = 3.18368
delta mean, abs_mean, abs_mean+, abs_mean-: -3.0582 3.53284 1.08575 4.21732
U_c = [[-0.10601571]] U_f = [[ 0.]] b_f = [ 1.06553936]
W_c max, min, mean, abs_mean: 0.0950879 0.000756541 0.0894803 0.0894803
W_f max, min, mean, abs_mean: 0.0915737 0.00116176 0.0867226 0.0867226
 bj_newdata680split2 31061.1      0.70  0.13  0.64      0.70  0.07  0.67      0.73  0.05  0.70
forget mean min: 0.889639 0.769469
delta_x = 7.25093
delta_h = 6.6826
delta mean, abs_mean, abs_mean+, abs_mean-: -6.86576 7.25093 1.28334 8.3046
U_c = [[-0.10601571]] U_f = [[ 0.]] b_f = [ 1.06553936]
W_c max, min, mean, abs_mean: 0.0950879 0.000756541 0.0894803 0.0894803
W_f max, min, mean, abs_mean: 0.0915737 0.00116176 0.0867226 0.0867226
Epoch 2/500
0s - loss: 4301.2738 - val_loss: 21553.4059
Epoch 00001: val_loss improved from 31061.12014 to 21553.40589, saving model to bj_newdata680split2_weights.hdf5
 bj_newdata680split2  2949.7      0.83  0.28  0.62      0.79  0.22  0.65      0.80  0.17  0.69
forget mean min: 0.92098 0.791663
delta_x = 5.72695
delta_h = 2.84744
delta mean, abs_mean, abs_mean+, abs_mean-: 0.681611 5.72695 5.43931 6.13932
U_c = [[-0.06520349]] U_f = [[ 0.]] b_f = [ 1.07790732]
W_c max, min, mean, abs_mean: 0.150754 0.000756541 0.142369 0.142369
W_f max, min, mean, abs_mean: 0.119408 0.00116176 0.113109 0.113109
 bj_newdata680split2 21553.4      0.86  0.17  0.73      0.87  0.10  0.79      0.88  0.07  0.82
forget mean min: 0.930326 0.791663
delta_x = 8.51639
delta_h = 4.71931
delta mean, abs_mean, abs_mean+, abs_mean-: -1.58299 8.51639 5.47433 13.7693
U_c = [[-0.06520349]] U_f = [[ 0.]] b_f = [ 1.07790732]
W_c max, min, mean, abs_mean: 0.150754 0.000756541 0.142369 0.142369
W_f max, min, mean, abs_mean: 0.119408 0.00116176 0.113109 0.113109
Epoch 3/500
0s - loss: 2483.3460 - val_loss: 20094.0790
Epoch 00002: val_loss improved from 21553.40589 to 20094.07896, saving model to bj_newdata680split2_weights.hdf5
 bj_newdata680split2  2087.3      0.85  0.25  0.66      0.83  0.20  0.69      0.83  0.16  0.71
forget mean min: 0.904688 0.763165
delta_x = 6.8788
delta_h = 1.91269
delta mean, abs_mean, abs_mean+, abs_mean-: 0.467565 6.8788 6.63095 7.18661
U_c = [[-0.03664199]] U_f = [[ 0.]] b_f = [ 1.02512777]
W_c max, min, mean, abs_mean: 0.169953 0.000756541 0.160611 0.160611
W_f max, min, mean, abs_mean: 0.106113 0.00116176 0.10035 0.10035
 bj_newdata680split2 20094.1      0.84  0.16  0.73      0.84  0.09  0.78      0.86  0.06  0.81
forget mean min: 0.922264 0.763165
delta_x = 9.29844
delta_h = 3.09883
delta mean, abs_mean, abs_mean+, abs_mean-: -1.578 9.29844 6.32615 13.9513
U_c = [[-0.03664199]] U_f = [[ 0.]] b_f = [ 1.02512777]
W_c max, min, mean, abs_mean: 0.169953 0.000756541 0.160611 0.160611
W_f max, min, mean, abs_mean: 0.106113 0.00116176 0.10035 0.10035
Epoch 4/500
0s - loss: 2103.8121 - val_loss: 19575.7145
Epoch 00003: val_loss improved from 20094.07896 to 19575.71447, saving model to bj_newdata680split2_weights.hdf5
 bj_newdata680split2  1929.0      0.87  0.27  0.66      0.85  0.21  0.70      0.86  0.17  0.73
forget mean min: 0.903 0.746428
delta_x = 7.24437
delta_h = 1.53377
delta mean, abs_mean, abs_mean+, abs_mean-: 0.553067 7.24437 6.75263 7.91614
U_c = [[-0.0274371]] U_f = [[ 0.]] b_f = [ 0.98693705]
W_c max, min, mean, abs_mean: 0.173521 0.000756541 0.164004 0.164004
W_f max, min, mean, abs_mean: 0.113473 0.00116176 0.107347 0.107347
 bj_newdata680split2 19575.7      0.84  0.15  0.73      0.83  0.09  0.77      0.86  0.06  0.81
forget mean min: 0.920931 0.746428
delta_x = 9.989
delta_h = 2.45812
delta mean, abs_mean, abs_mean+, abs_mean-: -1.45893 9.989 6.83951 15.2067
U_c = [[-0.0274371]] U_f = [[ 0.]] b_f = [ 0.98693705]
W_c max, min, mean, abs_mean: 0.173521 0.000756541 0.164004 0.164004
W_f max, min, mean, abs_mean: 0.113473 0.00116176 0.107347 0.107347
Epoch 5/500
0s - loss: 2011.3174 - val_loss: 20187.6987
Epoch 00004: val_loss did not improve
Epoch 6/500
0s - loss: 1956.7913 - val_loss: 20222.7867
Epoch 00005: val_loss did not improve
Epoch 7/500
0s - loss: 1923.9817 - val_loss: 20431.6032
Epoch 00006: val_loss did not improve
Epoch 8/500
0s - loss: 1891.4127 - val_loss: 19946.8879
Epoch 00007: val_loss did not improve
Epoch 9/500
0s - loss: 1863.2051 - val_loss: 19653.3285
Epoch 00008: val_loss did not improve
Epoch 10/500
0s - loss: 1817.1406 - val_loss: 20176.2254
Epoch 00009: val_loss did not improve
Epoch 11/500
0s - loss: 1774.7922 - val_loss: 19555.4895
Epoch 00010: val_loss improved from 19575.71447 to 19555.48946, saving model to bj_newdata680split2_weights.hdf5
 bj_newdata680split2  1624.3      0.88  0.23  0.69      0.85  0.17  0.72      0.86  0.14  0.75
forget mean min: 0.89362 0.681095
delta_x = 7.40144
delta_h = 1.11142
delta mean, abs_mean, abs_mean+, abs_mean-: 0.33559 7.40144 6.49382 8.73887
U_c = [[-0.01986438]] U_f = [[ 0.]] b_f = [ 0.75880778]
W_c max, min, mean, abs_mean: 0.18751 0.000756541 0.177288 0.177288
W_f max, min, mean, abs_mean: 0.151898 0.00116176 0.143698 0.143698
 bj_newdata680split2 19555.5      0.82  0.13  0.73      0.82  0.08  0.77      0.84  0.06  0.80
forget mean min: 0.911918 0.681095
delta_x = 10.6019
delta_h = 1.84083
delta mean, abs_mean, abs_mean+, abs_mean-: -1.71279 10.6019 7.26748 15.8517
U_c = [[-0.01986438]] U_f = [[ 0.]] b_f = [ 0.75880778]
W_c max, min, mean, abs_mean: 0.18751 0.000756541 0.177288 0.177288
W_f max, min, mean, abs_mean: 0.151898 0.00116176 0.143698 0.143698
Epoch 12/500
0s - loss: 1723.0809 - val_loss: 19366.0871
Epoch 00011: val_loss improved from 19555.48946 to 19366.08710, saving model to bj_newdata680split2_weights.hdf5
 bj_newdata680split2  1576.4      0.88  0.23  0.70      0.86  0.17  0.73      0.86  0.14  0.75
forget mean min: 0.89301 0.671662
delta_x = 7.52254
delta_h = 1.0323
delta mean, abs_mean, abs_mean+, abs_mean-: 0.335225 7.52254 6.53196 9.01779
U_c = [[-0.01816918]] U_f = [[ 0.]] b_f = [ 0.71570957]
W_c max, min, mean, abs_mean: 0.190561 0.000756541 0.180179 0.180179
W_f max, min, mean, abs_mean: 0.164059 0.00116176 0.155149 0.155149
 bj_newdata680split2 19366.1      0.82  0.14  0.72      0.81  0.08  0.76      0.83  0.06  0.79
forget mean min: 0.912876 0.671662
delta_x = 10.8377
delta_h = 1.73205
delta mean, abs_mean, abs_mean+, abs_mean-: -1.59215 10.8377 7.41944 16.4881
U_c = [[-0.01816918]] U_f = [[ 0.]] b_f = [ 0.71570957]
W_c max, min, mean, abs_mean: 0.190561 0.000756541 0.180179 0.180179
W_f max, min, mean, abs_mean: 0.164059 0.00116176 0.155149 0.155149
Epoch 13/500
0s - loss: 1679.2080 - val_loss: 19357.6708
Epoch 00012: val_loss improved from 19366.08710 to 19357.67079, saving model to bj_newdata680split2_weights.hdf5
 bj_newdata680split2  1533.5      0.88  0.22  0.70      0.86  0.17  0.73      0.86  0.14  0.75
forget mean min: 0.892151 0.66197
delta_x = 7.47294
delta_h = 1.02167
delta mean, abs_mean, abs_mean+, abs_mean-: 0.286885 7.47294 6.39858 9.12795
U_c = [[-0.01828779]] U_f = [[ 0.]] b_f = [ 0.67208624]
W_c max, min, mean, abs_mean: 0.192646 0.000756541 0.18215 0.18215
W_f max, min, mean, abs_mean: 0.175958 0.00116176 0.166345 0.166345
 bj_newdata680split2 19357.7      0.81  0.14  0.72      0.81  0.08  0.76      0.83  0.06  0.79
forget mean min: 0.912486 0.66197
delta_x = 10.8927
delta_h = 1.74647
delta mean, abs_mean, abs_mean+, abs_mean-: -1.5777 10.8927 7.39113 16.8585
U_c = [[-0.01828779]] U_f = [[ 0.]] b_f = [ 0.67208624]
W_c max, min, mean, abs_mean: 0.192646 0.000756541 0.18215 0.18215
W_f max, min, mean, abs_mean: 0.175958 0.00116176 0.166345 0.166345
Epoch 14/500
0s - loss: 1642.4075 - val_loss: 19306.7900
Epoch 00013: val_loss improved from 19357.67079 to 19306.78995, saving model to bj_newdata680split2_weights.hdf5
 bj_newdata680split2  1500.9      0.87  0.21  0.71      0.85  0.16  0.73      0.86  0.14  0.75
forget mean min: 0.889411 0.651573
delta_x = 7.53478
delta_h = 1.00902
delta mean, abs_mean, abs_mean+, abs_mean-: 0.238406 7.53478 6.40193 9.28519
U_c = [[-0.01818356]] U_f = [[ 0.]] b_f = [ 0.62596148]
W_c max, min, mean, abs_mean: 0.196752 0.000756541 0.18604 0.18604
W_f max, min, mean, abs_mean: 0.185772 0.00116176 0.175552 0.175552
 bj_newdata680split2 19306.8      0.81  0.14  0.72      0.81  0.08  0.76      0.83  0.06  0.78
forget mean min: 0.910833 0.651573
delta_x = 11.0496
delta_h = 1.74856
delta mean, abs_mean, abs_mean+, abs_mean-: -1.58309 11.0496 7.4348 17.3829
U_c = [[-0.01818356]] U_f = [[ 0.]] b_f = [ 0.62596148]
W_c max, min, mean, abs_mean: 0.196752 0.000756541 0.18604 0.18604
W_f max, min, mean, abs_mean: 0.185772 0.00116176 0.175552 0.175552
Epoch 15/500
0s - loss: 1604.4020 - val_loss: 19034.1157
Epoch 00014: val_loss improved from 19306.78995 to 19034.11570, saving model to bj_newdata680split2_weights.hdf5
 bj_newdata680split2  1471.3      0.89  0.23  0.70      0.87  0.17  0.74      0.88  0.15  0.76
forget mean min: 0.888759 0.641169
delta_x = 7.9114
delta_h = 0.904009
delta mean, abs_mean, abs_mean+, abs_mean-: 0.373578 7.9114 6.71522 9.83744
U_c = [[-0.01553585]] U_f = [[ 0.]] b_f = [ 0.58044213]
W_c max, min, mean, abs_mean: 0.203063 0.000756541 0.192023 0.192023
W_f max, min, mean, abs_mean: 0.198609 0.00116176 0.187647 0.187647
 bj_newdata680split2 19034.1      0.81  0.15  0.72      0.81  0.08  0.75      0.83  0.07  0.78
forget mean min: 0.910199 0.641169
delta_x = 11.625
delta_h = 1.57012
delta mean, abs_mean, abs_mean+, abs_mean-: -1.39175 11.625 7.80776 18.8828
U_c = [[-0.01553585]] U_f = [[ 0.]] b_f = [ 0.58044213]
W_c max, min, mean, abs_mean: 0.203063 0.000756541 0.192023 0.192023
W_f max, min, mean, abs_mean: 0.198609 0.00116176 0.187647 0.187647
Epoch 16/500
0s - loss: 1567.8955 - val_loss: 19208.0702
Epoch 00015: val_loss did not improve
Epoch 17/500
0s - loss: 1541.4782 - val_loss: 19148.9047
Epoch 00016: val_loss did not improve
Epoch 18/500
0s - loss: 1521.0008 - val_loss: 19103.1032
Epoch 00017: val_loss did not improve
Epoch 19/500
0s - loss: 1499.4718 - val_loss: 19360.6632
Epoch 00018: val_loss did not improve
Epoch 20/500
0s - loss: 1480.3944 - val_loss: 19517.3917
Epoch 00019: val_loss did not improve
Epoch 21/500
0s - loss: 1460.0653 - val_loss: 19633.2951
Epoch 00020: val_loss did not improve
Epoch 22/500
0s - loss: 1440.9114 - val_loss: 19657.8172
Epoch 00021: val_loss did not improve
Epoch 23/500
0s - loss: 1432.6248 - val_loss: 19854.7383
Epoch 00022: val_loss did not improve
Epoch 24/500
0s - loss: 1411.2458 - val_loss: 19592.1049
Epoch 00023: val_loss did not improve
Epoch 25/500
0s - loss: 1397.2841 - val_loss: 20268.2706
Epoch 00024: val_loss did not improve
Epoch 26/500
0s - loss: 1392.8894 - val_loss: 19905.1040
Epoch 00025: val_loss did not improve
Epoch 27/500
0s - loss: 1381.6824 - val_loss: 19887.9785
Epoch 00026: val_loss did not improve
Epoch 28/500
0s - loss: 1372.5277 - val_loss: 20089.7424
Epoch 00027: val_loss did not improve
Epoch 29/500
0s - loss: 1363.6673 - val_loss: 19754.5815
Epoch 00028: val_loss did not improve
Epoch 30/500
0s - loss: 1353.9044 - val_loss: 19845.0532
Epoch 00029: val_loss did not improve
Epoch 31/500
0s - loss: 1343.2244 - val_loss: 20224.8716
Epoch 00030: val_loss did not improve
Epoch 32/500
0s - loss: 1332.6667 - val_loss: 20054.4415
Epoch 00031: val_loss did not improve
Epoch 33/500
0s - loss: 1318.3126 - val_loss: 20227.9016
Epoch 00032: val_loss did not improve
Epoch 34/500
0s - loss: 1311.0565 - val_loss: 20375.1533
Epoch 00033: val_loss did not improve
Epoch 35/500
0s - loss: 1301.1384 - val_loss: 20765.0740
Epoch 00034: val_loss did not improve
Epoch 36/500
0s - loss: 1296.1086 - val_loss: 20771.2602
Epoch 00035: val_loss did not improve
X_train[0].shape = (3618, 40, 23)

training bj_newdata680split3
Train on 3618 samples, validate on 1098 samples
Before training:
 bj_newdata680split3 10875.7      0.03  -nan  0.03      0.06  -nan  0.05      0.09  -nan  0.09
forget mean min: 0.731058 0.731059
delta_x = 4.27293
delta_h = 2.69643
delta mean, abs_mean, abs_mean+, abs_mean-: -4.27293 4.27293 nan 4.27293
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
 bj_newdata680split3 52149.9      0.06  -nan  0.06      0.08  -nan  0.08      0.14  -nan  0.14
forget mean min: 0.731059 0.731059
delta_x = 9.22632
delta_h = 5.61792
delta mean, abs_mean, abs_mean+, abs_mean-: -9.22632 9.22632 nan 9.22632
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/500
0s - loss: 9091.8287 - val_loss: 31554.1263
Epoch 00000: val_loss improved from inf to 31554.12629, saving model to bj_newdata680split3_weights.hdf5
 bj_newdata680split3  5932.6      0.28  0.18  0.26      0.27  0.11  0.26      0.27  0.05  0.27
forget mean min: 0.877155 0.769315
delta_x = 3.45515
delta_h = 3.14143
delta mean, abs_mean, abs_mean+, abs_mean-: -3.12908 3.45515 0.884535 4.03604
U_c = [[-0.10516339]] U_f = [[ 0.]] b_f = [ 1.06583774]
W_c max, min, mean, abs_mean: 0.0939169 0.00413896 0.0886202 0.0886202
W_f max, min, mean, abs_mean: 0.0916368 0.00202686 0.0864223 0.0864223
 bj_newdata680split3 31554.1      0.69  0.12  0.63      0.69  0.07  0.66      0.72  0.04  0.69
forget mean min: 0.887708 0.769315
delta_x = 7.31576
delta_h = 6.69721
delta mean, abs_mean, abs_mean+, abs_mean-: -7.11577 7.31576 0.889559 8.12961
U_c = [[-0.10516339]] U_f = [[ 0.]] b_f = [ 1.06583774]
W_c max, min, mean, abs_mean: 0.0939169 0.00413896 0.0886202 0.0886202
W_f max, min, mean, abs_mean: 0.0916368 0.00202686 0.0864223 0.0864223
Epoch 2/500
0s - loss: 4270.7179 - val_loss: 21827.1007
Epoch 00001: val_loss improved from 31554.12629 to 21827.10065, saving model to bj_newdata680split3_weights.hdf5
 bj_newdata680split3  2926.6      0.81  0.26  0.63      0.77  0.20  0.65      0.78  0.15  0.68
forget mean min: 0.920266 0.789682
delta_x = 5.51278
delta_h = 2.82509
delta mean, abs_mean, abs_mean+, abs_mean-: 0.462648 5.51278 5.14765 6.01784
U_c = [[-0.06817207]] U_f = [[ 0.]] b_f = [ 1.07632077]
W_c max, min, mean, abs_mean: 0.149136 0.00413896 0.141086 0.141086
W_f max, min, mean, abs_mean: 0.118196 0.00202686 0.111593 0.111593
 bj_newdata680split3 21827.1      0.87  0.17  0.74      0.87  0.10  0.79      0.88  0.07  0.83
forget mean min: 0.929638 0.789682
delta_x = 8.11799
delta_h = 4.75406
delta mean, abs_mean, abs_mean+, abs_mean-: -1.85967 8.11799 5.02772 13.2113
U_c = [[-0.06817207]] U_f = [[ 0.]] b_f = [ 1.07632077]
W_c max, min, mean, abs_mean: 0.149136 0.00413896 0.141086 0.141086
W_f max, min, mean, abs_mean: 0.118196 0.00202686 0.111593 0.111593
Epoch 3/500
0s - loss: 2476.6492 - val_loss: 19786.2401
Epoch 00002: val_loss improved from 21827.10065 to 19786.24005, saving model to bj_newdata680split3_weights.hdf5
 bj_newdata680split3  2087.0      0.87  0.28  0.65      0.85  0.21  0.69      0.86  0.17  0.73
forget mean min: 0.909733 0.766284
delta_x = 7.13995
delta_h = 1.90192
delta mean, abs_mean, abs_mean+, abs_mean-: 0.743912 7.13995 6.93596 7.40851
U_c = [[-0.03473572]] U_f = [[ 0.]] b_f = [ 1.02764726]
W_c max, min, mean, abs_mean: 0.17066 0.00413896 0.161538 0.161538
W_f max, min, mean, abs_mean: 0.112761 0.00202686 0.106339 0.106339
 bj_newdata680split3 19786.2      0.85  0.17  0.72      0.85  0.10  0.77      0.87  0.07  0.81
forget mean min: 0.926502 0.766284
delta_x = 9.62741
delta_h = 3.04306
delta mean, abs_mean, abs_mean+, abs_mean-: -1.21391 9.62741 6.65683 14.7278
U_c = [[-0.03473572]] U_f = [[ 0.]] b_f = [ 1.02764726]
W_c max, min, mean, abs_mean: 0.17066 0.00413896 0.161538 0.161538
W_f max, min, mean, abs_mean: 0.112761 0.00202686 0.106339 0.106339
Epoch 4/500
0s - loss: 2111.4224 - val_loss: 19623.6907
Epoch 00003: val_loss improved from 19786.24005 to 19623.69068, saving model to bj_newdata680split3_weights.hdf5
 bj_newdata680split3  1927.5      0.86  0.27  0.66      0.85  0.20  0.69      0.86  0.17  0.73
forget mean min: 0.903813 0.744821
delta_x = 7.20441
delta_h = 1.51029
delta mean, abs_mean, abs_mean+, abs_mean-: 0.542712 7.20441 6.66455 7.95368
U_c = [[-0.02703722]] U_f = [[ 0.]] b_f = [ 0.98449111]
W_c max, min, mean, abs_mean: 0.171281 0.00413896 0.16213 0.16213
W_f max, min, mean, abs_mean: 0.116771 0.00202686 0.11018 0.11018
 bj_newdata680split3 19623.7      0.84  0.15  0.73      0.83  0.09  0.77      0.86  0.07  0.81
forget mean min: 0.922229 0.744821
delta_x = 9.96597
delta_h = 2.4403
delta mean, abs_mean, abs_mean+, abs_mean-: -1.41018 9.96597 6.78286 15.402
U_c = [[-0.02703722]] U_f = [[ 0.]] b_f = [ 0.98449111]
W_c max, min, mean, abs_mean: 0.171281 0.00413896 0.16213 0.16213
W_f max, min, mean, abs_mean: 0.116771 0.00202686 0.11018 0.11018
Epoch 5/500
0s - loss: 1995.7627 - val_loss: 19663.1350
Epoch 00004: val_loss did not improve
Epoch 6/500
0s - loss: 1940.5317 - val_loss: 20003.3759
Epoch 00005: val_loss did not improve
Epoch 7/500
0s - loss: 1906.0378 - val_loss: 19641.4362
Epoch 00006: val_loss did not improve
Epoch 8/500
0s - loss: 1862.4969 - val_loss: 19556.2305
Epoch 00007: val_loss improved from 19623.69068 to 19556.23050, saving model to bj_newdata680split3_weights.hdf5
 bj_newdata680split3  1721.4      0.88  0.25  0.68      0.86  0.19  0.72      0.87  0.16  0.75
forget mean min: 0.898089 0.699949
delta_x = 7.34299
delta_h = 1.2041
delta mean, abs_mean, abs_mean+, abs_mean-: 0.440839 7.34299 6.52024 8.56128
U_c = [[-0.02137079]] U_f = [[ 0.]] b_f = [ 0.84705681]
W_c max, min, mean, abs_mean: 0.180095 0.0140391 0.170992 0.170992
W_f max, min, mean, abs_mean: 0.138058 0.0215535 0.131267 0.131267
 bj_newdata680split3 19556.2      0.83  0.14  0.73      0.82  0.08  0.77      0.84  0.06  0.80
forget mean min: 0.91541 0.699949
delta_x = 10.3831
delta_h = 1.96288
delta mean, abs_mean, abs_mean+, abs_mean-: -1.66118 10.3831 7.04812 15.7953
U_c = [[-0.02137079]] U_f = [[ 0.]] b_f = [ 0.84705681]
W_c max, min, mean, abs_mean: 0.180095 0.0140391 0.170992 0.170992
W_f max, min, mean, abs_mean: 0.138058 0.0215535 0.131267 0.131267
Epoch 9/500
0s - loss: 1811.1200 - val_loss: 19460.6775
Epoch 00008: val_loss improved from 19556.23050 to 19460.67747, saving model to bj_newdata680split3_weights.hdf5
 bj_newdata680split3  1670.2      0.88  0.25  0.68      0.87  0.18  0.73      0.87  0.15  0.75
forget mean min: 0.897584 0.691051
delta_x = 7.4161
delta_h = 1.13137
delta mean, abs_mean, abs_mean+, abs_mean-: 0.419539 7.4161 6.54485 8.71544
U_c = [[-0.02000393]] U_f = [[ 0.]] b_f = [ 0.8050366]
W_c max, min, mean, abs_mean: 0.182999 0.0162435 0.173857 0.173857
W_f max, min, mean, abs_mean: 0.147072 0.0426952 0.140818 0.140818
 bj_newdata680split3 19460.7      0.82  0.14  0.73      0.82  0.08  0.77      0.84  0.06  0.80
forget mean min: 0.915952 0.691051
delta_x = 10.4487
delta_h = 1.84372
delta mean, abs_mean, abs_mean+, abs_mean-: -1.64936 10.4487 7.10703 15.8791
U_c = [[-0.02000393]] U_f = [[ 0.]] b_f = [ 0.8050366]
W_c max, min, mean, abs_mean: 0.182999 0.0162435 0.173857 0.173857
W_f max, min, mean, abs_mean: 0.147072 0.0426952 0.140818 0.140818
Epoch 10/500
0s - loss: 1762.8673 - val_loss: 19299.4671
Epoch 00009: val_loss improved from 19460.67747 to 19299.46708, saving model to bj_newdata680split3_weights.hdf5
 bj_newdata680split3  1616.2      0.88  0.24  0.69      0.87  0.18  0.73      0.87  0.15  0.76
forget mean min: 0.896761 0.681864
delta_x = 7.45393
delta_h = 1.08534
delta mean, abs_mean, abs_mean+, abs_mean-: 0.403504 7.45393 6.5398 8.82935
U_c = [[-0.01908027]] U_f = [[ 0.]] b_f = [ 0.76235074]
W_c max, min, mean, abs_mean: 0.18595 0.0182896 0.176754 0.176754
W_f max, min, mean, abs_mean: 0.157978 0.0683383 0.152402 0.152402
 bj_newdata680split3 19299.5      0.82  0.14  0.72      0.82  0.08  0.76      0.84  0.07  0.79
forget mean min: 0.91602 0.681864
delta_x = 10.7202
delta_h = 1.81435
delta mean, abs_mean, abs_mean+, abs_mean-: -1.53049 10.7202 7.2053 16.9071
U_c = [[-0.01908027]] U_f = [[ 0.]] b_f = [ 0.76235074]
W_c max, min, mean, abs_mean: 0.18595 0.0182896 0.176754 0.176754
W_f max, min, mean, abs_mean: 0.157978 0.0683383 0.152402 0.152402
Epoch 11/500
0s - loss: 1713.1505 - val_loss: 19343.5865
Epoch 00010: val_loss did not improve
Epoch 12/500
0s - loss: 1668.0246 - val_loss: 19382.2244
Epoch 00011: val_loss did not improve
Epoch 13/500
0s - loss: 1628.5781 - val_loss: 19152.6590
Epoch 00012: val_loss improved from 19299.46708 to 19152.65905, saving model to bj_newdata680split3_weights.hdf5
 bj_newdata680split3  1491.6      0.88  0.22  0.70      0.86  0.17  0.73      0.87  0.15  0.75
forget mean min: 0.889666 0.650511
delta_x = 7.66826
delta_h = 0.91137
delta mean, abs_mean, abs_mean+, abs_mean-: 0.285453 7.66826 6.56242 9.36915
U_c = [[-0.01599374]] U_f = [[ 0.]] b_f = [ 0.62128782]
W_c max, min, mean, abs_mean: 0.19781 0.0291433 0.188515 0.188515
W_f max, min, mean, abs_mean: 0.185919 0.138519 0.182224 0.182224
 bj_newdata680split3 19152.7      0.81  0.14  0.72      0.81  0.08  0.76      0.83  0.07  0.78
forget mean min: 0.912611 0.650511
delta_x = 11.1806
delta_h = 1.56554
delta mean, abs_mean, abs_mean+, abs_mean-: -1.51629 11.1806 7.48525 17.9113
U_c = [[-0.01599374]] U_f = [[ 0.]] b_f = [ 0.62128782]
W_c max, min, mean, abs_mean: 0.19781 0.0291433 0.188515 0.188515
W_f max, min, mean, abs_mean: 0.185919 0.138519 0.182224 0.182224
Epoch 14/500
0s - loss: 1588.8266 - val_loss: 19247.6518
Epoch 00013: val_loss did not improve
Epoch 15/500
0s - loss: 1560.3395 - val_loss: 19201.8274
Epoch 00014: val_loss did not improve
Epoch 16/500
0s - loss: 1524.9379 - val_loss: 19163.3316
Epoch 00015: val_loss did not improve
Epoch 17/500
0s - loss: 1505.2223 - val_loss: 19232.0877
Epoch 00016: val_loss did not improve
Epoch 18/500
0s - loss: 1486.2653 - val_loss: 19604.5397
Epoch 00017: val_loss did not improve
Epoch 19/500
0s - loss: 1464.1281 - val_loss: 19514.6107
Epoch 00018: val_loss did not improve
Epoch 20/500
0s - loss: 1447.9056 - val_loss: 19540.2728
Epoch 00019: val_loss did not improve
Epoch 21/500
0s - loss: 1423.6686 - val_loss: 19683.8979
Epoch 00020: val_loss did not improve
Epoch 22/500
0s - loss: 1412.3153 - val_loss: 20037.5688
Epoch 00021: val_loss did not improve
Epoch 23/500
0s - loss: 1402.1036 - val_loss: 19941.5811
Epoch 00022: val_loss did not improve
Epoch 24/500
0s - loss: 1386.6435 - val_loss: 19947.7633
Epoch 00023: val_loss did not improve
Epoch 25/500
0s - loss: 1371.4677 - val_loss: 20311.1336
Epoch 00024: val_loss did not improve
Epoch 26/500
0s - loss: 1362.9047 - val_loss: 19947.0348
Epoch 00025: val_loss did not improve
Epoch 27/500
0s - loss: 1352.2509 - val_loss: 20800.0463
Epoch 00026: val_loss did not improve
Epoch 28/500
0s - loss: 1343.7602 - val_loss: 20289.2261
Epoch 00027: val_loss did not improve
Epoch 29/500
0s - loss: 1329.7784 - val_loss: 20170.8641
Epoch 00028: val_loss did not improve
Epoch 30/500
0s - loss: 1316.5064 - val_loss: 20393.0651
Epoch 00029: val_loss did not improve
Epoch 31/500
0s - loss: 1310.0873 - val_loss: 20548.4899
Epoch 00030: val_loss did not improve
Epoch 32/500
0s - loss: 1300.9512 - val_loss: 20623.2588
Epoch 00031: val_loss did not improve
Epoch 33/500
0s - loss: 1297.6392 - val_loss: 20636.9119
Epoch 00032: val_loss did not improve
Epoch 34/500
0s - loss: 1280.7450 - val_loss: 20675.1247
Epoch 00033: val_loss did not improve
X_train[0].shape = (3618, 40, 23)

training bj_newdata680split4
Train on 3618 samples, validate on 1098 samples
Before training:
 bj_newdata680split4 10875.7      0.03  -nan  0.03      0.06  -nan  0.05      0.09  -nan  0.09
forget mean min: 0.731058 0.731059
delta_x = 4.27293
delta_h = 2.69643
delta mean, abs_mean, abs_mean+, abs_mean-: -4.27293 4.27293 nan 4.27293
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
 bj_newdata680split4 52149.9      0.06  -nan  0.06      0.08  -nan  0.08      0.14  -nan  0.14
forget mean min: 0.731059 0.731059
delta_x = 9.22632
delta_h = 5.61792
delta mean, abs_mean, abs_mean+, abs_mean-: -9.22632 9.22632 nan 9.22632
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/500
0s - loss: 8963.7982 - val_loss: 30828.9985
Epoch 00000: val_loss improved from inf to 30828.99850, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  5830.8      0.30  0.20  0.28      0.29  0.12  0.28      0.29  0.06  0.29
forget mean min: 0.87762 0.770247
delta_x = 3.54912
delta_h = 3.19502
delta mean, abs_mean, abs_mean+, abs_mean-: -3.022 3.54912 1.15065 4.2617
U_c = [[-0.10658914]] U_f = [[ 0.]] b_f = [ 1.06552398]
W_c max, min, mean, abs_mean: 0.0940247 0.0900778 0.0928875 0.0928875
W_f max, min, mean, abs_mean: 0.0903821 0.0879747 0.0898677 0.0898677
 bj_newdata680split4 30829.0      0.71  0.13  0.64      0.71  0.07  0.67      0.73  0.05  0.70
forget mean min: 0.890414 0.770247
delta_x = 7.24165
delta_h = 6.6904
delta mean, abs_mean, abs_mean+, abs_mean-: -6.79357 7.24165 1.37542 8.38311
U_c = [[-0.10658914]] U_f = [[ 0.]] b_f = [ 1.06552398]
W_c max, min, mean, abs_mean: 0.0940247 0.0900778 0.0928875 0.0928875
W_f max, min, mean, abs_mean: 0.0903821 0.0879747 0.0898677 0.0898677
Epoch 2/500
0s - loss: 4214.2266 - val_loss: 21400.5562
Epoch 00001: val_loss improved from 30828.99850 to 21400.55616, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  2882.3      0.83  0.28  0.63      0.80  0.22  0.65      0.81  0.17  0.69
forget mean min: 0.919715 0.791339
delta_x = 5.8603
delta_h = 2.85937
delta mean, abs_mean, abs_mean+, abs_mean-: 0.691342 5.8603 5.6143 6.20491
U_c = [[-0.06456988]] U_f = [[ 0.]] b_f = [ 1.07523775]
W_c max, min, mean, abs_mean: 0.149567 0.145736 0.148457 0.148457
W_f max, min, mean, abs_mean: 0.116783 0.114401 0.116261 0.116261
 bj_newdata680split4 21400.6      0.86  0.17  0.73      0.87  0.10  0.79      0.88  0.07  0.82
forget mean min: 0.929862 0.791339
delta_x = 8.60383
delta_h = 4.72376
delta mean, abs_mean, abs_mean+, abs_mean-: -1.55843 8.60383 5.56655 13.8387
U_c = [[-0.06456988]] U_f = [[ 0.]] b_f = [ 1.07523775]
W_c max, min, mean, abs_mean: 0.149567 0.145736 0.148457 0.148457
W_f max, min, mean, abs_mean: 0.116783 0.114401 0.116261 0.116261
Epoch 3/500
0s - loss: 2419.0568 - val_loss: 19631.5785
Epoch 00002: val_loss improved from 21400.55616 to 19631.57849, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  2062.5      0.87  0.27  0.65      0.85  0.21  0.69      0.86  0.17  0.73
forget mean min: 0.906772 0.764914
delta_x = 7.26624
delta_h = 1.90786
delta mean, abs_mean, abs_mean+, abs_mean-: 0.706979 7.26624 7.02808 7.57841
U_c = [[-0.03460216]] U_f = [[ 0.]] b_f = [ 1.02575076]
W_c max, min, mean, abs_mean: 0.168954 0.16512 0.167835 0.167835
W_f max, min, mean, abs_mean: 0.10982 0.106836 0.109239 0.109239
 bj_newdata680split4 19631.6      0.84  0.16  0.73      0.85  0.10  0.78      0.86  0.07  0.81
forget mean min: 0.924088 0.764914
delta_x = 9.86826
delta_h = 3.04598
delta mean, abs_mean, abs_mean+, abs_mean-: -1.27503 9.86826 6.88436 14.8226
U_c = [[-0.03460216]] U_f = [[ 0.]] b_f = [ 1.02575076]
W_c max, min, mean, abs_mean: 0.168954 0.16512 0.167835 0.167835
W_f max, min, mean, abs_mean: 0.10982 0.106836 0.109239 0.109239
Epoch 4/500
0s - loss: 2097.1388 - val_loss: 19553.6315
Epoch 00003: val_loss improved from 19631.57849 to 19553.63150, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  1917.9      0.87  0.27  0.66      0.85  0.20  0.70      0.86  0.17  0.73
forget mean min: 0.902745 0.746522
delta_x = 7.27251
delta_h = 1.58489
delta mean, abs_mean, abs_mean+, abs_mean-: 0.552179 7.27251 6.76724 7.96494
U_c = [[-0.02850804]] U_f = [[ 0.]] b_f = [ 0.98682988]
W_c max, min, mean, abs_mean: 0.169863 0.166009 0.16873 0.16873
W_f max, min, mean, abs_mean: 0.114356 0.111002 0.113713 0.113713
 bj_newdata680split4 19553.6      0.84  0.14  0.73      0.83  0.09  0.77      0.86  0.06  0.81
forget mean min: 0.920108 0.746522
delta_x = 10.088
delta_h = 2.53528
delta mean, abs_mean, abs_mean+, abs_mean-: -1.50232 10.088 6.85929 15.4885
U_c = [[-0.02850804]] U_f = [[ 0.]] b_f = [ 0.98682988]
W_c max, min, mean, abs_mean: 0.169863 0.166009 0.16873 0.16873
W_f max, min, mean, abs_mean: 0.114356 0.111002 0.113713 0.113713
Epoch 5/500
0s - loss: 1993.1451 - val_loss: 19996.6808
Epoch 00004: val_loss did not improve
Epoch 6/500
0s - loss: 1946.4169 - val_loss: 20174.6035
Epoch 00005: val_loss did not improve
Epoch 7/500
0s - loss: 1922.0301 - val_loss: 19809.5069
Epoch 00006: val_loss did not improve
Epoch 8/500
0s - loss: 1885.5674 - val_loss: 19729.0679
Epoch 00007: val_loss did not improve
Epoch 9/500
0s - loss: 1850.4737 - val_loss: 19680.4322
Epoch 00008: val_loss did not improve
Epoch 10/500
0s - loss: 1810.6583 - val_loss: 19570.6436
Epoch 00009: val_loss did not improve
Epoch 11/500
0s - loss: 1764.0596 - val_loss: 19242.8218
Epoch 00010: val_loss improved from 19553.63150 to 19242.82181, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  1617.0      0.89  0.24  0.69      0.87  0.18  0.73      0.87  0.15  0.76
forget mean min: 0.895531 0.678044
delta_x = 7.6765
delta_h = 1.06284
delta mean, abs_mean, abs_mean+, abs_mean-: 0.423514 7.6765 6.70867 9.1508
U_c = [[-0.01832739]] U_f = [[ 0.]] b_f = [ 0.74479771]
W_c max, min, mean, abs_mean: 0.184787 0.180874 0.183661 0.183661
W_f max, min, mean, abs_mean: 0.173696 0.169419 0.172491 0.172491
 bj_newdata680split4 19242.8      0.82  0.14  0.72      0.82  0.08  0.76      0.84  0.06  0.79
forget mean min: 0.91527 0.678044
delta_x = 10.9893
delta_h = 1.75155
delta mean, abs_mean, abs_mean+, abs_mean-: -1.54238 10.9893 7.42103 17.2375
U_c = [[-0.01832739]] U_f = [[ 0.]] b_f = [ 0.74479771]
W_c max, min, mean, abs_mean: 0.184787 0.180874 0.183661 0.183661
W_f max, min, mean, abs_mean: 0.173696 0.169419 0.172491 0.172491
Epoch 12/500
0s - loss: 1701.7818 - val_loss: 19173.7245
Epoch 00011: val_loss improved from 19242.82181 to 19173.72454, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  1556.8      0.88  0.23  0.70      0.86  0.17  0.73      0.87  0.14  0.76
forget mean min: 0.893856 0.667561
delta_x = 7.66058
delta_h = 0.997772
delta mean, abs_mean, abs_mean+, abs_mean-: 0.354341 7.66058 6.61164 9.27476
U_c = [[-0.01731866]] U_f = [[ 0.]] b_f = [ 0.69717509]
W_c max, min, mean, abs_mean: 0.188459 0.184548 0.187347 0.187347
W_f max, min, mean, abs_mean: 0.187054 0.18257 0.185616 0.185616
 bj_newdata680split4 19173.7      0.82  0.14  0.72      0.81  0.08  0.76      0.83  0.07  0.79
forget mean min: 0.915059 0.667561
delta_x = 11.1446
delta_h = 1.67945
delta mean, abs_mean, abs_mean+, abs_mean-: -1.49587 11.1446 7.51292 17.6615
U_c = [[-0.01731866]] U_f = [[ 0.]] b_f = [ 0.69717509]
W_c max, min, mean, abs_mean: 0.188459 0.184548 0.187347 0.187347
W_f max, min, mean, abs_mean: 0.187054 0.18257 0.185616 0.185616
Epoch 13/500
0s - loss: 1654.1242 - val_loss: 19240.6131
Epoch 00012: val_loss did not improve
Epoch 14/500
0s - loss: 1619.9345 - val_loss: 19109.3965
Epoch 00013: val_loss improved from 19173.72454 to 19109.39650, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  1478.6      0.87  0.21  0.71      0.85  0.16  0.73      0.85  0.13  0.75
forget mean min: 0.890577 0.647409
delta_x = 7.59915
delta_h = 1.10443
delta mean, abs_mean, abs_mean+, abs_mean-: 0.268885 7.59915 6.452 9.39142
U_c = [[-0.01987739]] U_f = [[ 0.]] b_f = [ 0.60766971]
W_c max, min, mean, abs_mean: 0.194557 0.190633 0.193453 0.193453
W_f max, min, mean, abs_mean: 0.212778 0.207961 0.210927 0.210927
 bj_newdata680split4 19109.4      0.81  0.14  0.72      0.81  0.08  0.76      0.83  0.07  0.79
forget mean min: 0.912484 0.647409
delta_x = 11.297
delta_h = 1.9231
delta mean, abs_mean, abs_mean+, abs_mean-: -1.46285 11.297 7.51603 18.4504
U_c = [[-0.01987739]] U_f = [[ 0.]] b_f = [ 0.60766971]
W_c max, min, mean, abs_mean: 0.194557 0.190633 0.193453 0.193453
W_f max, min, mean, abs_mean: 0.212778 0.207961 0.210927 0.210927
Epoch 15/500
0s - loss: 1584.0880 - val_loss: 19047.2384
Epoch 00014: val_loss improved from 19109.39650 to 19047.23840, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  1450.9      0.87  0.21  0.71      0.85  0.16  0.73      0.86  0.14  0.76
forget mean min: 0.887026 0.636384
delta_x = 7.81003
delta_h = 0.928684
delta mean, abs_mean, abs_mean+, abs_mean-: 0.232247 7.81003 6.59563 9.70682
U_c = [[-0.01630911]] U_f = [[ 0.]] b_f = [ 0.55970281]
W_c max, min, mean, abs_mean: 0.200593 0.196661 0.19949 0.19949
W_f max, min, mean, abs_mean: 0.224919 0.219967 0.22286 0.22286
 bj_newdata680split4 19047.2      0.81  0.14  0.72      0.81  0.08  0.76      0.83  0.06  0.78
forget mean min: 0.910113 0.636384
delta_x = 11.5246
delta_h = 1.60286
delta mean, abs_mean, abs_mean+, abs_mean-: -1.55315 11.5246 7.67495 18.6619
U_c = [[-0.01630911]] U_f = [[ 0.]] b_f = [ 0.55970281]
W_c max, min, mean, abs_mean: 0.200593 0.196661 0.19949 0.19949
W_f max, min, mean, abs_mean: 0.224919 0.219967 0.22286 0.22286
Epoch 16/500
0s - loss: 1559.0626 - val_loss: 19146.6918
Epoch 00015: val_loss did not improve
Epoch 17/500
0s - loss: 1535.4255 - val_loss: 19081.9972
Epoch 00016: val_loss did not improve
Epoch 18/500
0s - loss: 1513.4765 - val_loss: 19058.0388
Epoch 00017: val_loss did not improve
Epoch 19/500
0s - loss: 1487.4432 - val_loss: 19019.9640
Epoch 00018: val_loss improved from 19047.23840 to 19019.96401, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  1348.3      0.87  0.20  0.72      0.85  0.15  0.74      0.86  0.13  0.76
forget mean min: 0.877759 0.592646
delta_x = 8.14252
delta_h = 0.996924
delta mean, abs_mean, abs_mean+, abs_mean-: 0.216707 8.14252 6.81586 10.2459
U_c = [[-0.01760136]] U_f = [[ 0.]] b_f = [ 0.37491342]
W_c max, min, mean, abs_mean: 0.216344 0.212402 0.215253 0.215253
W_f max, min, mean, abs_mean: 0.268998 0.263612 0.266224 0.266224
 bj_newdata680split4 19020.0      0.80  0.13  0.72      0.80  0.07  0.76      0.82  0.05  0.79
forget mean min: 0.900707 0.592646
delta_x = 12.0602
delta_h = 1.7664
delta mean, abs_mean, abs_mean+, abs_mean-: -1.56003 12.0602 8.01275 19.7517
U_c = [[-0.01760136]] U_f = [[ 0.]] b_f = [ 0.37491342]
W_c max, min, mean, abs_mean: 0.216344 0.212402 0.215253 0.215253
W_f max, min, mean, abs_mean: 0.268998 0.263612 0.266224 0.266224
Epoch 20/500
0s - loss: 1463.4233 - val_loss: 18953.1565
Epoch 00019: val_loss improved from 19019.96401 to 18953.15648, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  1320.2      0.87  0.19  0.72      0.85  0.15  0.74      0.86  0.13  0.76
forget mean min: 0.875042 0.581806
delta_x = 8.28247
delta_h = 0.922835
delta mean, abs_mean, abs_mean+, abs_mean-: 0.221328 8.28247 6.92103 10.4512
U_c = [[-0.01605201]] U_f = [[ 0.]] b_f = [ 0.33019125]
W_c max, min, mean, abs_mean: 0.221368 0.217438 0.22029 0.22029
W_f max, min, mean, abs_mean: 0.277283 0.271786 0.274341 0.274341
 bj_newdata680split4 18953.2      0.80  0.12  0.72      0.80  0.06  0.76      0.82  0.05  0.79
forget mean min: 0.897381 0.581806
delta_x = 12.288
delta_h = 1.64936
delta mean, abs_mean, abs_mean+, abs_mean-: -1.55144 12.288 8.11532 20.4422
U_c = [[-0.01605201]] U_f = [[ 0.]] b_f = [ 0.33019125]
W_c max, min, mean, abs_mean: 0.221368 0.217438 0.22029 0.22029
W_f max, min, mean, abs_mean: 0.277283 0.271786 0.274341 0.274341
Epoch 21/500
0s - loss: 1449.9240 - val_loss: 18941.4957
Epoch 00020: val_loss improved from 18953.15648 to 18941.49572, saving model to bj_newdata680split4_weights.hdf5
 bj_newdata680split4  1310.4      0.88  0.20  0.72      0.86  0.16  0.74      0.87  0.14  0.76
forget mean min: 0.873489 0.57146
delta_x = 8.50614
delta_h = 0.860378
delta mean, abs_mean, abs_mean+, abs_mean-: 0.28606 8.50614 7.10025 10.7917
U_c = [[-0.01462569]] U_f = [[ 0.]] b_f = [ 0.28781211]
W_c max, min, mean, abs_mean: 0.226379 0.222461 0.225316 0.225316
W_f max, min, mean, abs_mean: 0.285353 0.279476 0.282248 0.282248
 bj_newdata680split4 18941.5      0.80  0.12  0.72      0.80  0.06  0.76      0.82  0.05  0.79
forget mean min: 0.895498 0.57146
delta_x = 12.5554
delta_h = 1.53668
delta mean, abs_mean, abs_mean+, abs_mean-: -1.50124 12.5554 8.30853 20.9947
U_c = [[-0.01462569]] U_f = [[ 0.]] b_f = [ 0.28781211]
W_c max, min, mean, abs_mean: 0.226379 0.222461 0.225316 0.225316
W_f max, min, mean, abs_mean: 0.285353 0.279476 0.282248 0.282248
Epoch 22/500
0s - loss: 1434.6463 - val_loss: 19021.4319
Epoch 00021: val_loss did not improve
Epoch 23/500
0s - loss: 1416.2771 - val_loss: 19054.9828
Epoch 00022: val_loss did not improve
Epoch 24/500
0s - loss: 1398.1842 - val_loss: 19456.4646
Epoch 00023: val_loss did not improve
Epoch 25/500
0s - loss: 1382.5951 - val_loss: 19476.5889
Epoch 00024: val_loss did not improve
Epoch 26/500
0s - loss: 1376.6074 - val_loss: 19361.8545
Epoch 00025: val_loss did not improve
Epoch 27/500
0s - loss: 1360.8899 - val_loss: 19442.6364
Epoch 00026: val_loss did not improve
Epoch 28/500
0s - loss: 1358.6914 - val_loss: 19364.1464
Epoch 00027: val_loss did not improve
Epoch 29/500
0s - loss: 1343.6705 - val_loss: 19523.8517
Epoch 00028: val_loss did not improve
Epoch 30/500
0s - loss: 1331.1236 - val_loss: 19427.0788
Epoch 00029: val_loss did not improve
Epoch 31/500
0s - loss: 1322.1760 - val_loss: 19618.6592
Epoch 00030: val_loss did not improve
Epoch 32/500
0s - loss: 1308.2432 - val_loss: 19708.2053
Epoch 00031: val_loss did not improve
Epoch 33/500
0s - loss: 1297.5250 - val_loss: 19684.6517
Epoch 00032: val_loss did not improve
Epoch 34/500
0s - loss: 1282.8968 - val_loss: 20139.8658
Epoch 00033: val_loss did not improve
Epoch 35/500
0s - loss: 1279.9846 - val_loss: 19974.8632
Epoch 00034: val_loss did not improve
Epoch 36/500
0s - loss: 1263.0008 - val_loss: 20134.3895
Epoch 00035: val_loss did not improve
Epoch 37/500
0s - loss: 1263.7060 - val_loss: 19847.8616
Epoch 00036: val_loss did not improve
Epoch 38/500
0s - loss: 1254.0813 - val_loss: 20306.9195
Epoch 00037: val_loss did not improve
Epoch 39/500
0s - loss: 1239.7389 - val_loss: 20148.2852
Epoch 00038: val_loss did not improve
Epoch 40/500
0s - loss: 1245.0931 - val_loss: 20507.1916
Epoch 00039: val_loss did not improve
Epoch 41/500
0s - loss: 1237.7209 - val_loss: 20481.6091
Epoch 00040: val_loss did not improve
Epoch 42/500
0s - loss: 1226.9012 - val_loss: 20434.7572
Epoch 00041: val_loss did not improve
X_train[0].shape = (3618, 40, 23)

training bj_newdata680split5
Train on 3618 samples, validate on 1098 samples
Before training:
 bj_newdata680split5 10875.7      0.03  -nan  0.03      0.06  -nan  0.05      0.09  -nan  0.09
forget mean min: 0.731058 0.731059
delta_x = 4.27293
delta_h = 2.69643
delta mean, abs_mean, abs_mean+, abs_mean-: -4.27293 4.27293 nan 4.27293
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
 bj_newdata680split5 52149.9      0.06  -nan  0.06      0.08  -nan  0.08      0.14  -nan  0.14
forget mean min: 0.731059 0.731059
delta_x = 9.22632
delta_h = 5.61792
delta mean, abs_mean, abs_mean+, abs_mean-: -9.22632 9.22632 nan 9.22632
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/500
0s - loss: 8981.6808 - val_loss: 30778.4275
Epoch 00000: val_loss improved from inf to 30778.42750, saving model to bj_newdata680split5_weights.hdf5
 bj_newdata680split5  5801.6      0.31  0.21  0.28      0.29  0.13  0.28      0.29  0.06  0.29
forget mean min: 0.879163 0.770266
delta_x = 3.51183
delta_h = 3.14846
delta mean, abs_mean, abs_mean+, abs_mean-: -2.9457 3.51183 1.20086 4.22457
U_c = [[-0.10544671]] U_f = [[ 0.]] b_f = [ 1.06466019]
W_c max, min, mean, abs_mean: 0.0944795 0.0907181 0.0934643 0.0934643
W_f max, min, mean, abs_mean: 0.0904739 0.0867503 0.0899064 0.0899064
 bj_newdata680split5 30778.4      0.72  0.13  0.65      0.72  0.08  0.68      0.74  0.05  0.72
forget mean min: 0.891409 0.770266
delta_x = 7.16256
delta_h = 6.60186
delta mean, abs_mean, abs_mean+, abs_mean-: -6.68846 7.16256 1.39393 8.34459
U_c = [[-0.10544671]] U_f = [[ 0.]] b_f = [ 1.06466019]
W_c max, min, mean, abs_mean: 0.0944795 0.0907181 0.0934643 0.0934643
W_f max, min, mean, abs_mean: 0.0904739 0.0867503 0.0899064 0.0899064
Epoch 2/500
0s - loss: 4180.1463 - val_loss: 21384.8248
Epoch 00001: val_loss improved from 30778.42750 to 21384.82483, saving model to bj_newdata680split5_weights.hdf5
 bj_newdata680split5  2876.7      0.84  0.29  0.63      0.80  0.23  0.65      0.81  0.17  0.69
forget mean min: 0.920855 0.791308
delta_x = 5.87522
delta_h = 2.89269
delta mean, abs_mean, abs_mean+, abs_mean-: 0.755777 5.87522 5.62613 6.23264
U_c = [[-0.06554555]] U_f = [[ 0.]] b_f = [ 1.0739063]
W_c max, min, mean, abs_mean: 0.150535 0.146934 0.149552 0.149552
W_f max, min, mean, abs_mean: 0.11569 0.112084 0.115169 0.115169
 bj_newdata680split5 21384.8      0.87  0.17  0.74      0.87  0.10  0.79      0.88  0.07  0.83
forget mean min: 0.930367 0.791308
delta_x = 8.59087
delta_h = 4.73459
delta mean, abs_mean, abs_mean+, abs_mean-: -1.52535 8.59087 5.57303 13.8163
U_c = [[-0.06554555]] U_f = [[ 0.]] b_f = [ 1.0739063]
W_c max, min, mean, abs_mean: 0.150535 0.146934 0.149552 0.149552
W_f max, min, mean, abs_mean: 0.11569 0.112084 0.115169 0.115169
Epoch 3/500
0s - loss: 2436.0840 - val_loss: 19997.0404
Epoch 00002: val_loss improved from 21384.82483 to 19997.04037, saving model to bj_newdata680split5_weights.hdf5
 bj_newdata680split5  2061.4      0.86  0.26  0.66      0.84  0.20  0.69      0.84  0.17  0.72
forget mean min: 0.90554 0.762307
delta_x = 6.94359
delta_h = 1.90631
delta mean, abs_mean, abs_mean+, abs_mean-: 0.538087 6.94359 6.66684 7.29741
U_c = [[-0.03617468]] U_f = [[ 0.]] b_f = [ 1.02171743]
W_c max, min, mean, abs_mean: 0.167546 0.163972 0.166577 0.166577
W_f max, min, mean, abs_mean: 0.103895 0.0996922 0.103303 0.103303
 bj_newdata680split5 19997.0      0.84  0.16  0.73      0.84  0.09  0.78      0.86  0.06  0.81
forget mean min: 0.922252 0.762307
delta_x = 9.41099
delta_h = 3.05591
delta mean, abs_mean, abs_mean+, abs_mean-: -1.5577 9.41099 6.39682 14.2024
U_c = [[-0.03617468]] U_f = [[ 0.]] b_f = [ 1.02171743]
W_c max, min, mean, abs_mean: 0.167546 0.163972 0.166577 0.166577
W_f max, min, mean, abs_mean: 0.103895 0.0996922 0.103303 0.103303
Epoch 4/500
0s - loss: 2081.6575 - val_loss: 19602.3390
Epoch 00003: val_loss improved from 19997.04037 to 19602.33905, saving model to bj_newdata680split5_weights.hdf5
 bj_newdata680split5  1915.8      0.86  0.27  0.66      0.85  0.21  0.69      0.86  0.17  0.73
forget mean min: 0.902612 0.743874
delta_x = 7.18632
delta_h = 1.50302
delta mean, abs_mean, abs_mean+, abs_mean-: 0.538646 7.18632 6.68859 7.86658
U_c = [[-0.02695653]] U_f = [[ 0.]] b_f = [ 0.98113054]
W_c max, min, mean, abs_mean: 0.170077 0.166498 0.169115 0.169115
W_f max, min, mean, abs_mean: 0.110897 0.106275 0.110209 0.110209
 bj_newdata680split5 19602.3      0.84  0.14  0.73      0.83  0.09  0.77      0.86  0.06  0.81
forget mean min: 0.920108 0.743874
delta_x = 10.0348
delta_h = 2.42061
delta mean, abs_mean, abs_mean+, abs_mean-: -1.47749 10.0348 6.83087 15.4058
U_c = [[-0.02695653]] U_f = [[ 0.]] b_f = [ 0.98113054]
W_c max, min, mean, abs_mean: 0.170077 0.166498 0.169115 0.169115
W_f max, min, mean, abs_mean: 0.110897 0.106275 0.110209 0.110209
Epoch 5/500
0s - loss: 1990.9177 - val_loss: 20407.6217
Epoch 00004: val_loss did not improve
Epoch 6/500
0s - loss: 1952.9199 - val_loss: 20162.2258
Epoch 00005: val_loss did not improve
Epoch 7/500
0s - loss: 1927.3181 - val_loss: 20488.4613
Epoch 00006: val_loss did not improve
Epoch 8/500
0s - loss: 1902.5945 - val_loss: 20216.7118
Epoch 00007: val_loss did not improve
Epoch 9/500
0s - loss: 1873.9754 - val_loss: 20393.7772
Epoch 00008: val_loss did not improve
Epoch 10/500
0s - loss: 1835.7145 - val_loss: 19823.6227
Epoch 00009: val_loss did not improve
Epoch 11/500
0s - loss: 1792.8673 - val_loss: 19598.1353
Epoch 00010: val_loss improved from 19602.33905 to 19598.13527, saving model to bj_newdata680split5_weights.hdf5
 bj_newdata680split5  1653.0      0.88  0.24  0.69      0.86  0.18  0.72      0.86  0.15  0.75
forget mean min: 0.893807 0.686257
delta_x = 7.43873
delta_h = 0.977218
delta mean, abs_mean, abs_mean+, abs_mean-: 0.371246 7.43873 6.62023 8.61586
U_c = [[-0.01712265]] U_f = [[ 0.]] b_f = [ 0.78267992]
W_c max, min, mean, abs_mean: 0.187114 0.183437 0.186119 0.186119
W_f max, min, mean, abs_mean: 0.137618 0.132511 0.136841 0.136841
 bj_newdata680split5 19598.1      0.82  0.13  0.73      0.82  0.07  0.77      0.84  0.06  0.80
forget mean min: 0.910568 0.686257
delta_x = 10.776
delta_h = 1.59784
delta mean, abs_mean, abs_mean+, abs_mean-: -1.73633 10.776 7.53932 15.6208
U_c = [[-0.01712265]] U_f = [[ 0.]] b_f = [ 0.78267992]
W_c max, min, mean, abs_mean: 0.187114 0.183437 0.186119 0.186119
W_f max, min, mean, abs_mean: 0.137618 0.132511 0.136841 0.136841
Epoch 12/500
0s - loss: 1754.4740 - val_loss: 19565.2764
Epoch 00011: val_loss improved from 19598.13527 to 19565.27635, saving model to bj_newdata680split5_weights.hdf5
 bj_newdata680split5  1607.3      0.87  0.23  0.69      0.85  0.17  0.72      0.85  0.14  0.75
forget mean min: 0.891825 0.678568
delta_x = 7.36893
delta_h = 0.875568
delta mean, abs_mean, abs_mean+, abs_mean-: 0.267474 7.36893 6.48633 8.63198
U_c = [[-0.01550227]] U_f = [[ 0.]] b_f = [ 0.74719763]
W_c max, min, mean, abs_mean: 0.190257 0.186553 0.189245 0.189245
W_f max, min, mean, abs_mean: 0.14114 0.135988 0.140339 0.140339
 bj_newdata680split5 19565.3      0.82  0.13  0.73      0.81  0.07  0.76      0.83  0.06  0.79
forget mean min: 0.910116 0.678568
delta_x = 10.7776
delta_h = 1.46675
delta mean, abs_mean, abs_mean+, abs_mean-: -1.74463 10.7776 7.53402 15.6323
U_c = [[-0.01550227]] U_f = [[ 0.]] b_f = [ 0.74719763]
W_c max, min, mean, abs_mean: 0.190257 0.186553 0.189245 0.189245
W_f max, min, mean, abs_mean: 0.14114 0.135988 0.140339 0.140339
Epoch 13/500
0s - loss: 1703.5970 - val_loss: 19309.1925
Epoch 00012: val_loss improved from 19565.27635 to 19309.19245, saving model to bj_newdata680split5_weights.hdf5
 bj_newdata680split5  1582.7      0.89  0.24  0.69      0.87  0.18  0.73      0.88  0.15  0.76
forget mean min: 0.893432 0.670039
delta_x = 7.5976
delta_h = 0.769258
delta mean, abs_mean, abs_mean+, abs_mean-: 0.383109 7.5976 6.63172 9.05675
U_c = [[-0.01326968]] U_f = [[ 0.]] b_f = [ 0.70836157]
W_c max, min, mean, abs_mean: 0.196212 0.192479 0.195178 0.195178
W_f max, min, mean, abs_mean: 0.146419 0.141247 0.145603 0.145603
 bj_newdata680split5 19309.2      0.82  0.14  0.72      0.82  0.08  0.76      0.84  0.06  0.79
forget mean min: 0.911113 0.670039
delta_x = 11.1273
delta_h = 1.3008
delta mean, abs_mean, abs_mean+, abs_mean-: -1.56104 11.1273 7.77219 16.4961
U_c = [[-0.01326968]] U_f = [[ 0.]] b_f = [ 0.70836157]
W_c max, min, mean, abs_mean: 0.196212 0.192479 0.195178 0.195178
W_f max, min, mean, abs_mean: 0.146419 0.141247 0.145603 0.145603
Epoch 14/500
0s - loss: 1659.2459 - val_loss: 19542.3779
Epoch 00013: val_loss did not improve
Epoch 15/500
0s - loss: 1627.1274 - val_loss: 19539.7688
Epoch 00014: val_loss did not improve
Epoch 16/500
0s - loss: 1590.0638 - val_loss: 19628.4110
Epoch 00015: val_loss did not improve
Epoch 17/500
0s - loss: 1558.6559 - val_loss: 19337.0903
Epoch 00016: val_loss did not improve
Epoch 18/500
0s - loss: 1544.0423 - val_loss: 19499.8551
Epoch 00017: val_loss did not improve
Epoch 19/500
0s - loss: 1515.2152 - val_loss: 19634.8864
Epoch 00018: val_loss did not improve
Epoch 20/500
0s - loss: 1506.1044 - val_loss: 19827.9801
Epoch 00019: val_loss did not improve
Epoch 21/500
0s - loss: 1482.5879 - val_loss: 19967.7799
Epoch 00020: val_loss did not improve
Epoch 22/500
0s - loss: 1473.9820 - val_loss: 19906.4135
Epoch 00021: val_loss did not improve
Epoch 23/500
0s - loss: 1458.1407 - val_loss: 20010.0294
Epoch 00022: val_loss did not improve
Epoch 24/500
0s - loss: 1446.9170 - val_loss: 19849.0656
Epoch 00023: val_loss did not improve
Epoch 25/500
0s - loss: 1426.4595 - val_loss: 19899.2359
Epoch 00024: val_loss did not improve
Epoch 26/500
0s - loss: 1422.3212 - val_loss: 19939.0209
Epoch 00025: val_loss did not improve
Epoch 27/500
0s - loss: 1408.3195 - val_loss: 19870.6515
Epoch 00026: val_loss did not improve
Epoch 28/500
0s - loss: 1393.4096 - val_loss: 19705.1917
Epoch 00027: val_loss did not improve
Epoch 29/500
0s - loss: 1393.4582 - val_loss: 19903.6157
Epoch 00028: val_loss did not improve
Epoch 30/500
0s - loss: 1376.4874 - val_loss: 20460.8611
Epoch 00029: val_loss did not improve
Epoch 31/500
0s - loss: 1366.5166 - val_loss: 20148.0440
Epoch 00030: val_loss did not improve
Epoch 32/500
0s - loss: 1355.1396 - val_loss: 20300.8869
Epoch 00031: val_loss did not improve
Epoch 33/500
0s - loss: 1352.1152 - val_loss: 20479.9954
Epoch 00032: val_loss did not improve
Epoch 34/500
0s - loss: 1336.5768 - val_loss: 20040.7028
Epoch 00033: val_loss did not improve
X_train[0].shape = (3618, 40, 23)

training bj_newdata680split6
Train on 3618 samples, validate on 1098 samples
Before training:
 bj_newdata680split6 10875.7      0.03  -nan  0.03      0.06  -nan  0.05      0.09  -nan  0.09
forget mean min: 0.731058 0.731059
delta_x = 4.27293
delta_h = 2.69643
delta mean, abs_mean, abs_mean+, abs_mean-: -4.27293 4.27293 nan 4.27293
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
 bj_newdata680split6 52149.9      0.06  -nan  0.06      0.08  -nan  0.08      0.14  -nan  0.14
forget mean min: 0.731059 0.731059
delta_x = 9.22632
delta_h = 5.61792
delta mean, abs_mean, abs_mean+, abs_mean-: -9.22632 9.22632 nan 9.22632
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/500
0s - loss: 8967.9033 - val_loss: 30920.6166
Epoch 00000: val_loss improved from inf to 30920.61660, saving model to bj_newdata680split6_weights.hdf5
 bj_newdata680split6  5819.8      0.30  0.20  0.28      0.29  0.12  0.28      0.29  0.06  0.29
forget mean min: 0.878617 0.770129
delta_x = 3.50307
delta_h = 3.17369
delta mean, abs_mean, abs_mean+, abs_mean-: -3.01175 3.50307 1.097 4.19735
U_c = [[-0.10704938]] U_f = [[ 0.]] b_f = [ 1.06539869]
W_c max, min, mean, abs_mean: 0.0939193 0.0895145 0.093303 0.093303
W_f max, min, mean, abs_mean: 0.090134 0.0861795 0.0895471 0.0895471
 bj_newdata680split6 30920.6      0.71  0.13  0.64      0.71  0.07  0.68      0.73  0.05  0.71
forget mean min: 0.890556 0.770129
delta_x = 7.21307
delta_h = 6.68209
delta mean, abs_mean, abs_mean+, abs_mean-: -6.83214 7.21307 1.24871 8.28653
U_c = [[-0.10704938]] U_f = [[ 0.]] b_f = [ 1.06539869]
W_c max, min, mean, abs_mean: 0.0939193 0.0895145 0.093303 0.093303
W_f max, min, mean, abs_mean: 0.090134 0.0861795 0.0895471 0.0895471
Epoch 2/500
0s - loss: 4181.6225 - val_loss: 21277.8952
Epoch 00001: val_loss improved from 30920.61660 to 21277.89516, saving model to bj_newdata680split6_weights.hdf5
 bj_newdata680split6  2831.6      0.84  0.28  0.63      0.81  0.22  0.65      0.81  0.17  0.70
forget mean min: 0.920735 0.791057
delta_x = 5.90691
delta_h = 2.86325
delta mean, abs_mean, abs_mean+, abs_mean-: 0.753456 5.90691 5.68719 6.21734
U_c = [[-0.06434736]] U_f = [[ 0.]] b_f = [ 1.07364011]
W_c max, min, mean, abs_mean: 0.150486 0.146195 0.149882 0.149882
W_f max, min, mean, abs_mean: 0.116605 0.11272 0.116033 0.116033
 bj_newdata680split6 21277.9      0.87  0.17  0.74      0.87  0.10  0.79      0.88  0.07  0.83
forget mean min: 0.930678 0.791057
delta_x = 8.59585
delta_h = 4.68559
delta mean, abs_mean, abs_mean+, abs_mean-: -1.48942 8.59585 5.59826 13.8041
U_c = [[-0.06434736]] U_f = [[ 0.]] b_f = [ 1.07364011]
W_c max, min, mean, abs_mean: 0.150486 0.146195 0.149882 0.149882
W_f max, min, mean, abs_mean: 0.116605 0.11272 0.116033 0.116033
Epoch 3/500
0s - loss: 2406.2515 - val_loss: 19642.3817
Epoch 00002: val_loss improved from 21277.89516 to 19642.38170, saving model to bj_newdata680split6_weights.hdf5
 bj_newdata680split6  2070.1      0.87  0.28  0.65      0.85  0.21  0.69      0.86  0.17  0.73
forget mean min: 0.906843 0.763226
delta_x = 7.31382
delta_h = 1.81404
delta mean, abs_mean, abs_mean+, abs_mean-: 0.73007 7.31382 7.09729 7.597
U_c = [[-0.03224956]] U_f = [[ 0.]] b_f = [ 1.02145445]
W_c max, min, mean, abs_mean: 0.169711 0.165422 0.169098 0.169098
W_f max, min, mean, abs_mean: 0.108401 0.10384 0.107771 0.107771
 bj_newdata680split6 19642.4      0.84  0.17  0.72      0.84  0.10  0.77      0.86  0.07  0.81
forget mean min: 0.924831 0.763226
delta_x = 9.87875
delta_h = 2.90319
delta mean, abs_mean, abs_mean+, abs_mean-: -1.18853 9.87875 6.87899 15.0227
U_c = [[-0.03224956]] U_f = [[ 0.]] b_f = [ 1.02145445]
W_c max, min, mean, abs_mean: 0.169711 0.165422 0.169098 0.169098
W_f max, min, mean, abs_mean: 0.108401 0.10384 0.107771 0.107771
Epoch 4/500
0s - loss: 2087.8367 - val_loss: 19752.1178
Epoch 00003: val_loss did not improve
Epoch 5/500
0s - loss: 1999.2050 - val_loss: 19691.3159
Epoch 00004: val_loss did not improve
Epoch 6/500
0s - loss: 1951.8865 - val_loss: 20247.8636
Epoch 00005: val_loss did not improve
Epoch 7/500
0s - loss: 1926.3772 - val_loss: 19823.5014
Epoch 00006: val_loss did not improve
Epoch 8/500
0s - loss: 1899.6062 - val_loss: 20054.3721
Epoch 00007: val_loss did not improve
Epoch 9/500
0s - loss: 1870.8968 - val_loss: 19643.8731
Epoch 00008: val_loss did not improve
Epoch 10/500
0s - loss: 1843.4509 - val_loss: 19755.5899
Epoch 00009: val_loss did not improve
Epoch 11/500
0s - loss: 1799.7374 - val_loss: 19547.8601
Epoch 00010: val_loss improved from 19642.38170 to 19547.86009, saving model to bj_newdata680split6_weights.hdf5
 bj_newdata680split6  1652.4      0.88  0.24  0.69      0.86  0.18  0.73      0.86  0.15  0.75
forget mean min: 0.893585 0.685197
delta_x = 7.40387
delta_h = 1.03212
delta mean, abs_mean, abs_mean+, abs_mean-: 0.315622 7.40387 6.5953 8.54472
U_c = [[-0.01838766]] U_f = [[ 0.]] b_f = [ 0.77776057]
W_c max, min, mean, abs_mean: 0.184578 0.180201 0.183887 0.183887
W_f max, min, mean, abs_mean: 0.140645 0.134878 0.139644 0.139644
 bj_newdata680split6 19547.9      0.83  0.12  0.74      0.82  0.06  0.78      0.84  0.05  0.81
forget mean min: 0.909217 0.685197
delta_x = 10.621
delta_h = 1.6803
delta mean, abs_mean, abs_mean+, abs_mean-: -1.87391 10.621 7.35566 15.4099
U_c = [[-0.01838766]] U_f = [[ 0.]] b_f = [ 0.77776057]
W_c max, min, mean, abs_mean: 0.184578 0.180201 0.183887 0.183887
W_f max, min, mean, abs_mean: 0.140645 0.134878 0.139644 0.139644
Epoch 12/500
0s - loss: 1743.1592 - val_loss: 20075.8449
Epoch 00011: val_loss did not improve
Epoch 13/500
0s - loss: 1699.5179 - val_loss: 19142.9693
Epoch 00012: val_loss improved from 19547.86009 to 19142.96927, saving model to bj_newdata680split6_weights.hdf5
 bj_newdata680split6  1548.2      0.88  0.23  0.70      0.86  0.17  0.73      0.86  0.15  0.75
forget mean min: 0.893817 0.667938
delta_x = 7.5145
delta_h = 0.860964
delta mean, abs_mean, abs_mean+, abs_mean-: 0.314212 7.5145 6.50998 9.02937
U_c = [[-0.0151424]] U_f = [[ 0.]] b_f = [ 0.69887578]
W_c max, min, mean, abs_mean: 0.191206 0.18681 0.190504 0.190504
W_f max, min, mean, abs_mean: 0.159859 0.153854 0.158674 0.158674
 bj_newdata680split6 19143.0      0.83  0.13  0.73      0.82  0.07  0.77      0.84  0.06  0.80
forget mean min: 0.912021 0.667938
delta_x = 10.9317
delta_h = 1.44845
delta mean, abs_mean, abs_mean+, abs_mean-: -1.664 10.9317 7.50577 16.4595
U_c = [[-0.0151424]] U_f = [[ 0.]] b_f = [ 0.69887578]
W_c max, min, mean, abs_mean: 0.191206 0.18681 0.190504 0.190504
W_f max, min, mean, abs_mean: 0.159859 0.153854 0.158674 0.158674
Epoch 14/500
0s - loss: 1650.3841 - val_loss: 19038.6996
Epoch 00013: val_loss improved from 19142.96927 to 19038.69959, saving model to bj_newdata680split6_weights.hdf5
 bj_newdata680split6  1511.8      0.89  0.23  0.70      0.87  0.17  0.73      0.87  0.15  0.76
forget mean min: 0.892842 0.65799
delta_x = 7.7014
delta_h = 0.783711
delta mean, abs_mean, abs_mean+, abs_mean-: 0.345803 7.7014 6.62332 9.36995
U_c = [[-0.01354443]] U_f = [[ 0.]] b_f = [ 0.65434915]
W_c max, min, mean, abs_mean: 0.196765 0.192359 0.196058 0.196058
W_f max, min, mean, abs_mean: 0.169684 0.163562 0.168424 0.168424
 bj_newdata680split6 19038.7      0.82  0.14  0.73      0.82  0.08  0.76      0.84  0.06  0.80
forget mean min: 0.911947 0.65799
delta_x = 11.2576
delta_h = 1.3314
delta mean, abs_mean, abs_mean+, abs_mean-: -1.56178 11.2576 7.66812 17.428
U_c = [[-0.01354443]] U_f = [[ 0.]] b_f = [ 0.65434915]
W_c max, min, mean, abs_mean: 0.196765 0.192359 0.196058 0.196058
W_f max, min, mean, abs_mean: 0.169684 0.163562 0.168424 0.168424
Epoch 15/500
0s - loss: 1610.0054 - val_loss: 19093.6875
Epoch 00014: val_loss did not improve
Epoch 16/500
0s - loss: 1580.3431 - val_loss: 19069.5456
Epoch 00015: val_loss did not improve
Epoch 17/500
0s - loss: 1549.5388 - val_loss: 19624.5197
Epoch 00016: val_loss did not improve
Epoch 18/500
0s - loss: 1527.4396 - val_loss: 19645.8619
Epoch 00017: val_loss did not improve
Epoch 19/500
0s - loss: 1507.1506 - val_loss: 19213.2710
Epoch 00018: val_loss did not improve
Epoch 20/500
0s - loss: 1491.7654 - val_loss: 19899.8585
Epoch 00019: val_loss did not improve
Epoch 21/500
0s - loss: 1475.0509 - val_loss: 19949.9811
Epoch 00020: val_loss did not improve
Epoch 22/500
0s - loss: 1461.4117 - val_loss: 19901.5786
Epoch 00021: val_loss did not improve
Epoch 23/500
0s - loss: 1445.5251 - val_loss: 19705.5923
Epoch 00022: val_loss did not improve
Epoch 24/500
0s - loss: 1429.0840 - val_loss: 20041.0202
Epoch 00023: val_loss did not improve
Epoch 25/500
0s - loss: 1417.6926 - val_loss: 20177.4164
Epoch 00024: val_loss did not improve
Epoch 26/500
0s - loss: 1403.2213 - val_loss: 20243.2522
Epoch 00025: val_loss did not improve
Epoch 27/500
0s - loss: 1384.4526 - val_loss: 20029.7960
Epoch 00026: val_loss did not improve
Epoch 28/500
0s - loss: 1378.2313 - val_loss: 20492.8422
Epoch 00027: val_loss did not improve
Epoch 29/500
0s - loss: 1367.3677 - val_loss: 20393.6870
Epoch 00028: val_loss did not improve
Epoch 30/500
0s - loss: 1354.5443 - val_loss: 20294.1174
Epoch 00029: val_loss did not improve
Epoch 31/500
0s - loss: 1345.7713 - val_loss: 20441.3992
Epoch 00030: val_loss did not improve
Epoch 32/500
0s - loss: 1336.8537 - val_loss: 20237.7948
Epoch 00031: val_loss did not improve
Epoch 33/500
0s - loss: 1321.2244 - val_loss: 20282.9062
Epoch 00032: val_loss did not improve
Epoch 34/500
0s - loss: 1309.0647 - val_loss: 20653.6845
Epoch 00033: val_loss did not improve
Epoch 35/500
0s - loss: 1297.5164 - val_loss: 20851.1798
Epoch 00034: val_loss did not improve
X_train[0].shape = (3618, 40, 23)

training bj_newdata680split7
Train on 3618 samples, validate on 1098 samples
Before training:
 bj_newdata680split7 10875.7      0.03  -nan  0.03      0.06  -nan  0.05      0.09  -nan  0.09
forget mean min: 0.731058 0.731059
delta_x = 4.27293
delta_h = 2.69643
delta mean, abs_mean, abs_mean+, abs_mean-: -4.27293 4.27293 nan 4.27293
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
 bj_newdata680split7 52149.9      0.06  -nan  0.06      0.08  -nan  0.08      0.14  -nan  0.14
forget mean min: 0.731059 0.731059
delta_x = 9.22632
delta_h = 5.61792
delta mean, abs_mean, abs_mean+, abs_mean-: -9.22632 9.22632 nan 9.22632
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/500
0s - loss: 8929.4656 - val_loss: 30577.3407
Epoch 00000: val_loss improved from inf to 30577.34073, saving model to bj_newdata680split7_weights.hdf5
 bj_newdata680split7  5768.8      0.31  0.21  0.29      0.29  0.13  0.28      0.30  0.07  0.29
forget mean min: 0.879563 0.770199
delta_x = 3.52836
delta_h = 3.15962
delta mean, abs_mean, abs_mean+, abs_mean-: -2.93632 3.52836 1.23926 4.24676
U_c = [[-0.10598061]] U_f = [[ 0.]] b_f = [ 1.06442964]
W_c max, min, mean, abs_mean: 0.0949801 0.0910143 0.0941691 0.0941691
W_f max, min, mean, abs_mean: 0.0910861 0.0871116 0.0904569 0.0904569
 bj_newdata680split7 30577.3      0.71  0.13  0.65      0.71  0.07  0.67      0.73  0.05  0.71
forget mean min: 0.89176 0.770199
delta_x = 7.17811
delta_h = 6.62609
delta mean, abs_mean, abs_mean+, abs_mean-: -6.65714 7.17811 1.47427 8.40216
U_c = [[-0.10598061]] U_f = [[ 0.]] b_f = [ 1.06442964]
W_c max, min, mean, abs_mean: 0.0949801 0.0910143 0.0941691 0.0941691
W_f max, min, mean, abs_mean: 0.0910861 0.0871116 0.0904569 0.0904569
Epoch 2/500
0s - loss: 4161.6229 - val_loss: 21297.9509
Epoch 00001: val_loss improved from 30577.34073 to 21297.95090, saving model to bj_newdata680split7_weights.hdf5
 bj_newdata680split7  2852.4      0.83  0.28  0.63      0.80  0.22  0.66      0.81  0.17  0.69
forget mean min: 0.920383 0.790666
delta_x = 5.85013
delta_h = 2.82969
delta mean, abs_mean, abs_mean+, abs_mean-: 0.703097 5.85013 5.63668 6.14647
U_c = [[-0.06366777]] U_f = [[ 0.]] b_f = [ 1.07359982]
W_c max, min, mean, abs_mean: 0.150069 0.14619 0.149268 0.149268
W_f max, min, mean, abs_mean: 0.116422 0.112482 0.115803 0.115803
 bj_newdata680split7 21298.0      0.87  0.17  0.74      0.87  0.10  0.79      0.88  0.07  0.82
forget mean min: 0.930702 0.790666
delta_x = 8.58641
delta_h = 4.67709
delta mean, abs_mean, abs_mean+, abs_mean-: -1.49914 8.58641 5.5924 13.765
U_c = [[-0.06366777]] U_f = [[ 0.]] b_f = [ 1.07359982]
W_c max, min, mean, abs_mean: 0.150069 0.14619 0.149268 0.149268
W_f max, min, mean, abs_mean: 0.116422 0.112482 0.115803 0.115803
Epoch 3/500
0s - loss: 2424.5237 - val_loss: 19671.4935
Epoch 00002: val_loss improved from 21297.95090 to 19671.49345, saving model to bj_newdata680split7_weights.hdf5
 bj_newdata680split7  2062.9      0.87  0.27  0.66      0.85  0.21  0.69      0.86  0.17  0.73
forget mean min: 0.908009 0.765132
delta_x = 7.12661
delta_h = 1.91064
delta mean, abs_mean, abs_mean+, abs_mean-: 0.669824 7.12661 6.89923 7.42197
U_c = [[-0.03517789]] U_f = [[ 0.]] b_f = [ 1.02503979]
W_c max, min, mean, abs_mean: 0.168195 0.164301 0.167371 0.167371
W_f max, min, mean, abs_mean: 0.10855 0.104075 0.107907 0.107907
 bj_newdata680split7 19671.5      0.85  0.17  0.73      0.85  0.10  0.78      0.87  0.07  0.81
forget mean min: 0.92578 0.765132
delta_x = 9.62109
delta_h = 3.05665
delta mean, abs_mean, abs_mean+, abs_mean-: -1.26921 9.62109 6.66403 14.5842
U_c = [[-0.03517789]] U_f = [[ 0.]] b_f = [ 1.02503979]
W_c max, min, mean, abs_mean: 0.168195 0.164301 0.167371 0.167371
W_f max, min, mean, abs_mean: 0.10855 0.104075 0.107907 0.107907
Epoch 4/500
0s - loss: 2100.4708 - val_loss: 19404.4427
Epoch 00003: val_loss improved from 19671.49345 to 19404.44273, saving model to bj_newdata680split7_weights.hdf5
 bj_newdata680split7  1929.4      0.87  0.27  0.66      0.85  0.21  0.70      0.86  0.17  0.73
forget mean min: 0.904093 0.746209
delta_x = 7.30633
delta_h = 1.52553
delta mean, abs_mean, abs_mean+, abs_mean-: 0.5862 7.30633 6.8198 7.9745
U_c = [[-0.02701299]] U_f = [[ 0.]] b_f = [ 0.98634779]
W_c max, min, mean, abs_mean: 0.170435 0.1665 0.169573 0.169573
W_f max, min, mean, abs_mean: 0.1132 0.108264 0.112534 0.112534
 bj_newdata680split7 19404.4      0.84  0.15  0.73      0.84  0.09  0.77      0.86  0.06  0.81
forget mean min: 0.922133 0.746209
delta_x = 10.0738
delta_h = 2.42201
delta mean, abs_mean, abs_mean+, abs_mean-: -1.41693 10.0738 6.88838 15.4599
U_c = [[-0.02701299]] U_f = [[ 0.]] b_f = [ 0.98634779]
W_c max, min, mean, abs_mean: 0.170435 0.1665 0.169573 0.169573
W_f max, min, mean, abs_mean: 0.1132 0.108264 0.112534 0.112534
Epoch 5/500
0s - loss: 1996.6761 - val_loss: 20027.0581
Epoch 00004: val_loss did not improve
Epoch 6/500
0s - loss: 1952.4839 - val_loss: 20267.3673
Epoch 00005: val_loss did not improve
Epoch 7/500
0s - loss: 1931.0355 - val_loss: 20011.6527
Epoch 00006: val_loss did not improve
Epoch 8/500
0s - loss: 1908.1269 - val_loss: 20820.7129
Epoch 00007: val_loss did not improve
Epoch 9/500
0s - loss: 1879.7288 - val_loss: 19883.7183
Epoch 00008: val_loss did not improve
Epoch 10/500
0s - loss: 1846.0376 - val_loss: 20145.7174
Epoch 00009: val_loss did not improve
Epoch 11/500
0s - loss: 1810.8751 - val_loss: 20143.4738
Epoch 00010: val_loss did not improve
Epoch 12/500
0s - loss: 1761.8909 - val_loss: 19379.5014
Epoch 00011: val_loss improved from 19404.44273 to 19379.50138, saving model to bj_newdata680split7_weights.hdf5
 bj_newdata680split7  1615.4      0.88  0.24  0.69      0.86  0.18  0.72      0.87  0.15  0.75
forget mean min: 0.894503 0.67762
delta_x = 7.53285
delta_h = 0.90484
delta mean, abs_mean, abs_mean+, abs_mean-: 0.376041 7.53285 6.67414 8.78142
U_c = [[-0.01574155]] U_f = [[ 0.]] b_f = [ 0.7428574]
W_c max, min, mean, abs_mean: 0.18912 0.185056 0.188147 0.188147
W_f max, min, mean, abs_mean: 0.148249 0.14231 0.147102 0.147102
 bj_newdata680split7 19379.5      0.83  0.13  0.73      0.82  0.08  0.77      0.84  0.06  0.80
forget mean min: 0.911214 0.67762
delta_x = 10.9432
delta_h = 1.49607
delta mean, abs_mean, abs_mean+, abs_mean-: -1.67454 10.9432 7.62581 16.0826
U_c = [[-0.01574155]] U_f = [[ 0.]] b_f = [ 0.7428574]
W_c max, min, mean, abs_mean: 0.18912 0.185056 0.188147 0.188147
W_f max, min, mean, abs_mean: 0.148249 0.14231 0.147102 0.147102
Epoch 13/500
0s - loss: 1698.3142 - val_loss: 19589.8185
Epoch 00012: val_loss did not improve
Epoch 14/500
0s - loss: 1649.8316 - val_loss: 19304.2382
Epoch 00013: val_loss improved from 19379.50138 to 19304.23824, saving model to bj_newdata680split7_weights.hdf5
 bj_newdata680split7  1508.9      0.88  0.23  0.70      0.86  0.17  0.73      0.87  0.15  0.75
forget mean min: 0.89242 0.656997
delta_x = 7.54876
delta_h = 0.81566
delta mean, abs_mean, abs_mean+, abs_mean-: 0.303116 7.54876 6.51114 9.12452
U_c = [[-0.01438752]] U_f = [[ 0.]] b_f = [ 0.6499393]
W_c max, min, mean, abs_mean: 0.196832 0.192747 0.195851 0.195851
W_f max, min, mean, abs_mean: 0.162495 0.156448 0.161205 0.161205
 bj_newdata680split7 19304.2      0.82  0.14  0.72      0.81  0.08  0.76      0.83  0.06  0.79
forget mean min: 0.910231 0.656997
delta_x = 11.1262
delta_h = 1.39852
delta mean, abs_mean, abs_mean+, abs_mean-: -1.61691 11.1262 7.67173 16.7568
U_c = [[-0.01438752]] U_f = [[ 0.]] b_f = [ 0.6499393]
W_c max, min, mean, abs_mean: 0.196832 0.192747 0.195851 0.195851
W_f max, min, mean, abs_mean: 0.162495 0.156448 0.161205 0.161205
Epoch 15/500
0s - loss: 1617.7968 - val_loss: 19228.2992
Epoch 00014: val_loss improved from 19304.23824 to 19228.29915, saving model to bj_newdata680split7_weights.hdf5
 bj_newdata680split7  1480.0      0.88  0.22  0.70      0.86  0.17  0.73      0.86  0.14  0.75
forget mean min: 0.888798 0.64653
delta_x = 7.73001
delta_h = 0.737874
delta mean, abs_mean, abs_mean+, abs_mean-: 0.277955 7.73001 6.62274 9.42299
U_c = [[-0.01281856]] U_f = [[ 0.]] b_f = [ 0.60382074]
W_c max, min, mean, abs_mean: 0.200653 0.196562 0.199672 0.199672
W_f max, min, mean, abs_mean: 0.168864 0.162793 0.167528 0.167528
 bj_newdata680split7 19228.3      0.81  0.14  0.72      0.81  0.08  0.76      0.83  0.06  0.79
forget mean min: 0.907456 0.64653
delta_x = 11.4085
delta_h = 1.28401
delta mean, abs_mean, abs_mean+, abs_mean-: -1.59997 11.4085 7.83397 17.3921
U_c = [[-0.01281856]] U_f = [[ 0.]] b_f = [ 0.60382074]
W_c max, min, mean, abs_mean: 0.200653 0.196562 0.199672 0.199672
W_f max, min, mean, abs_mean: 0.168864 0.162793 0.167528 0.167528
Epoch 16/500
0s - loss: 1584.8180 - val_loss: 19309.5551
Epoch 00015: val_loss did not improve
Epoch 17/500
0s - loss: 1567.8290 - val_loss: 19325.4990
Epoch 00016: val_loss did not improve
Epoch 18/500
0s - loss: 1538.2122 - val_loss: 19309.3774
Epoch 00017: val_loss did not improve
Epoch 19/500
0s - loss: 1519.8845 - val_loss: 19207.4538
Epoch 00018: val_loss improved from 19228.29915 to 19207.45382, saving model to bj_newdata680split7_weights.hdf5
 bj_newdata680split7  1388.8      0.88  0.21  0.71      0.87  0.16  0.74      0.87  0.14  0.76
forget mean min: 0.879697 0.606937
delta_x = 8.2254
delta_h = 0.627473
delta mean, abs_mean, abs_mean+, abs_mean-: 0.252439 8.2254 6.94584 10.2291
U_c = [[-0.01074267]] U_f = [[ 0.]] b_f = [ 0.43445474]
W_c max, min, mean, abs_mean: 0.215666 0.211532 0.214654 0.214654
W_f max, min, mean, abs_mean: 0.193663 0.187448 0.192076 0.192076
 bj_newdata680split7 19207.5      0.80  0.13  0.72      0.80  0.07  0.75      0.82  0.05  0.78
forget mean min: 0.900927 0.606937
delta_x = 11.9119
delta_h = 1.09572
delta mean, abs_mean, abs_mean+, abs_mean-: -1.66375 11.9119 8.14777 18.2908
U_c = [[-0.01074267]] U_f = [[ 0.]] b_f = [ 0.43445474]
W_c max, min, mean, abs_mean: 0.215666 0.211532 0.214654 0.214654
W_f max, min, mean, abs_mean: 0.193663 0.187448 0.192076 0.192076
Epoch 20/500
0s - loss: 1506.3101 - val_loss: 19484.2399
Epoch 00019: val_loss did not improve
Epoch 21/500
0s - loss: 1485.7928 - val_loss: 19519.3032
Epoch 00020: val_loss did not improve
Epoch 22/500
0s - loss: 1468.0987 - val_loss: 19585.2824
Epoch 00021: val_loss did not improve
Epoch 23/500
0s - loss: 1453.8728 - val_loss: 19575.0332
Epoch 00022: val_loss did not improve
Epoch 24/500
0s - loss: 1446.1285 - val_loss: 19796.9392
Epoch 00023: val_loss did not improve
Epoch 25/500
0s - loss: 1420.5479 - val_loss: 19718.9741
Epoch 00024: val_loss did not improve
Epoch 26/500
0s - loss: 1408.9306 - val_loss: 19799.4470
Epoch 00025: val_loss did not improve
Epoch 27/500
0s - loss: 1402.5441 - val_loss: 19687.8302
Epoch 00026: val_loss did not improve
Epoch 28/500
0s - loss: 1390.7281 - val_loss: 19903.9555
Epoch 00027: val_loss did not improve
Epoch 29/500
0s - loss: 1382.0997 - val_loss: 20213.1687
Epoch 00028: val_loss did not improve
Epoch 30/500
0s - loss: 1367.1755 - val_loss: 20123.9861
Epoch 00029: val_loss did not improve
Epoch 31/500
0s - loss: 1351.4401 - val_loss: 20123.1665
Epoch 00030: val_loss did not improve
Epoch 32/500
0s - loss: 1348.4977 - val_loss: 20199.9419
Epoch 00031: val_loss did not improve
Epoch 33/500
0s - loss: 1337.1795 - val_loss: 20664.9416
Epoch 00032: val_loss did not improve
Epoch 34/500
0s - loss: 1329.4287 - val_loss: 20240.1121
Epoch 00033: val_loss did not improve
Epoch 35/500
0s - loss: 1314.2660 - val_loss: 20490.8195
Epoch 00034: val_loss did not improve
Epoch 36/500
0s - loss: 1302.0701 - val_loss: 20443.3405
Epoch 00035: val_loss did not improve
Epoch 37/500
0s - loss: 1298.6031 - val_loss: 20312.8104
Epoch 00036: val_loss did not improve
Epoch 38/500
0s - loss: 1285.9650 - val_loss: 20539.1734
Epoch 00037: val_loss did not improve
Epoch 39/500
0s - loss: 1285.3594 - val_loss: 20672.0901
Epoch 00038: val_loss did not improve
Epoch 40/500
0s - loss: 1263.8265 - val_loss: 20763.0399
Epoch 00039: val_loss did not improve
X_train[0].shape = (3618, 40, 23)

training bj_newdata680split8
Train on 3618 samples, validate on 1098 samples
Before training:
 bj_newdata680split8 10875.7      0.03  -nan  0.03      0.06  -nan  0.05      0.09  -nan  0.09
forget mean min: 0.731058 0.731059
delta_x = 4.27293
delta_h = 2.69643
delta mean, abs_mean, abs_mean+, abs_mean-: -4.27293 4.27293 nan 4.27293
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
 bj_newdata680split8 52149.9      0.06  -nan  0.06      0.08  -nan  0.08      0.14  -nan  0.14
forget mean min: 0.731059 0.731059
delta_x = 9.22632
delta_h = 5.61792
delta mean, abs_mean, abs_mean+, abs_mean-: -9.22632 9.22632 nan 9.22632
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/500
0s - loss: 8997.8824 - val_loss: 30902.6775
Epoch 00000: val_loss improved from inf to 30902.67749, saving model to bj_newdata680split8_weights.hdf5
 bj_newdata680split8  5820.2      0.30  0.20  0.28      0.29  0.12  0.28      0.29  0.06  0.28
forget mean min: 0.879427 0.770161
delta_x = 3.47072
delta_h = 3.15214
delta mean, abs_mean, abs_mean+, abs_mean-: -3.00898 3.47072 1.06496 4.13663
U_c = [[-0.10655569]] U_f = [[ 0.]] b_f = [ 1.06549275]
W_c max, min, mean, abs_mean: 0.0942725 0.0901575 0.0932625 0.0932625
W_f max, min, mean, abs_mean: 0.090426 0.088272 0.0899889 0.0899889
 bj_newdata680split8 30902.7      0.71  0.13  0.64      0.71  0.07  0.67      0.73  0.05  0.71
forget mean min: 0.890711 0.770161
delta_x = 7.20263
delta_h = 6.661
delta mean, abs_mean, abs_mean+, abs_mean-: -6.83882 7.20263 1.2083 8.26499
U_c = [[-0.10655569]] U_f = [[ 0.]] b_f = [ 1.06549275]
W_c max, min, mean, abs_mean: 0.0942725 0.0901575 0.0932625 0.0932625
W_f max, min, mean, abs_mean: 0.090426 0.088272 0.0899889 0.0899889
Epoch 2/500
0s - loss: 4152.5726 - val_loss: 21264.9469
Epoch 00001: val_loss improved from 30902.67749 to 21264.94686, saving model to bj_newdata680split8_weights.hdf5
 bj_newdata680split8  2846.9      0.84  0.29  0.63      0.81  0.22  0.66      0.82  0.17  0.70
forget mean min: 0.922656 0.791981
delta_x = 5.85614
delta_h = 2.85722
delta mean, abs_mean, abs_mean+, abs_mean-: 0.797097 5.85614 5.65315 6.14638
U_c = [[-0.06427389]] U_f = [[ 0.]] b_f = [ 1.07459235]
W_c max, min, mean, abs_mean: 0.150485 0.146444 0.149483 0.149483
W_f max, min, mean, abs_mean: 0.1182 0.116032 0.117708 0.117708
 bj_newdata680split8 21264.9      0.87  0.17  0.74      0.87  0.11  0.79      0.89  0.07  0.83
forget mean min: 0.931935 0.791981
delta_x = 8.54344
delta_h = 4.67814
delta mean, abs_mean, abs_mean+, abs_mean-: -1.43592 8.54344 5.57214 13.775
U_c = [[-0.06427389]] U_f = [[ 0.]] b_f = [ 1.07459235]
W_c max, min, mean, abs_mean: 0.150485 0.146444 0.149483 0.149483
W_f max, min, mean, abs_mean: 0.1182 0.116032 0.117708 0.117708
Epoch 3/500
0s - loss: 2432.0193 - val_loss: 19845.2763
Epoch 00002: val_loss improved from 21264.94686 to 19845.27628, saving model to bj_newdata680split8_weights.hdf5
 bj_newdata680split8  2054.7      0.86  0.27  0.65      0.84  0.21  0.69      0.85  0.17  0.72
forget mean min: 0.908354 0.763517
delta_x = 7.00949
delta_h = 1.79553
delta mean, abs_mean, abs_mean+, abs_mean-: 0.630615 7.00949 6.743 7.35778
U_c = [[-0.03302742]] U_f = [[ 0.]] b_f = [ 1.02422357]
W_c max, min, mean, abs_mean: 0.167498 0.163488 0.166515 0.166515
W_f max, min, mean, abs_mean: 0.108076 0.105429 0.107497 0.107497
 bj_newdata680split8 19845.3      0.84  0.17  0.72      0.85  0.10  0.77      0.87  0.07  0.81
forget mean min: 0.926252 0.763517
delta_x = 9.49699
delta_h = 2.89577
delta mean, abs_mean, abs_mean+, abs_mean-: -1.27646 9.49699 6.5369 14.5109
U_c = [[-0.03302742]] U_f = [[ 0.]] b_f = [ 1.02422357]
W_c max, min, mean, abs_mean: 0.167498 0.163488 0.166515 0.166515
W_f max, min, mean, abs_mean: 0.108076 0.105429 0.107497 0.107497
Epoch 4/500
0s - loss: 2082.3378 - val_loss: 20185.7507
Epoch 00003: val_loss did not improve
Epoch 5/500
0s - loss: 1990.4185 - val_loss: 19686.6938
Epoch 00004: val_loss improved from 19845.27628 to 19686.69380, saving model to bj_newdata680split8_weights.hdf5
 bj_newdata680split8  1853.7      0.87  0.26  0.66      0.85  0.20  0.71      0.86  0.16  0.74
forget mean min: 0.898964 0.724959
delta_x = 7.28589
delta_h = 1.29906
delta mean, abs_mean, abs_mean+, abs_mean-: 0.4625 7.28589 6.61288 8.23793
U_c = [[-0.02287838]] U_f = [[ 0.]] b_f = [ 0.94782597]
W_c max, min, mean, abs_mean: 0.172968 0.16899 0.171996 0.171996
W_f max, min, mean, abs_mean: 0.114043 0.110959 0.113417 0.113417
 bj_newdata680split8 19686.7      0.83  0.14  0.74      0.83  0.08  0.77      0.85  0.06  0.80
forget mean min: 0.916799 0.724959
delta_x = 10.0562
delta_h = 2.07711
delta mean, abs_mean, abs_mean+, abs_mean-: -1.64483 10.0562 6.80995 15.2985
U_c = [[-0.02287838]] U_f = [[ 0.]] b_f = [ 0.94782597]
W_c max, min, mean, abs_mean: 0.172968 0.16899 0.171996 0.171996
W_f max, min, mean, abs_mean: 0.114043 0.110959 0.113417 0.113417
Epoch 6/500
0s - loss: 1936.3168 - val_loss: 19710.8272
Epoch 00005: val_loss did not improve
Epoch 7/500
0s - loss: 1909.1787 - val_loss: 20039.3149
Epoch 00006: val_loss did not improve
Epoch 8/500
0s - loss: 1880.1283 - val_loss: 19704.5581
Epoch 00007: val_loss did not improve
Epoch 9/500
0s - loss: 1835.5501 - val_loss: 19454.4581
Epoch 00008: val_loss improved from 19686.69380 to 19454.45814, saving model to bj_newdata680split8_weights.hdf5
 bj_newdata680split8  1704.7      0.88  0.25  0.68      0.86  0.18  0.72      0.87  0.15  0.75
forget mean min: 0.896469 0.693282
delta_x = 7.42277
delta_h = 1.10117
delta mean, abs_mean, abs_mean+, abs_mean-: 0.432153 7.42277 6.54215 8.74552
U_c = [[-0.01926897]] U_f = [[ 0.]] b_f = [ 0.81551003]
W_c max, min, mean, abs_mean: 0.181564 0.177606 0.180577 0.180577
W_f max, min, mean, abs_mean: 0.136349 0.133152 0.135667 0.135667
 bj_newdata680split8 19454.5      0.83  0.13  0.74      0.82  0.07  0.77      0.84  0.06  0.80
forget mean min: 0.913364 0.693282
delta_x = 10.5009
delta_h = 1.7873
delta mean, abs_mean, abs_mean+, abs_mean-: -1.70283 10.5009 7.18581 15.7338
U_c = [[-0.01926897]] U_f = [[ 0.]] b_f = [ 0.81551003]
W_c max, min, mean, abs_mean: 0.181564 0.177606 0.180577 0.180577
W_f max, min, mean, abs_mean: 0.136349 0.133152 0.135667 0.135667
Epoch 10/500
0s - loss: 1793.1385 - val_loss: 19915.0753
Epoch 00009: val_loss did not improve
Epoch 11/500
0s - loss: 1736.8860 - val_loss: 19444.1785
Epoch 00010: val_loss improved from 19454.45814 to 19444.17854, saving model to bj_newdata680split8_weights.hdf5
 bj_newdata680split8  1588.9      0.87  0.23  0.70      0.85  0.17  0.72      0.86  0.14  0.75
forget mean min: 0.894262 0.675402
delta_x = 7.28923
delta_h = 1.05051
delta mean, abs_mean, abs_mean+, abs_mean-: 0.299884 7.28923 6.31728 8.7512
U_c = [[-0.01887292]] U_f = [[ 0.]] b_f = [ 0.73272073]
W_c max, min, mean, abs_mean: 0.185182 0.181262 0.18421 0.18421
W_f max, min, mean, abs_mean: 0.156256 0.152824 0.155298 0.155298
 bj_newdata680split8 19444.2      0.82  0.13  0.73      0.82  0.08  0.77      0.84  0.06  0.80
forget mean min: 0.912977 0.675402
delta_x = 10.5801
delta_h = 1.76462
delta mean, abs_mean, abs_mean+, abs_mean-: -1.68362 10.5801 7.17709 16.1274
U_c = [[-0.01887292]] U_f = [[ 0.]] b_f = [ 0.73272073]
W_c max, min, mean, abs_mean: 0.185182 0.181262 0.18421 0.18421
W_f max, min, mean, abs_mean: 0.156256 0.152824 0.155298 0.155298
Epoch 12/500
0s - loss: 1683.5062 - val_loss: 19302.4181
Epoch 00011: val_loss improved from 19444.17854 to 19302.41808, saving model to bj_newdata680split8_weights.hdf5
 bj_newdata680split8  1543.5      0.87  0.22  0.70      0.85  0.17  0.73      0.86  0.14  0.75
forget mean min: 0.892589 0.665063
delta_x = 7.35202
delta_h = 1.07721
delta mean, abs_mean, abs_mean+, abs_mean-: 0.27964 7.35202 6.34503 8.87128
U_c = [[-0.01944317]] U_f = [[ 0.]] b_f = [ 0.68593919]
W_c max, min, mean, abs_mean: 0.188788 0.184885 0.187824 0.187824
W_f max, min, mean, abs_mean: 0.167837 0.164296 0.166736 0.166736
 bj_newdata680split8 19302.4      0.82  0.14  0.73      0.82  0.08  0.77      0.84  0.06  0.80
forget mean min: 0.91267 0.665063
delta_x = 10.7557
delta_h = 1.83406
delta mean, abs_mean, abs_mean+, abs_mean-: -1.60883 10.7557 7.26536 16.6856
U_c = [[-0.01944317]] U_f = [[ 0.]] b_f = [ 0.68593919]
W_c max, min, mean, abs_mean: 0.188788 0.184885 0.187824 0.187824
W_f max, min, mean, abs_mean: 0.167837 0.164296 0.166736 0.166736
Epoch 13/500
0s - loss: 1649.0736 - val_loss: 19341.0480
Epoch 00012: val_loss did not improve
Epoch 14/500
0s - loss: 1607.4133 - val_loss: 18927.3354
Epoch 00013: val_loss improved from 19302.41808 to 18927.33543, saving model to bj_newdata680split8_weights.hdf5
 bj_newdata680split8  1473.2      0.89  0.23  0.70      0.87  0.18  0.73      0.88  0.15  0.76
forget mean min: 0.889435 0.644245
delta_x = 7.82379
delta_h = 0.846618
delta mean, abs_mean, abs_mean+, abs_mean-: 0.353519 7.82379 6.64589 9.70709
U_c = [[-0.0145356]] U_f = [[ 0.]] b_f = [ 0.59383798]
W_c max, min, mean, abs_mean: 0.200238 0.196365 0.199283 0.199283
W_f max, min, mean, abs_mean: 0.188193 0.184505 0.186873 0.186873
 bj_newdata680split8 18927.3      0.82  0.14  0.72      0.82  0.08  0.76      0.84  0.06  0.79
forget mean min: 0.911084 0.644245
delta_x = 11.4849
delta_h = 1.45143
delta mean, abs_mean, abs_mean+, abs_mean-: -1.4639 11.4849 7.70012 18.5357
U_c = [[-0.0145356]] U_f = [[ 0.]] b_f = [ 0.59383798]
W_c max, min, mean, abs_mean: 0.200238 0.196365 0.199283 0.199283
W_f max, min, mean, abs_mean: 0.188193 0.184505 0.186873 0.186873
Epoch 15/500
0s - loss: 1579.7284 - val_loss: 18979.5221
Epoch 00014: val_loss did not improve
Epoch 16/500
0s - loss: 1552.6881 - val_loss: 19094.8739
Epoch 00015: val_loss did not improve
Epoch 17/500
0s - loss: 1520.7330 - val_loss: 19233.1771
Epoch 00016: val_loss did not improve
Epoch 18/500
0s - loss: 1500.2321 - val_loss: 19133.0972
Epoch 00017: val_loss did not improve
Epoch 19/500
0s - loss: 1484.2882 - val_loss: 19286.3766
Epoch 00018: val_loss did not improve
Epoch 20/500
0s - loss: 1468.3996 - val_loss: 19286.2996
Epoch 00019: val_loss did not improve
Epoch 21/500
0s - loss: 1446.9722 - val_loss: 19404.6042
Epoch 00020: val_loss did not improve
Epoch 22/500
0s - loss: 1432.8801 - val_loss: 19554.2658
Epoch 00021: val_loss did not improve
Epoch 23/500
0s - loss: 1413.6949 - val_loss: 19572.2899
Epoch 00022: val_loss did not improve
Epoch 24/500
0s - loss: 1405.1100 - val_loss: 19767.0977
Epoch 00023: val_loss did not improve
Epoch 25/500
0s - loss: 1383.5635 - val_loss: 19657.0901
Epoch 00024: val_loss did not improve
Epoch 26/500
0s - loss: 1374.1814 - val_loss: 19884.5101
Epoch 00025: val_loss did not improve
Epoch 27/500
0s - loss: 1364.3291 - val_loss: 19953.7214
Epoch 00026: val_loss did not improve
Epoch 28/500
0s - loss: 1352.7819 - val_loss: 20218.5342
Epoch 00027: val_loss did not improve
Epoch 29/500
0s - loss: 1347.0148 - val_loss: 19950.1533
Epoch 00028: val_loss did not improve
Epoch 30/500
0s - loss: 1332.8504 - val_loss: 20368.5169
Epoch 00029: val_loss did not improve
Epoch 31/500
0s - loss: 1321.3969 - val_loss: 20087.9459
Epoch 00030: val_loss did not improve
Epoch 32/500
0s - loss: 1298.8651 - val_loss: 20383.7047
Epoch 00031: val_loss did not improve
Epoch 33/500
0s - loss: 1299.8361 - val_loss: 20682.0672
Epoch 00032: val_loss did not improve
Epoch 34/500
0s - loss: 1285.9532 - val_loss: 20352.1176
Epoch 00033: val_loss did not improve
Epoch 35/500
0s - loss: 1282.5153 - val_loss: 20635.7089
Epoch 00034: val_loss did not improve
X_train[0].shape = (3618, 40, 23)

training bj_newdata680split9
Train on 3618 samples, validate on 1098 samples
Before training:
 bj_newdata680split9 10875.7      0.03  -nan  0.03      0.06  -nan  0.05      0.09  -nan  0.09
forget mean min: 0.731058 0.731059
delta_x = 4.27293
delta_h = 2.69643
delta mean, abs_mean, abs_mean+, abs_mean-: -4.27293 4.27293 nan 4.27293
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
 bj_newdata680split9 52149.9      0.06  -nan  0.06      0.08  -nan  0.08      0.14  -nan  0.14
forget mean min: 0.731059 0.731059
delta_x = 9.22632
delta_h = 5.61792
delta mean, abs_mean, abs_mean+, abs_mean-: -9.22632 9.22632 nan 9.22632
U_c = [[-0.05]] U_f = [[ 0.]] b_f = [ 1.]
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/500
0s - loss: 8891.7674 - val_loss: 30626.0371
Epoch 00000: val_loss improved from inf to 30626.03708, saving model to bj_newdata680split9_weights.hdf5
 bj_newdata680split9  5776.2      0.31  0.22  0.29      0.29  0.14  0.28      0.30  0.07  0.29
forget mean min: 0.879448 0.770683
delta_x = 3.54046
delta_h = 3.17869
delta mean, abs_mean, abs_mean+, abs_mean-: -2.93383 3.54046 1.24377 4.28121
U_c = [[-0.10701776]] U_f = [[ 0.]] b_f = [ 1.06590176]
W_c max, min, mean, abs_mean: 0.0946864 0.0904023 0.0939038 0.0939038
W_f max, min, mean, abs_mean: 0.0913576 0.0877981 0.0907816 0.0907816
 bj_newdata680split9 30626.0      0.73  0.13  0.66      0.73  0.07  0.69      0.75  0.05  0.72
forget mean min: 0.892003 0.770683
delta_x = 7.1767
delta_h = 6.65047
delta mean, abs_mean, abs_mean+, abs_mean-: -6.66142 7.1767 1.45088 8.41298
U_c = [[-0.10701776]] U_f = [[ 0.]] b_f = [ 1.06590176]
W_c max, min, mean, abs_mean: 0.0946864 0.0904023 0.0939038 0.0939038
W_f max, min, mean, abs_mean: 0.0913576 0.0877981 0.0907816 0.0907816
Epoch 2/500
0s - loss: 4272.8158 - val_loss: 21830.7174
Epoch 00001: val_loss improved from 30626.03708 to 21830.71742, saving model to bj_newdata680split9_weights.hdf5
 bj_newdata680split9  2927.9      0.81  0.26  0.63      0.77  0.20  0.65      0.77  0.15  0.68
forget mean min: 0.91791 0.7892
delta_x = 5.61868
delta_h = 2.88777
delta mean, abs_mean, abs_mean+, abs_mean-: 0.440783 5.61868 5.24979 6.1221
U_c = [[-0.06943417]] U_f = [[ 0.]] b_f = [ 1.07413578]
W_c max, min, mean, abs_mean: 0.147794 0.143583 0.147004 0.147004
W_f max, min, mean, abs_mean: 0.114202 0.110697 0.113623 0.113623
 bj_newdata680split9 21830.7      0.86  0.17  0.74      0.87  0.10  0.79      0.88  0.07  0.82
forget mean min: 0.928228 0.7892
delta_x = 8.31184
delta_h = 4.87788
delta mean, abs_mean, abs_mean+, abs_mean-: -1.85324 8.31184 5.17065 13.537
U_c = [[-0.06943417]] U_f = [[ 0.]] b_f = [ 1.07413578]
W_c max, min, mean, abs_mean: 0.147794 0.143583 0.147004 0.147004
W_f max, min, mean, abs_mean: 0.114202 0.110697 0.113623 0.113623
Epoch 3/500
0s - loss: 2436.1438 - val_loss: 19495.9410
Epoch 00002: val_loss improved from 21830.71742 to 19495.94096, saving model to bj_newdata680split9_weights.hdf5
 bj_newdata680split9  2079.6      0.88  0.29  0.65      0.86  0.22  0.69      0.88  0.18  0.73
forget mean min: 0.908788 0.765128
delta_x = 7.38926
delta_h = 1.97682
delta mean, abs_mean, abs_mean+, abs_mean-: 0.863939 7.38926 7.18637 7.66289
U_c = [[-0.03541848]] U_f = [[ 0.]] b_f = [ 1.02652061]
W_c max, min, mean, abs_mean: 0.17144 0.167256 0.170651 0.170651
W_f max, min, mean, abs_mean: 0.111505 0.107571 0.110966 0.110966
 bj_newdata680split9 19495.9      0.85  0.17  0.73      0.85  0.10  0.78      0.87  0.07  0.81
forget mean min: 0.925273 0.765128
delta_x = 10.0885
delta_h = 3.15268
delta mean, abs_mean, abs_mean+, abs_mean-: -1.0757 10.0885 7.13384 15.1562
U_c = [[-0.03541848]] U_f = [[ 0.]] b_f = [ 1.02652061]
W_c max, min, mean, abs_mean: 0.17144 0.167256 0.170651 0.170651
W_f max, min, mean, abs_mean: 0.111505 0.107571 0.110966 0.110966
Epoch 4/500
0s - loss: 2082.8051 - val_loss: 19910.2745
Epoch 00003: val_loss did not improve
Epoch 5/500
0s - loss: 2000.4674 - val_loss: 20079.0576
Epoch 00004: val_loss did not improve
Epoch 6/500
0s - loss: 1957.3169 - val_loss: 20231.6100
Epoch 00005: val_loss did not improve
Epoch 7/500
0s - loss: 1934.9940 - val_loss: 20315.3760
Epoch 00006: val_loss did not improve
Epoch 8/500
0s - loss: 1899.8403 - val_loss: 20481.2913
Epoch 00007: val_loss did not improve
Epoch 9/500
0s - loss: 1871.1989 - val_loss: 20452.9470
Epoch 00008: val_loss did not improve
Epoch 10/500
0s - loss: 1839.4694 - val_loss: 19856.1154
Epoch 00009: val_loss did not improve
Epoch 11/500
0s - loss: 1787.2386 - val_loss: 19502.4408
Epoch 00010: val_loss did not improve
Epoch 12/500
0s - loss: 1726.3685 - val_loss: 19052.9088
Epoch 00011: val_loss improved from 19495.94096 to 19052.90878, saving model to bj_newdata680split9_weights.hdf5
 bj_newdata680split9  1598.2      0.89  0.25  0.69      0.87  0.19  0.73      0.88  0.15  0.76
forget mean min: 0.895737 0.67592
delta_x = 7.62232
delta_h = 0.902667
delta mean, abs_mean, abs_mean+, abs_mean-: 0.416052 7.62232 6.65542 9.09647
U_c = [[-0.0155946]] U_f = [[ 0.]] b_f = [ 0.73508507]
W_c max, min, mean, abs_mean: 0.190505 0.186335 0.189778 0.189778
W_f max, min, mean, abs_mean: 0.155883 0.150703 0.155015 0.155015
 bj_newdata680split9 19052.9      0.82  0.14  0.73      0.82  0.08  0.77      0.84  0.06  0.80
forget mean min: 0.912821 0.67592
delta_x = 11.1083
delta_h = 1.51115
delta mean, abs_mean, abs_mean+, abs_mean-: -1.54108 11.1083 7.75231 16.5158
U_c = [[-0.0155946]] U_f = [[ 0.]] b_f = [ 0.73508507]
W_c max, min, mean, abs_mean: 0.190505 0.186335 0.189778 0.189778
W_f max, min, mean, abs_mean: 0.155883 0.150703 0.155015 0.155015
Epoch 13/500
0s - loss: 1681.4844 - val_loss: 19101.9211
Epoch 00012: val_loss did not improve
Epoch 14/500
0s - loss: 1646.6750 - val_loss: 19112.7472
Epoch 00013: val_loss did not improve
Epoch 15/500
0s - loss: 1615.6245 - val_loss: 19141.9003
Epoch 00014: val_loss did not improve
Epoch 16/500
0s - loss: 1580.2215 - val_loss: 19038.3582
Epoch 00015: val_loss improved from 19052.90878 to 19038.35823, saving model to bj_newdata680split9_weights.hdf5
 bj_newdata680split9  1444.3      0.88  0.22  0.71      0.86  0.17  0.73      0.87  0.15  0.76
forget mean min: 0.885494 0.634133
delta_x = 7.99031
delta_h = 0.70109
delta mean, abs_mean, abs_mean+, abs_mean-: 0.264418 7.99031 6.76213 9.91426
U_c = [[-0.01204691]] U_f = [[ 0.]] b_f = [ 0.54998744]
W_c max, min, mean, abs_mean: 0.204546 0.200313 0.203798 0.203798
W_f max, min, mean, abs_mean: 0.192654 0.187251 0.191674 0.191674
 bj_newdata680split9 19038.4      0.81  0.14  0.72      0.81  0.08  0.76      0.83  0.06  0.78
forget mean min: 0.907094 0.634133
delta_x = 11.7867
delta_h = 1.23461
delta mean, abs_mean, abs_mean+, abs_mean-: -1.52202 11.7867 8.0582 18.3269
U_c = [[-0.01204691]] U_f = [[ 0.]] b_f = [ 0.54998744]
W_c max, min, mean, abs_mean: 0.204546 0.200313 0.203798 0.203798
W_f max, min, mean, abs_mean: 0.192654 0.187251 0.191674 0.191674
Epoch 17/500
0s - loss: 1551.9096 - val_loss: 19258.3539
Epoch 00016: val_loss did not improve
Epoch 18/500
0s - loss: 1530.9219 - val_loss: 19291.2863
Epoch 00017: val_loss did not improve
Epoch 19/500
0s - loss: 1507.3091 - val_loss: 19155.3247
Epoch 00018: val_loss did not improve
Epoch 20/500
0s - loss: 1483.3861 - val_loss: 19310.3302
Epoch 00019: val_loss did not improve
Epoch 21/500
0s - loss: 1466.2675 - val_loss: 19460.5017
Epoch 00020: val_loss did not improve
Epoch 22/500
0s - loss: 1450.5532 - val_loss: 19397.1280
Epoch 00021: val_loss did not improve
Epoch 23/500
0s - loss: 1435.2049 - val_loss: 19389.3126
Epoch 00022: val_loss did not improve
Epoch 24/500
0s - loss: 1427.0055 - val_loss: 19491.0117
Epoch 00023: val_loss did not improve
Epoch 25/500
0s - loss: 1406.5274 - val_loss: 19460.7397
Epoch 00024: val_loss did not improve
Epoch 26/500
0s - loss: 1387.9909 - val_loss: 19572.7819
Epoch 00025: val_loss did not improve
Epoch 27/500
0s - loss: 1374.4862 - val_loss: 19702.6208
Epoch 00026: val_loss did not improve
Epoch 28/500
0s - loss: 1370.0993 - val_loss: 19713.6186
Epoch 00027: val_loss did not improve
Epoch 29/500
0s - loss: 1352.8404 - val_loss: 20128.1725
Epoch 00028: val_loss did not improve
Epoch 30/500
0s - loss: 1343.4532 - val_loss: 19645.9822
Epoch 00029: val_loss did not improve
Epoch 31/500
0s - loss: 1338.1770 - val_loss: 19945.2595
Epoch 00030: val_loss did not improve
Epoch 32/500
0s - loss: 1324.3773 - val_loss: 19921.7043
Epoch 00031: val_loss did not improve
Epoch 33/500
0s - loss: 1313.5256 - val_loss: 20046.7350
Epoch 00032: val_loss did not improve
Epoch 34/500
0s - loss: 1297.5576 - val_loss: 19983.2245
Epoch 00033: val_loss did not improve
Epoch 35/500
0s - loss: 1290.1224 - val_loss: 20149.9325
Epoch 00034: val_loss did not improve
Epoch 36/500
0s - loss: 1276.8202 - val_loss: 20326.6777
Epoch 00035: val_loss did not improve
Epoch 37/500
0s - loss: 1270.0546 - val_loss: 19987.5513
Epoch 00036: val_loss did not improve
 bj_newdata680split0  1605.4      0.89  0.25  0.69      0.87  0.19  0.72      0.87  0.16  0.75
forget mean min: 0.893642 0.674046
 bj_newdata680split0 18993.7      0.83  0.13  0.74      0.83  0.07  0.78      0.85  0.05  0.81
forget mean min: 0.911094 0.674046
 bj_newdata680split1  1460.0      0.89  0.23  0.70      0.87  0.18  0.73      0.88  0.15  0.76
forget mean min: 0.887382 0.638351
 bj_newdata680split1 19006.1      0.81  0.15  0.71      0.81  0.09  0.75      0.83  0.07  0.78
forget mean min: 0.910412 0.638351
 bj_newdata680split2  1471.3      0.89  0.23  0.70      0.87  0.17  0.74      0.88  0.15  0.76
forget mean min: 0.888759 0.641169
 bj_newdata680split2 19034.1      0.81  0.15  0.72      0.81  0.08  0.75      0.83  0.07  0.78
forget mean min: 0.910199 0.641169
 bj_newdata680split3  1491.6      0.88  0.22  0.70      0.86  0.17  0.73      0.87  0.15  0.75
forget mean min: 0.889666 0.650511
 bj_newdata680split3 19152.7      0.81  0.14  0.72      0.81  0.08  0.76      0.83  0.07  0.78
forget mean min: 0.912611 0.650511
 bj_newdata680split4  1310.4      0.88  0.20  0.72      0.86  0.16  0.74      0.87  0.14  0.76
forget mean min: 0.873489 0.57146
 bj_newdata680split4 18941.5      0.80  0.12  0.72      0.80  0.06  0.76      0.82  0.05  0.79
forget mean min: 0.895498 0.57146
 bj_newdata680split5  1582.7      0.89  0.24  0.69      0.87  0.18  0.73      0.88  0.15  0.76
forget mean min: 0.893432 0.670039
 bj_newdata680split5 19309.2      0.82  0.14  0.72      0.82  0.08  0.76      0.84  0.06  0.79
forget mean min: 0.911113 0.670039
 bj_newdata680split6  1511.8      0.89  0.23  0.70      0.87  0.17  0.73      0.87  0.15  0.76
forget mean min: 0.892842 0.65799
 bj_newdata680split6 19038.7      0.82  0.14  0.73      0.82  0.08  0.76      0.84  0.06  0.80
forget mean min: 0.911947 0.65799
 bj_newdata680split7  1388.8      0.88  0.21  0.71      0.87  0.16  0.74      0.87  0.14  0.76
forget mean min: 0.879697 0.606937
 bj_newdata680split7 19207.5      0.80  0.13  0.72      0.80  0.07  0.75      0.82  0.05  0.78
forget mean min: 0.900927 0.606937
 bj_newdata680split8  1473.2      0.89  0.23  0.70      0.87  0.18  0.73      0.88  0.15  0.76
forget mean min: 0.889435 0.644245
 bj_newdata680split8 18927.3      0.82  0.14  0.72      0.82  0.08  0.76      0.84  0.06  0.79
forget mean min: 0.911084 0.644245
 bj_newdata680split9  1444.3      0.88  0.22  0.71      0.86  0.17  0.73      0.87  0.15  0.76
forget mean min: 0.885494 0.634133
 bj_newdata680split9 19038.4      0.81  0.14  0.72      0.81  0.08  0.76      0.83  0.06  0.78
forget mean min: 0.907094 0.634133
