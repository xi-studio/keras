X_train[0].shape = (5274, 40, 23)

training nanjing
Train on 5274 samples, validate on 1044 samples
Before training:
             nanjing 2761.3354      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 2.74329 delta_h = 1.7857
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -2.74329 2.74329 nan 2.74329
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
             nanjing 5594.5706      0.01  -nan  0.01      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 3.82527 delta_h = 2.38944
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.82527 3.82527 nan 3.82527
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 1752.8225 - val_loss: 1889.8409
Epoch 00000: val_loss improved from inf to 1889.84094, saving model to nanjing_weights.hdf5
             nanjing  786.0506      0.17  0.42  0.15      0.18  0.43  0.16      0.20  0.33  0.18
forget mean min: 0.924676 0.790741
delta_x = 2.57138 delta_h = 1.91024
U_c = [[-0.11930893]] U_f = [[ 0.]] b_c = [ 0.08590908] b_f = [ 1.08511746]
incx.max(), incx.min(), incx.mean() 6.75713 0.341334 2.12434
fgtx.max(), fgtx.min(), fgtx.mean() 6.37995 0.244282 1.94943
delta mean, abs_mean, abs_mean+, abs_mean-: -0.446451 2.57138 2.54312 2.59166
W_c max, min, mean, abs_mean: 0.11505 0.11137 0.11447 0.11447
W_f max, min, mean, abs_mean: 0.109972 0.107936 0.109475 0.109475
             nanjing 1889.8409      0.20  0.44  0.17      0.19  0.46  0.16      0.17  0.43  0.15
forget mean min: 0.94993 0.802047
delta_x = 2.88972 delta_h = 1.96971
U_c = [[-0.11930893]] U_f = [[ 0.]] b_c = [ 0.08590908] b_f = [ 1.08511746]
incx.max(), incx.min(), incx.mean() 6.78045 0.414259 2.60042
fgtx.max(), fgtx.min(), fgtx.mean() 6.40225 0.314022 2.40473
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0620801 2.88972 2.60506 3.22756
W_c max, min, mean, abs_mean: 0.11505 0.11137 0.11447 0.11447
W_f max, min, mean, abs_mean: 0.109972 0.107936 0.109475 0.109475
Epoch 2/300
0s - loss: 683.6531 - val_loss: 1504.6051
Epoch 00001: val_loss improved from 1889.84094 to 1504.60515, saving model to nanjing_weights.hdf5
             nanjing  638.1121      0.38  0.35  0.32      0.41  0.33  0.34      0.43  0.28  0.37
forget mean min: 0.943165 0.810793
delta_x = 2.65996 delta_h = 1.74601
U_c = [[-0.1123008]] U_f = [[ 0.]] b_c = [ 0.09036119] b_f = [ 1.09901106]
incx.max(), incx.min(), incx.mean() 7.80031 0.499253 2.7336
fgtx.max(), fgtx.min(), fgtx.mean() 6.71553 0.356159 2.30233
delta mean, abs_mean, abs_mean+, abs_mean-: 0.469382 2.65996 2.89635 2.3822
W_c max, min, mean, abs_mean: 0.137187 0.133439 0.136622 0.136622
W_f max, min, mean, abs_mean: 0.119547 0.117538 0.119003 0.119003
             nanjing 1504.6052      0.54  0.47  0.37      0.55  0.46  0.38      0.55  0.44  0.38
forget mean min: 0.968876 0.850197
delta_x = 3.15485 delta_h = 2.34398
U_c = [[-0.1123008]] U_f = [[ 0.]] b_c = [ 0.09036119] b_f = [ 1.09901106]
incx.max(), incx.min(), incx.mean() 7.51558 0.821842 3.58042
fgtx.max(), fgtx.min(), fgtx.mean() 6.46753 0.637137 3.03992
delta mean, abs_mean, abs_mean+, abs_mean-: 1.60663 3.15485 3.5858 2.30347
W_c max, min, mean, abs_mean: 0.137187 0.133439 0.136622 0.136622
W_f max, min, mean, abs_mean: 0.119547 0.117538 0.119003 0.119003
Epoch 3/300
0s - loss: 610.8133 - val_loss: 1431.0782
Epoch 00002: val_loss improved from 1504.60515 to 1431.07816, saving model to nanjing_weights.hdf5
             nanjing  587.4186      0.46  0.33  0.38      0.50  0.31  0.41      0.54  0.25  0.46
forget mean min: 0.93982 0.785779
delta_x = 2.82674 delta_h = 1.38234
U_c = [[-0.08561646]] U_f = [[ 0.]] b_c = [ 0.0760108] b_f = [ 1.07926702]
incx.max(), incx.min(), incx.mean() 8.19472 0.37867 3.03351
fgtx.max(), fgtx.min(), fgtx.mean() 5.91206 0.220402 2.15365
delta mean, abs_mean, abs_mean+, abs_mean-: 0.505401 2.82674 2.90374 2.7231
W_c max, min, mean, abs_mean: 0.15759 0.153614 0.156943 0.156943
W_f max, min, mean, abs_mean: 0.114942 0.112749 0.114288 0.114288
             nanjing 1431.0782      0.65  0.46  0.42      0.65  0.45  0.43      0.65  0.42  0.44
forget mean min: 0.966523 0.838886
delta_x = 3.37539 delta_h = 1.99332
U_c = [[-0.08561646]] U_f = [[ 0.]] b_c = [ 0.0760108] b_f = [ 1.07926702]
incx.max(), incx.min(), incx.mean() 8.26195 0.859714 3.97619
fgtx.max(), fgtx.min(), fgtx.mean() 5.96101 0.570698 2.84011
delta mean, abs_mean, abs_mean+, abs_mean-: 1.67156 3.37539 3.69743 2.68316
W_c max, min, mean, abs_mean: 0.15759 0.153614 0.156943 0.156943
W_f max, min, mean, abs_mean: 0.114942 0.112749 0.114288 0.114288
Epoch 4/300
0s - loss: 578.0421 - val_loss: 1501.5569
Epoch 00003: val_loss did not improve
Epoch 5/300
0s - loss: 559.2658 - val_loss: 1464.8026
Epoch 00004: val_loss did not improve
Epoch 6/300
0s - loss: 543.4184 - val_loss: 1447.1588
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 530.8883 - val_loss: 1456.4540
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 520.2968 - val_loss: 1506.0437
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 509.4926 - val_loss: 1461.8101
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 498.5731 - val_loss: 1402.7614
Epoch 00009: val_loss improved from 1431.07816 to 1402.76142, saving model to nanjing_weights.hdf5
             nanjing  485.7716      0.51  0.33  0.40      0.55  0.30  0.45      0.60  0.25  0.50
forget mean min: 0.93619 0.710869
delta_x = 4.07188 delta_h = 0.795113
U_c = [[-0.04589637]] U_f = [[ 0.]] b_c = [-0.05884265] b_f = [ 0.8996079]
incx.max(), incx.min(), incx.mean() 10.0853 -0.0588426 3.18965
fgtx.max(), fgtx.min(), fgtx.mean() 8.25511 0.0 2.64363
delta mean, abs_mean, abs_mean+, abs_mean-: 0.400808 4.07188 3.46827 5.16761
W_c max, min, mean, abs_mean: 0.201215 0.196446 0.200094 0.200094
W_f max, min, mean, abs_mean: 0.164021 0.160937 0.162838 0.162838
             nanjing 1402.7614      0.63  0.47  0.40      0.63  0.47  0.41      0.63  0.45  0.42
forget mean min: 0.965191 0.710869
delta_x = 4.07041 delta_h = 1.13022
U_c = [[-0.04589637]] U_f = [[ 0.]] b_c = [-0.05884265] b_f = [ 0.8996079]
incx.max(), incx.min(), incx.mean() 9.04154 -0.0588426 3.84306
fgtx.max(), fgtx.min(), fgtx.mean() 7.40596 0.0 3.17536
delta mean, abs_mean, abs_mean+, abs_mean-: 1.20836 4.07041 3.49208 5.86051
W_c max, min, mean, abs_mean: 0.201215 0.196446 0.200094 0.200094
W_f max, min, mean, abs_mean: 0.164021 0.160937 0.162838 0.162838
Epoch 11/300
0s - loss: 488.7918 - val_loss: 1384.5114
Epoch 00010: val_loss improved from 1402.76142 to 1384.51138, saving model to nanjing_weights.hdf5
             nanjing  475.8550      0.49  0.31  0.40      0.53  0.28  0.44      0.58  0.23  0.50
forget mean min: 0.933797 0.703775
delta_x = 4.073 delta_h = 0.745825
U_c = [[-0.04415591]] U_f = [[ 0.]] b_c = [-0.08129719] b_f = [ 0.86533934]
incx.max(), incx.min(), incx.mean() 10.4756 -0.0812972 3.06439
fgtx.max(), fgtx.min(), fgtx.mean() 9.05105 0.0 2.69705
delta mean, abs_mean, abs_mean+, abs_mean-: 0.266786 4.073 3.38312 5.30685
W_c max, min, mean, abs_mean: 0.20452 0.199583 0.203248 0.203248
W_f max, min, mean, abs_mean: 0.175503 0.172381 0.174262 0.174262
             nanjing 1384.5114      0.62  0.47  0.40      0.62  0.48  0.40      0.61  0.46  0.40
forget mean min: 0.964695 0.703775
delta_x = 4.05526 delta_h = 1.06869
U_c = [[-0.04415591]] U_f = [[ 0.]] b_c = [-0.08129719] b_f = [ 0.86533934]
incx.max(), incx.min(), incx.mean() 9.11913 -0.0812972 3.71097
fgtx.max(), fgtx.min(), fgtx.mean() 7.8883 0.0 3.25139
delta mean, abs_mean, abs_mean+, abs_mean-: 1.08319 4.05526 3.41582 5.99582
W_c max, min, mean, abs_mean: 0.20452 0.199583 0.203248 0.203248
W_f max, min, mean, abs_mean: 0.175503 0.172381 0.174262 0.174262
Epoch 12/300
0s - loss: 479.9521 - val_loss: 1400.2215
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 472.1205 - val_loss: 1429.4641
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 464.8323 - val_loss: 1442.6933
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 459.3692 - val_loss: 1471.2213
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 452.3115 - val_loss: 1498.4492
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 447.7517 - val_loss: 1480.5153
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 441.3795 - val_loss: 1510.4969
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 437.9341 - val_loss: 1613.0697
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 431.1306 - val_loss: 1511.3687
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 426.8360 - val_loss: 1564.4365
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 421.8916 - val_loss: 1550.3560
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 417.9515 - val_loss: 1671.1910
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 414.3199 - val_loss: 1562.8178
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 410.8988 - val_loss: 1583.9480
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 407.2973 - val_loss: 1623.9145
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 403.6825 - val_loss: 1724.0662
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 400.5513 - val_loss: 1655.4795
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 397.0299 - val_loss: 1750.3058
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 392.5403 - val_loss: 1683.7668
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 389.9739 - val_loss: 1695.2379
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 388.1657 - val_loss: 1757.8857
Epoch 00031: val_loss did not improve
X_train[0].shape = (5274, 40, 23)

training shanghai
Train on 5274 samples, validate on 1044 samples
Before training:
            shanghai 2474.6284      0.01  -nan  0.01      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 2.77301 delta_h = 1.82566
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -2.77301 2.77301 nan 2.77301
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
            shanghai 4685.9556      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 3.79465 delta_h = 2.37907
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.79465 3.79465 nan 3.79465
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 1549.7007 - val_loss: 1326.8900
Epoch 00000: val_loss improved from inf to 1326.88996, saving model to shanghai_weights.hdf5
            shanghai  712.1589      0.10  0.28  0.08      0.10  0.26  0.09      0.11  0.22  0.09
forget mean min: 0.936314 0.786497
delta_x = 1.90132 delta_h = 1.45702
U_c = [[-0.11414956]] U_f = [[ 0.]] b_c = [ 0.08364426] b_f = [ 1.0788672]
incx.max(), incx.min(), incx.mean() 6.0443 0.323302 2.13294
fgtx.max(), fgtx.min(), fgtx.mean() 5.59726 0.225071 1.92442
delta mean, abs_mean, abs_mean+, abs_mean-: -0.284001 1.90132 1.84337 1.94661
W_c max, min, mean, abs_mean: 0.115013 0.110711 0.113798 0.113798
W_f max, min, mean, abs_mean: 0.107558 0.10378 0.10687 0.10687
            shanghai 1326.8899      0.10  0.56  0.09      0.11  0.51  0.09      0.10  0.54  0.09
forget mean min: 0.95706 0.840534
delta_x = 2.1874 delta_h = 1.32887
U_c = [[-0.11414956]] U_f = [[ 0.]] b_c = [ 0.08364426] b_f = [ 1.0788672]
incx.max(), incx.min(), incx.mean() 5.74347 0.704826 2.58624
fgtx.max(), fgtx.min(), fgtx.mean() 5.31476 0.583339 2.35009
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0935985 2.1874 1.93214 2.55515
W_c max, min, mean, abs_mean: 0.115013 0.110711 0.113798 0.113798
W_f max, min, mean, abs_mean: 0.107558 0.10378 0.10687 0.10687
Epoch 2/300
0s - loss: 625.4041 - val_loss: 1310.1548
Epoch 00001: val_loss improved from 1326.88996 to 1310.15483, saving model to shanghai_weights.hdf5
            shanghai  561.0037      0.35  0.31  0.30      0.41  0.24  0.36      0.43  0.15  0.39
forget mean min: 0.91589 0.770799
delta_x = 2.88829 delta_h = 1.54022
U_c = [[-0.09287939]] U_f = [[ 0.]] b_c = [ 0.11488756] b_f = [ 1.05205894]
incx.max(), incx.min(), incx.mean() 9.52545 0.422 3.27805
fgtx.max(), fgtx.min(), fgtx.mean() 4.92634 0.16077 1.6559
delta mean, abs_mean, abs_mean+, abs_mean-: 0.033466 2.88829 2.99752 2.78445
W_c max, min, mean, abs_mean: 0.163386 0.159119 0.162152 0.162152
W_f max, min, mean, abs_mean: 0.0855964 0.0817821 0.0848859 0.0848859
            shanghai 1310.1548      0.26  0.53  0.20      0.23  0.55  0.18      0.13  0.74  0.10
forget mean min: 0.941292 0.781403
delta_x = 3.03037 delta_h = 1.42747
U_c = [[-0.09287939]] U_f = [[ 0.]] b_c = [ 0.11488756] b_f = [ 1.05205894]
incx.max(), incx.min(), incx.mean() 8.4691 0.538592 3.916
fgtx.max(), fgtx.min(), fgtx.mean() 4.37334 0.221804 1.98985
delta mean, abs_mean, abs_mean+, abs_mean-: 0.368406 3.03037 2.80079 3.38459
W_c max, min, mean, abs_mean: 0.163386 0.159119 0.162152 0.162152
W_f max, min, mean, abs_mean: 0.0855964 0.0817821 0.0848859 0.0848859
Epoch 3/300
0s - loss: 520.8910 - val_loss: 1452.2770
Epoch 00002: val_loss did not improve
Epoch 4/300
0s - loss: 464.4424 - val_loss: 1486.0391
Epoch 00003: val_loss did not improve
Epoch 5/300
0s - loss: 434.0974 - val_loss: 1477.9302
Epoch 00004: val_loss did not improve
Epoch 6/300
0s - loss: 418.5252 - val_loss: 1461.4184
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 410.0472 - val_loss: 1473.0486
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 404.7430 - val_loss: 1469.5472
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 399.7688 - val_loss: 1417.3246
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 395.5297 - val_loss: 1403.7658
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 393.2306 - val_loss: 1346.7722
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 389.6758 - val_loss: 1375.6240
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 387.0931 - val_loss: 1337.7051
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 383.3206 - val_loss: 1334.6832
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 380.0711 - val_loss: 1341.7278
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 377.5022 - val_loss: 1268.3202
Epoch 00015: val_loss improved from 1310.15483 to 1268.32024, saving model to shanghai_weights.hdf5
            shanghai  371.5090      0.60  0.29  0.48      0.67  0.25  0.55      0.70  0.23  0.59
forget mean min: 0.87363 0.692546
delta_x = 4.53082 delta_h = 0.593728
U_c = [[-0.03238957]] U_f = [[ 0.]] b_c = [ 0.08416191] b_f = [ 0.81204915]
incx.max(), incx.min(), incx.mean() 18.9177 0.0841619 6.03482
fgtx.max(), fgtx.min(), fgtx.mean() 4.0839 0.0 1.29023
delta mean, abs_mean, abs_mean+, abs_mean-: 0.171089 4.53082 4.85082 4.22989
W_c max, min, mean, abs_mean: 0.31606 0.310841 0.313783 0.313783
W_f max, min, mean, abs_mean: 0.069376 0.0630887 0.0680369 0.0680369
            shanghai 1268.3202      0.30  0.40  0.25      0.33  0.31  0.29      0.34  0.25  0.30
forget mean min: 0.893577 0.711488
delta_x = 4.63228 delta_h = 0.533764
U_c = [[-0.03238957]] U_f = [[ 0.]] b_c = [ 0.08416191] b_f = [ 0.81204915]
incx.max(), incx.min(), incx.mean() 17.1456 0.501988 6.79912
fgtx.max(), fgtx.min(), fgtx.mean() 3.69898 0.0905741 1.45598
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0252045 4.63228 4.72515 4.54203
W_c max, min, mean, abs_mean: 0.31606 0.310841 0.313783 0.313783
W_f max, min, mean, abs_mean: 0.069376 0.0630887 0.0680369 0.0680369
Epoch 17/300
0s - loss: 372.9043 - val_loss: 1319.2160
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 369.3861 - val_loss: 1298.8183
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 364.5610 - val_loss: 1315.0102
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 361.5164 - val_loss: 1279.6871
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 357.9035 - val_loss: 1269.5144
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 353.9977 - val_loss: 1246.7373
Epoch 00021: val_loss improved from 1268.32024 to 1246.73734, saving model to shanghai_weights.hdf5
            shanghai  344.8808      0.58  0.24  0.49      0.65  0.20  0.56      0.65  0.19  0.57
forget mean min: 0.86846 0.673369
delta_x = 4.52154 delta_h = 0.39266
U_c = [[-0.02107956]] U_f = [[ 0.]] b_c = [ 0.05619698] b_f = [ 0.72346026]
incx.max(), incx.min(), incx.mean() 18.7774 0.056197 5.91539
fgtx.max(), fgtx.min(), fgtx.mean() 4.28836 0.0 1.34193
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0354579 4.52154 4.63133 4.41522
W_c max, min, mean, abs_mean: 0.349031 0.342836 0.346035 0.346035
W_f max, min, mean, abs_mean: 0.0812795 0.0727566 0.0792575 0.0792575
            shanghai 1246.7373      0.30  0.39  0.25      0.32  0.29  0.28      0.34  0.23  0.30
forget mean min: 0.891727 0.686396
delta_x = 4.82483 delta_h = 0.355784
U_c = [[-0.02107956]] U_f = [[ 0.]] b_c = [ 0.05619698] b_f = [ 0.72346026]
incx.max(), incx.min(), incx.mean() 18.4147 0.317761 6.80032
fgtx.max(), fgtx.min(), fgtx.mean() 4.20412 0.0598622 1.54465
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0497316 4.82483 4.8841 4.76815
W_c max, min, mean, abs_mean: 0.349031 0.342836 0.346035 0.346035
W_f max, min, mean, abs_mean: 0.0812795 0.0727566 0.0792575 0.0792575
Epoch 23/300
0s - loss: 350.3758 - val_loss: 1276.8764
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 347.3440 - val_loss: 1228.4756
Epoch 00023: val_loss improved from 1246.73734 to 1228.47561, saving model to shanghai_weights.hdf5
            shanghai  340.4136      0.64  0.28  0.51      0.71  0.24  0.58      0.75  0.24  0.61
forget mean min: 0.874537 0.667087
delta_x = 4.72649 delta_h = 0.339706
U_c = [[-0.01774806]] U_f = [[ 0.]] b_c = [ 0.04979882] b_f = [ 0.69504064]
incx.max(), incx.min(), incx.mean() 19.0143 0.0497988 6.04355
fgtx.max(), fgtx.min(), fgtx.mean() 4.58419 0.0 1.4486
delta mean, abs_mean, abs_mean+, abs_mean-: 0.150428 4.72649 4.78048 4.67029
W_c max, min, mean, abs_mean: 0.36192 0.35542 0.358679 0.358679
W_f max, min, mean, abs_mean: 0.0889658 0.0795525 0.0866944 0.0866944
            shanghai 1228.4756      0.32  0.45  0.25      0.34  0.37  0.28      0.36  0.32  0.30
forget mean min: 0.896883 0.705431
delta_x = 4.97453 delta_h = 0.311964
U_c = [[-0.01774806]] U_f = [[ 0.]] b_c = [ 0.04979882] b_f = [ 0.69504064]
incx.max(), incx.min(), incx.mean() 19.3647 0.787605 6.87506
fgtx.max(), fgtx.min(), fgtx.mean() 4.66758 0.178257 1.64961
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0872901 4.97453 5.01427 4.93402
W_c max, min, mean, abs_mean: 0.36192 0.35542 0.358679 0.358679
W_f max, min, mean, abs_mean: 0.0889658 0.0795525 0.0866944 0.0866944
Epoch 25/300
0s - loss: 344.5495 - val_loss: 1262.9587
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 340.7951 - val_loss: 1296.7985
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 338.3813 - val_loss: 1300.9406
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 334.0975 - val_loss: 1318.1732
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 332.6462 - val_loss: 1294.6253
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 329.0126 - val_loss: 1350.2551
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 327.2067 - val_loss: 1353.9916
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 324.6539 - val_loss: 1323.7829
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 321.7981 - val_loss: 1336.6321
Epoch 00032: val_loss did not improve
Epoch 34/300
0s - loss: 320.3477 - val_loss: 1361.8719
Epoch 00033: val_loss did not improve
Epoch 35/300
0s - loss: 317.4526 - val_loss: 1349.9022
Epoch 00034: val_loss did not improve
Epoch 36/300
0s - loss: 316.6603 - val_loss: 1387.5447
Epoch 00035: val_loss did not improve
Epoch 37/300
0s - loss: 314.0910 - val_loss: 1388.1104
Epoch 00036: val_loss did not improve
Epoch 38/300
0s - loss: 311.9795 - val_loss: 1416.1354
Epoch 00037: val_loss did not improve
Epoch 39/300
0s - loss: 311.6343 - val_loss: 1368.8884
Epoch 00038: val_loss did not improve
Epoch 40/300
0s - loss: 309.9355 - val_loss: 1419.4736
Epoch 00039: val_loss did not improve
Epoch 41/300
0s - loss: 308.0775 - val_loss: 1398.1693
Epoch 00040: val_loss did not improve
Epoch 42/300
0s - loss: 307.4317 - val_loss: 1496.6662
Epoch 00041: val_loss did not improve
Epoch 43/300
0s - loss: 305.7422 - val_loss: 1491.5137
Epoch 00042: val_loss did not improve
Epoch 44/300
0s - loss: 303.8978 - val_loss: 1502.4692
Epoch 00043: val_loss did not improve
Epoch 45/300
0s - loss: 302.9911 - val_loss: 1425.0829
Epoch 00044: val_loss did not improve
X_train[0].shape = (6446, 40, 23)

training hangzhou
Train on 6446 samples, validate on 1276 samples
Before training:
            hangzhou 2405.1851      0.01  -nan  0.01      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 2.99824 delta_h = 1.9571
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -2.99824 2.99824 nan 2.99824
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
            hangzhou 5013.8891      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 3.2437 delta_h = 2.02747
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.2437 3.2437 nan 3.2437
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 1234.6819 - val_loss: 1684.1518
Epoch 00000: val_loss improved from inf to 1684.15179, saving model to hangzhou_weights.hdf5
            hangzhou  481.0551      0.35  0.26  0.31      0.44  0.20  0.39      0.50  0.13  0.45
forget mean min: 0.936133 0.790579
delta_x = 2.36623 delta_h = 1.72511
U_c = [[-0.12497716]] U_f = [[ 0.]] b_c = [ 0.08992736] b_f = [ 1.0893321]
incx.max(), incx.min(), incx.mean() 7.71248 0.342619 2.29577
fgtx.max(), fgtx.min(), fgtx.mean() 7.21143 0.239087 2.08691
delta mean, abs_mean, abs_mean+, abs_mean-: -0.248509 2.36623 2.48708 2.27663
W_c max, min, mean, abs_mean: 0.118323 0.114266 0.117002 0.117002
W_f max, min, mean, abs_mean: 0.111465 0.108537 0.110699 0.110699
            hangzhou 1684.1518      0.11  0.49  0.10      0.12  0.44  0.10      0.12  0.43  0.10
forget mean min: 0.945606 0.790579
delta_x = 2.39818 delta_h = 1.50627
U_c = [[-0.12497716]] U_f = [[ 0.]] b_c = [ 0.08992736] b_f = [ 1.0893321]
incx.max(), incx.min(), incx.mean() 7.11131 0.342619 2.5025
fgtx.max(), fgtx.min(), fgtx.mean() 6.64268 0.239087 2.28248
delta mean, abs_mean, abs_mean+, abs_mean-: 0.129267 2.39818 2.5331 2.26386
W_c max, min, mean, abs_mean: 0.118323 0.114266 0.117002 0.117002
W_f max, min, mean, abs_mean: 0.111465 0.108537 0.110699 0.110699
Epoch 2/300
1s - loss: 428.2431 - val_loss: 1573.7192
Epoch 00001: val_loss improved from 1684.15179 to 1573.71920, saving model to hangzhou_weights.hdf5
            hangzhou  400.9347      0.43  0.31  0.36      0.54  0.26  0.45      0.62  0.20  0.53
forget mean min: 0.939888 0.795259
delta_x = 2.60663 delta_h = 1.6701
U_c = [[-0.1190492]] U_f = [[ 0.]] b_c = [ 0.10613044] b_f = [ 1.09668541]
incx.max(), incx.min(), incx.mean() 8.60248 0.459409 2.94388
fgtx.max(), fgtx.min(), fgtx.mean() 6.25817 0.260237 2.09026
delta mean, abs_mean, abs_mean+, abs_mean-: 0.299499 2.60663 2.60007 2.61493
W_c max, min, mean, abs_mean: 0.149518 0.145451 0.148177 0.148177
W_f max, min, mean, abs_mean: 0.110329 0.107231 0.10915 0.10915
            hangzhou 1573.7192      0.15  0.61  0.12      0.16  0.60  0.13      0.15  0.58  0.12
forget mean min: 0.948824 0.795259
delta_x = 2.71408 delta_h = 1.60764
U_c = [[-0.1190492]] U_f = [[ 0.]] b_c = [ 0.10613044] b_f = [ 1.09668541]
incx.max(), incx.min(), incx.mean() 8.41306 0.459409 3.1927
fgtx.max(), fgtx.min(), fgtx.mean() 6.11865 0.260237 2.27353
delta mean, abs_mean, abs_mean+, abs_mean-: 0.627083 2.71408 2.80815 2.57594
W_c max, min, mean, abs_mean: 0.149518 0.145451 0.148177 0.148177
W_f max, min, mean, abs_mean: 0.110329 0.107231 0.10915 0.10915
Epoch 3/300
1s - loss: 386.5642 - val_loss: 1623.3391
Epoch 00002: val_loss did not improve
Epoch 4/300
1s - loss: 368.4318 - val_loss: 1636.7324
Epoch 00003: val_loss did not improve
Epoch 5/300
1s - loss: 358.2971 - val_loss: 1641.8366
Epoch 00004: val_loss did not improve
Epoch 6/300
1s - loss: 349.5979 - val_loss: 1679.9998
Epoch 00005: val_loss did not improve
Epoch 7/300
1s - loss: 341.5667 - val_loss: 1713.1161
Epoch 00006: val_loss did not improve
Epoch 8/300
1s - loss: 334.3182 - val_loss: 1779.9109
Epoch 00007: val_loss did not improve
Epoch 9/300
1s - loss: 328.5073 - val_loss: 1739.0158
Epoch 00008: val_loss did not improve
Epoch 10/300
1s - loss: 322.0228 - val_loss: 1759.8813
Epoch 00009: val_loss did not improve
Epoch 11/300
1s - loss: 315.9207 - val_loss: 1749.1103
Epoch 00010: val_loss did not improve
Epoch 12/300
1s - loss: 309.9832 - val_loss: 1813.6952
Epoch 00011: val_loss did not improve
Epoch 13/300
1s - loss: 302.4425 - val_loss: 1838.3546
Epoch 00012: val_loss did not improve
Epoch 14/300
1s - loss: 297.0934 - val_loss: 1847.3755
Epoch 00013: val_loss did not improve
Epoch 15/300
1s - loss: 291.8355 - val_loss: 1833.3357
Epoch 00014: val_loss did not improve
Epoch 16/300
1s - loss: 286.9039 - val_loss: 1734.6082
Epoch 00015: val_loss did not improve
Epoch 17/300
1s - loss: 282.9405 - val_loss: 1848.4522
Epoch 00016: val_loss did not improve
Epoch 18/300
1s - loss: 278.2297 - val_loss: 1800.6004
Epoch 00017: val_loss did not improve
Epoch 19/300
1s - loss: 272.9476 - val_loss: 1841.9523
Epoch 00018: val_loss did not improve
Epoch 20/300
1s - loss: 267.6680 - val_loss: 1902.5178
Epoch 00019: val_loss did not improve
Epoch 21/300
1s - loss: 264.3501 - val_loss: 1859.0574
Epoch 00020: val_loss did not improve
Epoch 22/300
1s - loss: 261.1406 - val_loss: 1886.5431
Epoch 00021: val_loss did not improve
Epoch 23/300
1s - loss: 258.1931 - val_loss: 1958.5100
Epoch 00022: val_loss did not improve
X_train[0].shape = (5274, 40, 23)

training hefei
Train on 5274 samples, validate on 1044 samples
Before training:
               hefei 3822.5815      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.47536 delta_h = 2.25482
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.47536 3.47536 nan 3.47536
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
               hefei11948.5713      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 4.47624 delta_h = 2.79374
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -4.47624 4.47624 nan 4.47624
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 2314.2535 - val_loss: 5955.5718
Epoch 00000: val_loss improved from inf to 5955.57176, saving model to hefei_weights.hdf5
               hefei  947.6383      0.28  0.41  0.23      0.32  0.39  0.26      0.34  0.34  0.28
forget mean min: 0.943666 0.786463
delta_x = 2.28496 delta_h = 1.75718
U_c = [[-0.1200712]] U_f = [[ 0.]] b_c = [ 0.08589344] b_f = [ 1.08287418]
incx.max(), incx.min(), incx.mean() 6.49699 0.31837 2.33336
fgtx.max(), fgtx.min(), fgtx.mean() 6.09032 0.22086 2.13504
delta mean, abs_mean, abs_mean+, abs_mean-: -0.336028 2.28496 2.12759 2.41796
W_c max, min, mean, abs_mean: 0.116053 0.112214 0.115387 0.115387
W_f max, min, mean, abs_mean: 0.109991 0.107774 0.109619 0.109619
               hefei 5955.5717      0.19  0.44  0.16      0.20  0.38  0.17      0.19  0.31  0.17
forget mean min: 0.948607 0.786996
delta_x = 2.2293 delta_h = 1.63641
U_c = [[-0.1200712]] U_f = [[ 0.]] b_c = [ 0.08589344] b_f = [ 1.08287418]
incx.max(), incx.min(), incx.mean() 5.47051 0.321715 2.30073
fgtx.max(), fgtx.min(), fgtx.mean() 5.1152 0.224037 2.10404
delta mean, abs_mean, abs_mean+, abs_mean-: -0.888131 2.2293 1.57998 2.7081
W_c max, min, mean, abs_mean: 0.116053 0.112214 0.115387 0.115387
W_f max, min, mean, abs_mean: 0.109991 0.107774 0.109619 0.109619
Epoch 2/300
0s - loss: 846.7506 - val_loss: 5147.3535
Epoch 00001: val_loss improved from 5955.57176 to 5147.35352, saving model to hefei_weights.hdf5
               hefei  800.4009      0.43  0.40  0.34      0.50  0.37  0.39      0.52  0.31  0.42
forget mean min: 0.948023 0.79544
delta_x = 3.0638 delta_h = 2.42113
U_c = [[-0.1580704]] U_f = [[ 0.]] b_c = [ 0.10362007] b_f = [ 1.07282376]
incx.max(), incx.min(), incx.mean() 9.85127 0.517087 3.45757
fgtx.max(), fgtx.min(), fgtx.mean() 6.72372 0.28521 2.3135
delta mean, abs_mean, abs_mean+, abs_mean-: 0.700361 3.0638 3.21628 2.8487
W_c max, min, mean, abs_mean: 0.151327 0.14727 0.150589 0.150589
W_f max, min, mean, abs_mean: 0.104398 0.102153 0.103877 0.103877
               hefei 5147.3535      0.40  0.50  0.29      0.40  0.47  0.30      0.40  0.42  0.31
forget mean min: 0.964382 0.814894
delta_x = 2.8616 delta_h = 2.35512
U_c = [[-0.1580704]] U_f = [[ 0.]] b_c = [ 0.10362007] b_f = [ 1.07282376]
incx.max(), incx.min(), incx.mean() 8.36593 0.696982 3.86693
fgtx.max(), fgtx.min(), fgtx.mean() 5.69919 0.409304 2.59588
delta mean, abs_mean, abs_mean+, abs_mean-: 1.21235 2.8616 3.02871 2.51838
W_c max, min, mean, abs_mean: 0.151327 0.14727 0.150589 0.150589
W_f max, min, mean, abs_mean: 0.104398 0.102153 0.103877 0.103877
Epoch 3/300
0s - loss: 779.2050 - val_loss: 5047.4372
Epoch 00002: val_loss improved from 5147.35352 to 5047.43720, saving model to hefei_weights.hdf5
               hefei  759.2887      0.49  0.41  0.37      0.56  0.39  0.41      0.58  0.34  0.45
forget mean min: 0.935814 0.761931
delta_x = 3.9473 delta_h = 3.00338
U_c = [[-0.18126601]] U_f = [[ 0.]] b_c = [ 0.1098949] b_f = [ 1.0321275]
incx.max(), incx.min(), incx.mean() 12.8005 0.402365 4.6775
fgtx.max(), fgtx.min(), fgtx.mean() 5.69121 0.131166 2.04841
delta mean, abs_mean, abs_mean+, abs_mean-: 1.13307 3.9473 4.1642 3.60804
W_c max, min, mean, abs_mean: 0.187892 0.183468 0.186973 0.186973
W_f max, min, mean, abs_mean: 0.0848266 0.0823466 0.0838533 0.0838533
               hefei 5047.4372      0.47  0.51  0.32      0.48  0.48  0.33      0.47  0.45  0.34
forget mean min: 0.957274 0.805728
delta_x = 3.83548 delta_h = 3.05271
U_c = [[-0.18126601]] U_f = [[ 0.]] b_c = [ 0.1098949] b_f = [ 1.0321275]
incx.max(), incx.min(), incx.mean() 12.0987 0.9803 5.43458
fgtx.max(), fgtx.min(), fgtx.mean() 5.37656 0.390363 2.38795
delta mean, abs_mean, abs_mean+, abs_mean-: 2.08292 3.83548 4.18023 2.99996
W_c max, min, mean, abs_mean: 0.187892 0.183468 0.186973 0.186973
W_f max, min, mean, abs_mean: 0.0848266 0.0823466 0.0838533 0.0838533
Epoch 4/300
0s - loss: 746.8206 - val_loss: 5271.3722
Epoch 00003: val_loss did not improve
Epoch 5/300
0s - loss: 721.0147 - val_loss: 5244.9891
Epoch 00004: val_loss did not improve
Epoch 6/300
0s - loss: 702.4783 - val_loss: 5320.7431
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 686.7115 - val_loss: 5429.8771
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 674.9567 - val_loss: 5389.9024
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 661.9272 - val_loss: 5337.0807
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 648.8342 - val_loss: 5455.6100
Epoch 00009: val_loss did not improve
Epoch 11/300
1s - loss: 638.1627 - val_loss: 5433.5370
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 626.7591 - val_loss: 5327.6204
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 616.5663 - val_loss: 5382.2058
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 606.1157 - val_loss: 5438.8983
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 594.8909 - val_loss: 5316.0533
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 582.9311 - val_loss: 5352.4674
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 572.5479 - val_loss: 5344.3475
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 562.9218 - val_loss: 5205.6853
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 553.0846 - val_loss: 5202.6572
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 543.2258 - val_loss: 5070.4943
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 533.3655 - val_loss: 5048.7966
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 524.9257 - val_loss: 5042.6098
Epoch 00021: val_loss improved from 5047.43720 to 5042.60977, saving model to hefei_weights.hdf5
               hefei  505.1953      0.62  0.30  0.49      0.71  0.25  0.58      0.75  0.20  0.64
forget mean min: 0.894284 0.629985
delta_x = 7.10503 delta_h = 2.32763
U_c = [[-0.12186992]] U_f = [[ 0.]] b_c = [-0.20946851] b_f = [ 0.53215402]
incx.max(), incx.min(), incx.mean() 32.7 -0.209469 7.17863
fgtx.max(), fgtx.min(), fgtx.mean() 9.05917 0.0 2.05915
delta mean, abs_mean, abs_mean+, abs_mean-: 0.910087 7.10503 7.08895 7.12595
W_c max, min, mean, abs_mean: 0.510094 0.46466 0.485971 0.485971
W_f max, min, mean, abs_mean: 0.157377 0.10722 0.135178 0.135178
               hefei 5042.6098      0.59  0.44  0.40      0.59  0.43  0.41      0.59  0.38  0.43
forget mean min: 0.922757 0.643705
delta_x = 5.88529 delta_h = 2.52957
U_c = [[-0.12186992]] U_f = [[ 0.]] b_c = [-0.20946851] b_f = [ 0.53215402]
incx.max(), incx.min(), incx.mean() 25.3187 -0.0117597 7.85551
fgtx.max(), fgtx.min(), fgtx.mean() 7.03873 0.059326 2.24729
delta mean, abs_mean, abs_mean+, abs_mean-: 1.53911 5.88529 6.15996 5.46874
W_c max, min, mean, abs_mean: 0.510094 0.46466 0.485971 0.485971
W_f max, min, mean, abs_mean: 0.157377 0.10722 0.135178 0.135178
Epoch 23/300
0s - loss: 515.3253 - val_loss: 4949.5774
Epoch 00022: val_loss improved from 5042.60977 to 4949.57744, saving model to hefei_weights.hdf5
               hefei  494.5149      0.63  0.29  0.50      0.71  0.24  0.58      0.75  0.18  0.64
forget mean min: 0.895299 0.625346
delta_x = 7.2341 delta_h = 2.25988
U_c = [[-0.11958214]] U_f = [[ 0.]] b_c = [-0.22113638] b_f = [ 0.51230377]
incx.max(), incx.min(), incx.mean() 33.4241 -0.221136 7.06144
fgtx.max(), fgtx.min(), fgtx.mean() 9.74161 0.0 2.13526
delta mean, abs_mean, abs_mean+, abs_mean-: 0.865056 7.2341 7.1634 7.32606
W_c max, min, mean, abs_mean: 0.522189 0.473397 0.496168 0.496168
W_f max, min, mean, abs_mean: 0.168502 0.115675 0.145164 0.145164
               hefei 4949.5774      0.59  0.43  0.40      0.59  0.41  0.41      0.58  0.37  0.43
forget mean min: 0.924098 0.633371
delta_x = 6.02931 delta_h = 2.43345
U_c = [[-0.11958214]] U_f = [[ 0.]] b_c = [-0.22113638] b_f = [ 0.51230377]
incx.max(), incx.min(), incx.mean() 25.2924 -0.116659 7.69967
fgtx.max(), fgtx.min(), fgtx.mean() 7.3983 0.0344021 2.32163
delta mean, abs_mean, abs_mean+, abs_mean-: 1.49835 6.02931 6.3818 5.52253
W_c max, min, mean, abs_mean: 0.522189 0.473397 0.496168 0.496168
W_f max, min, mean, abs_mean: 0.168502 0.115675 0.145164 0.145164
Epoch 24/300
0s - loss: 507.0681 - val_loss: 4978.7043
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 501.1780 - val_loss: 4951.3893
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 491.8260 - val_loss: 4650.6398
Epoch 00025: val_loss improved from 4949.57744 to 4650.63981, saving model to hefei_weights.hdf5
               hefei  471.4936      0.62  0.25  0.51      0.70  0.19  0.60      0.74  0.14  0.66
forget mean min: 0.902023 0.612739
delta_x = 7.16075 delta_h = 2.09826
U_c = [[-0.11925756]] U_f = [[ 0.]] b_c = [-0.25367188] b_f = [ 0.45883912]
incx.max(), incx.min(), incx.mean() 36.0641 -0.253672 6.63773
fgtx.max(), fgtx.min(), fgtx.mean() 12.3372 0.0 2.37029
delta mean, abs_mean, abs_mean+, abs_mean-: 0.810856 7.16075 6.8683 7.56513
W_c max, min, mean, abs_mean: 0.552358 0.493088 0.520358 0.520358
W_f max, min, mean, abs_mean: 0.203656 0.146187 0.178408 0.178408
               hefei 4650.6398      0.60  0.42  0.42      0.62  0.38  0.44      0.61  0.34  0.46
forget mean min: 0.93108 0.641474
delta_x = 6.16122 delta_h = 2.36691
U_c = [[-0.11925756]] U_f = [[ 0.]] b_c = [-0.25367188] b_f = [ 0.45883912]
incx.max(), incx.min(), incx.mean() 24.9766 0.084301 7.25447
fgtx.max(), fgtx.min(), fgtx.mean() 8.57964 0.122928 2.58082
delta mean, abs_mean, abs_mean+, abs_mean-: 1.59174 6.16122 6.59504 5.54263
W_c max, min, mean, abs_mean: 0.552358 0.493088 0.520358 0.520358
W_f max, min, mean, abs_mean: 0.203656 0.146187 0.178408 0.178408
Epoch 27/300
0s - loss: 482.1750 - val_loss: 4831.0358
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 471.6642 - val_loss: 4741.7123
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 465.1254 - val_loss: 4749.8033
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 458.7766 - val_loss: 4639.9670
Epoch 00029: val_loss improved from 4650.63981 to 4639.96699, saving model to hefei_weights.hdf5
               hefei  432.3702      0.63  0.25  0.52      0.72  0.19  0.61      0.76  0.14  0.67
forget mean min: 0.902824 0.593851
delta_x = 7.44047 delta_h = 1.94871
U_c = [[-0.1036491]] U_f = [[ 0.]] b_c = [-0.28621924] b_f = [ 0.379908]
incx.max(), incx.min(), incx.mean() 36.946 -0.286219 6.28074
fgtx.max(), fgtx.min(), fgtx.mean() 14.8178 0.0 2.64312
delta mean, abs_mean, abs_mean+, abs_mean-: 0.660972 7.44047 6.9727 8.08892
W_c max, min, mean, abs_mean: 0.606224 0.530305 0.564533 0.564533
W_f max, min, mean, abs_mean: 0.251348 0.194205 0.226321 0.226321
               hefei 4639.9670      0.63  0.41  0.43      0.65  0.37  0.47      0.65  0.33  0.49
forget mean min: 0.934983 0.60947
delta_x = 6.46333 delta_h = 2.22604
U_c = [[-0.1036491]] U_f = [[ 0.]] b_c = [-0.28621924] b_f = [ 0.379908]
incx.max(), incx.min(), incx.mean() 25.6394 -0.139757 6.88313
fgtx.max(), fgtx.min(), fgtx.mean() 10.3301 0.0651777 2.88409
delta mean, abs_mean, abs_mean+, abs_mean-: 1.54514 6.46333 6.67372 6.14775
W_c max, min, mean, abs_mean: 0.606224 0.530305 0.564533 0.564533
W_f max, min, mean, abs_mean: 0.251348 0.194205 0.226321 0.226321
Epoch 31/300
0s - loss: 453.4296 - val_loss: 4547.1015
Epoch 00030: val_loss improved from 4639.96699 to 4547.10151, saving model to hefei_weights.hdf5
               hefei  423.3083      0.63  0.23  0.53      0.72  0.19  0.62      0.76  0.13  0.68
forget mean min: 0.90353 0.58964
delta_x = 7.46192 delta_h = 1.91368
U_c = [[-0.10401042]] U_f = [[ 0.]] b_c = [-0.29073828] b_f = [ 0.36247855]
incx.max(), incx.min(), incx.mean() 36.1986 -0.290738 6.21106
fgtx.max(), fgtx.min(), fgtx.mean() 14.9694 0.0 2.69724
delta mean, abs_mean, abs_mean+, abs_mean-: 0.63233 7.46192 6.98813 8.11391
W_c max, min, mean, abs_mean: 0.616719 0.537448 0.573041 0.573041
W_f max, min, mean, abs_mean: 0.26162 0.204886 0.236748 0.236748
               hefei 4547.1015      0.64  0.42  0.44      0.67  0.37  0.48      0.66  0.33  0.49
forget mean min: 0.937171 0.591792
delta_x = 6.45559 delta_h = 2.254
U_c = [[-0.10401042]] U_f = [[ 0.]] b_c = [-0.29073828] b_f = [ 0.36247855]
incx.max(), incx.min(), incx.mean() 25.644 -0.272092 6.84643
fgtx.max(), fgtx.min(), fgtx.mean() 10.6536 0.00890166 2.9593
delta mean, abs_mean, abs_mean+, abs_mean-: 1.63559 6.45559 6.70491 6.0763
W_c max, min, mean, abs_mean: 0.616719 0.537448 0.573041 0.573041
W_f max, min, mean, abs_mean: 0.26162 0.204886 0.236748 0.236748
Epoch 32/300
0s - loss: 446.5782 - val_loss: 4629.2364
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 440.5243 - val_loss: 4706.0609
Epoch 00032: val_loss did not improve
Epoch 34/300
0s - loss: 434.4818 - val_loss: 4592.5677
Epoch 00033: val_loss did not improve
Epoch 35/300
0s - loss: 429.2235 - val_loss: 4614.4431
Epoch 00034: val_loss did not improve
Epoch 36/300
0s - loss: 423.9347 - val_loss: 4687.3141
Epoch 00035: val_loss did not improve
Epoch 37/300
0s - loss: 421.4933 - val_loss: 4560.0967
Epoch 00036: val_loss did not improve
Epoch 38/300
0s - loss: 415.4532 - val_loss: 4576.1181
Epoch 00037: val_loss did not improve
Epoch 39/300
0s - loss: 413.4594 - val_loss: 4589.8384
Epoch 00038: val_loss did not improve
Epoch 40/300
0s - loss: 409.8859 - val_loss: 4491.7756
Epoch 00039: val_loss improved from 4547.10151 to 4491.77562, saving model to hefei_weights.hdf5
               hefei  383.7419      0.61  0.17  0.54      0.69  0.12  0.63      0.73  0.07  0.69
forget mean min: 0.903493 0.558819
delta_x = 7.70059 delta_h = 1.70273
U_c = [[-0.09333739]] U_f = [[ 0.]] b_c = [-0.32034227] b_f = [ 0.23637149]
incx.max(), incx.min(), incx.mean() 39.3992 -0.320342 5.71541
fgtx.max(), fgtx.min(), fgtx.mean() 20.2889 0.0 3.11804
delta mean, abs_mean, abs_mean+, abs_mean-: 0.332979 7.70059 6.91966 8.7812
W_c max, min, mean, abs_mean: 0.715594 0.596856 0.647635 0.647635
W_f max, min, mean, abs_mean: 0.353764 0.311207 0.332465 0.332465
               hefei 4491.7756      0.63  0.43  0.43      0.66  0.38  0.47      0.66  0.32  0.50
forget mean min: 0.941588 0.559413
delta_x = 6.69383 delta_h = 2.16014
U_c = [[-0.09333739]] U_f = [[ 0.]] b_c = [-0.32034227] b_f = [ 0.23637149]
incx.max(), incx.min(), incx.mean() 27.8461 -0.316221 6.3739
fgtx.max(), fgtx.min(), fgtx.mean() 14.4123 0.00241004 3.45712
delta mean, abs_mean, abs_mean+, abs_mean-: 1.58789 6.69383 6.74161 6.61776
W_c max, min, mean, abs_mean: 0.715594 0.596856 0.647635 0.647635
W_f max, min, mean, abs_mean: 0.353764 0.311207 0.332465 0.332465
Epoch 41/300
0s - loss: 405.6926 - val_loss: 4700.8843
Epoch 00040: val_loss did not improve
Epoch 42/300
0s - loss: 403.8623 - val_loss: 4618.4685
Epoch 00041: val_loss did not improve
Epoch 43/300
0s - loss: 400.7646 - val_loss: 4437.2743
Epoch 00042: val_loss improved from 4491.77562 to 4437.27432, saving model to hefei_weights.hdf5
               hefei  370.0048      0.65  0.20  0.56      0.75  0.16  0.66      0.80  0.11  0.73
forget mean min: 0.909403 0.553052
delta_x = 7.77734 delta_h = 1.67742
U_c = [[-0.08974992]] U_f = [[ 0.]] b_c = [-0.32474336] b_f = [ 0.21301174]
incx.max(), incx.min(), incx.mean() 42.8857 -0.324743 5.76382
fgtx.max(), fgtx.min(), fgtx.mean() 23.3792 0.0 3.33562
delta mean, abs_mean, abs_mean+, abs_mean-: 0.556193 7.77734 6.9669 8.98331
W_c max, min, mean, abs_mean: 0.746872 0.61275 0.669302 0.669302
W_f max, min, mean, abs_mean: 0.383464 0.34937 0.363811 0.363811
               hefei 4437.2743      0.66  0.43  0.44      0.68  0.38  0.48      0.69  0.33  0.52
forget mean min: 0.943422 0.569285
delta_x = 6.87902 delta_h = 2.26192
U_c = [[-0.08974992]] U_f = [[ 0.]] b_c = [-0.32474336] b_f = [ 0.21301174]
incx.max(), incx.min(), incx.mean() 29.6124 -0.216266 6.39306
fgtx.max(), fgtx.min(), fgtx.mean() 16.2297 0.065924 3.67976
delta mean, abs_mean, abs_mean+, abs_mean-: 1.7945 6.87902 6.91682 6.81549
W_c max, min, mean, abs_mean: 0.746872 0.61275 0.669302 0.669302
W_f max, min, mean, abs_mean: 0.383464 0.34937 0.363811 0.363811
Epoch 44/300
0s - loss: 396.9822 - val_loss: 4410.1995
Epoch 00043: val_loss improved from 4437.27432 to 4410.19951, saving model to hefei_weights.hdf5
               hefei  369.1974      0.72  0.24  0.59      0.82  0.21  0.68      0.87  0.15  0.76
forget mean min: 0.914041 0.55204
delta_x = 7.94003 delta_h = 1.80557
U_c = [[-0.09071856]] U_f = [[ 0.]] b_c = [-0.32395911] b_f = [ 0.20891793]
incx.max(), incx.min(), incx.mean() 45.2562 -0.323959 5.9693
fgtx.max(), fgtx.min(), fgtx.mean() 24.9069 0.0 3.48401
delta mean, abs_mean, abs_mean+, abs_mean-: 0.86501 7.94003 7.18895 9.12671
W_c max, min, mean, abs_mean: 0.761715 0.620847 0.679907 0.679907
W_f max, min, mean, abs_mean: 0.392507 0.358235 0.373192 0.373192
               hefei 4410.1995      0.71  0.45  0.45      0.73  0.41  0.49      0.73  0.36  0.52
forget mean min: 0.948317 0.584987
delta_x = 6.9641 delta_h = 2.40789
U_c = [[-0.09071856]] U_f = [[ 0.]] b_c = [-0.32395911] b_f = [ 0.20891793]
incx.max(), incx.min(), incx.mean() 30.6243 -0.102392 6.59846
fgtx.max(), fgtx.min(), fgtx.mean() 16.9472 0.134363 3.83208
delta mean, abs_mean, abs_mean+, abs_mean-: 2.18638 6.9641 7.13157 6.66436
W_c max, min, mean, abs_mean: 0.761715 0.620847 0.679907 0.679907
W_f max, min, mean, abs_mean: 0.392507 0.358235 0.373192 0.373192
Epoch 45/300
0s - loss: 395.0317 - val_loss: 4638.4210
Epoch 00044: val_loss did not improve
Epoch 46/300
0s - loss: 392.2257 - val_loss: 4592.6766
Epoch 00045: val_loss did not improve
Epoch 47/300
0s - loss: 389.6869 - val_loss: 4704.1023
Epoch 00046: val_loss did not improve
Epoch 48/300
0s - loss: 386.3445 - val_loss: 4539.5130
Epoch 00047: val_loss did not improve
Epoch 49/300
0s - loss: 382.0727 - val_loss: 4582.6566
Epoch 00048: val_loss did not improve
Epoch 50/300
0s - loss: 381.7883 - val_loss: 4607.0609
Epoch 00049: val_loss did not improve
Epoch 51/300
0s - loss: 378.4016 - val_loss: 4611.2992
Epoch 00050: val_loss did not improve
Epoch 52/300
0s - loss: 376.2427 - val_loss: 4670.2697
Epoch 00051: val_loss did not improve
Epoch 53/300
0s - loss: 373.3274 - val_loss: 4679.9468
Epoch 00052: val_loss did not improve
Epoch 54/300
0s - loss: 371.6343 - val_loss: 4671.0400
Epoch 00053: val_loss did not improve
Epoch 55/300
0s - loss: 369.8494 - val_loss: 4737.3522
Epoch 00054: val_loss did not improve
Epoch 56/300
0s - loss: 366.7630 - val_loss: 4690.7577
Epoch 00055: val_loss did not improve
Epoch 57/300
0s - loss: 364.4996 - val_loss: 4559.0449
Epoch 00056: val_loss did not improve
Epoch 58/300
0s - loss: 362.4956 - val_loss: 4843.7456
Epoch 00057: val_loss did not improve
Epoch 59/300
0s - loss: 361.6705 - val_loss: 4715.4723
Epoch 00058: val_loss did not improve
Epoch 60/300
0s - loss: 358.5510 - val_loss: 4739.9179
Epoch 00059: val_loss did not improve
Epoch 61/300
0s - loss: 358.9098 - val_loss: 4768.9233
Epoch 00060: val_loss did not improve
Epoch 62/300
0s - loss: 356.5425 - val_loss: 4765.8624
Epoch 00061: val_loss did not improve
Epoch 63/300
0s - loss: 356.2255 - val_loss: 4809.4180
Epoch 00062: val_loss did not improve
Epoch 64/300
0s - loss: 353.0755 - val_loss: 4765.3222
Epoch 00063: val_loss did not improve
Epoch 65/300
0s - loss: 353.0255 - val_loss: 4739.9973
Epoch 00064: val_loss did not improve
X_train[0].shape = (5860, 40, 23)

training wuhan
Train on 5860 samples, validate on 1160 samples
Before training:
               wuhan 3612.3264      0.01  -nan  0.01      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.6862 delta_h = 2.39203
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.6862 3.6862 nan 3.6862
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
               wuhan 9539.7282      0.00  -nan  0.00      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 3.72091 delta_h = 2.35125
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.72091 3.72091 nan 3.72091
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 1951.3387 - val_loss: 5224.4494
Epoch 00000: val_loss improved from inf to 5224.44937, saving model to wuhan_weights.hdf5
               wuhan  747.8553      0.42  0.39  0.33      0.47  0.35  0.37      0.49  0.32  0.39
forget mean min: 0.952467 0.808724
delta_x = 2.48087 delta_h = 1.74887
U_c = [[-0.11756442]] U_f = [[ 0.]] b_c = [ 0.08686253] b_f = [ 1.08406341]
incx.max(), incx.min(), incx.mean() 5.87514 0.462435 2.578
fgtx.max(), fgtx.min(), fgtx.mean() 5.51226 0.357674 2.37235
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0121292 2.48087 2.43143 2.53289
W_c max, min, mean, abs_mean: 0.116827 0.113074 0.116019 0.116019
W_f max, min, mean, abs_mean: 0.11093 0.108538 0.110492 0.110492
               wuhan 5224.4494      0.04  -nan  0.04      0.05  -nan  0.04      0.04  -nan  0.03
forget mean min: 0.942287 0.813872
delta_x = 2.07914 delta_h = 1.4221
U_c = [[-0.11756442]] U_f = [[ 0.]] b_c = [ 0.08686253] b_f = [ 1.08406341]
incx.max(), incx.min(), incx.mean() 4.71525 0.497748 2.13184
fgtx.max(), fgtx.min(), fgtx.mean() 4.40767 0.391304 1.94749
delta mean, abs_mean, abs_mean+, abs_mean-: -0.880727 2.07914 1.78615 2.22705
W_c max, min, mean, abs_mean: 0.116827 0.113074 0.116019 0.116019
W_f max, min, mean, abs_mean: 0.11093 0.108538 0.110492 0.110492
Epoch 2/300
1s - loss: 681.1932 - val_loss: 4699.9592
Epoch 00001: val_loss improved from 5224.44937 to 4699.95923, saving model to wuhan_weights.hdf5
               wuhan  641.3870      0.47  0.40  0.36      0.53  0.34  0.42      0.53  0.32  0.43
forget mean min: 0.955076 0.796092
delta_x = 2.84675 delta_h = 2.1629
U_c = [[-0.13740452]] U_f = [[ 0.]] b_c = [ 0.09718363] b_f = [ 1.08862782]
incx.max(), incx.min(), incx.mean() 6.42914 0.370639 2.74131
fgtx.max(), fgtx.min(), fgtx.mean() 6.33078 0.273419 2.64363
delta mean, abs_mean, abs_mean+, abs_mean-: 0.372761 2.84675 2.61756 3.21283
W_c max, min, mean, abs_mean: 0.125223 0.121448 0.124387 0.124387
W_f max, min, mean, abs_mean: 0.124769 0.122363 0.124369 0.124369
               wuhan 4699.9593      0.06  0.58  0.06      0.07  0.65  0.06      0.05  -nan  0.05
forget mean min: 0.961468 0.828632
delta_x = 1.75624 delta_h = 1.38343
U_c = [[-0.13740452]] U_f = [[ 0.]] b_c = [ 0.09718363] b_f = [ 1.08862782]
incx.max(), incx.min(), incx.mean() 5.5356 0.584599 2.50658
fgtx.max(), fgtx.min(), fgtx.mean() 5.4374 0.487332 2.40896
delta mean, abs_mean, abs_mean+, abs_mean-: 0.218266 1.75624 1.74509 1.77077
W_c max, min, mean, abs_mean: 0.125223 0.121448 0.124387 0.124387
W_f max, min, mean, abs_mean: 0.124769 0.122363 0.124369 0.124369
Epoch 3/300
1s - loss: 627.1719 - val_loss: 4485.6943
Epoch 00002: val_loss improved from 4699.95923 to 4485.69426, saving model to wuhan_weights.hdf5
               wuhan  610.5065      0.47  0.39  0.36      0.52  0.34  0.41      0.53  0.31  0.43
forget mean min: 0.949495 0.782111
delta_x = 3.07588 delta_h = 2.25145
U_c = [[-0.14077288]] U_f = [[ 0.]] b_c = [ 0.10333017] b_f = [ 1.05903757]
incx.max(), incx.min(), incx.mean() 7.78795 0.372686 3.1322
fgtx.max(), fgtx.min(), fgtx.mean() 6.2471 0.218976 2.46228
delta mean, abs_mean, abs_mean+, abs_mean-: 0.413122 3.07588 2.92732 3.29499
W_c max, min, mean, abs_mean: 0.14838 0.144421 0.14744 0.14744
W_f max, min, mean, abs_mean: 0.120368 0.117712 0.119862 0.119862
               wuhan 4485.6942      0.07  0.59  0.06      0.07  0.52  0.06      0.06  -nan  0.05
forget mean min: 0.958477 0.817508
delta_x = 1.91929 delta_h = 1.37962
U_c = [[-0.14077288]] U_f = [[ 0.]] b_c = [ 0.10333017] b_f = [ 1.05903757]
incx.max(), incx.min(), incx.mean() 6.8156 0.6452 2.9439
fgtx.max(), fgtx.min(), fgtx.mean() 5.45664 0.440518 2.3092
delta mean, abs_mean, abs_mean+, abs_mean-: 0.393844 1.91929 2.02013 1.78424
W_c max, min, mean, abs_mean: 0.14838 0.144421 0.14744 0.14744
W_f max, min, mean, abs_mean: 0.120368 0.117712 0.119862 0.119862
Epoch 4/300
1s - loss: 597.6587 - val_loss: 4301.5029
Epoch 00003: val_loss improved from 4485.69426 to 4301.50291, saving model to wuhan_weights.hdf5
               wuhan  581.5563      0.47  0.36  0.37      0.52  0.31  0.42      0.52  0.29  0.43
forget mean min: 0.941443 0.760666
delta_x = 3.42264 delta_h = 2.23488
U_c = [[-0.14082363]] U_f = [[ 0.]] b_c = [ 0.10959314] b_f = [ 1.0154326]
incx.max(), incx.min(), incx.mean() 9.43451 0.335395 3.70129
fgtx.max(), fgtx.min(), fgtx.mean() 5.81866 0.140899 2.24118
delta mean, abs_mean, abs_mean+, abs_mean-: 0.424808 3.42264 3.30895 3.58052
W_c max, min, mean, abs_mean: 0.179463 0.175316 0.178413 0.178413
W_f max, min, mean, abs_mean: 0.111997 0.109072 0.111329 0.111329
               wuhan 4301.5028      0.09  0.62  0.07      0.08  0.71  0.07      0.06  0.87  0.05
forget mean min: 0.950065 0.798367
delta_x = 2.32732 delta_h = 1.40251
U_c = [[-0.14082363]] U_f = [[ 0.]] b_c = [ 0.10959314] b_f = [ 1.0154326]
incx.max(), incx.min(), incx.mean() 8.73026 0.687621 3.54344
fgtx.max(), fgtx.min(), fgtx.mean() 5.37922 0.360685 2.14268
delta mean, abs_mean, abs_mean+, abs_mean-: 0.43777 2.32732 2.33996 2.30906
W_c max, min, mean, abs_mean: 0.179463 0.175316 0.178413 0.178413
W_f max, min, mean, abs_mean: 0.111997 0.109072 0.111329 0.111329
Epoch 5/300
1s - loss: 570.6274 - val_loss: 4217.1885
Epoch 00004: val_loss improved from 4301.50291 to 4217.18848, saving model to wuhan_weights.hdf5
               wuhan  554.1606      0.51  0.34  0.40      0.56  0.30  0.45      0.55  0.29  0.45
forget mean min: 0.931114 0.739868
delta_x = 4.05082 delta_h = 2.3156
U_c = [[-0.13903619]] U_f = [[ 0.]] b_c = [ 0.11594965] b_f = [ 0.97157925]
incx.max(), incx.min(), incx.mean() 12.2231 0.267695 4.38769
fgtx.max(), fgtx.min(), fgtx.mean() 5.88041 0.0737006 2.07477
delta mean, abs_mean, abs_mean+, abs_mean-: 0.4535 4.05082 4.04219 4.06167
W_c max, min, mean, abs_mean: 0.215553 0.211209 0.2144 0.2144
W_f max, min, mean, abs_mean: 0.104944 0.101807 0.104133 0.104133
               wuhan 4217.1884      0.10  0.68  0.08      0.09  0.72  0.07      0.08  0.72  0.07
forget mean min: 0.940556 0.772648
delta_x = 2.92652 delta_h = 1.46273
U_c = [[-0.13903619]] U_f = [[ 0.]] b_c = [ 0.11594965] b_f = [ 0.97157925]
incx.max(), incx.min(), incx.mean() 10.8315 0.634269 4.25546
fgtx.max(), fgtx.min(), fgtx.mean() 5.20452 0.251743 2.01054
delta mean, abs_mean, abs_mean+, abs_mean-: 0.509565 2.92652 2.87705 2.99986
W_c max, min, mean, abs_mean: 0.215553 0.211209 0.2144 0.2144
W_f max, min, mean, abs_mean: 0.104944 0.101807 0.104133 0.104133
Epoch 6/300
1s - loss: 547.5575 - val_loss: 4208.7018
Epoch 00005: val_loss improved from 4217.18848 to 4208.70179, saving model to wuhan_weights.hdf5
               wuhan  536.7607      0.47  0.30  0.39      0.51  0.24  0.44      0.49  0.21  0.43
forget mean min: 0.920495 0.720788
delta_x = 4.56447 delta_h = 2.23054
U_c = [[-0.14098722]] U_f = [[ 0.]] b_c = [ 0.11497319] b_f = [ 0.93149185]
incx.max(), incx.min(), incx.mean() 14.4732 0.156311 4.79015
fgtx.max(), fgtx.min(), fgtx.mean() 5.86442 0.0168809 1.90951
delta mean, abs_mean, abs_mean+, abs_mean-: 0.21017 4.56447 4.5396 4.59205
W_c max, min, mean, abs_mean: 0.24276 0.238276 0.241533 0.241533
W_f max, min, mean, abs_mean: 0.0996347 0.0962792 0.0986503 0.0986503
               wuhan 4208.7018      0.09  0.68  0.07      0.09  0.69  0.07      0.07  0.71  0.06
forget mean min: 0.930034 0.738326
delta_x = 3.32218 delta_h = 1.43385
U_c = [[-0.14098722]] U_f = [[ 0.]] b_c = [ 0.11497319] b_f = [ 0.93149185]
incx.max(), incx.min(), incx.mean() 12.1011 0.374002 4.68081
fgtx.max(), fgtx.min(), fgtx.mean() 4.89557 0.105793 1.86485
delta mean, abs_mean, abs_mean+, abs_mean-: 0.313992 3.32218 3.21491 3.46181
W_c max, min, mean, abs_mean: 0.24276 0.238276 0.241533 0.241533
W_f max, min, mean, abs_mean: 0.0996347 0.0962792 0.0986503 0.0986503
Epoch 7/300
1s - loss: 530.8836 - val_loss: 4168.7831
Epoch 00006: val_loss improved from 4208.70179 to 4168.78313, saving model to wuhan_weights.hdf5
               wuhan  520.9116      0.57  0.35  0.44      0.61  0.31  0.48      0.60  0.29  0.48
forget mean min: 0.917767 0.709549
delta_x = 5.2009 delta_h = 2.47273
U_c = [[-0.13917206]] U_f = [[ 0.]] b_c = [ 0.1122998] b_f = [ 0.8931945]
incx.max(), incx.min(), incx.mean() 17.09 0.1123 5.37548
fgtx.max(), fgtx.min(), fgtx.mean() 6.31615 0.0 1.95804
delta mean, abs_mean, abs_mean+, abs_mean-: 0.553124 5.2009 5.34851 5.02908
W_c max, min, mean, abs_mean: 0.270156 0.265523 0.268847 0.268847
W_f max, min, mean, abs_mean: 0.1012 0.097593 0.100018 0.100018
               wuhan 4168.7831      0.12  0.66  0.10      0.11  0.75  0.08      0.10  0.75  0.08
forget mean min: 0.928871 0.709549
delta_x = 3.7757 delta_h = 1.61164
U_c = [[-0.13917206]] U_f = [[ 0.]] b_c = [ 0.1122998] b_f = [ 0.8931945]
incx.max(), incx.min(), incx.mean() 13.7513 0.1123 5.26232
fgtx.max(), fgtx.min(), fgtx.mean() 5.07409 0.0 1.91594
delta mean, abs_mean, abs_mean+, abs_mean-: 0.684539 3.7757 3.71967 3.85959
W_c max, min, mean, abs_mean: 0.270156 0.265523 0.268847 0.268847
W_f max, min, mean, abs_mean: 0.1012 0.097593 0.100018 0.100018
Epoch 8/300
1s - loss: 518.0546 - val_loss: 4093.8896
Epoch 00007: val_loss improved from 4168.78313 to 4093.88962, saving model to wuhan_weights.hdf5
               wuhan  506.6962      0.52  0.30  0.43      0.56  0.24  0.48      0.53  0.20  0.47
forget mean min: 0.914167 0.702457
delta_x = 5.36901 delta_h = 2.27968
U_c = [[-0.13946204]] U_f = [[ 0.]] b_c = [ 0.10441595] b_f = [ 0.85902578]
incx.max(), incx.min(), incx.mean() 17.6491 0.104416 5.48517
fgtx.max(), fgtx.min(), fgtx.mean() 6.23178 0.0 1.9112
delta mean, abs_mean, abs_mean+, abs_mean-: 0.38947 5.36901 5.38738 5.34791
W_c max, min, mean, abs_mean: 0.286983 0.282226 0.285596 0.285596
W_f max, min, mean, abs_mean: 0.102824 0.0989759 0.101441 0.101441
               wuhan 4093.8897      0.10  0.70  0.08      0.09  0.73  0.07      0.09  0.71  0.07
forget mean min: 0.924397 0.702457
delta_x = 3.8992 delta_h = 1.50311
U_c = [[-0.13946204]] U_f = [[ 0.]] b_c = [ 0.10441595] b_f = [ 0.85902578]
incx.max(), incx.min(), incx.mean() 13.6709 0.104416 5.37395
fgtx.max(), fgtx.min(), fgtx.mean() 4.81874 0.0 1.87169
delta mean, abs_mean, abs_mean+, abs_mean-: 0.541515 3.8992 3.76208 4.09667
W_c max, min, mean, abs_mean: 0.286983 0.282226 0.285596 0.285596
W_f max, min, mean, abs_mean: 0.102824 0.0989759 0.101441 0.101441
Epoch 9/300
1s - loss: 507.4715 - val_loss: 4099.3532
Epoch 00008: val_loss did not improve
Epoch 10/300
1s - loss: 497.2787 - val_loss: 4207.8150
Epoch 00009: val_loss did not improve
Epoch 11/300
1s - loss: 488.7165 - val_loss: 4115.8529
Epoch 00010: val_loss did not improve
Epoch 12/300
1s - loss: 480.4624 - val_loss: 4140.8015
Epoch 00011: val_loss did not improve
Epoch 13/300
1s - loss: 473.3206 - val_loss: 4181.3005
Epoch 00012: val_loss did not improve
Epoch 14/300
1s - loss: 467.1924 - val_loss: 4229.8964
Epoch 00013: val_loss did not improve
Epoch 15/300
1s - loss: 461.7520 - val_loss: 4167.5031
Epoch 00014: val_loss did not improve
Epoch 16/300
1s - loss: 455.8060 - val_loss: 4139.3355
Epoch 00015: val_loss did not improve
Epoch 17/300
1s - loss: 451.3689 - val_loss: 4215.4854
Epoch 00016: val_loss did not improve
Epoch 18/300
1s - loss: 447.2246 - val_loss: 4195.3104
Epoch 00017: val_loss did not improve
Epoch 19/300
1s - loss: 441.2983 - val_loss: 4128.0244
Epoch 00018: val_loss did not improve
Epoch 20/300
1s - loss: 438.2938 - val_loss: 4265.8827
Epoch 00019: val_loss did not improve
Epoch 21/300
1s - loss: 434.7149 - val_loss: 4341.0601
Epoch 00020: val_loss did not improve
Epoch 22/300
1s - loss: 430.3286 - val_loss: 4310.5584
Epoch 00021: val_loss did not improve
Epoch 23/300
1s - loss: 426.8984 - val_loss: 4263.6164
Epoch 00022: val_loss did not improve
Epoch 24/300
1s - loss: 424.1652 - val_loss: 4176.2450
Epoch 00023: val_loss did not improve
Epoch 25/300
1s - loss: 421.2414 - val_loss: 4240.3019
Epoch 00024: val_loss did not improve
Epoch 26/300
1s - loss: 418.3026 - val_loss: 4263.2227
Epoch 00025: val_loss did not improve
Epoch 27/300
1s - loss: 415.7261 - val_loss: 4461.3775
Epoch 00026: val_loss did not improve
Epoch 28/300
1s - loss: 413.4598 - val_loss: 4325.7708
Epoch 00027: val_loss did not improve
Epoch 29/300
1s - loss: 413.1928 - val_loss: 4327.7333
Epoch 00028: val_loss did not improve
X_train[0].shape = (5274, 40, 23)

training nanchang
Train on 5274 samples, validate on 1044 samples
Before training:
            nanchang 1983.0007      0.01  -nan  0.01      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 2.49644 delta_h = 1.64026
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -2.49644 2.49644 nan 2.49644
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
            nanchang 3894.1676      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 2.04194 delta_h = 1.26379
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -2.04194 2.04194 nan 2.04194
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 1177.5904 - val_loss: 2946.8598
Epoch 00000: val_loss improved from inf to 2946.85984, saving model to nanchang_weights.hdf5
            nanchang  568.9564      0.26  0.43  0.22      0.30  0.39  0.25      0.30  0.36  0.25
forget mean min: 0.909139 0.782651
delta_x = 3.05857 delta_h = 1.92839
U_c = [[-0.1104228]] U_f = [[ 0.]] b_c = [ 0.08208133] b_f = [ 1.08094871]
incx.max(), incx.min(), incx.mean() 7.1793 0.294401 2.16755
fgtx.max(), fgtx.min(), fgtx.mean() 6.69309 0.200232 1.96672
delta mean, abs_mean, abs_mean+, abs_mean-: -0.333989 3.05857 2.97642 3.1279
W_c max, min, mean, abs_mean: 0.109697 0.105565 0.108233 0.108233
W_f max, min, mean, abs_mean: 0.10293 0.0989514 0.102071 0.102071
            nanchang 2946.8598      0.02  -nan  0.01      0.02  -nan  0.02      0.02  -nan  0.02
forget mean min: 0.867592 0.782651
delta_x = 2.51833 delta_h = 1.35809
U_c = [[-0.1104228]] U_f = [[ 0.]] b_c = [ 0.08208133] b_f = [ 1.08094871]
incx.max(), incx.min(), incx.mean() 5.67702 0.294401 1.29367
fgtx.max(), fgtx.min(), fgtx.mean() 5.27635 0.200232 1.1426
delta mean, abs_mean, abs_mean+, abs_mean-: -1.39038 2.51833 2.31602 2.58345
W_c max, min, mean, abs_mean: 0.109697 0.105565 0.108233 0.108233
W_f max, min, mean, abs_mean: 0.10293 0.0989514 0.102071 0.102071
Epoch 2/300
0s - loss: 537.1150 - val_loss: 2764.8515
Epoch 00001: val_loss improved from 2946.85984 to 2764.85152, saving model to nanchang_weights.hdf5
            nanchang  515.3214      0.26  0.35  0.22      0.29  0.30  0.25      0.29  0.27  0.26
forget mean min: 0.927713 0.808596
delta_x = 2.78634 delta_h = 1.78085
U_c = [[-0.10986153]] U_f = [[ 0.]] b_c = [ 0.10213403] b_f = [ 1.12157857]
incx.max(), incx.min(), incx.mean() 7.17354 0.398368 2.15613
fgtx.max(), fgtx.min(), fgtx.mean() 7.62245 0.319337 2.21407
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0461131 2.78634 2.78812 2.78462
W_c max, min, mean, abs_mean: 0.110812 0.106832 0.109409 0.109409
W_f max, min, mean, abs_mean: 0.118816 0.115095 0.117939 0.117939
            nanchang 2764.8515      0.02  -nan  0.02      0.03  -nan  0.02      0.02  -nan  0.02
forget mean min: 0.898797 0.808596
delta_x = 2.25054 delta_h = 1.22292
U_c = [[-0.10986153]] U_f = [[ 0.]] b_c = [ 0.10213403] b_f = [ 1.12157857]
incx.max(), incx.min(), incx.mean() 5.14192 0.398368 1.45076
fgtx.max(), fgtx.min(), fgtx.mean() 5.43252 0.319337 1.45373
delta mean, abs_mean, abs_mean+, abs_mean-: -0.936593 2.25054 2.17739 2.28214
W_c max, min, mean, abs_mean: 0.110812 0.106832 0.109409 0.109409
W_f max, min, mean, abs_mean: 0.118816 0.115095 0.117939 0.117939
Epoch 3/300
0s - loss: 506.1095 - val_loss: 2671.7075
Epoch 00002: val_loss improved from 2764.85152 to 2671.70750, saving model to nanchang_weights.hdf5
            nanchang  497.9396      0.22  0.35  0.19      0.26  0.30  0.22      0.26  0.28  0.23
forget mean min: 0.932746 0.814253
delta_x = 2.45999 delta_h = 1.44801
U_c = [[-0.09309862]] U_f = [[ 0.]] b_c = [ 0.10332612] b_f = [ 1.12891555]
incx.max(), incx.min(), incx.mean() 6.56897 0.410622 2.01888
fgtx.max(), fgtx.min(), fgtx.mean() 7.34197 0.34897 2.17521
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0995055 2.45999 2.46375 2.45654
W_c max, min, mean, abs_mean: 0.110585 0.106641 0.109191 0.109191
W_f max, min, mean, abs_mean: 0.124924 0.121145 0.123996 0.123996
            nanchang 2671.7075      0.02  -nan  0.02      0.03  -nan  0.02      0.02  -nan  0.02
forget mean min: 0.910149 0.814253
delta_x = 1.96887 delta_h = 0.980117
U_c = [[-0.09309862]] U_f = [[ 0.]] b_c = [ 0.10332612] b_f = [ 1.12891555]
incx.max(), incx.min(), incx.mean() 4.54629 0.410622 1.45555
fgtx.max(), fgtx.min(), fgtx.mean() 5.04514 0.34897 1.53553
delta mean, abs_mean, abs_mean+, abs_mean-: -0.784022 1.96887 1.89475 2.00259
W_c max, min, mean, abs_mean: 0.110585 0.106641 0.109191 0.109191
W_f max, min, mean, abs_mean: 0.124924 0.121145 0.123996 0.123996
Epoch 4/300
0s - loss: 490.4380 - val_loss: 2556.0194
Epoch 00003: val_loss improved from 2671.70750 to 2556.01940, saving model to nanchang_weights.hdf5
            nanchang  483.9452      0.26  0.35  0.23      0.29  0.31  0.25      0.30  0.27  0.27
forget mean min: 0.935685 0.808974
delta_x = 2.38767 delta_h = 1.24742
U_c = [[-0.08144449]] U_f = [[ 0.]] b_c = [ 0.1005719] b_f = [ 1.11325729]
incx.max(), incx.min(), incx.mean() 6.73788 0.395755 2.08352
fgtx.max(), fgtx.min(), fgtx.mean() 7.42207 0.330101 2.21743
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0261665 2.38767 2.44322 2.33571
W_c max, min, mean, abs_mean: 0.115829 0.111875 0.114436 0.114436
W_f max, min, mean, abs_mean: 0.129034 0.124969 0.127971 0.127971
            nanchang 2556.0193      0.02  -nan  0.02      0.03  -nan  0.03      0.03  -nan  0.03
forget mean min: 0.917797 0.808974
delta_x = 1.86186 delta_h = 0.790154
U_c = [[-0.08144449]] U_f = [[ 0.]] b_c = [ 0.1005719] b_f = [ 1.11325729]
incx.max(), incx.min(), incx.mean() 4.89456 0.395755 1.56397
fgtx.max(), fgtx.min(), fgtx.mean() 5.3608 0.330101 1.63645
delta mean, abs_mean, abs_mean+, abs_mean-: -0.61255 1.86186 1.60804 2.02309
W_c max, min, mean, abs_mean: 0.115829 0.111875 0.114436 0.114436
W_f max, min, mean, abs_mean: 0.129034 0.124969 0.127971 0.127971
Epoch 5/300
0s - loss: 480.0333 - val_loss: 2466.3065
Epoch 00004: val_loss improved from 2556.01940 to 2466.30648, saving model to nanchang_weights.hdf5
            nanchang  474.7714      0.41  0.37  0.33      0.46  0.34  0.37      0.47  0.30  0.39
forget mean min: 0.935174 0.797452
delta_x = 2.63218 delta_h = 1.18313
U_c = [[-0.07263549]] U_f = [[ 0.]] b_c = [ 0.0984147] b_f = [ 1.08591819]
incx.max(), incx.min(), incx.mean() 7.84671 0.374691 2.34064
fgtx.max(), fgtx.min(), fgtx.mean() 7.97952 0.284527 2.30915
delta mean, abs_mean, abs_mean+, abs_mean-: 0.139462 2.63218 2.7641 2.49954
W_c max, min, mean, abs_mean: 0.127055 0.123087 0.125671 0.125671
W_f max, min, mean, abs_mean: 0.130559 0.126211 0.129424 0.129424
            nanchang 2466.3065      0.03  -nan  0.02      0.04  -nan  0.03      0.03  -nan  0.03
forget mean min: 0.921201 0.797452
delta_x = 1.98117 delta_h = 0.687495
U_c = [[-0.07263549]] U_f = [[ 0.]] b_c = [ 0.0984147] b_f = [ 1.08591819]
incx.max(), incx.min(), incx.mean() 5.81352 0.374691 1.79306
fgtx.max(), fgtx.min(), fgtx.mean() 5.88565 0.284527 1.74524
delta mean, abs_mean, abs_mean+, abs_mean-: -0.424916 1.98117 1.73712 2.17919
W_c max, min, mean, abs_mean: 0.127055 0.123087 0.125671 0.125671
W_f max, min, mean, abs_mean: 0.130559 0.126211 0.129424 0.129424
Epoch 6/300
0s - loss: 471.3933 - val_loss: 2423.4429
Epoch 00005: val_loss improved from 2466.30648 to 2423.44288, saving model to nanchang_weights.hdf5
            nanchang  468.3159      0.40  0.36  0.33      0.45  0.33  0.37      0.48  0.29  0.40
forget mean min: 0.933392 0.78634
delta_x = 2.76178 delta_h = 1.1517
U_c = [[-0.07015175]] U_f = [[ 0.]] b_c = [ 0.09493902] b_f = [ 1.062235]
incx.max(), incx.min(), incx.mean() 8.80624 0.343066 2.47792
fgtx.max(), fgtx.min(), fgtx.mean() 8.4529 0.240767 2.31231
delta mean, abs_mean, abs_mean+, abs_mean-: 0.170256 2.76178 2.88286 2.63649
W_c max, min, mean, abs_mean: 0.13521 0.131191 0.133812 0.133812
W_f max, min, mean, abs_mean: 0.131084 0.12646 0.129843 0.129843
            nanchang 2423.4429      0.03  -nan  0.02      0.04  -nan  0.03      0.04  -nan  0.03
forget mean min: 0.919931 0.78634
delta_x = 2.07758 delta_h = 0.642893
U_c = [[-0.07015175]] U_f = [[ 0.]] b_c = [ 0.09493902] b_f = [ 1.062235]
incx.max(), incx.min(), incx.mean() 6.41274 0.343066 1.89804
fgtx.max(), fgtx.min(), fgtx.mean() 6.13041 0.240767 1.74964
delta mean, abs_mean, abs_mean+, abs_mean-: -0.391427 2.07758 1.83628 2.28242
W_c max, min, mean, abs_mean: 0.13521 0.131191 0.133812 0.133812
W_f max, min, mean, abs_mean: 0.131084 0.12646 0.129843 0.129843
Epoch 7/300
0s - loss: 464.7176 - val_loss: 2388.3756
Epoch 00006: val_loss improved from 2423.44288 to 2388.37556, saving model to nanchang_weights.hdf5
            nanchang  459.3079      0.42  0.34  0.35      0.48  0.30  0.39      0.49  0.26  0.42
forget mean min: 0.927906 0.771626
delta_x = 2.96086 delta_h = 1.11552
U_c = [[-0.06813115]] U_f = [[ 0.]] b_c = [ 0.08872657] b_f = [ 1.03346705]
incx.max(), incx.min(), incx.mean() 9.38163 0.28937 2.5615
fgtx.max(), fgtx.min(), fgtx.mean() 8.5244 0.184046 2.2683
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0886959 2.96086 3.0593 2.86304
W_c max, min, mean, abs_mean: 0.142539 0.138388 0.141059 0.141059
W_f max, min, mean, abs_mean: 0.130739 0.125809 0.129393 0.129393
            nanchang 2388.3756      0.03  -nan  0.02      0.04  -nan  0.03      0.04  -nan  0.04
forget mean min: 0.917815 0.771626
delta_x = 2.18173 delta_h = 0.617634
U_c = [[-0.06813115]] U_f = [[ 0.]] b_c = [ 0.08872657] b_f = [ 1.03346705]
incx.max(), incx.min(), incx.mean() 6.68617 0.28937 2.00628
fgtx.max(), fgtx.min(), fgtx.mean() 6.05186 0.184046 1.75899
delta mean, abs_mean, abs_mean+, abs_mean-: -0.367 2.18173 1.94515 2.38858
W_c max, min, mean, abs_mean: 0.142539 0.138388 0.141059 0.141059
W_f max, min, mean, abs_mean: 0.130739 0.125809 0.129393 0.129393
Epoch 8/300
0s - loss: 457.7532 - val_loss: 2347.4883
Epoch 00007: val_loss improved from 2388.37556 to 2347.48831, saving model to nanchang_weights.hdf5
            nanchang  455.2765      0.47  0.36  0.37      0.54  0.33  0.42      0.55  0.28  0.45
forget mean min: 0.927883 0.758648
delta_x = 3.13067 delta_h = 1.09593
U_c = [[-0.06581148]] U_f = [[ 0.]] b_c = [ 0.08390728] b_f = [ 1.00750804]
incx.max(), incx.min(), incx.mean() 10.3031 0.237565 2.71202
fgtx.max(), fgtx.min(), fgtx.mean() 9.16348 0.137776 2.35662
delta mean, abs_mean, abs_mean+, abs_mean-: 0.176777 3.13067 3.2594 2.99809
W_c max, min, mean, abs_mean: 0.149954 0.145679 0.148392 0.148392
W_f max, min, mean, abs_mean: 0.134493 0.129289 0.13306 0.13306
            nanchang 2347.4883      0.03  -nan  0.03      0.04  -nan  0.03      0.04  -nan  0.04
forget mean min: 0.917391 0.758648
delta_x = 2.3192 delta_h = 0.595879
U_c = [[-0.06581148]] U_f = [[ 0.]] b_c = [ 0.08390728] b_f = [ 1.00750804]
incx.max(), incx.min(), incx.mean() 7.3019 0.237565 2.10974
fgtx.max(), fgtx.min(), fgtx.mean() 6.47233 0.137776 1.81656
delta mean, abs_mean, abs_mean+, abs_mean-: -0.308186 2.3192 2.11376 2.50558
W_c max, min, mean, abs_mean: 0.149954 0.145679 0.148392 0.148392
W_f max, min, mean, abs_mean: 0.134493 0.129289 0.13306 0.13306
Epoch 9/300
0s - loss: 452.5456 - val_loss: 2323.3919
Epoch 00008: val_loss improved from 2347.48831 to 2323.39190, saving model to nanchang_weights.hdf5
            nanchang  447.3035      0.44  0.33  0.36      0.50  0.29  0.41      0.52  0.25  0.44
forget mean min: 0.925764 0.746071
delta_x = 3.20186 delta_h = 1.05618
U_c = [[-0.06444656]] U_f = [[ 0.]] b_c = [ 0.07783346] b_f = [ 0.98491424]
incx.max(), incx.min(), incx.mean() 10.624 0.181611 2.71615
fgtx.max(), fgtx.min(), fgtx.mean() 9.4366 0.0928503 2.36076
delta mean, abs_mean, abs_mean+, abs_mean-: 0.115582 3.20186 3.29012 3.11213
W_c max, min, mean, abs_mean: 0.153441 0.14906 0.151808 0.151808
W_f max, min, mean, abs_mean: 0.137321 0.131908 0.135834 0.135834
            nanchang 2323.3919      0.03  -nan  0.03      0.04  -nan  0.04      0.04  -nan  0.04
forget mean min: 0.916152 0.746071
delta_x = 2.35732 delta_h = 0.576136
U_c = [[-0.06444656]] U_f = [[ 0.]] b_c = [ 0.07783346] b_f = [ 0.98491424]
incx.max(), incx.min(), incx.mean() 7.40063 0.181611 2.12488
fgtx.max(), fgtx.min(), fgtx.mean() 6.55239 0.0928503 1.8317
delta mean, abs_mean, abs_mean+, abs_mean-: -0.315935 2.35732 2.11052 2.58846
W_c max, min, mean, abs_mean: 0.153441 0.14906 0.151808 0.151808
W_f max, min, mean, abs_mean: 0.137321 0.131908 0.135834 0.135834
Epoch 10/300
0s - loss: 447.6401 - val_loss: 2294.8262
Epoch 00009: val_loss improved from 2323.39190 to 2294.82619, saving model to nanchang_weights.hdf5
            nanchang  442.8980      0.38  0.28  0.33      0.42  0.25  0.36      0.43  0.20  0.38
forget mean min: 0.925054 0.733922
delta_x = 3.2322 delta_h = 1.00602
U_c = [[-0.06337947]] U_f = [[ 0.]] b_c = [ 0.07251364] b_f = [ 0.96412539]
incx.max(), incx.min(), incx.mean() 10.9061 0.128294 2.70614
fgtx.max(), fgtx.min(), fgtx.mean() 9.80777 0.0504886 2.38427
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0670593 3.2322 3.26554 3.19815
W_c max, min, mean, abs_mean: 0.156799 0.152327 0.155104 0.155104
W_f max, min, mean, abs_mean: 0.141961 0.136343 0.140415 0.140415
            nanchang 2294.8262      0.03  -nan  0.03      0.05  -nan  0.04      0.04  -nan  0.04
forget mean min: 0.91518 0.733922
delta_x = 2.40704 delta_h = 0.567132
U_c = [[-0.06337947]] U_f = [[ 0.]] b_c = [ 0.07251364] b_f = [ 0.96412539]
incx.max(), incx.min(), incx.mean() 7.57785 0.128294 2.12261
fgtx.max(), fgtx.min(), fgtx.mean() 6.79471 0.0504886 1.856
delta mean, abs_mean, abs_mean+, abs_mean-: -0.32038 2.40704 2.09187 2.72064
W_c max, min, mean, abs_mean: 0.156799 0.152327 0.155104 0.155104
W_f max, min, mean, abs_mean: 0.141961 0.136343 0.140415 0.140415
Epoch 11/300
0s - loss: 442.4613 - val_loss: 2300.2159
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 438.9600 - val_loss: 2275.5608
Epoch 00011: val_loss improved from 2294.82619 to 2275.56083, saving model to nanchang_weights.hdf5
            nanchang  432.2901      0.41  0.27  0.35      0.46  0.23  0.40      0.47  0.19  0.42
forget mean min: 0.922918 0.713942
delta_x = 3.38091 delta_h = 0.888377
U_c = [[-0.05499872]] U_f = [[ 0.]] b_c = [ 0.0591284] b_f = [ 0.9146049]
incx.max(), incx.min(), incx.mean() 11.3044 0.0591284 2.68454
fgtx.max(), fgtx.min(), fgtx.mean() 10.7696 0.0 2.51436
delta mean, abs_mean, abs_mean+, abs_mean-: 0.000864274 3.38091 3.35269 3.40962
W_c max, min, mean, abs_mean: 0.161542 0.156908 0.159718 0.159718
W_f max, min, mean, abs_mean: 0.154581 0.148679 0.152959 0.152959
            nanchang 2275.5609      0.04  -nan  0.03      0.05  -nan  0.04      0.04  -nan  0.04
forget mean min: 0.914553 0.713942
delta_x = 2.46152 delta_h = 0.502224
U_c = [[-0.05499872]] U_f = [[ 0.]] b_c = [ 0.0591284] b_f = [ 0.9146049]
incx.max(), incx.min(), incx.mean() 7.66915 0.0591284 2.09989
fgtx.max(), fgtx.min(), fgtx.mean() 7.28812 0.0 1.95445
delta mean, abs_mean, abs_mean+, abs_mean-: -0.331624 2.46152 2.06578 2.8826
W_c max, min, mean, abs_mean: 0.161542 0.156908 0.159718 0.159718
W_f max, min, mean, abs_mean: 0.154581 0.148679 0.152959 0.152959
Epoch 13/300
0s - loss: 436.0333 - val_loss: 2247.4886
Epoch 00012: val_loss improved from 2275.56083 to 2247.48859, saving model to nanchang_weights.hdf5
            nanchang  430.5003      0.47  0.32  0.38      0.53  0.29  0.44      0.56  0.24  0.47
forget mean min: 0.924819 0.709561
delta_x = 3.46801 delta_h = 0.971837
U_c = [[-0.05756749]] U_f = [[ 0.]] b_c = [ 0.05547021] b_f = [ 0.89325309]
incx.max(), incx.min(), incx.mean() 11.787 0.0554702 2.77075
fgtx.max(), fgtx.min(), fgtx.mean() 11.5378 0.0 2.67046
delta mean, abs_mean, abs_mean+, abs_mean-: 0.133052 3.46801 3.45384 3.48344
W_c max, min, mean, abs_mean: 0.164783 0.160105 0.16292 0.16292
W_f max, min, mean, abs_mean: 0.161875 0.155903 0.160227 0.160227
            nanchang 2247.4886      0.04  -nan  0.03      0.05  -nan  0.04      0.04  -nan  0.04
forget mean min: 0.915862 0.709561
delta_x = 2.55284 delta_h = 0.538523
U_c = [[-0.05756749]] U_f = [[ 0.]] b_c = [ 0.05547021] b_f = [ 0.89325309]
incx.max(), incx.min(), incx.mean() 8.0319 0.0554702 2.14418
fgtx.max(), fgtx.min(), fgtx.mean() 7.84475 0.0 2.05424
delta mean, abs_mean, abs_mean+, abs_mean-: -0.26602 2.55284 2.14814 3.0134
W_c max, min, mean, abs_mean: 0.164783 0.160105 0.16292 0.16292
W_f max, min, mean, abs_mean: 0.161875 0.155903 0.160227 0.160227
Epoch 14/300
0s - loss: 432.0354 - val_loss: 2229.5475
Epoch 00013: val_loss improved from 2247.48859 to 2229.54752, saving model to nanchang_weights.hdf5
            nanchang  430.0293      0.52  0.35  0.41      0.59  0.31  0.46      0.61  0.27  0.50
forget mean min: 0.925781 0.704713
delta_x = 3.53727 delta_h = 0.921644
U_c = [[-0.05272896]] U_f = [[ 0.]] b_c = [ 0.05025467] b_f = [ 0.86984247]
incx.max(), incx.min(), incx.mean() 12.0202 0.0502547 2.79601
fgtx.max(), fgtx.min(), fgtx.mean() 12.1607 0.0 2.78951
delta mean, abs_mean, abs_mean+, abs_mean-: 0.172334 3.53727 3.50354 3.57522
W_c max, min, mean, abs_mean: 0.166763 0.162047 0.164864 0.164864
W_f max, min, mean, abs_mean: 0.169151 0.163141 0.167488 0.167488
            nanchang 2229.5475      0.04  -nan  0.03      0.05  -nan  0.04      0.05  -nan  0.04
forget mean min: 0.917413 0.704713
delta_x = 2.58501 delta_h = 0.502326
U_c = [[-0.05272896]] U_f = [[ 0.]] b_c = [ 0.05025467] b_f = [ 0.86984247]
incx.max(), incx.min(), incx.mean() 8.15348 0.0502547 2.15699
fgtx.max(), fgtx.min(), fgtx.mean() 8.23234 0.0 2.14032
delta mean, abs_mean, abs_mean+, abs_mean-: -0.234153 2.58501 2.164 3.08561
W_c max, min, mean, abs_mean: 0.166763 0.162047 0.164864 0.164864
W_f max, min, mean, abs_mean: 0.169151 0.163141 0.167488 0.167488
Epoch 15/300
0s - loss: 427.9492 - val_loss: 2261.7012
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 424.6927 - val_loss: 2197.7683
Epoch 00015: val_loss improved from 2229.54752 to 2197.76832, saving model to nanchang_weights.hdf5
            nanchang  423.7927      0.54  0.35  0.41      0.60  0.31  0.47      0.63  0.27  0.51
forget mean min: 0.927036 0.693487
delta_x = 3.63621 delta_h = 0.912494
U_c = [[-0.05170711]] U_f = [[ 0.]] b_c = [ 0.03981549] b_f = [ 0.81647307]
incx.max(), incx.min(), incx.mean() 12.2992 0.0398155 2.81052
fgtx.max(), fgtx.min(), fgtx.mean() 13.2608 0.0 2.99705
delta mean, abs_mean, abs_mean+, abs_mean-: 0.206359 3.63621 3.50254 3.79862
W_c max, min, mean, abs_mean: 0.171098 0.166315 0.169135 0.169135
W_f max, min, mean, abs_mean: 0.184648 0.178571 0.182949 0.182949
            nanchang 2197.7683      0.05  -nan  0.04      0.06  -nan  0.05      0.05  -nan  0.04
forget mean min: 0.918681 0.693487
delta_x = 2.66579 delta_h = 0.503276
U_c = [[-0.05170711]] U_f = [[ 0.]] b_c = [ 0.03981549] b_f = [ 0.81647307]
incx.max(), incx.min(), incx.mean() 8.25176 0.0398155 2.15445
fgtx.max(), fgtx.min(), fgtx.mean() 8.88275 0.0 2.28739
delta mean, abs_mean, abs_mean+, abs_mean-: -0.206695 2.66579 2.16823 3.31752
W_c max, min, mean, abs_mean: 0.171098 0.166315 0.169135 0.169135
W_f max, min, mean, abs_mean: 0.184648 0.178571 0.182949 0.182949
Epoch 17/300
0s - loss: 420.3833 - val_loss: 2208.8577
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 416.0803 - val_loss: 2198.6073
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 412.9197 - val_loss: 2215.1101
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 409.5591 - val_loss: 2215.3492
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 408.2460 - val_loss: 2235.9182
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 405.5071 - val_loss: 2275.3100
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 401.8175 - val_loss: 2194.8738
Epoch 00022: val_loss improved from 2197.76832 to 2194.87376, saving model to nanchang_weights.hdf5
            nanchang  392.4412      0.51  0.31  0.42      0.57  0.26  0.47      0.60  0.22  0.51
forget mean min: 0.926099 0.649202
delta_x = 3.75854 delta_h = 0.856319
U_c = [[-0.05018292]] U_f = [[ 0.]] b_c = [ 0.01353472] b_f = [ 0.61553472]
incx.max(), incx.min(), incx.mean() 12.1029 0.0135347 2.68355
fgtx.max(), fgtx.min(), fgtx.mean() 15.8219 0.0 3.49439
delta mean, abs_mean, abs_mean+, abs_mean-: 0.111577 3.75854 3.31197 4.38614
W_c max, min, mean, abs_mean: 0.185287 0.180456 0.183238 0.183238
W_f max, min, mean, abs_mean: 0.241555 0.235547 0.239813 0.239813
            nanchang 2194.8737      0.05  -nan  0.04      0.06  -nan  0.05      0.05  -nan  0.05
forget mean min: 0.917461 0.649202
delta_x = 2.85841 delta_h = 0.516929
U_c = [[-0.05018292]] U_f = [[ 0.]] b_c = [ 0.01353472] b_f = [ 0.61553472]
incx.max(), incx.min(), incx.mean() 8.16465 0.0135347 2.06934
fgtx.max(), fgtx.min(), fgtx.mean() 10.6678 0.0 2.69054
delta mean, abs_mean, abs_mean+, abs_mean-: -0.253161 2.85841 2.09705 4.1068
W_c max, min, mean, abs_mean: 0.185287 0.180456 0.183238 0.183238
W_f max, min, mean, abs_mean: 0.241555 0.235547 0.239813 0.239813
Epoch 24/300
0s - loss: 401.0327 - val_loss: 2158.7433
Epoch 00023: val_loss improved from 2194.87376 to 2158.74334, saving model to nanchang_weights.hdf5
            nanchang  389.5819      0.51  0.30  0.42      0.56  0.25  0.47      0.58  0.21  0.50
forget mean min: 0.922835 0.643263
delta_x = 3.79023 delta_h = 0.843041
U_c = [[-0.04983879]] U_f = [[ 0.]] b_c = [ 0.01081199] b_f = [ 0.58955514]
incx.max(), incx.min(), incx.mean() 11.8664 0.010812 2.62674
fgtx.max(), fgtx.min(), fgtx.mean() 15.7564 0.0 3.47664
delta mean, abs_mean, abs_mean+, abs_mean-: 0.00943581 3.79023 3.29128 4.47148
W_c max, min, mean, abs_mean: 0.186472 0.181644 0.184422 0.184422
W_f max, min, mean, abs_mean: 0.246861 0.240827 0.245102 0.245102
            nanchang 2158.7434      0.05  -nan  0.04      0.07  -nan  0.06      0.06  -nan  0.05
forget mean min: 0.919022 0.643263
delta_x = 2.82618 delta_h = 0.498993
U_c = [[-0.04983879]] U_f = [[ 0.]] b_c = [ 0.01081199] b_f = [ 0.58955514]
incx.max(), incx.min(), incx.mean() 8.07575 0.010812 2.06942
fgtx.max(), fgtx.min(), fgtx.mean() 10.7185 0.0 2.73596
delta mean, abs_mean, abs_mean+, abs_mean-: -0.23619 2.82618 2.08269 4.04852
W_c max, min, mean, abs_mean: 0.186472 0.181644 0.184422 0.184422
W_f max, min, mean, abs_mean: 0.246861 0.240827 0.245102 0.245102
Epoch 25/300
0s - loss: 399.5500 - val_loss: 2153.7024
Epoch 00024: val_loss improved from 2158.74334 to 2153.70236, saving model to nanchang_weights.hdf5
            nanchang  389.6808      0.54  0.33  0.43      0.61  0.28  0.49      0.64  0.24  0.53
forget mean min: 0.922176 0.637786
delta_x = 3.8701 delta_h = 0.873871
U_c = [[-0.04956298]] U_f = [[ 0.]] b_c = [ 0.01021567] b_f = [ 0.56576592]
incx.max(), incx.min(), incx.mean() 12.0845 0.0102157 2.67429
fgtx.max(), fgtx.min(), fgtx.mean() 16.1833 0.0 3.57071
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0583451 3.8701 3.36814 4.57239
W_c max, min, mean, abs_mean: 0.189443 0.184607 0.187377 0.187377
W_f max, min, mean, abs_mean: 0.252913 0.246875 0.251145 0.251145
            nanchang 2153.7024      0.05  -nan  0.04      0.08  -nan  0.06      0.07  -nan  0.06
forget mean min: 0.91834 0.637786
delta_x = 2.92253 delta_h = 0.510074
U_c = [[-0.04956298]] U_f = [[ 0.]] b_c = [ 0.01021567] b_f = [ 0.56576592]
incx.max(), incx.min(), incx.mean() 8.11916 0.0102157 2.10135
fgtx.max(), fgtx.min(), fgtx.mean() 10.8686 0.0 2.80279
delta mean, abs_mean, abs_mean+, abs_mean-: -0.218757 2.92253 2.14665 4.24229
W_c max, min, mean, abs_mean: 0.189443 0.184607 0.187377 0.187377
W_f max, min, mean, abs_mean: 0.252913 0.246875 0.251145 0.251145
Epoch 26/300
0s - loss: 396.5349 - val_loss: 2196.0975
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 394.8789 - val_loss: 2176.3627
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 393.4711 - val_loss: 2212.8786
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 391.6761 - val_loss: 2146.8670
Epoch 00028: val_loss improved from 2153.70236 to 2146.86701, saving model to nanchang_weights.hdf5
            nanchang  380.7882      0.52  0.30  0.43      0.58  0.24  0.49      0.61  0.20  0.53
forget mean min: 0.920297 0.614051
delta_x = 3.94122 delta_h = 0.904129
U_c = [[-0.05205778]] U_f = [[ 0.]] b_c = [ 0.00693307] b_f = [ 0.46437398]
incx.max(), incx.min(), incx.mean() 12.083 0.00693307 2.65558
fgtx.max(), fgtx.min(), fgtx.mean() 17.1116 0.0 3.75313
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0119131 3.94122 3.326 4.84238
W_c max, min, mean, abs_mean: 0.196742 0.191908 0.19464 0.19464
W_f max, min, mean, abs_mean: 0.277671 0.271571 0.275804 0.275804
            nanchang 2146.8670      0.05  -nan  0.04      0.07  -nan  0.06      0.06  -nan  0.06
forget mean min: 0.916381 0.614051
delta_x = 2.99681 delta_h = 0.54914
U_c = [[-0.05205778]] U_f = [[ 0.]] b_c = [ 0.00693307] b_f = [ 0.46437398]
incx.max(), incx.min(), incx.mean() 7.9792 0.00693307 2.09584
fgtx.max(), fgtx.min(), fgtx.mean() 11.2967 0.0 2.95998
delta mean, abs_mean, abs_mean+, abs_mean-: -0.234714 2.99681 2.17714 4.41874
W_c max, min, mean, abs_mean: 0.196742 0.191908 0.19464 0.19464
W_f max, min, mean, abs_mean: 0.277671 0.271571 0.275804 0.275804
Epoch 30/300
0s - loss: 391.4253 - val_loss: 2176.3556
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 389.2210 - val_loss: 2244.7242
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 388.0724 - val_loss: 2211.0176
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 387.7082 - val_loss: 2222.9163
Epoch 00032: val_loss did not improve
Epoch 34/300
0s - loss: 386.6893 - val_loss: 2196.0291
Epoch 00033: val_loss did not improve
Epoch 35/300
0s - loss: 385.4383 - val_loss: 2209.8432
Epoch 00034: val_loss did not improve
Epoch 36/300
0s - loss: 384.8915 - val_loss: 2208.8133
Epoch 00035: val_loss did not improve
Epoch 37/300
0s - loss: 383.6025 - val_loss: 2219.8516
Epoch 00036: val_loss did not improve
Epoch 38/300
0s - loss: 382.2715 - val_loss: 2157.9170
Epoch 00037: val_loss did not improve
Epoch 39/300
0s - loss: 381.7258 - val_loss: 2274.5430
Epoch 00038: val_loss did not improve
Epoch 40/300
0s - loss: 380.4978 - val_loss: 2193.5129
Epoch 00039: val_loss did not improve
Epoch 41/300
0s - loss: 379.7639 - val_loss: 2211.1244
Epoch 00040: val_loss did not improve
Epoch 42/300
0s - loss: 379.4525 - val_loss: 2201.4608
Epoch 00041: val_loss did not improve
Epoch 43/300
0s - loss: 378.4560 - val_loss: 2258.5388
Epoch 00042: val_loss did not improve
Epoch 44/300
0s - loss: 377.3577 - val_loss: 2243.3499
Epoch 00043: val_loss did not improve
Epoch 45/300
0s - loss: 377.7576 - val_loss: 2227.9746
Epoch 00044: val_loss did not improve
Epoch 46/300
0s - loss: 376.7527 - val_loss: 2286.1901
Epoch 00045: val_loss did not improve
Epoch 47/300
0s - loss: 375.5040 - val_loss: 2249.7605
Epoch 00046: val_loss did not improve
Epoch 48/300
0s - loss: 375.0131 - val_loss: 2224.0225
Epoch 00047: val_loss did not improve
Epoch 49/300
0s - loss: 375.6107 - val_loss: 2257.6726
Epoch 00048: val_loss did not improve
Epoch 50/300
0s - loss: 374.4601 - val_loss: 2256.1434
Epoch 00049: val_loss did not improve
X_train[0].shape = (5860, 40, 23)

training changsha
Train on 5860 samples, validate on 1160 samples
Before training:
            changsha 3217.1458      0.01  -nan  0.01      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.57718 delta_h = 2.34471
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.57718 3.57718 nan 3.57718
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
            changsha 2873.8369      0.00  -nan  0.00      0.00  -nan  0.00      -nan  -nan  -nan
forget mean min: 0.731059 0.731059
delta_x = 2.6308 delta_h = 1.68438
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -2.6308 2.6308 nan 2.6308
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 1658.1744 - val_loss: 1532.5228
Epoch 00000: val_loss improved from inf to 1532.52282, saving model to changsha_weights.hdf5
            changsha  660.4080      0.48  0.45  0.35      0.53  0.39  0.40      0.58  0.34  0.45
forget mean min: 0.941898 0.783988
delta_x = 2.83718 delta_h = 2.03356
U_c = [[-0.10820682]] U_f = [[ 0.]] b_c = [ 0.08265298] b_f = [ 1.08089781]
incx.max(), incx.min(), incx.mean() 6.01673 0.293441 2.41373
fgtx.max(), fgtx.min(), fgtx.mean() 5.85984 0.208161 2.30192
delta mean, abs_mean, abs_mean+, abs_mean-: -0.262906 2.83718 2.78652 2.88067
W_c max, min, mean, abs_mean: 0.107708 0.104441 0.10701 0.10701
W_f max, min, mean, abs_mean: 0.106107 0.104784 0.105674 0.105674
            changsha 1532.5229      0.00  -nan  0.00      0.00  -nan  0.00      -nan  -nan  -nan
forget mean min: 0.905546 0.783988
delta_x = 2.15817 delta_h = 1.33938
U_c = [[-0.10820682]] U_f = [[ 0.]] b_c = [ 0.08265298] b_f = [ 1.08089781]
incx.max(), incx.min(), incx.mean() 3.88123 0.293441 1.51118
fgtx.max(), fgtx.min(), fgtx.mean() 3.75107 0.208161 1.41067
delta mean, abs_mean, abs_mean+, abs_mean-: -1.38078 2.15817 1.36984 2.47047
W_c max, min, mean, abs_mean: 0.107708 0.104441 0.10701 0.10701
W_f max, min, mean, abs_mean: 0.106107 0.104784 0.105674 0.105674
Epoch 2/300
1s - loss: 572.4660 - val_loss: 1458.1471
Epoch 00001: val_loss improved from 1532.52282 to 1458.14707, saving model to changsha_weights.hdf5
            changsha  529.0068      0.57  0.35  0.43      0.64  0.26  0.52      0.71  0.18  0.61
forget mean min: 0.949366 0.807479
delta_x = 2.81684 delta_h = 1.9404
U_c = [[-0.09962003]] U_f = [[ 0.]] b_c = [ 0.11427873] b_f = [ 1.09972763]
incx.max(), incx.min(), incx.mean() 5.28459 0.330313 2.00512
fgtx.max(), fgtx.min(), fgtx.mean() 7.9929 0.333982 2.92307
delta mean, abs_mean, abs_mean+, abs_mean-: -0.184329 2.81684 2.42933 3.27508
W_c max, min, mean, abs_mean: 0.0895015 0.0860001 0.0881973 0.0881973
W_f max, min, mean, abs_mean: 0.136973 0.135253 0.136348 0.136348
            changsha 1458.1471      0.01  -nan  0.00      0.00  -nan  0.00      -nan  -nan  -nan
forget mean min: 0.919098 0.807479
delta_x = 2.01201 delta_h = 1.13927
U_c = [[-0.09962003]] U_f = [[ 0.]] b_c = [ 0.11427873] b_f = [ 1.09972763]
incx.max(), incx.min(), incx.mean() 2.62897 0.330313 1.1805
fgtx.max(), fgtx.min(), fgtx.mean() 3.88751 0.333982 1.64827
delta mean, abs_mean, abs_mean+, abs_mean-: -1.33877 2.01201 0.971408 2.56384
W_c max, min, mean, abs_mean: 0.0895015 0.0860001 0.0881973 0.0881973
W_f max, min, mean, abs_mean: 0.136973 0.135253 0.136348 0.136348
Epoch 3/300
1s - loss: 515.8257 - val_loss: 1361.2893
Epoch 00002: val_loss improved from 1458.14707 to 1361.28935, saving model to changsha_weights.hdf5
            changsha  504.7932      0.64  0.36  0.47      0.72  0.28  0.57      0.78  0.21  0.65
forget mean min: 0.952363 0.814199
delta_x = 3.10703 delta_h = 1.95045
U_c = [[-0.09695264]] U_f = [[ 0.]] b_c = [ 0.15442762] b_f = [ 1.09050596]
incx.max(), incx.min(), incx.mean() 5.99976 0.394976 2.22631
fgtx.max(), fgtx.min(), fgtx.mean() 9.40456 0.387023 3.33343
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0982608 3.10703 2.75851 3.59025
W_c max, min, mean, abs_mean: 0.096925 0.0928023 0.09507 0.09507
W_f max, min, mean, abs_mean: 0.153667 0.151708 0.15296 0.15296
            changsha 1361.2894      0.01  -nan  0.00      0.00  -nan  0.00      -nan  -nan  -nan
forget mean min: 0.928297 0.814199
delta_x = 2.09107 delta_h = 0.937649
U_c = [[-0.09695264]] U_f = [[ 0.]] b_c = [ 0.15442762] b_f = [ 1.09050596]
incx.max(), incx.min(), incx.mean() 3.4977 0.394976 1.34596
fgtx.max(), fgtx.min(), fgtx.mean() 5.37898 0.387023 1.91702
delta mean, abs_mean, abs_mean+, abs_mean-: -1.02585 2.09107 1.1854 2.83002
W_c max, min, mean, abs_mean: 0.096925 0.0928023 0.09507 0.09507
W_f max, min, mean, abs_mean: 0.153667 0.151708 0.15296 0.15296
Epoch 4/300
1s - loss: 495.0563 - val_loss: 1373.2296
Epoch 00003: val_loss did not improve
Epoch 5/300
1s - loss: 480.4104 - val_loss: 1307.1444
Epoch 00004: val_loss improved from 1361.28935 to 1307.14440, saving model to changsha_weights.hdf5
            changsha  471.8526      0.62  0.32  0.48      0.69  0.23  0.57      0.74  0.16  0.65
forget mean min: 0.947179 0.78212
delta_x = 3.48054 delta_h = 1.75007
U_c = [[-0.09098839]] U_f = [[ 0.]] b_c = [ 0.21018779] b_f = [ 1.01970565]
incx.max(), incx.min(), incx.mean() 7.17257 0.400707 2.51519
fgtx.max(), fgtx.min(), fgtx.mean() 9.44188 0.258359 3.12586
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0079111 3.48054 3.10349 3.95938
W_c max, min, mean, abs_mean: 0.116767 0.111832 0.114386 0.114386
W_f max, min, mean, abs_mean: 0.156164 0.153538 0.155124 0.155124
            changsha 1307.1444      0.01  -nan  0.00      0.02  -nan  0.01      -nan  -nan  -nan
forget mean min: 0.928811 0.806071
delta_x = 2.44053 delta_h = 0.782178
U_c = [[-0.09098839]] U_f = [[ 0.]] b_c = [ 0.21018779] b_f = [ 1.01970565]
incx.max(), incx.min(), incx.mean() 5.10574 0.508857 1.7267
fgtx.max(), fgtx.min(), fgtx.mean() 6.63893 0.404977 2.05654
delta mean, abs_mean, abs_mean+, abs_mean-: -0.817958 2.44053 1.85282 2.89832
W_c max, min, mean, abs_mean: 0.116767 0.111832 0.114386 0.114386
W_f max, min, mean, abs_mean: 0.156164 0.153538 0.155124 0.155124
Epoch 6/300
1s - loss: 468.1095 - val_loss: 1257.3595
Epoch 00005: val_loss improved from 1307.14440 to 1257.35949, saving model to changsha_weights.hdf5
            changsha  459.5576      0.61  0.30  0.48      0.67  0.21  0.57      0.73  0.15  0.65
forget mean min: 0.94432 0.761916
delta_x = 3.6703 delta_h = 1.66722
U_c = [[-0.08718725]] U_f = [[ 0.]] b_c = [ 0.22457458] b_f = [ 0.98274601]
incx.max(), incx.min(), incx.mean() 7.75292 0.365843 2.63551
fgtx.max(), fgtx.min(), fgtx.mean() 9.61818 0.180467 3.08018
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0632128 3.6703 3.29726 4.12073
W_c max, min, mean, abs_mean: 0.125639 0.120332 0.123033 0.123033
W_f max, min, mean, abs_mean: 0.158331 0.155488 0.157189 0.157189
            changsha 1257.3595      0.01  -nan  0.00      0.02  -nan  0.01      -nan  -nan  -nan
forget mean min: 0.932204 0.789288
delta_x = 2.50352 delta_h = 0.658047
U_c = [[-0.08718725]] U_f = [[ 0.]] b_c = [ 0.22457458] b_f = [ 0.98274601]
incx.max(), incx.min(), incx.mean() 5.65731 0.489102 1.92962
fgtx.max(), fgtx.min(), fgtx.mean() 6.94078 0.337893 2.17831
delta mean, abs_mean, abs_mean+, abs_mean-: -0.630708 2.50352 2.16155 2.7649
W_c max, min, mean, abs_mean: 0.125639 0.120332 0.123033 0.123033
W_f max, min, mean, abs_mean: 0.158331 0.155488 0.157189 0.157189
Epoch 7/300
1s - loss: 456.5415 - val_loss: 1257.7914
Epoch 00006: val_loss did not improve
Epoch 8/300
1s - loss: 445.3218 - val_loss: 1168.2246
Epoch 00007: val_loss improved from 1257.35949 to 1168.22457, saving model to changsha_weights.hdf5
            changsha  436.7808      0.66  0.30  0.51      0.73  0.22  0.60      0.77  0.16  0.67
forget mean min: 0.939694 0.717703
delta_x = 4.2211 delta_h = 1.54293
U_c = [[-0.07918108]] U_f = [[ 0.]] b_c = [ 0.25101119] b_f = [ 0.90928912]
incx.max(), incx.min(), incx.mean() 9.99166 0.273534 3.16726
fgtx.max(), fgtx.min(), fgtx.mean() 10.3096 0.0238076 3.08657
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0989787 4.2211 4.05132 4.41502
W_c max, min, mean, abs_mean: 0.157415 0.151304 0.15429 0.15429
W_f max, min, mean, abs_mean: 0.164591 0.161449 0.163305 0.163305
            changsha 1168.2246      0.01  -nan  0.00      0.02  -nan  0.01      -nan  -nan  -nan
forget mean min: 0.933027 0.771471
delta_x = 2.91213 delta_h = 0.547515
U_c = [[-0.07918108]] U_f = [[ 0.]] b_c = [ 0.25101119] b_f = [ 0.90928912]
incx.max(), incx.min(), incx.mean() 7.49859 0.541484 2.49407
fgtx.max(), fgtx.min(), fgtx.mean() 7.67087 0.307345 2.37402
delta mean, abs_mean, abs_mean+, abs_mean-: -0.272703 2.91213 3.00671 2.83814
W_c max, min, mean, abs_mean: 0.157415 0.151304 0.15429 0.15429
W_f max, min, mean, abs_mean: 0.164591 0.161449 0.163305 0.163305
Epoch 9/300
1s - loss: 432.9026 - val_loss: 1172.6632
Epoch 00008: val_loss did not improve
Epoch 10/300
1s - loss: 420.9233 - val_loss: 1132.9633
Epoch 00009: val_loss improved from 1168.22457 to 1132.96328, saving model to changsha_weights.hdf5
            changsha  409.5446      0.66  0.27  0.53      0.72  0.18  0.62      0.77  0.12  0.70
forget mean min: 0.929271 0.696915
delta_x = 4.8547 delta_h = 1.29809
U_c = [[-0.0672242]] U_f = [[ 0.]] b_c = [ 0.27378175] b_f = [ 0.83264929]
incx.max(), incx.min(), incx.mean() 12.0727 0.273782 3.67292
fgtx.max(), fgtx.min(), fgtx.mean() 9.95501 0.0 2.8679
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0175024 4.8547 4.85696 4.85245
W_c max, min, mean, abs_mean: 0.197672 0.190898 0.194087 0.194087
W_f max, min, mean, abs_mean: 0.16498 0.161906 0.163758 0.163758
            changsha 1132.9633      0.01  -nan  0.00      0.02  -nan  0.01      -nan  -nan  -nan
forget mean min: 0.925225 0.716005
delta_x = 3.4541 delta_h = 0.496883
U_c = [[-0.0672242]] U_f = [[ 0.]] b_c = [ 0.27378175] b_f = [ 0.83264929]
incx.max(), incx.min(), incx.mean() 9.41095 0.382981 3.04328
fgtx.max(), fgtx.min(), fgtx.mean() 7.70916 0.0920795 2.33663
delta mean, abs_mean, abs_mean+, abs_mean-: -0.1629 3.4541 3.64989 3.29334
W_c max, min, mean, abs_mean: 0.197672 0.190898 0.194087 0.194087
W_f max, min, mean, abs_mean: 0.16498 0.161906 0.163758 0.163758
Epoch 11/300
1s - loss: 411.0494 - val_loss: 1117.6011
Epoch 00010: val_loss improved from 1132.96328 to 1117.60111, saving model to changsha_weights.hdf5
            changsha  400.8781      0.65  0.26  0.53      0.71  0.17  0.62      0.75  0.11  0.69
forget mean min: 0.925584 0.690935
delta_x = 5.06955 delta_h = 1.25189
U_c = [[-0.06468546]] U_f = [[ 0.]] b_c = [ 0.28187779] b_f = [ 0.80449301]
incx.max(), incx.min(), incx.mean() 12.7756 0.281878 3.84961
fgtx.max(), fgtx.min(), fgtx.mean() 9.81302 0.0 2.8022
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0498267 5.06955 5.09542 5.04444
W_c max, min, mean, abs_mean: 0.213014 0.206055 0.209305 0.209305
W_f max, min, mean, abs_mean: 0.165594 0.162556 0.164399 0.164399
            changsha 1117.6011      0.01  -nan  0.00      0.02  -nan  0.00      -nan  -nan  -nan
forget mean min: 0.922788 0.699486
delta_x = 3.64267 delta_h = 0.48459
U_c = [[-0.06468546]] U_f = [[ 0.]] b_c = [ 0.28187779] b_f = [ 0.80449301]
incx.max(), incx.min(), incx.mean() 10.0273 0.333325 3.23463
fgtx.max(), fgtx.min(), fgtx.mean() 7.65431 0.0403593 2.31915
delta mean, abs_mean, abs_mean+, abs_mean-: -0.120825 3.64267 3.74974 3.54787
W_c max, min, mean, abs_mean: 0.213014 0.206055 0.209305 0.209305
W_f max, min, mean, abs_mean: 0.165594 0.162556 0.164399 0.164399
Epoch 12/300
1s - loss: 404.1334 - val_loss: 1132.8118
Epoch 00011: val_loss did not improve
Epoch 13/300
1s - loss: 397.6491 - val_loss: 1106.4116
Epoch 00012: val_loss improved from 1117.60111 to 1106.41162, saving model to changsha_weights.hdf5
            changsha  387.2455      0.68  0.28  0.54      0.74  0.19  0.63      0.78  0.12  0.70
forget mean min: 0.924823 0.680025
delta_x = 5.31772 delta_h = 1.1874
U_c = [[-0.06124655]] U_f = [[ 0.]] b_c = [ 0.29569939] b_f = [ 0.75388527]
incx.max(), incx.min(), incx.mean() 14.2694 0.295699 4.17455
fgtx.max(), fgtx.min(), fgtx.mean() 10.1038 0.0 2.80468
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0824994 5.31772 5.45218 5.1858
W_c max, min, mean, abs_mean: 0.237575 0.230336 0.233684 0.233684
W_f max, min, mean, abs_mean: 0.170147 0.167157 0.168974 0.168974
            changsha 1106.4116      0.01  -nan  0.00      0.02  -nan  0.00      -nan  -nan  -nan
forget mean min: 0.922607 0.695132
delta_x = 3.84818 delta_h = 0.493203
U_c = [[-0.06124655]] U_f = [[ 0.]] b_c = [ 0.29569939] b_f = [ 0.75388527]
incx.max(), incx.min(), incx.mean() 11.1918 0.393053 3.54556
fgtx.max(), fgtx.min(), fgtx.mean() 7.87861 0.070336 2.34985
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0381184 3.84818 3.87012 3.82606
W_c max, min, mean, abs_mean: 0.237575 0.230336 0.233684 0.233684
W_f max, min, mean, abs_mean: 0.170147 0.167157 0.168974 0.168974
Epoch 14/300
1s - loss: 393.0285 - val_loss: 1106.8985
Epoch 00013: val_loss did not improve
Epoch 15/300
1s - loss: 387.5000 - val_loss: 1140.0094
Epoch 00014: val_loss did not improve
Epoch 16/300
1s - loss: 384.2341 - val_loss: 1124.6900
Epoch 00015: val_loss did not improve
Epoch 17/300
1s - loss: 380.3052 - val_loss: 1103.6707
Epoch 00016: val_loss improved from 1106.41162 to 1103.67073, saving model to changsha_weights.hdf5
            changsha  369.4202      0.71  0.28  0.55      0.77  0.19  0.65      0.81  0.13  0.73
forget mean min: 0.921027 0.658822
delta_x = 5.52657 delta_h = 1.14042
U_c = [[-0.05770521]] U_f = [[ 0.]] b_c = [ 0.31565821] b_f = [ 0.65804785]
incx.max(), incx.min(), incx.mean() 16.0242 0.315658 4.41902
fgtx.max(), fgtx.min(), fgtx.mean() 10.7587 0.0 2.81041
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0833949 5.52657 5.64702 5.40769
W_c max, min, mean, abs_mean: 0.268015 0.260348 0.263859 0.263859
W_f max, min, mean, abs_mean: 0.182043 0.179007 0.180723 0.180723
            changsha 1103.6707      0.01  -nan  0.00      0.02  -nan  0.00      -nan  -nan  -nan
forget mean min: 0.92037 0.658822
delta_x = 4.02319 delta_h = 0.505597
U_c = [[-0.05770521]] U_f = [[ 0.]] b_c = [ 0.31565821] b_f = [ 0.65804785]
incx.max(), incx.min(), incx.mean() 12.2818 0.315658 3.82251
fgtx.max(), fgtx.min(), fgtx.mean() 8.19571 0.0 2.40184
delta mean, abs_mean, abs_mean+, abs_mean-: 0.119981 4.02319 3.91502 4.14474
W_c max, min, mean, abs_mean: 0.268015 0.260348 0.263859 0.263859
W_f max, min, mean, abs_mean: 0.182043 0.179007 0.180723 0.180723
Epoch 18/300
1s - loss: 376.1003 - val_loss: 1119.6553
Epoch 00017: val_loss did not improve
Epoch 19/300
1s - loss: 373.0759 - val_loss: 1128.3442
Epoch 00018: val_loss did not improve
Epoch 20/300
1s - loss: 369.9852 - val_loss: 1109.9198
Epoch 00019: val_loss did not improve
Epoch 21/300
1s - loss: 367.0424 - val_loss: 1113.4733
Epoch 00020: val_loss did not improve
Epoch 22/300
1s - loss: 364.3403 - val_loss: 1089.4686
Epoch 00021: val_loss improved from 1103.67073 to 1089.46864, saving model to changsha_weights.hdf5
            changsha  355.2734      0.64  0.24  0.53      0.70  0.14  0.62      0.73  0.09  0.68
forget mean min: 0.917488 0.63257
delta_x = 5.7152 delta_h = 1.05673
U_c = [[-0.05675734]] U_f = [[ 0.]] b_c = [ 0.34172988] b_f = [ 0.54325849]
incx.max(), incx.min(), incx.mean() 17.8753 0.34173 4.46234
fgtx.max(), fgtx.min(), fgtx.mean() 12.4294 0.0 2.92108
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0475085 5.7152 5.67573 5.75456
W_c max, min, mean, abs_mean: 0.293179 0.285031 0.288706 0.288706
W_f max, min, mean, abs_mean: 0.20627 0.203185 0.204668 0.204668
            changsha 1089.4686      0.01  -nan  0.00      0.02  -nan  0.00      -nan  -nan  -nan
forget mean min: 0.916029 0.63257
delta_x = 4.24197 delta_h = 0.473554
U_c = [[-0.05675734]] U_f = [[ 0.]] b_c = [ 0.34172988] b_f = [ 0.54325849]
incx.max(), incx.min(), incx.mean() 13.0449 0.34173 3.86979
fgtx.max(), fgtx.min(), fgtx.mean() 9.00525 0.0 2.50099
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0345266 4.24197 3.98581 4.53844
W_c max, min, mean, abs_mean: 0.293179 0.285031 0.288706 0.288706
W_f max, min, mean, abs_mean: 0.20627 0.203185 0.204668 0.204668
Epoch 23/300
1s - loss: 362.1552 - val_loss: 1096.5192
Epoch 00022: val_loss did not improve
Epoch 24/300
1s - loss: 358.4203 - val_loss: 1113.6428
Epoch 00023: val_loss did not improve
Epoch 25/300
1s - loss: 357.4784 - val_loss: 1114.1882
Epoch 00024: val_loss did not improve
Epoch 26/300
1s - loss: 353.6154 - val_loss: 1105.8884
Epoch 00025: val_loss did not improve
Epoch 27/300
1s - loss: 351.9419 - val_loss: 1116.8910
Epoch 00026: val_loss did not improve
Epoch 28/300
1s - loss: 350.1702 - val_loss: 1133.7898
Epoch 00027: val_loss did not improve
Epoch 29/300
1s - loss: 347.3053 - val_loss: 1119.6786
Epoch 00028: val_loss did not improve
Epoch 30/300
1s - loss: 345.3392 - val_loss: 1129.7674
Epoch 00029: val_loss did not improve
Epoch 31/300
1s - loss: 343.8338 - val_loss: 1146.1843
Epoch 00030: val_loss did not improve
Epoch 32/300
1s - loss: 341.0444 - val_loss: 1160.3165
Epoch 00031: val_loss did not improve
Epoch 33/300
1s - loss: 340.2187 - val_loss: 1166.5962
Epoch 00032: val_loss did not improve
Epoch 34/300
1s - loss: 338.4183 - val_loss: 1157.9467
Epoch 00033: val_loss did not improve
Epoch 35/300
1s - loss: 336.7585 - val_loss: 1167.8913
Epoch 00034: val_loss did not improve
Epoch 36/300
1s - loss: 335.7710 - val_loss: 1178.1730
Epoch 00035: val_loss did not improve
Epoch 37/300
1s - loss: 334.1527 - val_loss: 1163.5444
Epoch 00036: val_loss did not improve
Epoch 38/300
1s - loss: 331.7365 - val_loss: 1203.7786
Epoch 00037: val_loss did not improve
Epoch 39/300
1s - loss: 331.8196 - val_loss: 1192.8363
Epoch 00038: val_loss did not improve
Epoch 40/300
1s - loss: 329.6893 - val_loss: 1210.1468
Epoch 00039: val_loss did not improve
Epoch 41/300
1s - loss: 328.2163 - val_loss: 1198.7247
Epoch 00040: val_loss did not improve
Epoch 42/300
1s - loss: 328.3381 - val_loss: 1197.3720
Epoch 00041: val_loss did not improve
Epoch 43/300
1s - loss: 326.0417 - val_loss: 1227.8108
Epoch 00042: val_loss did not improve

nanjing
             nanjing  475.8550      0.49  0.31  0.40      0.53  0.28  0.44      0.58  0.23  0.50
forget mean min: 0.933797 0.703775
delta_x = 4.073 delta_h = 0.745825
U_c = [[-0.04415591]] U_f = [[ 0.]] b_c = [-0.08129719] b_f = [ 0.86533934]
incx.max(), incx.min(), incx.mean() 10.4756 -0.0812972 3.06439
fgtx.max(), fgtx.min(), fgtx.mean() 9.05105 0.0 2.69705
             nanjing 1384.5114      0.62  0.47  0.40      0.62  0.48  0.40      0.61  0.46  0.40
forget mean min: 0.964695 0.703775
delta_x = 4.05526 delta_h = 1.06869
U_c = [[-0.04415591]] U_f = [[ 0.]] b_c = [-0.08129719] b_f = [ 0.86533934]
incx.max(), incx.min(), incx.mean() 9.11913 -0.0812972 3.71097
fgtx.max(), fgtx.min(), fgtx.mean() 7.8883 0.0 3.25139

shanghai
            shanghai  340.4136      0.64  0.28  0.51      0.71  0.24  0.58      0.75  0.24  0.61
forget mean min: 0.874537 0.667087
delta_x = 4.72649 delta_h = 0.339706
U_c = [[-0.01774806]] U_f = [[ 0.]] b_c = [ 0.04979882] b_f = [ 0.69504064]
incx.max(), incx.min(), incx.mean() 19.0143 0.0497988 6.04355
fgtx.max(), fgtx.min(), fgtx.mean() 4.58419 0.0 1.4486
            shanghai 1228.4756      0.32  0.45  0.25      0.34  0.37  0.28      0.36  0.32  0.30
forget mean min: 0.896883 0.705431
delta_x = 4.97453 delta_h = 0.311964
U_c = [[-0.01774806]] U_f = [[ 0.]] b_c = [ 0.04979882] b_f = [ 0.69504064]
incx.max(), incx.min(), incx.mean() 19.3647 0.787605 6.87506
fgtx.max(), fgtx.min(), fgtx.mean() 4.66758 0.178257 1.64961

hangzhou
            hangzhou  400.9347      0.43  0.31  0.36      0.54  0.26  0.45      0.62  0.20  0.53
forget mean min: 0.939888 0.795259
delta_x = 2.60663 delta_h = 1.6701
U_c = [[-0.1190492]] U_f = [[ 0.]] b_c = [ 0.10613044] b_f = [ 1.09668541]
incx.max(), incx.min(), incx.mean() 8.60248 0.459409 2.94388
fgtx.max(), fgtx.min(), fgtx.mean() 6.25817 0.260237 2.09026
            hangzhou 1573.7192      0.15  0.61  0.12      0.16  0.60  0.13      0.15  0.58  0.12
forget mean min: 0.948824 0.795259
delta_x = 2.71408 delta_h = 1.60764
U_c = [[-0.1190492]] U_f = [[ 0.]] b_c = [ 0.10613044] b_f = [ 1.09668541]
incx.max(), incx.min(), incx.mean() 8.41306 0.459409 3.1927
fgtx.max(), fgtx.min(), fgtx.mean() 6.11865 0.260237 2.27353

hefei
               hefei  369.1974      0.72  0.24  0.59      0.82  0.21  0.68      0.87  0.15  0.76
forget mean min: 0.914041 0.55204
delta_x = 7.94003 delta_h = 1.80557
U_c = [[-0.09071856]] U_f = [[ 0.]] b_c = [-0.32395911] b_f = [ 0.20891793]
incx.max(), incx.min(), incx.mean() 45.2562 -0.323959 5.9693
fgtx.max(), fgtx.min(), fgtx.mean() 24.9069 0.0 3.48401
               hefei 4410.1995      0.71  0.45  0.45      0.73  0.41  0.49      0.73  0.36  0.52
forget mean min: 0.948317 0.584987
delta_x = 6.9641 delta_h = 2.40789
U_c = [[-0.09071856]] U_f = [[ 0.]] b_c = [-0.32395911] b_f = [ 0.20891793]
incx.max(), incx.min(), incx.mean() 30.6243 -0.102392 6.59846
fgtx.max(), fgtx.min(), fgtx.mean() 16.9472 0.134363 3.83208

wuhan
               wuhan  506.6962      0.52  0.30  0.43      0.56  0.24  0.48      0.53  0.20  0.47
forget mean min: 0.914167 0.702457
delta_x = 5.36901 delta_h = 2.27968
U_c = [[-0.13946204]] U_f = [[ 0.]] b_c = [ 0.10441595] b_f = [ 0.85902578]
incx.max(), incx.min(), incx.mean() 17.6491 0.104416 5.48517
fgtx.max(), fgtx.min(), fgtx.mean() 6.23178 0.0 1.9112
               wuhan 4093.8897      0.10  0.70  0.08      0.09  0.73  0.07      0.09  0.71  0.07
forget mean min: 0.924397 0.702457
delta_x = 3.8992 delta_h = 1.50311
U_c = [[-0.13946204]] U_f = [[ 0.]] b_c = [ 0.10441595] b_f = [ 0.85902578]
incx.max(), incx.min(), incx.mean() 13.6709 0.104416 5.37395
fgtx.max(), fgtx.min(), fgtx.mean() 4.81874 0.0 1.87169

nanchang
            nanchang  380.7882      0.52  0.30  0.43      0.58  0.24  0.49      0.61  0.20  0.53
forget mean min: 0.920297 0.614051
delta_x = 3.94122 delta_h = 0.904129
U_c = [[-0.05205778]] U_f = [[ 0.]] b_c = [ 0.00693307] b_f = [ 0.46437398]
incx.max(), incx.min(), incx.mean() 12.083 0.00693307 2.65558
fgtx.max(), fgtx.min(), fgtx.mean() 17.1116 0.0 3.75313
            nanchang 2146.8670      0.05  -nan  0.04      0.07  -nan  0.06      0.06  -nan  0.06
forget mean min: 0.916381 0.614051
delta_x = 2.99681 delta_h = 0.54914
U_c = [[-0.05205778]] U_f = [[ 0.]] b_c = [ 0.00693307] b_f = [ 0.46437398]
incx.max(), incx.min(), incx.mean() 7.9792 0.00693307 2.09584
fgtx.max(), fgtx.min(), fgtx.mean() 11.2967 0.0 2.95998

changsha
            changsha  355.2734      0.64  0.24  0.53      0.70  0.14  0.62      0.73  0.09  0.68
forget mean min: 0.917488 0.63257
delta_x = 5.7152 delta_h = 1.05673
U_c = [[-0.05675734]] U_f = [[ 0.]] b_c = [ 0.34172988] b_f = [ 0.54325849]
incx.max(), incx.min(), incx.mean() 17.8753 0.34173 4.46234
fgtx.max(), fgtx.min(), fgtx.mean() 12.4294 0.0 2.92108
            changsha 1089.4686      0.01  -nan  0.00      0.02  -nan  0.00      -nan  -nan  -nan
forget mean min: 0.916029 0.63257
delta_x = 4.24197 delta_h = 0.473554
U_c = [[-0.05675734]] U_f = [[ 0.]] b_c = [ 0.34172988] b_f = [ 0.54325849]
incx.max(), incx.min(), incx.mean() 13.0449 0.34173 3.86979
fgtx.max(), fgtx.min(), fgtx.mean() 9.00525 0.0 2.50099
