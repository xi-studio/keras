filter 0.435761835569
filter 0.630078525094
X_train[0].shape = (51582, 40, 23)

training dongbei
Train on 51582 samples, validate on 14764 samples
Before training:
             dongbei 11082.7      0.03  -nan  0.03      0.03  -nan  0.03      0.03  -nan  0.03
forget mean min: 0.73106 0.731059
delta_x = 3.71914 delta_h = 2.13374 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.71914 3.71914 nan 3.71914
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
             dongbei 10251.9      0.02  -nan  0.02      0.02  -nan  0.02      0.01  -nan  0.01
forget mean min: 0.731059 0.731059
delta_x = 4.89241 delta_h = 3.26162 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -4.89241 4.89241 nan 4.89241
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/12
5s - loss: 4862.3438 - val_loss: 4074.2843
Epoch 00000: val_loss improved from inf to 4074.28433, saving model to dongbei_weights.hdf5
             dongbei  3646.3      0.67  0.36  0.48      0.68  0.32  0.52      0.69  0.28  0.54
forget mean min: 0.911121 0.739613
delta_x = 6.42485 delta_h = 1.5085 U_c = [[-0.04279847]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.28819 6.42485 6.60575 6.17111
W_c max, min, mean, abs_mean: 0.256071 0.251959 0.255367 0.255367
W_f max, min, mean, abs_mean: 0.0565808 0.0532537 0.0558918 0.0558918
             dongbei  4074.3      0.56  0.31  0.45      0.57  0.27  0.47      0.58  0.23  0.50
forget mean min: 0.897241 0.739613
delta_x = 5.22626 delta_h = 1.28538 U_c = [[-0.04279847]]
delta mean, abs_mean, abs_mean+, abs_mean-: -0.440381 5.22626 5.1161 5.32306
W_c max, min, mean, abs_mean: 0.256071 0.251959 0.255367 0.255367
W_f max, min, mean, abs_mean: 0.0565808 0.0532537 0.0558918 0.0558918
Epoch 2/12
5s - loss: 3457.2967 - val_loss: 4103.7323
Epoch 00001: val_loss did not improve
Epoch 3/12
5s - loss: 3271.7186 - val_loss: 4235.0077
Epoch 00002: val_loss did not improve
Epoch 4/12
5s - loss: 3171.7570 - val_loss: 4319.7309
Epoch 00003: val_loss did not improve
Epoch 5/12
5s - loss: 3096.4725 - val_loss: 4347.3128
Epoch 00004: val_loss did not improve
Epoch 6/12
5s - loss: 3032.3581 - val_loss: 4384.2563
Epoch 00005: val_loss did not improve
Epoch 7/12
5s - loss: 2979.1418 - val_loss: 4431.5659
Epoch 00006: val_loss did not improve
Epoch 8/12
5s - loss: 2935.5935 - val_loss: 4573.8673
Epoch 00007: val_loss did not improve
Epoch 9/12
5s - loss: 2890.6871 - val_loss: 4719.8330
Epoch 00008: val_loss did not improve
Epoch 10/12
5s - loss: 2848.0473 - val_loss: 4885.4249
Epoch 00009: val_loss did not improve
Epoch 11/12
5s - loss: 2811.7284 - val_loss: 4898.7806
Epoch 00010: val_loss did not improve
Epoch 12/12
5s - loss: 2782.1102 - val_loss: 4875.1292
Epoch 00011: val_loss did not improve
filter 0.510613502039
filter 0.892276422764
X_train[0].shape = (73608, 40, 23)

training huabei
Train on 73608 samples, validate on 25462 samples
Before training:
              huabei  8629.6      0.02  -nan  0.02      0.02  -nan  0.02      0.01  -nan  0.01
forget mean min: 0.731061 0.731059
delta_x = 4.13487 delta_h = 2.4956 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -4.13487 4.13487 nan 4.13487
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
              huabei 20137.6      0.04  -nan  0.04      0.04  -nan  0.04      0.03  -nan  0.03
forget mean min: 0.731058 0.731059
delta_x = 6.14068 delta_h = 3.68935 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -6.14068 6.14068 nan 6.14068
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/12
8s - loss: 2829.4250 - val_loss: 5006.2308
Epoch 00000: val_loss improved from inf to 5006.23077, saving model to huabei_weights.hdf5
              huabei  2184.1      0.78  0.33  0.56      0.79  0.30  0.59      0.80  0.28  0.61
forget mean min: 0.936876 0.735735
delta_x = 6.39645 delta_h = 3.64174 U_c = [[-0.10470313]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.87548 6.39645 6.79097 5.54774
W_c max, min, mean, abs_mean: 0.264652 0.260661 0.263792 0.263792
W_f max, min, mean, abs_mean: 0.0848161 0.0811991 0.0836786 0.0836786
              huabei  5006.2      0.93  0.26  0.70      0.93  0.23  0.73      0.94  0.22  0.74
forget mean min: 0.950919 0.735735
delta_x = 7.18163 delta_h = 4.85196 U_c = [[-0.10470313]]
delta mean, abs_mean, abs_mean+, abs_mean-: 3.80372 7.18163 7.46397 6.39495
W_c max, min, mean, abs_mean: 0.264652 0.260661 0.263792 0.263792
W_f max, min, mean, abs_mean: 0.0848161 0.0811991 0.0836786 0.0836786
Epoch 2/12
8s - loss: 2134.2119 - val_loss: 4924.7510
Epoch 00001: val_loss improved from 5006.23077 to 4924.75102, saving model to huabei_weights.hdf5
              huabei  2109.1      0.76  0.31  0.56      0.77  0.28  0.59      0.78  0.25  0.61
forget mean min: 0.918669 0.678612
delta_x = 6.754 delta_h = 3.05623 U_c = [[-0.08992825]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.29359 6.754 7.08955 6.16236
W_c max, min, mean, abs_mean: 0.315567 0.311192 0.31442 0.31442
W_f max, min, mean, abs_mean: 0.0821668 0.0780171 0.0808458 0.0808458
              huabei  4924.8      0.93  0.26  0.70      0.93  0.23  0.73      0.94  0.21  0.75
forget mean min: 0.938728 0.678612
delta_x = 7.62211 delta_h = 4.41145 U_c = [[-0.08992825]]
delta mean, abs_mean, abs_mean+, abs_mean-: 3.58957 7.62211 7.93711 6.86464
W_c max, min, mean, abs_mean: 0.315567 0.311192 0.31442 0.31442
W_f max, min, mean, abs_mean: 0.0821668 0.0780171 0.0808458 0.0808458
Epoch 3/12
8s - loss: 2087.0135 - val_loss: 5019.5613
Epoch 00002: val_loss did not improve
Epoch 4/12
8s - loss: 2054.2536 - val_loss: 5221.8578
Epoch 00003: val_loss did not improve
Epoch 5/12
8s - loss: 2027.0661 - val_loss: 5038.7937
Epoch 00004: val_loss did not improve
Epoch 6/12
8s - loss: 2002.8577 - val_loss: 4997.3890
Epoch 00005: val_loss did not improve
Epoch 7/12
8s - loss: 1983.0337 - val_loss: 5187.6508
Epoch 00006: val_loss did not improve
Epoch 8/12
8s - loss: 1965.0482 - val_loss: 5079.7047
Epoch 00007: val_loss did not improve
Epoch 9/12
8s - loss: 1947.3378 - val_loss: 5027.4114
Epoch 00008: val_loss did not improve
Epoch 10/12
8s - loss: 1932.9359 - val_loss: 5373.9752
Epoch 00009: val_loss did not improve
Epoch 11/12
8s - loss: 1917.5684 - val_loss: 5297.1887
Epoch 00010: val_loss did not improve
Epoch 12/12
8s - loss: 1903.5871 - val_loss: 5386.1500
Epoch 00011: val_loss did not improve
filter 0.261174722008
filter 0.710720244716
X_train[0].shape = (18978, 40, 23)

training huaxibei
Train on 18978 samples, validate on 10223 samples
Before training:
            huaxibei  6065.2      0.02  -nan  0.02      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 3.44026 delta_h = 2.07129 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.44026 3.44026 nan 3.44026
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
            huaxibei 13587.5      0.03  -nan  0.03      0.03  -nan  0.03      0.02  -nan  0.02
forget mean min: 0.731058 0.731059
delta_x = 4.8209 delta_h = 2.84097 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -4.8209 4.8209 nan 4.8209
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/12
2s - loss: 3199.3787 - val_loss: 3962.1730
Epoch 00000: val_loss improved from inf to 3962.17301, saving model to huaxibei_weights.hdf5
            huaxibei  1834.8      0.54  0.37  0.41      0.57  0.33  0.44      0.59  0.30  0.47
forget mean min: 0.968838 0.802294
delta_x = 3.44835 delta_h = 2.79845 U_c = [[-0.12561002]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.17529 3.44835 3.65184 2.76723
W_c max, min, mean, abs_mean: 0.151152 0.147932 0.150386 0.150386
W_f max, min, mean, abs_mean: 0.125822 0.124683 0.125414 0.125414
            huaxibei  3962.2      0.76  0.27  0.59      0.76  0.24  0.61      0.77  0.22  0.63
forget mean min: 0.975651 0.803027
delta_x = 4.09258 delta_h = 3.73146 U_c = [[-0.12561002]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.65013 4.09258 4.25161 3.4835
W_c max, min, mean, abs_mean: 0.151152 0.147932 0.150386 0.150386
W_f max, min, mean, abs_mean: 0.125822 0.124683 0.125414 0.125414
Epoch 2/12
2s - loss: 1784.1104 - val_loss: 3687.5140
Epoch 00001: val_loss improved from 3962.17301 to 3687.51401, saving model to huaxibei_weights.hdf5
            huaxibei  1744.1      0.59  0.37  0.44      0.62  0.33  0.48      0.64  0.30  0.50
forget mean min: 0.956161 0.77712
delta_x = 4.14923 delta_h = 3.14764 U_c = [[-0.13196699]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.51633 4.14923 4.38666 3.39838
W_c max, min, mean, abs_mean: 0.194878 0.191284 0.193898 0.193898
W_f max, min, mean, abs_mean: 0.101447 0.100177 0.10098 0.10098
            huaxibei  3687.5      0.81  0.27  0.62      0.83  0.24  0.65      0.83  0.22  0.67
forget mean min: 0.96771 0.77712
delta_x = 5.14795 delta_h = 4.36535 U_c = [[-0.13196699]]
delta mean, abs_mean, abs_mean+, abs_mean-: 3.43698 5.14795 5.42071 4.11022
W_c max, min, mean, abs_mean: 0.194878 0.191284 0.193898 0.193898
W_f max, min, mean, abs_mean: 0.101447 0.100177 0.10098 0.10098
Epoch 3/12
2s - loss: 1720.7461 - val_loss: 3649.4242
Epoch 00002: val_loss improved from 3687.51401 to 3649.42416, saving model to huaxibei_weights.hdf5
            huaxibei  1710.2      0.55  0.34  0.43      0.58  0.30  0.46      0.59  0.26  0.49
forget mean min: 0.939074 0.753266
delta_x = 4.13582 delta_h = 2.77862 U_c = [[-0.12508287]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.1293 4.13582 4.40266 3.47769
W_c max, min, mean, abs_mean: 0.229629 0.225867 0.228529 0.228529
W_f max, min, mean, abs_mean: 0.0828715 0.0814847 0.0823544 0.0823544
            huaxibei  3649.4      0.79  0.24  0.63      0.80  0.22  0.66      0.80  0.19  0.68
forget mean min: 0.951917 0.753266
delta_x = 5.17892 delta_h = 3.90009 U_c = [[-0.12508287]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.8962 5.17892 5.52452 4.24052
W_c max, min, mean, abs_mean: 0.229629 0.225867 0.228529 0.228529
W_f max, min, mean, abs_mean: 0.0828715 0.0814847 0.0823544 0.0823544
Epoch 4/12
2s - loss: 1687.0173 - val_loss: 3499.2722
Epoch 00003: val_loss improved from 3649.42416 to 3499.27219, saving model to huaxibei_weights.hdf5
            huaxibei  1675.9      0.59  0.35  0.45      0.62  0.31  0.49      0.64  0.28  0.51
forget mean min: 0.928678 0.736935
delta_x = 4.44136 delta_h = 2.59712 U_c = [[-0.10818833]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.03302 4.44136 4.74638 3.7871
W_c max, min, mean, abs_mean: 0.255876 0.252045 0.254745 0.254745
W_f max, min, mean, abs_mean: 0.0764638 0.074967 0.0759018 0.0759018
            huaxibei  3499.3      0.82  0.25  0.64      0.83  0.22  0.67      0.84  0.20  0.69
forget mean min: 0.944418 0.736935
delta_x = 5.69144 delta_h = 3.7907 U_c = [[-0.10818833]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.98481 5.69144 6.02072 4.84247
W_c max, min, mean, abs_mean: 0.255876 0.252045 0.254745 0.254745
W_f max, min, mean, abs_mean: 0.0764638 0.074967 0.0759018 0.0759018
Epoch 5/12
2s - loss: 1667.3667 - val_loss: 3480.2650
Epoch 00004: val_loss improved from 3499.27219 to 3480.26496, saving model to huaxibei_weights.hdf5
            huaxibei  1660.8      0.63  0.37  0.46      0.66  0.33  0.50      0.68  0.30  0.53
forget mean min: 0.926252 0.726592
delta_x = 4.80843 delta_h = 2.70461 U_c = [[-0.10440935]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.27476 4.80843 5.15958 4.03982
W_c max, min, mean, abs_mean: 0.274183 0.27026 0.273004 0.273004
W_f max, min, mean, abs_mean: 0.0751471 0.0735772 0.074568 0.074568
            huaxibei  3480.3      0.84  0.27  0.64      0.86  0.24  0.68      0.87  0.21  0.70
forget mean min: 0.943423 0.726592
delta_x = 6.05325 delta_h = 3.86561 U_c = [[-0.10440935]]
delta mean, abs_mean, abs_mean+, abs_mean-: 3.29495 6.05325 6.44501 5.01925
W_c max, min, mean, abs_mean: 0.274183 0.27026 0.273004 0.273004
W_f max, min, mean, abs_mean: 0.0751471 0.0735772 0.074568 0.074568
Epoch 6/12
2s - loss: 1654.6482 - val_loss: 3620.9099
Epoch 00005: val_loss did not improve
Epoch 7/12
2s - loss: 1645.1045 - val_loss: 3499.1617
Epoch 00006: val_loss did not improve
Epoch 8/12
2s - loss: 1637.3182 - val_loss: 3559.9196
Epoch 00007: val_loss did not improve
Epoch 9/12
2s - loss: 1631.1310 - val_loss: 3526.1302
Epoch 00008: val_loss did not improve
Epoch 10/12
2s - loss: 1625.4574 - val_loss: 3406.8552
Epoch 00009: val_loss improved from 3480.26496 to 3406.85521, saving model to huaxibei_weights.hdf5
            huaxibei  1637.2      0.68  0.38  0.48      0.70  0.35  0.51      0.73  0.32  0.55
forget mean min: 0.914064 0.686546
delta_x = 5.29718 delta_h = 2.49353 U_c = [[-0.08941569]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.23786 5.29718 5.67708 4.54764
W_c max, min, mean, abs_mean: 0.323941 0.319546 0.322346 0.322346
W_f max, min, mean, abs_mean: 0.0742281 0.0722195 0.073368 0.073368
            huaxibei  3406.9      0.86  0.28  0.64      0.88  0.25  0.67      0.89  0.23  0.70
forget mean min: 0.933461 0.686546
delta_x = 6.5913 delta_h = 3.6442 U_c = [[-0.08941569]]
delta mean, abs_mean, abs_mean+, abs_mean-: 3.28619 6.5913 7.04037 5.536
W_c max, min, mean, abs_mean: 0.323941 0.319546 0.322346 0.322346
W_f max, min, mean, abs_mean: 0.0742281 0.0722195 0.073368 0.073368
Epoch 11/12
2s - loss: 1620.1018 - val_loss: 3399.5546
Epoch 00010: val_loss improved from 3406.85521 to 3399.55456, saving model to huaxibei_weights.hdf5
            huaxibei  1625.6      0.67  0.37  0.48      0.69  0.34  0.51      0.72  0.31  0.54
forget mean min: 0.911469 0.682214
delta_x = 5.25267 delta_h = 2.42249 U_c = [[-0.08952533]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.14884 5.25267 5.63289 4.52441
W_c max, min, mean, abs_mean: 0.331562 0.327118 0.329894 0.329894
W_f max, min, mean, abs_mean: 0.0737029 0.0716246 0.0727886 0.0727886
            huaxibei  3399.6      0.85  0.28  0.64      0.87  0.25  0.67      0.88  0.22  0.70
forget mean min: 0.929809 0.682214
delta_x = 6.44072 delta_h = 3.48122 U_c = [[-0.08952533]]
delta mean, abs_mean, abs_mean+, abs_mean-: 3.01869 6.44072 6.85799 5.51341
W_c max, min, mean, abs_mean: 0.331562 0.327118 0.329894 0.329894
W_f max, min, mean, abs_mean: 0.0737029 0.0716246 0.0727886 0.0727886
Epoch 12/12
2s - loss: 1615.7437 - val_loss: 3478.2810
Epoch 00011: val_loss did not improve
filter 0.193466175835
filter 0.41689881042
X_train[0].shape = (51924, 40, 23)

training huadongnan
Train on 51924 samples, validate on 22149 samples
Before training:
          huadongnan  5934.0      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.73106 0.731059
delta_x = 3.80013 delta_h = 2.31559 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.80013 3.80013 nan 3.80013
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
          huadongnan  9040.7      0.02  -nan  0.02      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 3.84188 delta_h = 2.33943 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.84188 3.84188 nan 3.84188
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/12
6s - loss: 2056.9064 - val_loss: 3074.8852
Epoch 00000: val_loss improved from inf to 3074.88517, saving model to huadongnan_weights.hdf5
          huadongnan  1452.0      0.65  0.42  0.44      0.66  0.39  0.47      0.67  0.35  0.49
forget mean min: 0.954595 0.780772
delta_x = 5.19974 delta_h = 3.59699 U_c = [[-0.14991404]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.7319 5.19974 5.47968 4.4664
W_c max, min, mean, abs_mean: 0.212234 0.208215 0.210715 0.210715
W_f max, min, mean, abs_mean: 0.100526 0.0973869 0.099537 0.099537
          huadongnan  3074.9      0.57  0.43  0.40      0.58  0.41  0.42      0.58  0.38  0.43
forget mean min: 0.957146 0.780772
delta_x = 4.43918 delta_h = 3.20618 U_c = [[-0.14991404]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.65583 4.43918 4.81579 3.38575
W_c max, min, mean, abs_mean: 0.212234 0.208215 0.210715 0.210715
W_f max, min, mean, abs_mean: 0.100526 0.0973869 0.099537 0.099537
Epoch 2/12
5s - loss: 1388.4640 - val_loss: 3088.7154
Epoch 00001: val_loss did not improve
Epoch 3/12
6s - loss: 1338.5356 - val_loss: 3074.8483
Epoch 00002: val_loss improved from 3074.88517 to 3074.84829, saving model to huadongnan_weights.hdf5
          huadongnan  1323.1      0.67  0.39  0.47      0.69  0.35  0.50      0.70  0.31  0.53
forget mean min: 0.911815 0.686434
delta_x = 7.28163 delta_h = 3.09483 U_c = [[-0.12522462]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.20245 7.28163 7.50321 6.90108
W_c max, min, mean, abs_mean: 0.332901 0.328408 0.331186 0.331186
W_f max, min, mean, abs_mean: 0.0789022 0.0739753 0.0770864 0.0770864
          huadongnan  3074.8      0.53  0.42  0.39      0.53  0.40  0.39      0.53  0.38  0.40
forget mean min: 0.915767 0.686434
delta_x = 5.70838 delta_h = 2.65819 U_c = [[-0.12522462]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.10818 5.70838 6.03188 5.113
W_c max, min, mean, abs_mean: 0.332901 0.328408 0.331186 0.331186
W_f max, min, mean, abs_mean: 0.0789022 0.0739753 0.0770864 0.0770864
Epoch 4/12
5s - loss: 1316.5842 - val_loss: 3022.2498
Epoch 00003: val_loss improved from 3074.84829 to 3022.24976, saving model to huadongnan_weights.hdf5
          huadongnan  1305.6      0.68  0.38  0.48      0.69  0.35  0.51      0.70  0.31  0.53
forget mean min: 0.909129 0.666464
delta_x = 7.47408 delta_h = 2.96574 U_c = [[-0.12000272]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.13592 7.47408 7.65565 7.16802
W_c max, min, mean, abs_mean: 0.35434 0.3497 0.352528 0.352528
W_f max, min, mean, abs_mean: 0.0853983 0.0799218 0.0833004 0.0833004
          huadongnan  3022.2      0.53  0.41  0.39      0.53  0.39  0.40      0.53  0.37  0.40
forget mean min: 0.913628 0.666464
delta_x = 5.84031 delta_h = 2.53596 U_c = [[-0.12000272]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.05679 5.84031 6.09939 5.36468
W_c max, min, mean, abs_mean: 0.35434 0.3497 0.352528 0.352528
W_f max, min, mean, abs_mean: 0.0853983 0.0799218 0.0833004 0.0833004
Epoch 5/12
5s - loss: 1299.9623 - val_loss: 3088.4815
Epoch 00004: val_loss did not improve
Epoch 6/12
6s - loss: 1286.0962 - val_loss: 3112.1001
Epoch 00005: val_loss did not improve
Epoch 7/12
6s - loss: 1275.8054 - val_loss: 3082.2791
Epoch 00006: val_loss did not improve
Epoch 8/12
5s - loss: 1266.0832 - val_loss: 3088.8625
Epoch 00007: val_loss did not improve
Epoch 9/12
5s - loss: 1257.9374 - val_loss: 3113.0256
Epoch 00008: val_loss did not improve
Epoch 10/12
6s - loss: 1251.5800 - val_loss: 3140.7176
Epoch 00009: val_loss did not improve
Epoch 11/12
5s - loss: 1246.3060 - val_loss: 3055.6761
Epoch 00010: val_loss did not improve
Epoch 12/12
5s - loss: 1241.6237 - val_loss: 3096.3389
Epoch 00011: val_loss did not improve
filter 0.110787659774
filter 0.12677484787
X_train[0].shape = (19866, 40, 23)

training huaxinan
Train on 19866 samples, validate on 4500 samples
Before training:
            huaxinan  5332.5      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 3.30754 delta_h = 1.92715 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.30754 3.30754 nan 3.30754
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
            huaxinan  7172.5      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.25362 delta_h = 1.99323 U_c = [[-0.05]]
delta mean, abs_mean, abs_mean+, abs_mean-: -3.25362 3.25362 nan 3.25362
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/12
2s - loss: 2761.5465 - val_loss: 2423.8386
Epoch 00000: val_loss improved from inf to 2423.83864, saving model to huaxinan_weights.hdf5
            huaxinan  1457.4      0.53  0.42  0.39      0.56  0.36  0.42      0.56  0.33  0.44
forget mean min: 0.975301 0.832912
delta_x = 3.9012 delta_h = 3.17322 U_c = [[-0.12535094]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.57853 3.9012 3.976 3.57196
W_c max, min, mean, abs_mean: 0.144401 0.140938 0.143507 0.143507
W_f max, min, mean, abs_mean: 0.155919 0.153606 0.155325 0.155325
            huaxinan  2423.8      0.46  0.36  0.37      0.49  0.29  0.41      0.49  0.27  0.42
forget mean min: 0.975301 0.832912
delta_x = 3.44814 delta_h = 3.00608 U_c = [[-0.12535094]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.30624 3.44814 3.60794 2.81895
W_c max, min, mean, abs_mean: 0.144401 0.140938 0.143507 0.143507
W_f max, min, mean, abs_mean: 0.155919 0.153606 0.155325 0.155325
Epoch 2/12
2s - loss: 1404.3187 - val_loss: 2378.9245
Epoch 00001: val_loss improved from 2423.83864 to 2378.92454, saving model to huaxinan_weights.hdf5
            huaxinan  1372.6      0.62  0.41  0.43      0.64  0.36  0.47      0.65  0.33  0.49
forget mean min: 0.972698 0.824893
delta_x = 3.87315 delta_h = 2.81132 U_c = [[-0.10242617]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.38399 3.87315 3.89677 3.77697
W_c max, min, mean, abs_mean: 0.153564 0.150077 0.152725 0.152725
W_f max, min, mean, abs_mean: 0.157755 0.154816 0.156989 0.156989
            huaxinan  2378.9      0.59  0.37  0.43      0.62  0.32  0.48      0.62  0.30  0.49
forget mean min: 0.975049 0.824893
delta_x = 3.57687 delta_h = 2.80052 U_c = [[-0.10242617]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.4325 3.57687 3.75732 2.85647
W_c max, min, mean, abs_mean: 0.153564 0.150077 0.152725 0.152725
W_f max, min, mean, abs_mean: 0.157755 0.154816 0.156989 0.156989
Epoch 3/12
2s - loss: 1341.8236 - val_loss: 2353.1297
Epoch 00002: val_loss improved from 2378.92454 to 2353.12970, saving model to huaxinan_weights.hdf5
            huaxinan  1319.3      0.63  0.39  0.45      0.65  0.34  0.49      0.66  0.31  0.51
forget mean min: 0.960473 0.793755
delta_x = 4.17996 delta_h = 2.45589 U_c = [[-0.08837893]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.11448 4.17996 4.43114 3.56427
W_c max, min, mean, abs_mean: 0.18197 0.178396 0.181114 0.181114
W_f max, min, mean, abs_mean: 0.137606 0.134329 0.136899 0.136899
            huaxinan  2353.1      0.61  0.38  0.44      0.64  0.33  0.49      0.64  0.32  0.50
forget mean min: 0.963857 0.793755
delta_x = 4.18159 delta_h = 2.54313 U_c = [[-0.08837893]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.33211 4.18159 4.56511 3.22685
W_c max, min, mean, abs_mean: 0.18197 0.178396 0.181114 0.181114
W_f max, min, mean, abs_mean: 0.137606 0.134329 0.136899 0.136899
Epoch 4/12
2s - loss: 1297.0294 - val_loss: 2284.2632
Epoch 00003: val_loss improved from 2353.12970 to 2284.26321, saving model to huaxinan_weights.hdf5
            huaxinan  1283.0      0.61  0.36  0.45      0.62  0.31  0.49      0.63  0.28  0.51
forget mean min: 0.945983 0.76966
delta_x = 4.87757 delta_h = 2.07326 U_c = [[-0.07780676]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.72432 4.87757 5.5081 3.93456
W_c max, min, mean, abs_mean: 0.209197 0.205573 0.208341 0.208341
W_f max, min, mean, abs_mean: 0.123306 0.11986 0.122575 0.122575
            huaxinan  2284.3      0.62  0.38  0.45      0.64  0.34  0.49      0.64  0.32  0.49
forget mean min: 0.951925 0.76966
delta_x = 5.13529 delta_h = 2.28546 U_c = [[-0.07780676]]
delta mean, abs_mean, abs_mean+, abs_mean-: 2.13488 5.13529 5.86036 3.95086
W_c max, min, mean, abs_mean: 0.209197 0.205573 0.208341 0.208341
W_f max, min, mean, abs_mean: 0.123306 0.11986 0.122575 0.122575
Epoch 5/12
2s - loss: 1276.3663 - val_loss: 2306.2964
Epoch 00004: val_loss did not improve
Epoch 6/12
2s - loss: 1265.5836 - val_loss: 2283.6446
Epoch 00005: val_loss improved from 2284.26321 to 2283.64461, saving model to huaxinan_weights.hdf5
            huaxinan  1260.1      0.59  0.35  0.45      0.60  0.30  0.48      0.61  0.26  0.50
forget mean min: 0.934752 0.746023
delta_x = 5.5676 delta_h = 1.7828 U_c = [[-0.06847263]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.41241 5.5676 6.52795 4.46435
W_c max, min, mean, abs_mean: 0.229441 0.225782 0.228551 0.228551
W_f max, min, mean, abs_mean: 0.119018 0.115403 0.118281 0.118281
            huaxinan  2283.6      0.60  0.37  0.44      0.63  0.31  0.49      0.63  0.30  0.50
forget mean min: 0.940592 0.746023
delta_x = 6.01967 delta_h = 1.96961 U_c = [[-0.06847263]]
delta mean, abs_mean, abs_mean+, abs_mean-: 1.79809 6.01967 6.94479 4.82852
W_c max, min, mean, abs_mean: 0.229441 0.225782 0.228551 0.228551
W_f max, min, mean, abs_mean: 0.119018 0.115403 0.118281 0.118281
Epoch 7/12
2s - loss: 1258.1043 - val_loss: 2348.4943
Epoch 00006: val_loss did not improve
Epoch 8/12
2s - loss: 1251.9047 - val_loss: 2332.5176
Epoch 00007: val_loss did not improve
Epoch 9/12
2s - loss: 1245.1739 - val_loss: 2375.7285
Epoch 00008: val_loss did not improve
Epoch 10/12
2s - loss: 1239.4921 - val_loss: 2318.7850
Epoch 00009: val_loss did not improve
Epoch 11/12
2s - loss: 1233.7406 - val_loss: 2362.6247
Epoch 00010: val_loss did not improve
Epoch 12/12
2s - loss: 1227.3576 - val_loss: 2344.1226
Epoch 00011: val_loss did not improve

dongbei
             dongbei  2185.6      0.63  0.48  0.40      0.67  0.45  0.43      0.69  0.42  0.46
forget mean min: 0.89947 0.739613
delta_x = 5.38883 delta_h = 1.19237 U_c = [[-0.04279847]]
             dongbei  2955.0      0.56  0.38  0.42      0.58  0.34  0.45      0.60  0.31  0.47
forget mean min: 0.892604 0.739613
delta_x = 4.95256 delta_h = 1.26773 U_c = [[-0.04279847]]

huabei
              huabei  1577.5      0.73  0.42  0.48      0.76  0.40  0.50      0.77  0.38  0.53
forget mean min: 0.909794 0.678612
delta_x = 6.01473 delta_h = 2.58917 U_c = [[-0.08992825]]
              huabei  4633.1      0.93  0.29  0.67      0.93  0.26  0.70      0.94  0.25  0.72
forget mean min: 0.936785 0.678612
delta_x = 7.39331 delta_h = 4.23848 U_c = [[-0.08992825]]

huaxibei
            huaxibei  1024.2      0.60  0.57  0.33      0.66  0.56  0.36      0.70  0.55  0.38
forget mean min: 0.899335 0.682214
delta_x = 4.79508 delta_h = 1.94721 U_c = [[-0.08952533]]
            huaxibei  2818.8      0.82  0.34  0.58      0.86  0.31  0.62      0.87  0.28  0.65
forget mean min: 0.92473 0.682214
delta_x = 6.14177 delta_h = 3.1686 U_c = [[-0.08952533]]

huadongnan
          huadongnan   662.8      0.59  0.52  0.36      0.64  0.50  0.39      0.67  0.46  0.42
forget mean min: 0.892733 0.666464
delta_x = 5.7576 delta_h = 2.14109 U_c = [[-0.12000272]]
          huadongnan  1587.7      0.50  0.49  0.34      0.52  0.48  0.35      0.52  0.46  0.36
forget mean min: 0.901932 0.666464
delta_x = 4.87877 delta_h = 2.19656 U_c = [[-0.12000272]]

huaxinan
            huaxinan   611.5      0.52  0.60  0.29      0.57  0.59  0.31      0.59  0.58  0.32
forget mean min: 0.913976 0.746023
delta_x = 4.83932 delta_h = 1.21977 U_c = [[-0.06847263]]
            huaxinan   778.1      0.51  0.58  0.30      0.57  0.56  0.33      0.60  0.55  0.35
forget mean min: 0.927501 0.746023
delta_x = 5.08259 delta_h = 1.38712 U_c = [[-0.06847263]]
