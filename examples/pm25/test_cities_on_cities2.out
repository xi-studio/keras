X_train[0].shape = (7032, 40, 23)

training beijing
Train on 7032 samples, validate on 1392 samples
Before training:
             beijing 9494.5161      0.03  -nan  0.03      0.03  -nan  0.03      0.02  -nan  0.02
forget mean min: 0.731058 0.731059
delta_x = 3.86167 delta_h = 2.49769
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.86167 3.86167 nan 3.86167
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
             beijing29096.3478      0.06  -nan  0.06      0.07  -nan  0.07      0.06  -nan  0.06
forget mean min: 0.731059 0.731059
delta_x = 8.09076 delta_h = 5.0167
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -8.09076 8.09076 nan 8.09076
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 5619.6902 - val_loss: 6930.5819
Epoch 00000: val_loss improved from inf to 6930.58194, saving model to beijing_weights.hdf5
             beijing 2405.6054      0.82  0.28  0.63      0.83  0.26  0.64      0.81  0.25  0.64
forget mean min: 0.918736 0.790565
delta_x = 5.57826 delta_h = 2.62037
U_c = [[-0.06385978]] U_f = [[ 0.]] b_c = [ 0.11073997] b_f = [ 1.07629502]
incx.max(), incx.min(), incx.mean() 11.2582 0.422858 3.74193
fgtx.max(), fgtx.min(), fgtx.mean() 9.00151 0.252041 2.93217
delta mean, abs_mean, abs_mean+, abs_mean-: 0.752167 5.57826 5.41302 5.81095
W_c max, min, mean, abs_mean: 0.144587 0.141676 0.144083 0.144083
W_f max, min, mean, abs_mean: 0.116772 0.115929 0.116349 0.116349
             beijing 6930.5821      0.89  0.15  0.76      0.89  0.12  0.79      0.91  0.10  0.82
forget mean min: 0.931255 0.790565
delta_x = 7.64395 delta_h = 4.27753
U_c = [[-0.06385978]] U_f = [[ 0.]] b_c = [ 0.11073997] b_f = [ 1.07629502]
incx.max(), incx.min(), incx.mean() 11.1362 0.422858 4.30678
fgtx.max(), fgtx.min(), fgtx.mean() 8.90299 0.252041 3.38828
delta mean, abs_mean, abs_mean+, abs_mean-: -0.511985 7.64395 5.72762 10.8052
W_c max, min, mean, abs_mean: 0.144587 0.141676 0.144083 0.144083
W_f max, min, mean, abs_mean: 0.116772 0.115929 0.116349 0.116349
Epoch 2/300
1s - loss: 2004.9807 - val_loss: 6980.9852
Epoch 00001: val_loss did not improve
Epoch 3/300
1s - loss: 1780.0647 - val_loss: 7222.8375
Epoch 00002: val_loss did not improve
Epoch 4/300
1s - loss: 1699.3459 - val_loss: 7089.7771
Epoch 00003: val_loss did not improve
Epoch 5/300
1s - loss: 1629.9097 - val_loss: 6938.6495
Epoch 00004: val_loss did not improve
Epoch 6/300
1s - loss: 1562.5553 - val_loss: 6852.8208
Epoch 00005: val_loss improved from 6930.58194 to 6852.82080, saving model to beijing_weights.hdf5
             beijing 1513.6024      0.87  0.23  0.69      0.88  0.21  0.71      0.88  0.19  0.73
forget mean min: 0.894714 0.666018
delta_x = 6.65175 delta_h = 1.05252
U_c = [[-0.02044622]] U_f = [[ 0.]] b_c = [ 0.1149696] b_f = [ 0.69023174]
incx.max(), incx.min(), incx.mean() 13.0762 0.11497 3.87393
fgtx.max(), fgtx.min(), fgtx.mean() 16.3137 0.0 4.73124
delta mean, abs_mean, abs_mean+, abs_mean-: 0.390382 6.65175 5.74881 8.07889
W_c max, min, mean, abs_mean: 0.165679 0.162693 0.165067 0.165067
W_f max, min, mean, abs_mean: 0.208382 0.206876 0.207764 0.207764
             beijing 6852.8207      0.84  0.12  0.76      0.84  0.09  0.78      0.86  0.06  0.81
forget mean min: 0.913154 0.666018
delta_x = 8.4689 delta_h = 1.70182
U_c = [[-0.02044622]] U_f = [[ 0.]] b_c = [ 0.1149696] b_f = [ 0.69023174]
incx.max(), incx.min(), incx.mean() 12.5624 0.11497 4.24646
fgtx.max(), fgtx.min(), fgtx.mean() 15.667 0.0 5.20011
delta mean, abs_mean, abs_mean+, abs_mean-: -0.914407 8.4689 5.91559 12.9791
W_c max, min, mean, abs_mean: 0.165679 0.162693 0.165067 0.165067
W_f max, min, mean, abs_mean: 0.208382 0.206876 0.207764 0.207764
Epoch 7/300
1s - loss: 1497.3991 - val_loss: 6780.1103
Epoch 00006: val_loss improved from 6852.82080 to 6780.11029, saving model to beijing_weights.hdf5
             beijing 1451.8930      0.87  0.22  0.69      0.88  0.20  0.72      0.88  0.18  0.74
forget mean min: 0.891036 0.646975
delta_x = 6.80821 delta_h = 0.992872
U_c = [[-0.01895491]] U_f = [[ 0.]] b_c = [ 0.12109932] b_f = [ 0.60576826]
incx.max(), incx.min(), incx.mean() 13.6581 0.121099 3.8937
fgtx.max(), fgtx.min(), fgtx.mean() 19.5421 0.0 5.44615
delta mean, abs_mean, abs_mean+, abs_mean-: 0.386103 6.80821 5.74163 8.59729
W_c max, min, mean, abs_mean: 0.170156 0.167173 0.169546 0.169546
W_f max, min, mean, abs_mean: 0.245439 0.243861 0.24476 0.24476
             beijing 6780.1103      0.84  0.12  0.75      0.84  0.09  0.78      0.86  0.07  0.81
forget mean min: 0.910932 0.646975
delta_x = 8.81398 delta_h = 1.64697
U_c = [[-0.01895491]] U_f = [[ 0.]] b_c = [ 0.12109932] b_f = [ 0.60576826]
incx.max(), incx.min(), incx.mean() 13.4523 0.121099 4.38939
fgtx.max(), fgtx.min(), fgtx.mean() 19.245 0.0 6.16173
delta mean, abs_mean, abs_mean+, abs_mean-: -0.754243 8.81398 6.051 14.323
W_c max, min, mean, abs_mean: 0.170156 0.167173 0.169546 0.169546
W_f max, min, mean, abs_mean: 0.245439 0.243861 0.24476 0.24476
Epoch 8/300
1s - loss: 1450.1947 - val_loss: 6740.8446
Epoch 00007: val_loss improved from 6780.11029 to 6740.84458, saving model to beijing_weights.hdf5
             beijing 1439.8358      0.89  0.24  0.69      0.90  0.22  0.72      0.90  0.19  0.74
forget mean min: 0.889922 0.627263
delta_x = 7.18499 delta_h = 0.868381
U_c = [[-0.01574635]] U_f = [[ 0.]] b_c = [ 0.13507926] b_f = [ 0.52049249]
incx.max(), incx.min(), incx.mean() 15.0783 0.135079 4.12043
fgtx.max(), fgtx.min(), fgtx.mean() 23.449 0.0 6.25384
delta mean, abs_mean, abs_mean+, abs_mean-: 0.538421 7.18499 5.95349 9.45849
W_c max, min, mean, abs_mean: 0.178506 0.175532 0.177906 0.177906
W_f max, min, mean, abs_mean: 0.280147 0.278291 0.279173 0.279173
             beijing 6740.8445      0.85  0.12  0.76      0.85  0.09  0.78      0.87  0.07  0.81
forget mean min: 0.907294 0.627263
delta_x = 9.37409 delta_h = 1.44784
U_c = [[-0.01574635]] U_f = [[ 0.]] b_c = [ 0.13507926] b_f = [ 0.52049249]
incx.max(), incx.min(), incx.mean() 14.8019 0.135079 4.68816
fgtx.max(), fgtx.min(), fgtx.mean() 23.0153 0.0 7.14469
delta mean, abs_mean, abs_mean+, abs_mean-: -0.577727 9.37409 6.41713 15.8156
W_c max, min, mean, abs_mean: 0.178506 0.175532 0.177906 0.177906
W_f max, min, mean, abs_mean: 0.280147 0.278291 0.279173 0.279173
Epoch 9/300
1s - loss: 1412.9695 - val_loss: 6449.2466
Epoch 00008: val_loss improved from 6740.84458 to 6449.24662, saving model to beijing_weights.hdf5
             beijing 1363.7711      0.87  0.21  0.71      0.89  0.19  0.74      0.89  0.16  0.76
forget mean min: 0.883761 0.608278
delta_x = 7.12286 delta_h = 1.01981
U_c = [[-0.01943632]] U_f = [[ 0.]] b_c = [ 0.14996576] b_f = [ 0.44007903]
incx.max(), incx.min(), incx.mean() 15.6078 0.149966 4.0288
fgtx.max(), fgtx.min(), fgtx.mean() 25.0405 0.0 6.28339
delta mean, abs_mean, abs_mean+, abs_mean-: 0.393325 7.12286 5.83595 9.45043
W_c max, min, mean, abs_mean: 0.185108 0.182137 0.184518 0.184518
W_f max, min, mean, abs_mean: 0.30006 0.297691 0.298907 0.298907
             beijing 6449.2467      0.85  0.11  0.77      0.85  0.08  0.79      0.87  0.06  0.82
forget mean min: 0.902145 0.608278
delta_x = 9.31178 delta_h = 1.75143
U_c = [[-0.01943632]] U_f = [[ 0.]] b_c = [ 0.14996576] b_f = [ 0.44007903]
incx.max(), incx.min(), incx.mean() 15.3839 0.149966 4.62748
fgtx.max(), fgtx.min(), fgtx.mean() 24.6777 0.0 7.25318
delta mean, abs_mean, abs_mean+, abs_mean-: -0.647368 9.31178 6.26425 16.1453
W_c max, min, mean, abs_mean: 0.185108 0.182137 0.184518 0.184518
W_f max, min, mean, abs_mean: 0.30006 0.297691 0.298907 0.298907
Epoch 10/300
1s - loss: 1378.0188 - val_loss: 6443.9881
Epoch 00009: val_loss improved from 6449.24662 to 6443.98809, saving model to beijing_weights.hdf5
             beijing 1331.8882      0.88  0.21  0.71      0.89  0.18  0.74      0.89  0.15  0.77
forget mean min: 0.879543 0.590084
delta_x = 7.262 delta_h = 0.947556
U_c = [[-0.0178592]] U_f = [[ 0.]] b_c = [ 0.16492368] b_f = [ 0.36431143]
incx.max(), incx.min(), incx.mean() 16.3295 0.164924 4.09433
fgtx.max(), fgtx.min(), fgtx.mean() 26.9918 0.0 6.56136
delta mean, abs_mean, abs_mean+, abs_mean-: 0.395789 7.262 5.8772 9.85059
W_c max, min, mean, abs_mean: 0.192004 0.188957 0.191346 0.191346
W_f max, min, mean, abs_mean: 0.320851 0.317972 0.319515 0.319515
             beijing 6443.9881      0.85  0.11  0.77      0.85  0.08  0.79      0.87  0.06  0.82
forget mean min: 0.897467 0.590084
delta_x = 9.49234 delta_h = 1.63987
U_c = [[-0.0178592]] U_f = [[ 0.]] b_c = [ 0.16492368] b_f = [ 0.36431143]
incx.max(), incx.min(), incx.mean() 16.1888 0.164924 4.69252
fgtx.max(), fgtx.min(), fgtx.mean() 26.7569 0.0 7.5602
delta mean, abs_mean, abs_mean+, abs_mean-: -0.653246 9.49234 6.30813 16.9438
W_c max, min, mean, abs_mean: 0.192004 0.188957 0.191346 0.191346
W_f max, min, mean, abs_mean: 0.320851 0.317972 0.319515 0.319515
Epoch 11/300
1s - loss: 1347.9419 - val_loss: 6255.7192
Epoch 00010: val_loss improved from 6443.98809 to 6255.71917, saving model to beijing_weights.hdf5
             beijing 1308.1592      0.87  0.20  0.72      0.89  0.17  0.75      0.89  0.14  0.78
forget mean min: 0.873594 0.572731
delta_x = 7.3478 delta_h = 1.01577
U_c = [[-0.01921792]] U_f = [[ 0.]] b_c = [ 0.17877877] b_f = [ 0.29300064]
incx.max(), incx.min(), incx.mean() 16.9543 0.178779 4.12127
fgtx.max(), fgtx.min(), fgtx.mean() 28.7435 0.0 6.75513
delta mean, abs_mean, abs_mean+, abs_mean-: 0.36464 7.3478 5.93794 9.95946
W_c max, min, mean, abs_mean: 0.197783 0.194651 0.197057 0.197057
W_f max, min, mean, abs_mean: 0.339341 0.335736 0.337644 0.337644
             beijing 6255.7192      0.85  0.10  0.77      0.85  0.07  0.80      0.87  0.05  0.83
forget mean min: 0.891714 0.572731
delta_x = 9.62241 delta_h = 1.77088
U_c = [[-0.01921792]] U_f = [[ 0.]] b_c = [ 0.17877877] b_f = [ 0.29300064]
incx.max(), incx.min(), incx.mean() 16.7058 0.178779 4.73795
fgtx.max(), fgtx.min(), fgtx.mean() 28.3177 0.0 7.81173
delta mean, abs_mean, abs_mean+, abs_mean-: -0.660115 9.62241 6.412 17.0731
W_c max, min, mean, abs_mean: 0.197783 0.194651 0.197057 0.197057
W_f max, min, mean, abs_mean: 0.339341 0.335736 0.337644 0.337644
Epoch 12/300
1s - loss: 1322.5942 - val_loss: 6293.7242
Epoch 00011: val_loss did not improve
Epoch 13/300
1s - loss: 1303.8779 - val_loss: 6347.9524
Epoch 00012: val_loss did not improve
Epoch 14/300
1s - loss: 1280.3378 - val_loss: 6380.8453
Epoch 00013: val_loss did not improve
Epoch 15/300
1s - loss: 1268.4463 - val_loss: 6244.0905
Epoch 00014: val_loss improved from 6255.71917 to 6244.09051, saving model to beijing_weights.hdf5
             beijing 1225.7640      0.89  0.19  0.73      0.90  0.16  0.76      0.90  0.13  0.80
forget mean min: 0.869962 0.512862
delta_x = 7.75671 delta_h = 0.904572
U_c = [[-0.01699352]] U_f = [[ 0.]] b_c = [ 0.24056761] b_f = [ 0.05145952]
incx.max(), incx.min(), incx.mean() 18.9141 0.240568 4.38887
fgtx.max(), fgtx.min(), fgtx.mean() 33.1613 0.0 7.36669
delta mean, abs_mean, abs_mean+, abs_mean-: 0.395375 7.75671 6.13734 10.9589
W_c max, min, mean, abs_mean: 0.222523 0.218949 0.221489 0.221489
W_f max, min, mean, abs_mean: 0.396911 0.389108 0.393335 0.393335
             beijing 6244.0905      0.85  0.09  0.79      0.85  0.06  0.81      0.87  0.05  0.84
forget mean min: 0.884572 0.512862
delta_x = 9.66795 delta_h = 1.55983
U_c = [[-0.01699352]] U_f = [[ 0.]] b_c = [ 0.24056761] b_f = [ 0.05145952]
incx.max(), incx.min(), incx.mean() 18.4137 0.240568 4.81211
fgtx.max(), fgtx.min(), fgtx.mean() 32.2724 0.0 8.11822
delta mean, abs_mean, abs_mean+, abs_mean-: -0.72702 9.66795 6.40759 17.1922
W_c max, min, mean, abs_mean: 0.222523 0.218949 0.221489 0.221489
W_f max, min, mean, abs_mean: 0.396911 0.389108 0.393335 0.393335
Epoch 16/300
1s - loss: 1244.3513 - val_loss: 6449.5857
Epoch 00015: val_loss did not improve
Epoch 17/300
1s - loss: 1214.3749 - val_loss: 6571.4744
Epoch 00016: val_loss did not improve
Epoch 18/300
1s - loss: 1195.2688 - val_loss: 6780.9025
Epoch 00017: val_loss did not improve
Epoch 19/300
1s - loss: 1176.3109 - val_loss: 6784.1718
Epoch 00018: val_loss did not improve
Epoch 20/300
1s - loss: 1162.5826 - val_loss: 7006.4596
Epoch 00019: val_loss did not improve
Epoch 21/300
1s - loss: 1150.8726 - val_loss: 7160.6527
Epoch 00020: val_loss did not improve
Epoch 22/300
1s - loss: 1140.9291 - val_loss: 7293.6124
Epoch 00021: val_loss did not improve
Epoch 23/300
1s - loss: 1131.6925 - val_loss: 7094.9928
Epoch 00022: val_loss did not improve
Epoch 24/300
1s - loss: 1121.8555 - val_loss: 7059.4861
Epoch 00023: val_loss did not improve
Epoch 25/300
1s - loss: 1119.3822 - val_loss: 7084.3127
Epoch 00024: val_loss did not improve
Epoch 26/300
1s - loss: 1112.6653 - val_loss: 7785.3194
Epoch 00025: val_loss did not improve
Epoch 27/300
1s - loss: 1105.5504 - val_loss: 7166.2649
Epoch 00026: val_loss did not improve
Epoch 28/300
1s - loss: 1102.9213 - val_loss: 7190.2085
Epoch 00027: val_loss did not improve
Epoch 29/300
1s - loss: 1095.9854 - val_loss: 7630.6809
Epoch 00028: val_loss did not improve
Epoch 30/300
1s - loss: 1092.7112 - val_loss: 7904.6065
Epoch 00029: val_loss did not improve
Epoch 31/300
1s - loss: 1085.8444 - val_loss: 7756.3734
Epoch 00030: val_loss did not improve
Epoch 32/300
1s - loss: 1078.8532 - val_loss: 8077.8582
Epoch 00031: val_loss did not improve
Epoch 33/300
1s - loss: 1074.0567 - val_loss: 8089.0090
Epoch 00032: val_loss did not improve
Epoch 34/300
1s - loss: 1069.5956 - val_loss: 8095.0016
Epoch 00033: val_loss did not improve
Epoch 35/300
1s - loss: 1073.4975 - val_loss: 8208.6917
Epoch 00034: val_loss did not improve
Epoch 36/300
1s - loss: 1064.0924 - val_loss: 8121.8713
Epoch 00035: val_loss did not improve
X_train[0].shape = (5274, 40, 23)

training tianjin
Train on 5274 samples, validate on 1044 samples
Before training:
             tianjin 5015.6057      0.02  -nan  0.02      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.33852 delta_h = 2.15111
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.33852 3.33852 nan 3.33852
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
             tianjin18553.9317      0.04  -nan  0.04      0.04  -nan  0.04      0.02  -nan  0.02
forget mean min: 0.731059 0.731059
delta_x = 5.9573 delta_h = 3.61017
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -5.9573 5.9573 nan 5.9573
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 3294.9116 - val_loss: 7084.9011
Epoch 00000: val_loss improved from inf to 7084.90113, saving model to tianjin_weights.hdf5
             tianjin 1428.4398      0.48  0.14  0.44      0.50  0.07  0.48      0.49  0.04  0.47
forget mean min: 0.938194 0.787377
delta_x = 3.14638 delta_h = 2.08329
U_c = [[-0.09938756]] U_f = [[ 0.]] b_c = [ 0.08906879] b_f = [ 1.08181596]
incx.max(), incx.min(), incx.mean() 5.27295 0.331021 2.56141
fgtx.max(), fgtx.min(), fgtx.mean() 4.87116 0.227373 2.3232
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0143629 3.14638 2.53382 4.16171
W_c max, min, mean, abs_mean: 0.120223 0.117666 0.11943 0.11943
W_f max, min, mean, abs_mean: 0.112619 0.111897 0.112231 0.112231
             tianjin 7084.9012      0.83  0.25  0.65      0.83  0.24  0.65      0.82  0.22  0.67
forget mean min: 0.953128 0.787377
delta_x = 3.60934 delta_h = 2.62409
U_c = [[-0.09938756]] U_f = [[ 0.]] b_c = [ 0.08906879] b_f = [ 1.08181596]
incx.max(), incx.min(), incx.mean() 4.46752 0.331021 2.82106
fgtx.max(), fgtx.min(), fgtx.mean() 4.1143 0.227373 2.56718
delta mean, abs_mean, abs_mean+, abs_mean-: -0.58742 3.60934 2.4246 5.56866
W_c max, min, mean, abs_mean: 0.120223 0.117666 0.11943 0.11943
W_f max, min, mean, abs_mean: 0.112619 0.111897 0.112231 0.112231
Epoch 2/300
0s - loss: 1193.0191 - val_loss: 5188.6012
Epoch 00001: val_loss improved from 7084.90113 to 5188.60120, saving model to tianjin_weights.hdf5
             tianjin 1111.0517      0.78  0.26  0.61      0.82  0.21  0.67      0.81  0.17  0.70
forget mean min: 0.928835 0.765082
delta_x = 4.88748 delta_h = 2.59039
U_c = [[-0.0829851]] U_f = [[ 0.]] b_c = [ 0.09851131] b_f = [ 1.03090549]
incx.max(), incx.min(), incx.mean() 8.44533 0.282834 3.54366
fgtx.max(), fgtx.min(), fgtx.mean() 6.78499 0.14984 2.80051
delta mean, abs_mean, abs_mean+, abs_mean-: 0.870581 4.88748 4.35222 5.93355
W_c max, min, mean, abs_mean: 0.146795 0.14428 0.146021 0.146021
W_f max, min, mean, abs_mean: 0.119164 0.118059 0.118702 0.118702
             tianjin 5188.6012      0.91  0.25  0.70      0.91  0.24  0.71      0.93  0.22  0.74
forget mean min: 0.948197 0.765082
delta_x = 6.36941 delta_h = 3.41158
U_c = [[-0.0829851]] U_f = [[ 0.]] b_c = [ 0.09851131] b_f = [ 1.03090549]
incx.max(), incx.min(), incx.mean() 7.99898 0.282834 4.35038
fgtx.max(), fgtx.min(), fgtx.mean() 6.42219 0.14984 3.45629
delta mean, abs_mean, abs_mean+, abs_mean-: 0.881995 6.36941 5.23509 8.92485
W_c max, min, mean, abs_mean: 0.146795 0.14428 0.146021 0.146021
W_f max, min, mean, abs_mean: 0.119164 0.118059 0.118702 0.118702
Epoch 3/300
0s - loss: 1086.5813 - val_loss: 5280.8720
Epoch 00002: val_loss did not improve
Epoch 4/300
0s - loss: 1052.0496 - val_loss: 5119.1513
Epoch 00003: val_loss improved from 5188.60120 to 5119.15133, saving model to tianjin_weights.hdf5
             tianjin 1034.9711      0.79  0.28  0.61      0.83  0.22  0.67      0.82  0.19  0.69
forget mean min: 0.918622 0.713493
delta_x = 5.58128 delta_h = 3.00289
U_c = [[-0.09269657]] U_f = [[ 0.]] b_c = [ 0.08972736] b_f = [ 0.91240805]
incx.max(), incx.min(), incx.mean() 10.9045 0.0897274 3.89883
fgtx.max(), fgtx.min(), fgtx.mean() 8.68295 0.0 3.05822
delta mean, abs_mean, abs_mean+, abs_mean-: 0.968563 5.58128 5.0474 6.56772
W_c max, min, mean, abs_mean: 0.163379 0.160967 0.162657 0.162657
W_f max, min, mean, abs_mean: 0.131698 0.129339 0.130595 0.130595
             tianjin 5119.1513      0.91  0.24  0.71      0.91  0.24  0.71      0.93  0.22  0.73
forget mean min: 0.937322 0.713493
delta_x = 7.31054 delta_h = 4.00138
U_c = [[-0.09269657]] U_f = [[ 0.]] b_c = [ 0.08972736] b_f = [ 0.91240805]
incx.max(), incx.min(), incx.mean() 10.9737 0.0897274 4.81122
fgtx.max(), fgtx.min(), fgtx.mean() 8.73846 0.0 3.79078
delta mean, abs_mean, abs_mean+, abs_mean-: 0.991354 7.31054 6.00823 10.2211
W_c max, min, mean, abs_mean: 0.163379 0.160967 0.162657 0.162657
W_f max, min, mean, abs_mean: 0.131698 0.129339 0.130595 0.130595
Epoch 5/300
0s - loss: 1027.4513 - val_loss: 4812.3558
Epoch 00004: val_loss improved from 5119.15133 to 4812.35582, saving model to tianjin_weights.hdf5
             tianjin 1013.6066      0.79  0.26  0.62      0.82  0.21  0.67      0.81  0.18  0.69
forget mean min: 0.91664 0.699482
delta_x = 5.5956 delta_h = 2.95135
U_c = [[-0.09127723]] U_f = [[ 0.]] b_c = [ 0.0812972] b_f = [ 0.84483087]
incx.max(), incx.min(), incx.mean() 11.0256 0.0812972 3.87718
fgtx.max(), fgtx.min(), fgtx.mean() 9.10761 0.0 3.15886
delta mean, abs_mean, abs_mean+, abs_mean-: 0.897965 5.5956 5.01568 6.66004
W_c max, min, mean, abs_mean: 0.166782 0.164306 0.165967 0.165967
W_f max, min, mean, abs_mean: 0.139585 0.136669 0.138117 0.138117
             tianjin 4812.3558      0.91  0.23  0.72      0.92  0.23  0.72      0.93  0.21  0.74
forget mean min: 0.935634 0.699482
delta_x = 7.41364 delta_h = 4.09236
U_c = [[-0.09127723]] U_f = [[ 0.]] b_c = [ 0.0812972] b_f = [ 0.84483087]
incx.max(), incx.min(), incx.mean() 11.1778 0.0812972 4.88129
fgtx.max(), fgtx.min(), fgtx.mean() 9.23435 0.0 3.99449
delta mean, abs_mean, abs_mean+, abs_mean-: 1.05622 7.41364 6.01656 10.7345
W_c max, min, mean, abs_mean: 0.166782 0.164306 0.165967 0.165967
W_f max, min, mean, abs_mean: 0.139585 0.136669 0.138117 0.138117
Epoch 6/300
0s - loss: 1009.2938 - val_loss: 4643.3367
Epoch 00005: val_loss improved from 4812.35582 to 4643.33670, saving model to tianjin_weights.hdf5
             tianjin  994.5459      0.79  0.26  0.62      0.83  0.20  0.68      0.82  0.17  0.70
forget mean min: 0.915066 0.685434
delta_x = 5.65415 delta_h = 2.84557
U_c = [[-0.08730108]] U_f = [[ 0.]] b_c = [ 0.0751691] b_f = [ 0.77885824]
incx.max(), incx.min(), incx.mean() 11.362 0.0751691 3.9268
fgtx.max(), fgtx.min(), fgtx.mean() 9.43803 0.0 3.22072
delta mean, abs_mean, abs_mean+, abs_mean-: 0.857806 5.65415 5.0561 6.73588
W_c max, min, mean, abs_mean: 0.172571 0.170012 0.17167 0.17167
W_f max, min, mean, abs_mean: 0.145434 0.141914 0.143553 0.143553
             tianjin 4643.3368      0.92  0.23  0.72      0.92  0.23  0.72      0.93  0.21  0.75
forget mean min: 0.936354 0.685434
delta_x = 7.38824 delta_h = 3.96457
U_c = [[-0.08730108]] U_f = [[ 0.]] b_c = [ 0.0751691] b_f = [ 0.77885824]
incx.max(), incx.min(), incx.mean() 11.6381 0.0751691 4.92784
fgtx.max(), fgtx.min(), fgtx.mean() 9.66899 0.0 4.05785
delta mean, abs_mean, abs_mean+, abs_mean-: 1.06551 7.38824 5.9722 10.8176
W_c max, min, mean, abs_mean: 0.172571 0.170012 0.17167 0.17167
W_f max, min, mean, abs_mean: 0.145434 0.141914 0.143553 0.143553
Epoch 7/300
0s - loss: 989.1390 - val_loss: 4514.6044
Epoch 00006: val_loss improved from 4643.33670 to 4514.60439, saving model to tianjin_weights.hdf5
             tianjin  973.8698      0.80  0.26  0.62      0.83  0.21  0.68      0.82  0.18  0.70
forget mean min: 0.914588 0.671291
delta_x = 5.78442 delta_h = 2.78979
U_c = [[-0.08498988]] U_f = [[ 0.]] b_c = [ 0.0740968] b_f = [ 0.71403009]
incx.max(), incx.min(), incx.mean() 11.6197 0.0740968 4.07703
fgtx.max(), fgtx.min(), fgtx.mean() 9.45536 0.0 3.27823
delta mean, abs_mean, abs_mean+, abs_mean-: 0.896934 5.78442 5.25379 6.71099
W_c max, min, mean, abs_mean: 0.181093 0.178445 0.180136 0.180136
W_f max, min, mean, abs_mean: 0.149866 0.145469 0.147527 0.147527
             tianjin 4514.6043      0.92  0.23  0.72      0.92  0.23  0.72      0.93  0.21  0.74
forget mean min: 0.936851 0.671291
delta_x = 7.49311 delta_h = 3.95474
U_c = [[-0.08498988]] U_f = [[ 0.]] b_c = [ 0.0740968] b_f = [ 0.71403009]
incx.max(), incx.min(), incx.mean() 12.1399 0.0740968 5.11106
fgtx.max(), fgtx.min(), fgtx.mean() 9.88146 0.0 4.12513
delta mean, abs_mean, abs_mean+, abs_mean-: 1.19072 7.49311 6.1362 10.7767
W_c max, min, mean, abs_mean: 0.181093 0.178445 0.180136 0.180136
W_f max, min, mean, abs_mean: 0.149866 0.145469 0.147527 0.147527
Epoch 8/300
0s - loss: 969.1367 - val_loss: 4413.1674
Epoch 00007: val_loss improved from 4514.60439 to 4413.16741, saving model to tianjin_weights.hdf5
             tianjin  951.1284      0.80  0.25  0.63      0.83  0.20  0.69      0.82  0.17  0.70
forget mean min: 0.9153 0.65815
delta_x = 5.78635 delta_h = 2.55864
U_c = [[-0.07792068]] U_f = [[ 0.]] b_c = [ 0.07375791] b_f = [ 0.65506065]
incx.max(), incx.min(), incx.mean() 12.419 0.0737579 4.15967
fgtx.max(), fgtx.min(), fgtx.mean() 9.87259 0.0 3.26756
delta mean, abs_mean, abs_mean+, abs_mean-: 0.86271 5.78635 5.30183 6.60098
W_c max, min, mean, abs_mean: 0.189337 0.186581 0.188345 0.188345
W_f max, min, mean, abs_mean: 0.153426 0.148137 0.150626 0.150626
             tianjin 4413.1674      0.92  0.23  0.72      0.92  0.23  0.72      0.93  0.21  0.74
forget mean min: 0.936838 0.65815
delta_x = 7.50805 delta_h = 3.71167
U_c = [[-0.07792068]] U_f = [[ 0.]] b_c = [ 0.07375791] b_f = [ 0.65506065]
incx.max(), incx.min(), incx.mean() 12.423 0.0737579 5.18659
fgtx.max(), fgtx.min(), fgtx.mean() 9.87592 0.0 4.0889
delta mean, abs_mean, abs_mean+, abs_mean-: 1.14507 7.50805 6.14987 10.7309
W_c max, min, mean, abs_mean: 0.189337 0.186581 0.188345 0.188345
W_f max, min, mean, abs_mean: 0.153426 0.148137 0.150626 0.150626
Epoch 9/300
0s - loss: 944.3314 - val_loss: 4287.5415
Epoch 00008: val_loss improved from 4413.16741 to 4287.54149, saving model to tianjin_weights.hdf5
             tianjin  921.6215      0.79  0.22  0.65      0.83  0.17  0.71      0.82  0.15  0.71
forget mean min: 0.915778 0.644932
delta_x = 5.79615 delta_h = 2.27751
U_c = [[-0.07085554]] U_f = [[ 0.]] b_c = [ 0.07639527] b_f = [ 0.59683639]
incx.max(), incx.min(), incx.mean() 13.2321 0.0763953 4.24806
fgtx.max(), fgtx.min(), fgtx.mean() 10.1484 0.0 3.2181
delta mean, abs_mean, abs_mean+, abs_mean-: 0.772466 5.79615 5.36276 6.48098
W_c max, min, mean, abs_mean: 0.200241 0.19723 0.199106 0.199106
W_f max, min, mean, abs_mean: 0.15681 0.150741 0.153598 0.153598
             tianjin 4287.5415      0.92  0.23  0.72      0.92  0.22  0.72      0.93  0.20  0.75
forget mean min: 0.936957 0.644932
delta_x = 7.55336 delta_h = 3.45449
U_c = [[-0.07085554]] U_f = [[ 0.]] b_c = [ 0.07639527] b_f = [ 0.59683639]
incx.max(), incx.min(), incx.mean() 12.7467 0.0763953 5.2943
fgtx.max(), fgtx.min(), fgtx.mean() 9.7742 0.0 4.02531
delta mean, abs_mean, abs_mean+, abs_mean-: 1.07674 7.55336 6.14544 10.8725
W_c max, min, mean, abs_mean: 0.200241 0.19723 0.199106 0.199106
W_f max, min, mean, abs_mean: 0.15681 0.150741 0.153598 0.153598
Epoch 10/300
0s - loss: 913.9830 - val_loss: 4277.6030
Epoch 00009: val_loss improved from 4287.54149 to 4277.60301, saving model to tianjin_weights.hdf5
             tianjin  887.8304      0.82  0.23  0.66      0.85  0.18  0.71      0.84  0.15  0.73
forget mean min: 0.914116 0.631704
delta_x = 6.06704 delta_h = 1.95185
U_c = [[-0.05885543]] U_f = [[ 0.]] b_c = [ 0.08147578] b_f = [ 0.53953248]
incx.max(), incx.min(), incx.mean() 14.5522 0.0814758 4.44115
fgtx.max(), fgtx.min(), fgtx.mean() 10.7218 0.0 3.23024
delta mean, abs_mean, abs_mean+, abs_mean-: 0.72979 6.06704 5.58922 6.80824
W_c max, min, mean, abs_mean: 0.214437 0.211077 0.213086 0.213086
W_f max, min, mean, abs_mean: 0.161428 0.154746 0.157888 0.157888
             tianjin 4277.6030      0.92  0.23  0.72      0.92  0.22  0.73      0.93  0.20  0.75
forget mean min: 0.938282 0.631704
delta_x = 7.5455 delta_h = 2.90209
U_c = [[-0.05885543]] U_f = [[ 0.]] b_c = [ 0.08147578] b_f = [ 0.53953248]
incx.max(), incx.min(), incx.mean() 13.4746 0.0814758 5.38752
fgtx.max(), fgtx.min(), fgtx.mean() 9.92357 0.0 3.93156
delta mean, abs_mean, abs_mean+, abs_mean-: 0.921044 7.5455 6.11997 10.744
W_c max, min, mean, abs_mean: 0.214437 0.211077 0.213086 0.213086
W_f max, min, mean, abs_mean: 0.161428 0.154746 0.157888 0.157888
Epoch 11/300
0s - loss: 878.8028 - val_loss: 4450.6495
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 846.1079 - val_loss: 4487.9355
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 818.3850 - val_loss: 4555.5165
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 798.8913 - val_loss: 4630.7415
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 781.3754 - val_loss: 4651.7422
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 767.1960 - val_loss: 4743.2724
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 754.1218 - val_loss: 4889.5580
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 745.7058 - val_loss: 4900.4699
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 737.7419 - val_loss: 4988.6743
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 729.3951 - val_loss: 5008.8019
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 720.2401 - val_loss: 5092.0697
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 714.1827 - val_loss: 5134.5254
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 708.3707 - val_loss: 5109.3203
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 698.8233 - val_loss: 5079.8168
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 690.8564 - val_loss: 5140.3093
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 686.3082 - val_loss: 5178.2921
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 677.1389 - val_loss: 5330.3726
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 673.4242 - val_loss: 5214.5944
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 663.5531 - val_loss: 5286.3088
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 661.3051 - val_loss: 5283.6989
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 658.7499 - val_loss: 5263.5054
Epoch 00030: val_loss did not improve
X_train[0].shape = (3516, 40, 23)

training tangshan
Train on 3516 samples, validate on 696 samples
Before training:
            tangshan 6869.6146      0.02  -nan  0.02      0.02  -nan  0.02      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.64554 delta_h = 2.28125
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.64554 3.64554 nan 3.64554
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
            tangshan21151.8067      0.04  -nan  0.04      0.04  -nan  0.04      0.03  -nan  0.03
forget mean min: 0.731058 0.731059
delta_x = 6.569 delta_h = 4.07136
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -6.569 6.569 nan 6.569
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 5500.3701 - val_loss: 11642.6600
Epoch 00000: val_loss improved from inf to 11642.66000, saving model to tangshan_weights.hdf5
            tangshan 3344.1657      0.13  0.02  0.12      0.14  0.01  0.13      0.15  0.01  0.14
forget mean min: 0.890347 0.769976
delta_x = 2.85581 delta_h = 2.55778
U_c = [[-0.1089135]] U_f = [[ 0.]] b_c = [ 0.06565928] b_f = [ 1.06586647]
incx.max(), incx.min(), incx.mean() 2.67909 0.210097 1.26541
fgtx.max(), fgtx.min(), fgtx.mean() 2.5747 0.142308 1.18198
delta mean, abs_mean, abs_mean+, abs_mean-: -2.70016 2.85581 0.514767 3.27276
W_c max, min, mean, abs_mean: 0.0917703 0.0886316 0.0913324 0.0913324
W_f max, min, mean, abs_mean: 0.0902885 0.0890346 0.0899836 0.0899836
            tangshan11642.6601      0.26  0.03  0.26      0.26  0.02  0.26      0.25  0.02  0.24
forget mean min: 0.889052 0.769976
delta_x = 5.52085 delta_h = 4.79815
U_c = [[-0.1089135]] U_f = [[ 0.]] b_c = [ 0.06565928] b_f = [ 1.06586647]
incx.max(), incx.min(), incx.mean() 2.58398 0.210097 1.22729
fgtx.max(), fgtx.min(), fgtx.mean() 2.481 0.142308 1.14442
delta mean, abs_mean, abs_mean+, abs_mean-: -5.51893 5.52085 0.255612 5.54079
W_c max, min, mean, abs_mean: 0.0917703 0.0886316 0.0913324 0.0913324
W_f max, min, mean, abs_mean: 0.0902885 0.0890346 0.0899836 0.0899836
Epoch 2/300
0s - loss: 2026.6582 - val_loss: 5809.9055
Epoch 00001: val_loss improved from 11642.66000 to 5809.90552, saving model to tangshan_weights.hdf5
            tangshan 1343.0070      0.79  0.22  0.64      0.83  0.19  0.69      0.86  0.17  0.73
forget mean min: 0.949186 0.794292
delta_x = 4.8921 delta_h = 2.49201
U_c = [[-0.07877712]] U_f = [[ 0.]] b_c = [ 0.10683354] b_f = [ 1.08360112]
incx.max(), incx.min(), incx.mean() 7.57596 0.415249 3.74718
fgtx.max(), fgtx.min(), fgtx.mean() 6.47538 0.267391 3.15602
delta mean, abs_mean, abs_mean+, abs_mean-: 1.2715 4.8921 4.36801 6.14783
W_c max, min, mean, abs_mean: 0.142064 0.138995 0.141633 0.141633
W_f max, min, mean, abs_mean: 0.123154 0.121896 0.122792 0.122792
            tangshan 5809.9056      0.91  0.18  0.76      0.93  0.14  0.81      0.92  0.13  0.81
forget mean min: 0.955772 0.794292
delta_x = 5.26012 delta_h = 2.8214
U_c = [[-0.07877712]] U_f = [[ 0.]] b_c = [ 0.10683354] b_f = [ 1.08360112]
incx.max(), incx.min(), incx.mean() 7.38917 0.415249 3.69721
fgtx.max(), fgtx.min(), fgtx.mean() 6.31344 0.267391 3.1127
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0656511 5.26012 4.1218 7.33783
W_c max, min, mean, abs_mean: 0.142064 0.138995 0.141633 0.141633
W_f max, min, mean, abs_mean: 0.123154 0.121896 0.122792 0.122792
Epoch 3/300
0s - loss: 1276.6236 - val_loss: 5021.4641
Epoch 00002: val_loss improved from 5809.90552 to 5021.46410, saving model to tangshan_weights.hdf5
            tangshan 1221.7308      0.81  0.25  0.64      0.86  0.22  0.69      0.88  0.20  0.73
forget mean min: 0.938474 0.770501
delta_x = 5.73479 delta_h = 2.79373
U_c = [[-0.07844663]] U_f = [[ 0.]] b_c = [ 0.10543669] b_f = [ 1.03920305]
incx.max(), incx.min(), incx.mean() 10.1293 0.32451 4.16772
fgtx.max(), fgtx.min(), fgtx.mean() 7.86708 0.171941 3.18822
delta mean, abs_mean, abs_mean+, abs_mean-: 1.37536 5.73479 5.10304 7.18567
W_c max, min, mean, abs_mean: 0.153052 0.150026 0.152642 0.152642
W_f max, min, mean, abs_mean: 0.120105 0.118623 0.119801 0.119801
            tangshan 5021.4642      0.93  0.13  0.81      0.94  0.10  0.86      0.94  0.09  0.86
forget mean min: 0.942615 0.770501
delta_x = 6.31611 delta_h = 3.27928
U_c = [[-0.07844663]] U_f = [[ 0.]] b_c = [ 0.10543669] b_f = [ 1.03920305]
incx.max(), incx.min(), incx.mean() 9.42096 0.32451 4.11958
fgtx.max(), fgtx.min(), fgtx.mean() 7.31114 0.171941 3.15045
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0205738 6.31611 4.6866 9.71658
W_c max, min, mean, abs_mean: 0.153052 0.150026 0.152642 0.152642
W_f max, min, mean, abs_mean: 0.120105 0.118623 0.119801 0.119801
Epoch 4/300
0s - loss: 1197.5509 - val_loss: 5123.1611
Epoch 00003: val_loss did not improve
Epoch 5/300
0s - loss: 1162.1154 - val_loss: 4929.1587
Epoch 00004: val_loss improved from 5021.46410 to 4929.15867, saving model to tangshan_weights.hdf5
            tangshan 1150.9202      0.82  0.26  0.63      0.86  0.23  0.68      0.89  0.21  0.72
forget mean min: 0.928667 0.724362
delta_x = 6.4652 delta_h = 3.0006
U_c = [[-0.07689725]] U_f = [[ 0.]] b_c = [ 0.09852207] b_f = [ 0.95228159]
incx.max(), incx.min(), incx.mean() 13.0741 0.116749 4.55946
fgtx.max(), fgtx.min(), fgtx.mean() 9.90857 0.0139191 3.40651
delta mean, abs_mean, abs_mean+, abs_mean-: 1.47538 6.4652 5.70604 8.20167
W_c max, min, mean, abs_mean: 0.164495 0.161482 0.164076 0.164076
W_f max, min, mean, abs_mean: 0.125618 0.123742 0.125295 0.125295
            tangshan 4929.1587      0.93  0.12  0.83      0.95  0.09  0.86      0.94  0.09  0.86
forget mean min: 0.933716 0.724362
delta_x = 7.18433 delta_h = 3.38853
U_c = [[-0.07689725]] U_f = [[ 0.]] b_c = [ 0.09852207] b_f = [ 0.95228159]
incx.max(), incx.min(), incx.mean() 11.6732 0.116749 4.49219
fgtx.max(), fgtx.min(), fgtx.mean() 8.83875 0.0139191 3.35515
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0105279 7.18433 5.39314 10.7414
W_c max, min, mean, abs_mean: 0.164495 0.161482 0.164076 0.164076
W_f max, min, mean, abs_mean: 0.125618 0.123742 0.125295 0.125295
Epoch 6/300
0s - loss: 1142.6101 - val_loss: 5191.7385
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 1127.4061 - val_loss: 5002.0743
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 1112.3401 - val_loss: 5107.7039
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 1097.4187 - val_loss: 5365.6851
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 1081.9342 - val_loss: 5198.2465
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 1069.8839 - val_loss: 5450.8341
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 1058.7110 - val_loss: 5382.7333
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 1047.9691 - val_loss: 5187.3584
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 1037.3279 - val_loss: 5006.5553
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 1029.1231 - val_loss: 5086.2416
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 1019.8589 - val_loss: 5217.5454
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 1008.8628 - val_loss: 5418.8375
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 1000.6973 - val_loss: 5343.5258
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 991.3331 - val_loss: 5277.3062
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 982.3000 - val_loss: 5517.7889
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 969.0117 - val_loss: 5322.1875
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 958.4035 - val_loss: 5188.5305
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 948.3048 - val_loss: 5228.0307
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 939.6080 - val_loss: 5446.3647
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 930.1149 - val_loss: 5350.4339
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 921.1585 - val_loss: 5675.7223
Epoch 00025: val_loss did not improve
X_train[0].shape = (3516, 40, 23)

training baoding
Train on 3516 samples, validate on 696 samples
Before training:
             baoding 8388.2037      0.02  -nan  0.02      0.02  -nan  0.02      0.01  -nan  0.01
forget mean min: 0.731058 0.731059
delta_x = 4.55012 delta_h = 3.01036
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -4.55012 4.55012 nan 4.55012
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
             baoding46155.4407      0.06  -nan  0.06      0.07  -nan  0.07      0.08  -nan  0.08
forget mean min: 0.731058 0.731059
delta_x = 9.24267 delta_h = 5.17297
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -9.24267 9.24267 nan 9.24267
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 6687.8956 - val_loss: 31238.4083
Epoch 00000: val_loss improved from inf to 31238.40827, saving model to baoding_weights.hdf5
             baoding 4162.2680      0.19  0.19  0.18      0.20  0.15  0.19      0.18  0.14  0.18
forget mean min: 0.886433 0.769281
delta_x = 3.80882 delta_h = 3.37204
U_c = [[-0.10588983]] U_f = [[ 0.]] b_c = [ 0.06450859] b_f = [ 1.0641737]
incx.max(), incx.min(), incx.mean() 3.37112 0.207275 1.33288
fgtx.max(), fgtx.min(), fgtx.mean() 3.24428 0.140081 1.24447
delta mean, abs_mean, abs_mean+, abs_mean-: -3.51899 3.80882 0.779245 4.50095
W_c max, min, mean, abs_mean: 0.0913519 0.0892809 0.0908661 0.0908661
W_f max, min, mean, abs_mean: 0.0894393 0.0888402 0.0891554 0.0891554
             baoding31238.4082      0.27  0.11  0.26      0.27  0.03  0.27      0.26  0.03  0.26
forget mean min: 0.880847 0.769281
delta_x = 8.44208 delta_h = 6.66314
U_c = [[-0.10588983]] U_f = [[ 0.]] b_c = [ 0.06450859] b_f = [ 1.0641737]
incx.max(), incx.min(), incx.mean() 2.65644 0.207275 1.10953
fgtx.max(), fgtx.min(), fgtx.mean() 2.54307 0.140081 1.02533
delta mean, abs_mean, abs_mean+, abs_mean-: -8.43445 8.44208 0.291461 8.55006
W_c max, min, mean, abs_mean: 0.0913519 0.0892809 0.0908661 0.0908661
W_f max, min, mean, abs_mean: 0.0894393 0.0888402 0.0891554 0.0891554
Epoch 2/300
0s - loss: 2810.5511 - val_loss: 18857.7572
Epoch 00001: val_loss improved from 31238.40827 to 18857.75717, saving model to baoding_weights.hdf5
             baoding 1969.4075      0.82  0.25  0.64      0.85  0.24  0.67      0.85  0.23  0.67
forget mean min: 0.93826 0.796929
delta_x = 5.13793 delta_h = 2.48052
U_c = [[-0.06669165]] U_f = [[ 0.]] b_c = [ 0.105475] b_f = [ 1.0894345]
incx.max(), incx.min(), incx.mean() 8.10282 0.41964 3.43905
fgtx.max(), fgtx.min(), fgtx.mean() 7.07093 0.277776 2.94741
delta mean, abs_mean, abs_mean+, abs_mean-: 0.339942 5.13793 4.32876 6.53194
W_c max, min, mean, abs_mean: 0.13981 0.137737 0.139304 0.139304
W_f max, min, mean, abs_mean: 0.123536 0.122777 0.123168 0.123168
             baoding18857.7574      0.86  0.11  0.78      0.86  0.08  0.80      0.85  0.06  0.81
forget mean min: 0.952947 0.796929
delta_x = 5.72696 delta_h = 3.13334
U_c = [[-0.06669165]] U_f = [[ 0.]] b_c = [ 0.105475] b_f = [ 1.0894345]
incx.max(), incx.min(), incx.mean() 6.23789 0.41964 3.2014
fgtx.max(), fgtx.min(), fgtx.mean() 5.42205 0.277776 2.7373
delta mean, abs_mean, abs_mean+, abs_mean-: -2.03725 5.72696 3.3556 8.62277
W_c max, min, mean, abs_mean: 0.13981 0.137737 0.139304 0.139304
W_f max, min, mean, abs_mean: 0.123536 0.122777 0.123168 0.123168
Epoch 3/300
0s - loss: 1842.0369 - val_loss: 17924.7039
Epoch 00002: val_loss improved from 18857.75717 to 17924.70389, saving model to baoding_weights.hdf5
             baoding 1767.1948      0.83  0.24  0.66      0.87  0.22  0.70      0.86  0.21  0.70
forget mean min: 0.929313 0.784717
delta_x = 5.32125 delta_h = 1.95492
U_c = [[-0.04501692]] U_f = [[ 0.]] b_c = [ 0.11115094] b_f = [ 1.06700039]
incx.max(), incx.min(), incx.mean() 9.52572 0.410262 3.66508
fgtx.max(), fgtx.min(), fgtx.mean() 7.12488 0.226368 2.68959
delta mean, abs_mean, abs_mean+, abs_mean-: 0.311112 5.32125 4.48289 6.7378
W_c max, min, mean, abs_mean: 0.151015 0.148922 0.15048 0.15048
W_f max, min, mean, abs_mean: 0.114295 0.113455 0.113883 0.113883
             baoding17924.7039      0.81  0.08  0.75      0.80  0.04  0.77      0.80  0.03  0.78
forget mean min: 0.940226 0.784717
delta_x = 7.17396 delta_h = 2.76306
U_c = [[-0.04501692]] U_f = [[ 0.]] b_c = [ 0.11115094] b_f = [ 1.06700039]
incx.max(), incx.min(), incx.mean() 8.51019 0.410262 3.78912
fgtx.max(), fgtx.min(), fgtx.mean() 6.35635 0.226368 2.78347
delta mean, abs_mean, abs_mean+, abs_mean-: -2.06862 7.17396 4.38519 11.0587
W_c max, min, mean, abs_mean: 0.151015 0.148922 0.15048 0.15048
W_f max, min, mean, abs_mean: 0.114295 0.113455 0.113883 0.113883
Epoch 4/300
0s - loss: 1748.1296 - val_loss: 17298.3106
Epoch 00003: val_loss improved from 17924.70389 to 17298.31060, saving model to baoding_weights.hdf5
             baoding 1711.2764      0.84  0.24  0.67      0.87  0.21  0.71      0.87  0.21  0.71
forget mean min: 0.926748 0.779415
delta_x = 5.44644 delta_h = 1.77019
U_c = [[-0.03945572]] U_f = [[ 0.]] b_c = [ 0.11812627] b_f = [ 1.05300951]
incx.max(), incx.min(), incx.mean() 10.0523 0.413603 3.82399
fgtx.max(), fgtx.min(), fgtx.mean() 7.03501 0.209249 2.62435
delta mean, abs_mean, abs_mean+, abs_mean-: 0.32548 5.44644 4.69026 6.65593
W_c max, min, mean, abs_mean: 0.156453 0.154353 0.15591 0.15591
W_f max, min, mean, abs_mean: 0.110819 0.110028 0.110411 0.110411
             baoding17298.3107      0.82  0.08  0.76      0.81  0.05  0.78      0.82  0.03  0.79
forget mean min: 0.942325 0.779415
delta_x = 7.46094 delta_h = 2.51083
U_c = [[-0.03945572]] U_f = [[ 0.]] b_c = [ 0.11812627] b_f = [ 1.05300951]
incx.max(), incx.min(), incx.mean() 9.23625 0.413603 4.12631
fgtx.max(), fgtx.min(), fgtx.mean() 6.45714 0.209249 2.83846
delta mean, abs_mean, abs_mean+, abs_mean-: -1.83479 7.46094 4.71329 11.5286
W_c max, min, mean, abs_mean: 0.156453 0.154353 0.15591 0.15591
W_f max, min, mean, abs_mean: 0.110819 0.110028 0.110411 0.110411
Epoch 5/300
0s - loss: 1692.2792 - val_loss: 16521.8847
Epoch 00004: val_loss improved from 17298.31060 to 16521.88465, saving model to baoding_weights.hdf5
             baoding 1657.2419      0.84  0.23  0.67      0.88  0.21  0.71      0.87  0.21  0.71
forget mean min: 0.927006 0.774244
delta_x = 5.53112 delta_h = 1.72107
U_c = [[-0.03853411]] U_f = [[ 0.]] b_c = [ 0.12491467] b_f = [ 1.03638101]
incx.max(), incx.min(), incx.mean() 10.4574 0.405535 3.92391
fgtx.max(), fgtx.min(), fgtx.mean() 7.21854 0.196051 2.65409
delta mean, abs_mean, abs_mean+, abs_mean-: 0.341648 5.53112 4.86377 6.54783
W_c max, min, mean, abs_mean: 0.160045 0.157941 0.159496 0.159496
W_f max, min, mean, abs_mean: 0.111847 0.111109 0.111429 0.111429
             baoding16521.8843      0.84  0.09  0.78      0.84  0.06  0.80      0.85  0.04  0.82
forget mean min: 0.947546 0.774244
delta_x = 7.52899 delta_h = 2.42306
U_c = [[-0.03853411]] U_f = [[ 0.]] b_c = [ 0.12491467] b_f = [ 1.03638101]
incx.max(), incx.min(), incx.mean() 9.93667 0.405535 4.37146
fgtx.max(), fgtx.min(), fgtx.mean() 6.85479 0.196051 2.96676
delta mean, abs_mean, abs_mean+, abs_mean-: -1.52296 7.52899 4.97347 11.4237
W_c max, min, mean, abs_mean: 0.160045 0.157941 0.159496 0.159496
W_f max, min, mean, abs_mean: 0.111847 0.111109 0.111429 0.111429
Epoch 6/300
0s - loss: 1637.9709 - val_loss: 16634.1698
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 1586.4753 - val_loss: 16807.0184
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 1539.3756 - val_loss: 16464.0186
Epoch 00007: val_loss improved from 16521.88465 to 16464.01862, saving model to baoding_weights.hdf5
             baoding 1534.4754      0.86  0.23  0.68      0.90  0.21  0.72      0.90  0.21  0.72
forget mean min: 0.933814 0.738496
delta_x = 5.79838 delta_h = 1.1518
U_c = [[-0.02402842]] U_f = [[ 0.]] b_c = [ 0.13236846] b_f = [ 0.95056367]
incx.max(), incx.min(), incx.mean() 12.1255 0.238356 4.0556
fgtx.max(), fgtx.min(), fgtx.mean() 9.91264 0.0876018 3.24265
delta mean, abs_mean, abs_mean+, abs_mean-: 0.489574 5.79838 5.21536 6.68329
W_c max, min, mean, abs_mean: 0.163627 0.161505 0.163056 0.163056
W_f max, min, mean, abs_mean: 0.135241 0.134408 0.134771 0.134771
             baoding16464.0187      0.91  0.14  0.79      0.91  0.10  0.82      0.90  0.09  0.83
forget mean min: 0.96041 0.738496
delta_x = 7.5425 delta_h = 1.55436
U_c = [[-0.02402842]] U_f = [[ 0.]] b_c = [ 0.13236846] b_f = [ 0.95056367]
incx.max(), incx.min(), incx.mean() 11.815 0.238356 4.54457
fgtx.max(), fgtx.min(), fgtx.mean() 9.65596 0.0876018 3.6468
delta mean, abs_mean, abs_mean+, abs_mean-: -1.05161 7.5425 5.28938 11.1201
W_c max, min, mean, abs_mean: 0.163627 0.161505 0.163056 0.163056
W_f max, min, mean, abs_mean: 0.135241 0.134408 0.134771 0.134771
Epoch 9/300
0s - loss: 1501.2681 - val_loss: 16436.0770
Epoch 00008: val_loss improved from 16464.01862 to 16436.07704, saving model to baoding_weights.hdf5
             baoding 1471.3668      0.85  0.22  0.68      0.88  0.19  0.73      0.88  0.19  0.73
forget mean min: 0.931743 0.720233
delta_x = 5.77521 delta_h = 1.2285
U_c = [[-0.02702213]] U_f = [[ 0.]] b_c = [ 0.13186201] b_f = [ 0.91872185]
incx.max(), incx.min(), incx.mean() 12.2066 0.162539 3.92792
fgtx.max(), fgtx.min(), fgtx.mean() 10.5858 0.0268945 3.32797
delta mean, abs_mean, abs_mean+, abs_mean-: 0.317413 5.77521 5.13327 6.71224
W_c max, min, mean, abs_mean: 0.162728 0.160604 0.162156 0.162156
W_f max, min, mean, abs_mean: 0.142638 0.141752 0.142162 0.142162
             baoding16436.0770      0.91  0.14  0.79      0.91  0.10  0.82      0.91  0.09  0.83
forget mean min: 0.960293 0.720233
delta_x = 7.554 delta_h = 1.69751
U_c = [[-0.02702213]] U_f = [[ 0.]] b_c = [ 0.13186201] b_f = [ 0.91872185]
incx.max(), incx.min(), incx.mean() 11.9801 0.162539 4.4531
fgtx.max(), fgtx.min(), fgtx.mean() 10.3872 0.0268945 3.7884
delta mean, abs_mean, abs_mean+, abs_mean-: -1.10284 7.554 5.22155 11.3234
W_c max, min, mean, abs_mean: 0.162728 0.160604 0.162156 0.162156
W_f max, min, mean, abs_mean: 0.142638 0.141752 0.142162 0.142162
Epoch 10/300
0s - loss: 1468.0346 - val_loss: 15878.8082
Epoch 00009: val_loss improved from 16436.07704 to 15878.80823, saving model to baoding_weights.hdf5
             baoding 1447.9261      0.86  0.22  0.69      0.90  0.20  0.73      0.90  0.20  0.73
forget mean min: 0.933032 0.707694
delta_x = 6.04783 delta_h = 1.22136
U_c = [[-0.02610095]] U_f = [[ 0.]] b_c = [ 0.13337246] b_f = [ 0.88420916]
incx.max(), incx.min(), incx.mean() 12.9603 0.133372 4.03374
fgtx.max(), fgtx.min(), fgtx.mean() 12.2016 0.0 3.71022
delta mean, abs_mean, abs_mean+, abs_mean-: 0.436945 6.04783 5.3664 7.08807
W_c max, min, mean, abs_mean: 0.164498 0.162373 0.163928 0.163928
W_f max, min, mean, abs_mean: 0.156427 0.155488 0.155937 0.155937
             baoding15878.8082      0.94  0.15  0.80      0.94  0.11  0.84      0.93  0.09  0.85
forget mean min: 0.963522 0.707694
delta_x = 7.75144 delta_h = 1.6668
U_c = [[-0.02610095]] U_f = [[ 0.]] b_c = [ 0.13337246] b_f = [ 0.88420916]
incx.max(), incx.min(), incx.mean() 12.7086 0.133372 4.57335
fgtx.max(), fgtx.min(), fgtx.mean() 11.9622 0.0 4.22353
delta mean, abs_mean, abs_mean+, abs_mean-: -0.796715 7.75144 5.384 12.0692
W_c max, min, mean, abs_mean: 0.164498 0.162373 0.163928 0.163928
W_f max, min, mean, abs_mean: 0.156427 0.155488 0.155937 0.155937
Epoch 11/300
0s - loss: 1447.6801 - val_loss: 15492.3415
Epoch 00010: val_loss improved from 15878.80823 to 15492.34149, saving model to baoding_weights.hdf5
             baoding 1426.0410      0.87  0.23  0.69      0.90  0.20  0.73      0.91  0.20  0.74
forget mean min: 0.934453 0.7005
delta_x = 6.11075 delta_h = 1.18908
U_c = [[-0.02528019]] U_f = [[ 0.]] b_c = [ 0.13245994] b_f = [ 0.84967971]
incx.max(), incx.min(), incx.mean() 13.2539 0.13246 4.03252
fgtx.max(), fgtx.min(), fgtx.mean() 13.3806 0.0 3.97712
delta mean, abs_mean, abs_mean+, abs_mean-: 0.461298 6.11075 5.38984 7.23677
W_c max, min, mean, abs_mean: 0.164443 0.162313 0.163872 0.163872
W_f max, min, mean, abs_mean: 0.167613 0.166645 0.167111 0.167111
             baoding15492.3418      0.95  0.15  0.81      0.94  0.11  0.85      0.94  0.09  0.85
forget mean min: 0.966115 0.7005
delta_x = 7.76327 delta_h = 1.65641
U_c = [[-0.02528019]] U_f = [[ 0.]] b_c = [ 0.13245994] b_f = [ 0.84967971]
incx.max(), incx.min(), incx.mean() 13.1736 0.13246 4.61683
fgtx.max(), fgtx.min(), fgtx.mean() 13.2988 0.0 4.57297
delta mean, abs_mean, abs_mean+, abs_mean-: -0.561249 7.76327 5.48725 12.1084
W_c max, min, mean, abs_mean: 0.164443 0.162313 0.163872 0.163872
W_f max, min, mean, abs_mean: 0.167613 0.166645 0.167111 0.167111
Epoch 12/300
0s - loss: 1422.3111 - val_loss: 15595.3451
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 1406.0204 - val_loss: 15002.0044
Epoch 00012: val_loss improved from 15492.34149 to 15002.00442, saving model to baoding_weights.hdf5
             baoding 1371.3069      0.87  0.22  0.69      0.90  0.20  0.74      0.91  0.19  0.75
forget mean min: 0.931559 0.685878
delta_x = 6.30384 delta_h = 1.08806
U_c = [[-0.02302136]] U_f = [[ 0.]] b_c = [ 0.13185994] b_f = [ 0.78092051]
incx.max(), incx.min(), incx.mean() 14.0041 0.13186 4.04998
fgtx.max(), fgtx.min(), fgtx.mean() 15.2783 0.0 4.31524
delta mean, abs_mean, abs_mean+, abs_mean-: 0.382861 6.30384 5.52083 7.5061
W_c max, min, mean, abs_mean: 0.16727 0.165149 0.166717 0.166717
W_f max, min, mean, abs_mean: 0.184102 0.183124 0.183615 0.183615
             baoding15002.0045      0.95  0.15  0.81      0.95  0.11  0.85      0.95  0.09  0.86
forget mean min: 0.967383 0.685878
delta_x = 7.94844 delta_h = 1.54104
U_c = [[-0.02302136]] U_f = [[ 0.]] b_c = [ 0.13185994] b_f = [ 0.78092051]
incx.max(), incx.min(), incx.mean() 13.8428 0.13186 4.69
fgtx.max(), fgtx.min(), fgtx.mean() 15.1006 0.0 5.02013
delta mean, abs_mean, abs_mean+, abs_mean-: -0.480444 7.94844 5.68337 12.2872
W_c max, min, mean, abs_mean: 0.16727 0.165149 0.166717 0.166717
W_f max, min, mean, abs_mean: 0.184102 0.183124 0.183615 0.183615
Epoch 14/300
0s - loss: 1374.0212 - val_loss: 14748.3004
Epoch 00013: val_loss improved from 15002.00442 to 14748.30039, saving model to baoding_weights.hdf5
             baoding 1341.1634      0.85  0.21  0.69      0.88  0.18  0.74      0.89  0.17  0.75
forget mean min: 0.929036 0.678426
delta_x = 6.30846 delta_h = 1.08389
U_c = [[-0.02405899]] U_f = [[ 0.]] b_c = [ 0.13191266] b_f = [ 0.74654716]
incx.max(), incx.min(), incx.mean() 14.687 0.131913 3.98274
fgtx.max(), fgtx.min(), fgtx.mean() 16.3831 0.0 4.33448
delta mean, abs_mean, abs_mean+, abs_mean-: 0.212793 6.30846 5.49014 7.50526
W_c max, min, mean, abs_mean: 0.16903 0.166918 0.168488 0.168488
W_f max, min, mean, abs_mean: 0.190132 0.189148 0.18965 0.18965
             baoding14748.3005      0.95  0.15  0.81      0.95  0.11  0.85      0.95  0.09  0.86
forget mean min: 0.967215 0.678426
delta_x = 7.96016 delta_h = 1.59739
U_c = [[-0.02405899]] U_f = [[ 0.]] b_c = [ 0.13191266] b_f = [ 0.74654716]
incx.max(), incx.min(), incx.mean() 14.3143 0.131913 4.70796
fgtx.max(), fgtx.min(), fgtx.mean() 15.9636 0.0 5.15079
delta mean, abs_mean, abs_mean+, abs_mean-: -0.472765 7.96016 5.72411 12.1871
W_c max, min, mean, abs_mean: 0.16903 0.166918 0.168488 0.168488
W_f max, min, mean, abs_mean: 0.190132 0.189148 0.18965 0.18965
Epoch 15/300
0s - loss: 1356.9262 - val_loss: 14349.0655
Epoch 00014: val_loss improved from 14748.30039 to 14349.06545, saving model to baoding_weights.hdf5
             baoding 1309.4089      0.86  0.22  0.70      0.90  0.19  0.74      0.90  0.17  0.76
forget mean min: 0.926857 0.671284
delta_x = 6.53075 delta_h = 1.11498
U_c = [[-0.02441206]] U_f = [[ 0.]] b_c = [ 0.13387348] b_f = [ 0.7139985]
incx.max(), incx.min(), incx.mean() 15.406 0.133873 4.08912
fgtx.max(), fgtx.min(), fgtx.mean() 17.5287 0.0 4.53966
delta mean, abs_mean, abs_mean+, abs_mean-: 0.24926 6.53075 5.69632 7.75727
W_c max, min, mean, abs_mean: 0.172474 0.170374 0.171945 0.171945
W_f max, min, mean, abs_mean: 0.19783 0.196836 0.197351 0.197351
             baoding14349.0656      0.96  0.15  0.82      0.96  0.11  0.85      0.95  0.09  0.87
forget mean min: 0.967646 0.671284
delta_x = 8.15785 delta_h = 1.61936
U_c = [[-0.02441206]] U_f = [[ 0.]] b_c = [ 0.13387348] b_f = [ 0.7139985]
incx.max(), incx.min(), incx.mean() 14.8171 0.133873 4.8328
fgtx.max(), fgtx.min(), fgtx.mean() 16.8527 0.0 5.39322
delta mean, abs_mean, abs_mean+, abs_mean-: -0.355169 8.15785 5.88563 12.6253
W_c max, min, mean, abs_mean: 0.172474 0.170374 0.171945 0.171945
W_f max, min, mean, abs_mean: 0.19783 0.196836 0.197351 0.197351
Epoch 16/300
0s - loss: 1326.7926 - val_loss: 13984.4094
Epoch 00015: val_loss improved from 14349.06545 to 13984.40939, saving model to baoding_weights.hdf5
             baoding 1282.9785      0.86  0.21  0.70      0.89  0.19  0.74      0.90  0.17  0.76
forget mean min: 0.926119 0.66356
delta_x = 6.70027 delta_h = 1.0672
U_c = [[-0.02333123]] U_f = [[ 0.]] b_c = [ 0.13605589] b_f = [ 0.67920125]
incx.max(), incx.min(), incx.mean() 16.3155 0.136056 4.17433
fgtx.max(), fgtx.min(), fgtx.mean() 18.9199 0.0 4.72226
delta mean, abs_mean, abs_mean+, abs_mean-: 0.252082 6.70027 5.85181 7.9418
W_c max, min, mean, abs_mean: 0.176379 0.174287 0.175858 0.175858
W_f max, min, mean, abs_mean: 0.206168 0.205108 0.205645 0.205645
             baoding13984.4095      0.96  0.15  0.82      0.96  0.11  0.85      0.95  0.09  0.87
forget mean min: 0.967785 0.66356
delta_x = 8.35022 delta_h = 1.57212
U_c = [[-0.02333123]] U_f = [[ 0.]] b_c = [ 0.13605589] b_f = [ 0.67920125]
incx.max(), incx.min(), incx.mean() 15.5307 0.136056 4.94771
fgtx.max(), fgtx.min(), fgtx.mean() 18.0021 0.0 5.62664
delta mean, abs_mean, abs_mean+, abs_mean-: -0.289196 8.35022 6.0318 13.0195
W_c max, min, mean, abs_mean: 0.176379 0.174287 0.175858 0.175858
W_f max, min, mean, abs_mean: 0.206168 0.205108 0.205645 0.205645
Epoch 17/300
0s - loss: 1302.0078 - val_loss: 13797.4943
Epoch 00016: val_loss improved from 13984.40939 to 13797.49433, saving model to baoding_weights.hdf5
             baoding 1247.5146      0.87  0.22  0.70      0.91  0.19  0.75      0.91  0.18  0.76
forget mean min: 0.924833 0.655403
delta_x = 6.93236 delta_h = 1.02484
U_c = [[-0.02199095]] U_f = [[ 0.]] b_c = [ 0.13793784] b_f = [ 0.64287639]
incx.max(), incx.min(), incx.mean() 17.0686 0.137938 4.28593
fgtx.max(), fgtx.min(), fgtx.mean() 20.3687 0.0 4.9903
delta mean, abs_mean, abs_mean+, abs_mean-: 0.286198 6.93236 6.02389 8.29031
W_c max, min, mean, abs_mean: 0.180339 0.178255 0.179829 0.179829
W_f max, min, mean, abs_mean: 0.216951 0.215785 0.216347 0.216347
             baoding13797.4944      0.96  0.16  0.82      0.96  0.11  0.86      0.96  0.09  0.87
forget mean min: 0.96935 0.655403
delta_x = 8.57456 delta_h = 1.5497
U_c = [[-0.02199095]] U_f = [[ 0.]] b_c = [ 0.13793784] b_f = [ 0.64287639]
incx.max(), incx.min(), incx.mean() 16.0673 0.137938 5.14495
fgtx.max(), fgtx.min(), fgtx.mean() 19.164 0.0 6.02377
delta mean, abs_mean, abs_mean+, abs_mean-: -0.049137 8.57456 6.24797 13.5702
W_c max, min, mean, abs_mean: 0.180339 0.178255 0.179829 0.179829
W_f max, min, mean, abs_mean: 0.216951 0.215785 0.216347 0.216347
Epoch 18/300
0s - loss: 1277.6380 - val_loss: 13396.7006
Epoch 00017: val_loss improved from 13797.49433 to 13396.70059, saving model to baoding_weights.hdf5
             baoding 1226.8943      0.88  0.22  0.70      0.92  0.20  0.75      0.92  0.19  0.76
forget mean min: 0.923872 0.647774
delta_x = 7.13456 delta_h = 1.08628
U_c = [[-0.02294737]] U_f = [[ 0.]] b_c = [ 0.13979739] b_f = [ 0.60926712]
incx.max(), incx.min(), incx.mean() 17.6578 0.139797 4.40401
fgtx.max(), fgtx.min(), fgtx.mean() 21.5849 0.0 5.25417
delta mean, abs_mean, abs_mean+, abs_mean-: 0.361987 7.13456 6.14381 8.68478
W_c max, min, mean, abs_mean: 0.183986 0.181892 0.183466 0.183466
W_f max, min, mean, abs_mean: 0.226757 0.225465 0.22606 0.22606
             baoding13396.7005      0.97  0.16  0.82      0.97  0.11  0.86      0.96  0.09  0.87
forget mean min: 0.970475 0.647774
delta_x = 8.69916 delta_h = 1.62799
U_c = [[-0.02294737]] U_f = [[ 0.]] b_c = [ 0.13979739] b_f = [ 0.60926712]
incx.max(), incx.min(), incx.mean() 16.4981 0.139797 5.28769
fgtx.max(), fgtx.min(), fgtx.mean() 20.1559 0.0 6.343
delta mean, abs_mean, abs_mean+, abs_mean-: 0.176987 8.69916 6.36624 14.0689
W_c max, min, mean, abs_mean: 0.183986 0.181892 0.183466 0.183466
W_f max, min, mean, abs_mean: 0.226757 0.225465 0.22606 0.22606
Epoch 19/300
0s - loss: 1255.2385 - val_loss: 12959.6202
Epoch 00018: val_loss improved from 13396.70059 to 12959.62021, saving model to baoding_weights.hdf5
             baoding 1213.3781      0.89  0.23  0.71      0.93  0.21  0.75      0.93  0.20  0.76
forget mean min: 0.922942 0.640154
delta_x = 7.38851 delta_h = 1.04338
U_c = [[-0.02141614]] U_f = [[ 0.]] b_c = [ 0.14229228] b_f = [ 0.57603174]
incx.max(), incx.min(), incx.mean() 18.2118 0.142292 4.54888
fgtx.max(), fgtx.min(), fgtx.mean() 22.6392 0.0 5.52096
delta mean, abs_mean, abs_mean+, abs_mean-: 0.431698 7.38851 6.33655 9.08371
W_c max, min, mean, abs_mean: 0.188569 0.186462 0.188037 0.188037
W_f max, min, mean, abs_mean: 0.236393 0.234945 0.235591 0.235591
             baoding12959.6200      0.97  0.16  0.82      0.97  0.12  0.86      0.96  0.09  0.87
forget mean min: 0.970645 0.640154
delta_x = 9.01848 delta_h = 1.56106
U_c = [[-0.02141614]] U_f = [[ 0.]] b_c = [ 0.14229228] b_f = [ 0.57603174]
incx.max(), incx.min(), incx.mean() 17.0811 0.142292 5.46878
fgtx.max(), fgtx.min(), fgtx.mean() 21.2225 0.0 6.67351
delta mean, abs_mean, abs_mean+, abs_mean-: 0.27281 9.01848 6.57623 14.8953
W_c max, min, mean, abs_mean: 0.188569 0.186462 0.188037 0.188037
W_f max, min, mean, abs_mean: 0.236393 0.234945 0.235591 0.235591
Epoch 20/300
0s - loss: 1232.3923 - val_loss: 13046.7238
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 1206.7400 - val_loss: 12667.0667
Epoch 00020: val_loss improved from 12959.62021 to 12667.06665, saving model to baoding_weights.hdf5
             baoding 1143.3666      0.86  0.21  0.70      0.90  0.18  0.75      0.91  0.17  0.77
forget mean min: 0.919663 0.625737
delta_x = 7.57816 delta_h = 0.988206
U_c = [[-0.0212971]] U_f = [[ 0.]] b_c = [ 0.14244463] b_f = [ 0.5139693]
incx.max(), incx.min(), incx.mean() 18.8507 0.142445 4.5322
fgtx.max(), fgtx.min(), fgtx.mean() 24.5239 0.0 5.75435
delta mean, abs_mean, abs_mean+, abs_mean-: 0.23893 7.57816 6.41721 9.38696
W_c max, min, mean, abs_mean: 0.193342 0.191184 0.192768 0.192768
W_f max, min, mean, abs_mean: 0.253705 0.251962 0.252692 0.252692
             baoding12667.0668      0.97  0.15  0.82      0.97  0.11  0.86      0.96  0.09  0.88
forget mean min: 0.968438 0.625737
delta_x = 9.3514 delta_h = 1.53786
U_c = [[-0.0212971]] U_f = [[ 0.]] b_c = [ 0.14244463] b_f = [ 0.5139693]
incx.max(), incx.min(), incx.mean() 17.8013 0.142445 5.51004
fgtx.max(), fgtx.min(), fgtx.mean() 23.1482 0.0 7.03617
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0674756 9.3514 6.72087 15.5103
W_c max, min, mean, abs_mean: 0.193342 0.191184 0.192768 0.192768
W_f max, min, mean, abs_mean: 0.253705 0.251962 0.252692 0.252692
Epoch 22/300
0s - loss: 1188.0721 - val_loss: 12302.3107
Epoch 00021: val_loss improved from 12667.06665 to 12302.31068, saving model to baoding_weights.hdf5
             baoding 1121.7460      0.87  0.21  0.70      0.91  0.18  0.75      0.91  0.17  0.77
forget mean min: 0.91873 0.618594
delta_x = 7.71146 delta_h = 1.03006
U_c = [[-0.02221096]] U_f = [[ 0.]] b_c = [ 0.14270324] b_f = [ 0.48358551]
incx.max(), incx.min(), incx.mean() 18.9801 0.142703 4.58477
fgtx.max(), fgtx.min(), fgtx.mean() 25.2473 0.0 5.95361
delta mean, abs_mean, abs_mean+, abs_mean-: 0.237038 7.71146 6.49377 9.63223
W_c max, min, mean, abs_mean: 0.196109 0.193917 0.195508 0.195508
W_f max, min, mean, abs_mean: 0.263173 0.261224 0.262036 0.262036
             baoding12302.3105      0.97  0.15  0.82      0.97  0.11  0.86      0.96  0.09  0.88
forget mean min: 0.968312 0.618594
delta_x = 9.53148 delta_h = 1.61621
U_c = [[-0.02221096]] U_f = [[ 0.]] b_c = [ 0.14270324] b_f = [ 0.48358551]
incx.max(), incx.min(), incx.mean() 18.2302 0.142703 5.61528
fgtx.max(), fgtx.min(), fgtx.mean() 24.2422 0.0 7.33479
delta mean, abs_mean, abs_mean+, abs_mean-: 0.152418 9.53148 6.85203 15.9859
W_c max, min, mean, abs_mean: 0.196109 0.193917 0.195508 0.195508
W_f max, min, mean, abs_mean: 0.263173 0.261224 0.262036 0.262036
Epoch 23/300
0s - loss: 1167.0806 - val_loss: 12092.8921
Epoch 00022: val_loss improved from 12302.31068 to 12092.89212, saving model to baoding_weights.hdf5
             baoding 1108.3646      0.89  0.22  0.71      0.92  0.20  0.75      0.93  0.19  0.76
forget mean min: 0.920354 0.611762
delta_x = 8.01118 delta_h = 1.03084
U_c = [[-0.02146378]] U_f = [[ 0.]] b_c = [ 0.14464471] b_f = [ 0.4547261]
incx.max(), incx.min(), incx.mean() 20.0686 0.144645 4.80772
fgtx.max(), fgtx.min(), fgtx.mean() 27.0321 0.0 6.3267
delta mean, abs_mean, abs_mean+, abs_mean-: 0.400962 8.01118 6.74745 10.1027
W_c max, min, mean, abs_mean: 0.20092 0.198685 0.200284 0.200284
W_f max, min, mean, abs_mean: 0.272965 0.270859 0.271739 0.271739
             baoding12092.8921      0.97  0.15  0.82      0.97  0.11  0.86      0.97  0.09  0.88
forget mean min: 0.968976 0.611762
delta_x = 9.80733 delta_h = 1.58729
U_c = [[-0.02146378]] U_f = [[ 0.]] b_c = [ 0.14464471] b_f = [ 0.4547261]
incx.max(), incx.min(), incx.mean() 18.7727 0.144645 5.80659
fgtx.max(), fgtx.min(), fgtx.mean() 25.2739 0.0 7.68194
delta mean, abs_mean, abs_mean+, abs_mean-: 0.293844 9.80733 7.13712 16.2708
W_c max, min, mean, abs_mean: 0.20092 0.198685 0.200284 0.200284
W_f max, min, mean, abs_mean: 0.272965 0.270859 0.271739 0.271739
Epoch 24/300
0s - loss: 1151.0107 - val_loss: 12223.9970
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 1132.7179 - val_loss: 11912.7970
Epoch 00024: val_loss improved from 12092.89212 to 11912.79699, saving model to baoding_weights.hdf5
             baoding 1058.3978      0.87  0.20  0.71      0.90  0.18  0.75      0.91  0.17  0.77
forget mean min: 0.918703 0.59765
delta_x = 8.08928 delta_h = 0.953231
U_c = [[-0.02074329]] U_f = [[ 0.]] b_c = [ 0.14054865] b_f = [ 0.39568427]
incx.max(), incx.min(), incx.mean() 20.3852 0.140549 4.746
fgtx.max(), fgtx.min(), fgtx.mean() 28.6988 0.0 6.52872
delta mean, abs_mean, abs_mean+, abs_mean-: 0.215691 8.08928 6.62965 10.5361
W_c max, min, mean, abs_mean: 0.203793 0.201454 0.203077 0.203077
W_f max, min, mean, abs_mean: 0.289383 0.286844 0.287884 0.287884
             baoding11912.7972      0.97  0.14  0.83      0.97  0.10  0.87      0.96  0.08  0.89
forget mean min: 0.966384 0.59765
delta_x = 9.99771 delta_h = 1.52297
U_c = [[-0.02074329]] U_f = [[ 0.]] b_c = [ 0.14054865] b_f = [ 0.39568427]
incx.max(), incx.min(), incx.mean() 18.9515 0.140549 5.72601
fgtx.max(), fgtx.min(), fgtx.mean() 26.6665 0.0 7.91798
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0169384 9.99771 7.15851 16.5327
W_c max, min, mean, abs_mean: 0.203793 0.201454 0.203077 0.203077
W_f max, min, mean, abs_mean: 0.289383 0.286844 0.287884 0.287884
Epoch 26/300
0s - loss: 1118.0830 - val_loss: 11692.1482
Epoch 00025: val_loss improved from 11912.79699 to 11692.14820, saving model to baoding_weights.hdf5
             baoding 1045.8690      0.89  0.21  0.72      0.92  0.19  0.76      0.92  0.18  0.77
forget mean min: 0.921225 0.591693
delta_x = 8.23293 delta_h = 0.917117
U_c = [[-0.01919341]] U_f = [[ 0.]] b_c = [ 0.13908178] b_f = [ 0.37096706]
incx.max(), incx.min(), incx.mean() 20.9765 0.139082 4.87564
fgtx.max(), fgtx.min(), fgtx.mean() 30.0263 0.0 6.82529
delta mean, abs_mean, abs_mean+, abs_mean-: 0.352094 8.23293 6.75082 10.8209
W_c max, min, mean, abs_mean: 0.2067 0.204294 0.205934 0.205934
W_f max, min, mean, abs_mean: 0.298357 0.295657 0.296748 0.296748
             baoding11692.1480      0.97  0.14  0.83      0.97  0.10  0.87      0.96  0.08  0.89
forget mean min: 0.967389 0.591693
delta_x = 10.1456 delta_h = 1.48322
U_c = [[-0.01919341]] U_f = [[ 0.]] b_c = [ 0.13908178] b_f = [ 0.37096706]
incx.max(), incx.min(), incx.mean() 19.5551 0.139082 5.87611
fgtx.max(), fgtx.min(), fgtx.mean() 27.9781 0.0 8.26696
delta mean, abs_mean, abs_mean+, abs_mean-: 0.171191 10.1456 7.32555 16.8582
W_c max, min, mean, abs_mean: 0.2067 0.204294 0.205934 0.205934
W_f max, min, mean, abs_mean: 0.298357 0.295657 0.296748 0.296748
Epoch 27/300
0s - loss: 1101.7502 - val_loss: 11928.8426
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 1095.6284 - val_loss: 11558.5426
Epoch 00027: val_loss improved from 11692.14820 to 11558.54264, saving model to baoding_weights.hdf5
             baoding 1014.0048      0.88  0.20  0.72      0.92  0.18  0.76      0.92  0.17  0.77
forget mean min: 0.917787 0.579463
delta_x = 8.42184 delta_h = 1.04094
U_c = [[-0.02216964]] U_f = [[ 0.]] b_c = [ 0.13441497] b_f = [ 0.3205685]
incx.max(), incx.min(), incx.mean() 21.5986 0.134415 4.91834
fgtx.max(), fgtx.min(), fgtx.mean() 31.9459 0.0 7.1201
delta mean, abs_mean, abs_mean+, abs_mean-: 0.294628 8.42184 6.89637 11.0412
W_c max, min, mean, abs_mean: 0.210299 0.207747 0.209426 0.209426
W_f max, min, mean, abs_mean: 0.313515 0.310513 0.311697 0.311697
             baoding11558.5428      0.96  0.13  0.84      0.96  0.09  0.88      0.96  0.07  0.90
forget mean min: 0.965418 0.579463
delta_x = 10.313 delta_h = 1.67693
U_c = [[-0.02216964]] U_f = [[ 0.]] b_c = [ 0.13441497] b_f = [ 0.3205685]
incx.max(), incx.min(), incx.mean() 19.9771 0.134415 5.89925
fgtx.max(), fgtx.min(), fgtx.mean() 29.5327 0.0 8.58004
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0904313 10.313 7.40672 17.1692
W_c max, min, mean, abs_mean: 0.210299 0.207747 0.209426 0.209426
W_f max, min, mean, abs_mean: 0.313515 0.310513 0.311697 0.311697
Epoch 29/300
0s - loss: 1083.6142 - val_loss: 11665.7208
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 1071.3743 - val_loss: 11442.8717
Epoch 00029: val_loss improved from 11558.54264 to 11442.87173, saving model to baoding_weights.hdf5
             baoding 1005.7835      0.90  0.21  0.72      0.94  0.19  0.76      0.94  0.18  0.77
forget mean min: 0.918968 0.567836
delta_x = 8.72252 delta_h = 0.880168
U_c = [[-0.01798533]] U_f = [[ 0.]] b_c = [ 0.13175687] b_f = [ 0.27302802]
incx.max(), incx.min(), incx.mean() 22.6999 0.131757 5.10267
fgtx.max(), fgtx.min(), fgtx.mean() 34.398 0.0 7.5766
delta mean, abs_mean, abs_mean+, abs_mean-: 0.393423 8.72252 7.07776 11.6977
W_c max, min, mean, abs_mean: 0.216102 0.213411 0.215127 0.215127
W_f max, min, mean, abs_mean: 0.32993 0.326601 0.327895 0.327895
             baoding11442.8718      0.97  0.13  0.84      0.96  0.09  0.88      0.96  0.07  0.89
forget mean min: 0.966497 0.567836
delta_x = 10.6313 delta_h = 1.47538
U_c = [[-0.01798533]] U_f = [[ 0.]] b_c = [ 0.13175687] b_f = [ 0.27302802]
incx.max(), incx.min(), incx.mean() 20.8798 0.131757 6.10627
fgtx.max(), fgtx.min(), fgtx.mean() 31.6238 0.0 9.10629
delta mean, abs_mean, abs_mean+, abs_mean-: 0.222971 10.6313 7.62123 18.0765
W_c max, min, mean, abs_mean: 0.216102 0.213411 0.215127 0.215127
W_f max, min, mean, abs_mean: 0.32993 0.326601 0.327895 0.327895
Epoch 31/300
0s - loss: 1056.4490 - val_loss: 11468.3316
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 1052.8716 - val_loss: 11451.8389
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 1045.4275 - val_loss: 11763.7421
Epoch 00032: val_loss did not improve
Epoch 34/300
0s - loss: 1028.8766 - val_loss: 11735.6950
Epoch 00033: val_loss did not improve
Epoch 35/300
0s - loss: 1016.7184 - val_loss: 12194.3491
Epoch 00034: val_loss did not improve
Epoch 36/300
0s - loss: 1001.3730 - val_loss: 12037.8818
Epoch 00035: val_loss did not improve
Epoch 37/300
0s - loss: 993.3209 - val_loss: 11803.1786
Epoch 00036: val_loss did not improve
Epoch 38/300
0s - loss: 981.5059 - val_loss: 12344.1225
Epoch 00037: val_loss did not improve
Epoch 39/300
0s - loss: 969.0666 - val_loss: 12304.8739
Epoch 00038: val_loss did not improve
Epoch 40/300
0s - loss: 969.3772 - val_loss: 12423.7345
Epoch 00039: val_loss did not improve
Epoch 41/300
0s - loss: 964.7759 - val_loss: 12725.0396
Epoch 00040: val_loss did not improve
Epoch 42/300
0s - loss: 946.0806 - val_loss: 13045.2116
Epoch 00041: val_loss did not improve
Epoch 43/300
0s - loss: 949.1437 - val_loss: 13216.8795
Epoch 00042: val_loss did not improve
Epoch 44/300
0s - loss: 944.9757 - val_loss: 12914.9833
Epoch 00043: val_loss did not improve
Epoch 45/300
0s - loss: 939.4964 - val_loss: 13277.6314
Epoch 00044: val_loss did not improve
Epoch 46/300
0s - loss: 936.8842 - val_loss: 13365.8398
Epoch 00045: val_loss did not improve
Epoch 47/300
0s - loss: 930.0224 - val_loss: 13518.7950
Epoch 00046: val_loss did not improve
Epoch 48/300
0s - loss: 920.7492 - val_loss: 13760.1123
Epoch 00047: val_loss did not improve
Epoch 49/300
0s - loss: 919.7219 - val_loss: 14131.1824
Epoch 00048: val_loss did not improve
Epoch 50/300
0s - loss: 916.7472 - val_loss: 14125.6343
Epoch 00049: val_loss did not improve
Epoch 51/300
0s - loss: 908.4774 - val_loss: 13510.1048
Epoch 00050: val_loss did not improve
X_train[0].shape = (4102, 40, 23)

training shijiazhuang
Train on 4102 samples, validate on 812 samples
Before training:
        shijiazhuang 5252.4778      0.02  -nan  0.02      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.20065 delta_h = 2.07456
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.20065 3.20065 nan 3.20065
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
        shijiazhuang38271.2621      0.07  -nan  0.06      0.08  -nan  0.08      0.10  -nan  0.10
forget mean min: 0.731058 0.731059
delta_x = 8.43602 delta_h = 4.9104
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -8.43602 8.43602 nan 8.43602
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 4021.1601 - val_loss: 18779.2272
Epoch 00000: val_loss improved from inf to 18779.22720, saving model to shijiazhuang_weights.hdf5
        shijiazhuang 2279.0772      0.17  0.03  0.17      0.18  0.03  0.17      0.18  0.03  0.17
forget mean min: 0.904664 0.776537
delta_x = 2.52312 delta_h = 1.94174
U_c = [[-0.10958764]] U_f = [[ 0.]] b_c = [ 0.07385238] b_f = [ 1.07216811]
incx.max(), incx.min(), incx.mean() 3.91415 0.252242 1.60726
fgtx.max(), fgtx.min(), fgtx.mean() 3.73304 0.173428 1.49058
delta mean, abs_mean, abs_mean+, abs_mean-: -1.62463 2.52312 1.23456 3.26024
W_c max, min, mean, abs_mean: 0.102076 0.0983674 0.101302 0.101302
W_f max, min, mean, abs_mean: 0.0989642 0.0970846 0.0984807 0.0984807
        shijiazhuang18779.2266      0.68  0.06  0.66      0.69  0.04  0.66      0.70  0.03  0.69
forget mean min: 0.905414 0.776537
delta_x = 5.87493 delta_h = 5.38745
U_c = [[-0.10958764]] U_f = [[ 0.]] b_c = [ 0.07385238] b_f = [ 1.07216811]
incx.max(), incx.min(), incx.mean() 3.9936 0.252242 1.67721
fgtx.max(), fgtx.min(), fgtx.mean() 3.81027 0.173428 1.55858
delta mean, abs_mean, abs_mean+, abs_mean-: -5.37209 5.87493 1.38831 6.86712
W_c max, min, mean, abs_mean: 0.102076 0.0983674 0.101302 0.101302
W_f max, min, mean, abs_mean: 0.0989642 0.0970846 0.0984807 0.0984807
Epoch 2/300
0s - loss: 1629.2411 - val_loss: 11917.2304
Epoch 00001: val_loss improved from 18779.22720 to 11917.23042, saving model to shijiazhuang_weights.hdf5
        shijiazhuang 1344.6940      0.71  0.32  0.53      0.73  0.31  0.55      0.72  0.29  0.56
forget mean min: 0.937457 0.787812
delta_x = 4.30985 delta_h = 1.62318
U_c = [[-0.05710878]] U_f = [[ 0.]] b_c = [ 0.09779165] b_f = [ 1.07286298]
incx.max(), incx.min(), incx.mean() 7.64078 0.366123 3.25538
fgtx.max(), fgtx.min(), fgtx.mean() 6.71581 0.238922 2.81133
delta mean, abs_mean, abs_mean+, abs_mean-: 0.742923 4.30985 4.02007 4.79997
W_c max, min, mean, abs_mean: 0.137091 0.133405 0.13632 0.13632
W_f max, min, mean, abs_mean: 0.121901 0.119958 0.121377 0.121377
        shijiazhuang11917.2307      0.89  0.08  0.83      0.90  0.07  0.85      0.90  0.05  0.86
forget mean min: 0.943504 0.787812
delta_x = 5.80976 delta_h = 3.02473
U_c = [[-0.05710878]] U_f = [[ 0.]] b_c = [ 0.09779165] b_f = [ 1.07286298]
incx.max(), incx.min(), incx.mean() 7.4903 0.366123 3.43246
fgtx.max(), fgtx.min(), fgtx.mean() 6.58185 0.238922 2.969
delta mean, abs_mean, abs_mean+, abs_mean-: -1.13821 5.80976 4.09577 8.08448
W_c max, min, mean, abs_mean: 0.137091 0.133405 0.13632 0.13632
W_f max, min, mean, abs_mean: 0.121901 0.119958 0.121377 0.121377
Epoch 3/300
0s - loss: 1295.6722 - val_loss: 11382.8873
Epoch 00002: val_loss improved from 11917.23042 to 11382.88732, saving model to shijiazhuang_weights.hdf5
        shijiazhuang 1265.5866      0.75  0.33  0.54      0.77  0.33  0.56      0.78  0.31  0.57
forget mean min: 0.935871 0.767789
delta_x = 4.44189 delta_h = 1.2196
U_c = [[-0.03824072]] U_f = [[ 0.]] b_c = [ 0.09150245] b_f = [ 1.02948833]
incx.max(), incx.min(), incx.mean() 7.81555 0.271578 3.26859
fgtx.max(), fgtx.min(), fgtx.mean() 7.13608 0.166378 2.93525
delta mean, abs_mean, abs_mean+, abs_mean-: 0.696713 4.44189 3.98284 5.2763
W_c max, min, mean, abs_mean: 0.139168 0.135478 0.138404 0.138404
W_f max, min, mean, abs_mean: 0.128453 0.126187 0.127874 0.127874
        shijiazhuang11382.8874      0.89  0.08  0.83      0.90  0.07  0.84      0.91  0.05  0.86
forget mean min: 0.943127 0.767789
delta_x = 5.86885 delta_h = 2.28816
U_c = [[-0.03824072]] U_f = [[ 0.]] b_c = [ 0.09150245] b_f = [ 1.02948833]
incx.max(), incx.min(), incx.mean() 7.29208 0.271578 3.44806
fgtx.max(), fgtx.min(), fgtx.mean() 6.65247 0.166378 3.10106
delta mean, abs_mean, abs_mean+, abs_mean-: -1.06436 5.86885 4.12634 8.29676
W_c max, min, mean, abs_mean: 0.139168 0.135478 0.138404 0.138404
W_f max, min, mean, abs_mean: 0.128453 0.126187 0.127874 0.127874
Epoch 4/300
0s - loss: 1239.9196 - val_loss: 11937.7131
Epoch 00003: val_loss did not improve
Epoch 5/300
0s - loss: 1198.1323 - val_loss: 13859.1768
Epoch 00004: val_loss did not improve
Epoch 6/300
0s - loss: 1166.1700 - val_loss: 13342.8555
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 1131.5879 - val_loss: 14284.3176
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 1105.4668 - val_loss: 14597.1194
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 1089.0355 - val_loss: 12710.8151
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 1069.2046 - val_loss: 11630.6671
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 1050.8201 - val_loss: 11056.0823
Epoch 00010: val_loss improved from 11382.88732 to 11056.08232, saving model to shijiazhuang_weights.hdf5
        shijiazhuang 1074.0534      0.76  0.31  0.56      0.79  0.31  0.58      0.80  0.29  0.61
forget mean min: 0.920851 0.689705
delta_x = 6.07847 delta_h = 0.522171
U_c = [[-0.01510867]] U_f = [[ 0.]] b_c = [ 0.11404922] b_f = [ 0.79874128]
incx.max(), incx.min(), incx.mean() 15.1566 0.114049 4.17439
fgtx.max(), fgtx.min(), fgtx.mean() 12.9771 0.0 3.50282
delta mean, abs_mean, abs_mean+, abs_mean-: 0.535574 6.07847 5.46893 7.01088
W_c max, min, mean, abs_mean: 0.18727 0.183462 0.186204 0.186204
W_f max, min, mean, abs_mean: 0.161472 0.158749 0.16064 0.16064
        shijiazhuang11056.0821      0.83  0.07  0.78      0.83  0.06  0.79      0.83  0.04  0.80
forget mean min: 0.927918 0.689705
delta_x = 6.92652 delta_h = 1.06587
U_c = [[-0.01510867]] U_f = [[ 0.]] b_c = [ 0.11404922] b_f = [ 0.79874128]
incx.max(), incx.min(), incx.mean() 10.527 0.114049 3.84838
fgtx.max(), fgtx.min(), fgtx.mean() 8.98323 0.0 3.22157
delta mean, abs_mean, abs_mean+, abs_mean-: -1.63483 6.92652 4.53781 10.267
W_c max, min, mean, abs_mean: 0.18727 0.183462 0.186204 0.186204
W_f max, min, mean, abs_mean: 0.161472 0.158749 0.16064 0.16064
Epoch 12/300
0s - loss: 1036.3858 - val_loss: 11377.6700
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 1026.3244 - val_loss: 12094.8074
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 1019.7943 - val_loss: 11181.4157
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 1010.5922 - val_loss: 11471.4343
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 1007.4570 - val_loss: 11239.5557
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 999.4745 - val_loss: 10420.7153
Epoch 00016: val_loss improved from 11056.08232 to 10420.71531, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  982.6772      0.72  0.26  0.57      0.75  0.25  0.60      0.76  0.22  0.62
forget mean min: 0.912725 0.660847
delta_x = 6.40406 delta_h = 0.617889
U_c = [[-0.01918616]] U_f = [[ 0.]] b_c = [ 0.12578137] b_f = [ 0.66706884]
incx.max(), incx.min(), incx.mean() 16.3527 0.125781 4.17192
fgtx.max(), fgtx.min(), fgtx.mean() 15.5574 0.0 3.87915
delta mean, abs_mean, abs_mean+, abs_mean-: 0.371987 6.40406 5.62556 7.58284
W_c max, min, mean, abs_mean: 0.200294 0.196431 0.199198 0.199198
W_f max, min, mean, abs_mean: 0.191869 0.189164 0.19098 0.19098
        shijiazhuang10420.7152      0.83  0.06  0.79      0.83  0.05  0.80      0.84  0.03  0.82
forget mean min: 0.925039 0.660847
delta_x = 6.88396 delta_h = 1.34482
U_c = [[-0.01918616]] U_f = [[ 0.]] b_c = [ 0.12578137] b_f = [ 0.66706884]
incx.max(), incx.min(), incx.mean() 11.1464 0.125781 3.81817
fgtx.max(), fgtx.min(), fgtx.mean() 10.5659 0.0 3.53998
delta mean, abs_mean, abs_mean+, abs_mean-: -1.56667 6.88396 4.41296 10.6287
W_c max, min, mean, abs_mean: 0.200294 0.196431 0.199198 0.199198
W_f max, min, mean, abs_mean: 0.191869 0.189164 0.19098 0.19098
Epoch 18/300
0s - loss: 995.1833 - val_loss: 10160.1493
Epoch 00017: val_loss improved from 10420.71531 to 10160.14930, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  988.1639      0.73  0.27  0.58      0.76  0.26  0.60      0.77  0.23  0.62
forget mean min: 0.91203 0.655932
delta_x = 6.55074 delta_h = 0.612925
U_c = [[-0.01856912]] U_f = [[ 0.]] b_c = [ 0.12843615] b_f = [ 0.64521706]
incx.max(), incx.min(), incx.mean() 16.5845 0.128436 4.23325
fgtx.max(), fgtx.min(), fgtx.mean() 15.9667 0.0 3.98271
delta mean, abs_mean, abs_mean+, abs_mean-: 0.402979 6.55074 5.73344 7.81
W_c max, min, mean, abs_mean: 0.202867 0.199005 0.201783 0.201783
W_f max, min, mean, abs_mean: 0.196661 0.193979 0.195784 0.195784
        shijiazhuang10160.1493      0.84  0.07  0.79      0.84  0.05  0.80      0.84  0.03  0.81
forget mean min: 0.925461 0.655932
delta_x = 7.13222 delta_h = 1.35108
U_c = [[-0.01856912]] U_f = [[ 0.]] b_c = [ 0.12843615] b_f = [ 0.64521706]
incx.max(), incx.min(), incx.mean() 11.7802 0.128436 3.93308
fgtx.max(), fgtx.min(), fgtx.mean() 11.3052 0.0 3.69145
delta mean, abs_mean, abs_mean+, abs_mean-: -1.45128 7.13222 4.62634 11.1179
W_c max, min, mean, abs_mean: 0.202867 0.199005 0.201783 0.201783
W_f max, min, mean, abs_mean: 0.196661 0.193979 0.195784 0.195784
Epoch 19/300
0s - loss: 991.0189 - val_loss: 9979.8824
Epoch 00018: val_loss improved from 10160.14930 to 9979.88235, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  993.3362      0.75  0.30  0.57      0.78  0.29  0.59      0.80  0.27  0.61
forget mean min: 0.914781 0.651641
delta_x = 6.56128 delta_h = 0.591751
U_c = [[-0.01724973]] U_f = [[ 0.]] b_c = [ 0.12959494] b_f = [ 0.62626141]
incx.max(), incx.min(), incx.mean() 16.7679 0.129595 4.28786
fgtx.max(), fgtx.min(), fgtx.mean() 16.5239 0.0 4.12963
delta mean, abs_mean, abs_mean+, abs_mean-: 0.482332 6.56128 5.76652 7.80819
W_c max, min, mean, abs_mean: 0.20379 0.199926 0.20271 0.20271
W_f max, min, mean, abs_mean: 0.202187 0.19952 0.201318 0.201318
        shijiazhuang 9979.8823      0.84  0.06  0.80      0.85  0.05  0.82      0.86  0.03  0.84
forget mean min: 0.926697 0.651641
delta_x = 6.91929 delta_h = 1.24282
U_c = [[-0.01724973]] U_f = [[ 0.]] b_c = [ 0.12959494] b_f = [ 0.62626141]
incx.max(), incx.min(), incx.mean() 11.6865 0.129595 3.88676
fgtx.max(), fgtx.min(), fgtx.mean() 11.4774 0.0 3.73128
delta mean, abs_mean, abs_mean+, abs_mean-: -1.40984 6.91929 4.44147 10.966
W_c max, min, mean, abs_mean: 0.20379 0.199926 0.20271 0.20271
W_f max, min, mean, abs_mean: 0.202187 0.19952 0.201318 0.201318
Epoch 20/300
0s - loss: 988.3734 - val_loss: 10387.4628
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 981.1966 - val_loss: 9720.6074
Epoch 00020: val_loss improved from 9979.88235 to 9720.60744, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  971.7602      0.75  0.29  0.57      0.78  0.27  0.60      0.79  0.25  0.62
forget mean min: 0.912765 0.642354
delta_x = 6.62198 delta_h = 0.685134
U_c = [[-0.02038158]] U_f = [[ 0.]] b_c = [ 0.13445634] b_f = [ 0.5855971]
incx.max(), incx.min(), incx.mean() 17.1027 0.134456 4.28818
fgtx.max(), fgtx.min(), fgtx.mean() 17.3772 0.0 4.25379
delta mean, abs_mean, abs_mean+, abs_mean-: 0.466486 6.62198 5.78518 7.94545
W_c max, min, mean, abs_mean: 0.206385 0.202521 0.205318 0.205318
W_f max, min, mean, abs_mean: 0.2112 0.208491 0.210268 0.210268
        shijiazhuang 9720.6074      0.85  0.06  0.80      0.86  0.05  0.82      0.86  0.03  0.84
forget mean min: 0.92609 0.642354
delta_x = 6.95903 delta_h = 1.46611
U_c = [[-0.02038158]] U_f = [[ 0.]] b_c = [ 0.13445634] b_f = [ 0.5855971]
incx.max(), incx.min(), incx.mean() 11.926 0.134456 3.91296
fgtx.max(), fgtx.min(), fgtx.mean() 12.0757 0.0 3.8695
delta mean, abs_mean, abs_mean+, abs_mean-: -1.32106 6.95903 4.45313 11.2819
W_c max, min, mean, abs_mean: 0.206385 0.202521 0.205318 0.205318
W_f max, min, mean, abs_mean: 0.2112 0.208491 0.210268 0.210268
Epoch 22/300
0s - loss: 978.2048 - val_loss: 9788.0636
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 976.1929 - val_loss: 10603.2475
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 972.6620 - val_loss: 9618.8137
Epoch 00023: val_loss improved from 9720.60744 to 9618.81370, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  955.7045      0.74  0.28  0.57      0.77  0.27  0.60      0.78  0.25  0.62
forget mean min: 0.910608 0.629211
delta_x = 6.62355 delta_h = 0.668365
U_c = [[-0.01992312]] U_f = [[ 0.]] b_c = [ 0.14387408] b_f = [ 0.52883494]
incx.max(), incx.min(), incx.mean() 17.0511 0.143874 4.25438
fgtx.max(), fgtx.min(), fgtx.mean() 17.8916 0.0 4.3498
delta mean, abs_mean, abs_mean+, abs_mean-: 0.407114 6.62355 5.73031 8.04119
W_c max, min, mean, abs_mean: 0.210185 0.206236 0.209061 0.209061
W_f max, min, mean, abs_mean: 0.222338 0.21951 0.221234 0.221234
        shijiazhuang 9618.8136      0.85  0.06  0.81      0.86  0.04  0.83      0.87  0.03  0.85
forget mean min: 0.926301 0.629211
delta_x = 6.92854 delta_h = 1.44106
U_c = [[-0.01992312]] U_f = [[ 0.]] b_c = [ 0.14387408] b_f = [ 0.52883494]
incx.max(), incx.min(), incx.mean() 11.9581 0.143874 3.91584
fgtx.max(), fgtx.min(), fgtx.mean() 12.502 0.0 3.99151
delta mean, abs_mean, abs_mean+, abs_mean-: -1.29026 6.92854 4.3929 11.4707
W_c max, min, mean, abs_mean: 0.210185 0.206236 0.209061 0.209061
W_f max, min, mean, abs_mean: 0.222338 0.21951 0.221234 0.221234
Epoch 25/300
0s - loss: 971.0675 - val_loss: 9108.0329
Epoch 00024: val_loss improved from 9618.81370 to 9108.03287, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  962.5451      0.76  0.29  0.58      0.79  0.28  0.60      0.81  0.27  0.62
forget mean min: 0.912363 0.625627
delta_x = 6.73747 delta_h = 0.724648
U_c = [[-0.02123068]] U_f = [[ 0.]] b_c = [ 0.14876264] b_f = [ 0.51350057]
incx.max(), incx.min(), incx.mean() 17.3686 0.148763 4.35262
fgtx.max(), fgtx.min(), fgtx.mean() 18.384 0.0 4.48803
delta mean, abs_mean, abs_mean+, abs_mean-: 0.504408 6.73747 5.81875 8.25108
W_c max, min, mean, abs_mean: 0.213041 0.209042 0.211877 0.211877
W_f max, min, mean, abs_mean: 0.227363 0.224497 0.226202 0.226202
        shijiazhuang 9108.0329      0.87  0.06  0.82      0.88  0.05  0.84      0.89  0.03  0.87
forget mean min: 0.92722 0.625627
delta_x = 7.014 delta_h = 1.58666
U_c = [[-0.02123068]] U_f = [[ 0.]] b_c = [ 0.14876264] b_f = [ 0.51350057]
incx.max(), incx.min(), incx.mean() 12.5306 0.148763 4.02797
fgtx.max(), fgtx.min(), fgtx.mean() 13.2189 0.0 4.14138
delta mean, abs_mean, abs_mean+, abs_mean-: -1.05159 7.014 4.47146 12.1002
W_c max, min, mean, abs_mean: 0.213041 0.209042 0.211877 0.211877
W_f max, min, mean, abs_mean: 0.227363 0.224497 0.226202 0.226202
Epoch 26/300
0s - loss: 966.3339 - val_loss: 9248.4956
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 961.4356 - val_loss: 10562.7625
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 957.1983 - val_loss: 9214.0317
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 953.6909 - val_loss: 9525.6959
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 948.8974 - val_loss: 9403.2388
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 942.3405 - val_loss: 10605.1414
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 933.3585 - val_loss: 9844.9584
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 933.2191 - val_loss: 8983.0699
Epoch 00032: val_loss improved from 9108.03287 to 8983.06987, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  913.3153      0.76  0.27  0.59      0.79  0.25  0.62      0.81  0.23  0.65
forget mean min: 0.908364 0.58901
delta_x = 6.69228 delta_h = 0.639286
U_c = [[-0.0187885]] U_f = [[ 0.]] b_c = [ 0.18127894] b_f = [ 0.35987419]
incx.max(), incx.min(), incx.mean() 17.7263 0.181279 4.32428
fgtx.max(), fgtx.min(), fgtx.mean() 19.7006 0.0 4.65192
delta mean, abs_mean, abs_mean+, abs_mean-: 0.411176 6.69228 5.66454 8.41996
W_c max, min, mean, abs_mean: 0.227493 0.222955 0.225897 0.225897
W_f max, min, mean, abs_mean: 0.255276 0.252053 0.253648 0.253648
        shijiazhuang 8983.0698      0.86  0.06  0.82      0.87  0.04  0.84      0.88  0.03  0.85
forget mean min: 0.923504 0.58901
delta_x = 7.01989 delta_h = 1.46657
U_c = [[-0.0187885]] U_f = [[ 0.]] b_c = [ 0.18127894] b_f = [ 0.35987419]
incx.max(), incx.min(), incx.mean() 12.973 0.181279 4.06186
fgtx.max(), fgtx.min(), fgtx.mean() 14.3631 0.0 4.35719
delta mean, abs_mean, abs_mean+, abs_mean-: -1.01338 7.01989 4.41423 12.566
W_c max, min, mean, abs_mean: 0.227493 0.222955 0.225897 0.225897
W_f max, min, mean, abs_mean: 0.255276 0.252053 0.253648 0.253648
Epoch 34/300
0s - loss: 925.9671 - val_loss: 8885.5813
Epoch 00033: val_loss improved from 8983.06987 to 8885.58131, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  914.8340      0.76  0.26  0.60      0.79  0.24  0.63      0.79  0.22  0.65
forget mean min: 0.907479 0.583944
delta_x = 6.64849 delta_h = 0.659833
U_c = [[-0.019535]] U_f = [[ 0.]] b_c = [ 0.18555112] b_f = [ 0.33898592]
incx.max(), incx.min(), incx.mean() 17.3348 0.185551 4.28911
fgtx.max(), fgtx.min(), fgtx.mean() 19.432 0.0 4.64971
delta mean, abs_mean, abs_mean+, abs_mean-: 0.400168 6.64849 5.615 8.39069
W_c max, min, mean, abs_mean: 0.227996 0.223365 0.226324 0.226324
W_f max, min, mean, abs_mean: 0.258124 0.25478 0.256449 0.256449
        shijiazhuang 8885.5813      0.87  0.06  0.82      0.88  0.04  0.84      0.89  0.03  0.87
forget mean min: 0.922842 0.583944
delta_x = 7.12192 delta_h = 1.55032
U_c = [[-0.019535]] U_f = [[ 0.]] b_c = [ 0.18555112] b_f = [ 0.33898592]
incx.max(), incx.min(), incx.mean() 12.8841 0.185551 4.10585
fgtx.max(), fgtx.min(), fgtx.mean() 14.3887 0.0 4.44199
delta mean, abs_mean, abs_mean+, abs_mean-: -0.913954 7.12192 4.47064 13.1436
W_c max, min, mean, abs_mean: 0.227996 0.223365 0.226324 0.226324
W_f max, min, mean, abs_mean: 0.258124 0.25478 0.256449 0.256449
Epoch 35/300
0s - loss: 922.3069 - val_loss: 9025.6504
Epoch 00034: val_loss did not improve
Epoch 36/300
0s - loss: 919.3304 - val_loss: 9425.2400
Epoch 00035: val_loss did not improve
Epoch 37/300
0s - loss: 916.3835 - val_loss: 8797.1774
Epoch 00036: val_loss improved from 8885.58131 to 8797.17743, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  904.5595      0.77  0.28  0.60      0.80  0.26  0.62      0.82  0.24  0.64
forget mean min: 0.909075 0.569644
delta_x = 6.78112 delta_h = 0.619992
U_c = [[-0.01797629]] U_f = [[ 0.]] b_c = [ 0.20340002] b_f = [ 0.28039718]
incx.max(), incx.min(), incx.mean() 18.0261 0.2034 4.4323
fgtx.max(), fgtx.min(), fgtx.mean() 19.9962 0.0 4.74454
delta mean, abs_mean, abs_mean+, abs_mean-: 0.456577 6.78112 5.71404 8.62418
W_c max, min, mean, abs_mean: 0.237101 0.232236 0.235243 0.235243
W_f max, min, mean, abs_mean: 0.265849 0.261933 0.263929 0.263929
        shijiazhuang 8797.1775      0.87  0.06  0.82      0.88  0.04  0.84      0.88  0.02  0.86
forget mean min: 0.923056 0.569644
delta_x = 6.99388 delta_h = 1.43226
U_c = [[-0.01797629]] U_f = [[ 0.]] b_c = [ 0.20340002] b_f = [ 0.28039718]
incx.max(), incx.min(), incx.mean() 12.8755 0.2034 4.14596
fgtx.max(), fgtx.min(), fgtx.mean() 14.2173 0.0 4.42321
delta mean, abs_mean, abs_mean+, abs_mean-: -0.913538 6.99388 4.43478 12.5726
W_c max, min, mean, abs_mean: 0.237101 0.232236 0.235243 0.235243
W_f max, min, mean, abs_mean: 0.265849 0.261933 0.263929 0.263929
Epoch 38/300
0s - loss: 910.9455 - val_loss: 10019.6500
Epoch 00037: val_loss did not improve
Epoch 39/300
0s - loss: 908.8780 - val_loss: 9556.9851
Epoch 00038: val_loss did not improve
Epoch 40/300
0s - loss: 908.1464 - val_loss: 9624.0722
Epoch 00039: val_loss did not improve
Epoch 41/300
0s - loss: 902.7222 - val_loss: 9136.6228
Epoch 00040: val_loss did not improve
Epoch 42/300
0s - loss: 901.1863 - val_loss: 9098.1828
Epoch 00041: val_loss did not improve
Epoch 43/300
0s - loss: 899.1333 - val_loss: 9559.9794
Epoch 00042: val_loss did not improve
Epoch 44/300
0s - loss: 891.7341 - val_loss: 9408.1336
Epoch 00043: val_loss did not improve
Epoch 45/300
0s - loss: 889.8415 - val_loss: 8969.1942
Epoch 00044: val_loss did not improve
Epoch 46/300
0s - loss: 889.5195 - val_loss: 9633.3087
Epoch 00045: val_loss did not improve
Epoch 47/300
0s - loss: 887.8769 - val_loss: 10077.2906
Epoch 00046: val_loss did not improve
Epoch 48/300
0s - loss: 881.0480 - val_loss: 8814.8924
Epoch 00047: val_loss did not improve
Epoch 49/300
0s - loss: 884.0409 - val_loss: 8536.4888
Epoch 00048: val_loss improved from 8797.17743 to 8536.48882, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  870.5952      0.78  0.27  0.61      0.81  0.25  0.64      0.83  0.23  0.66
forget mean min: 0.902306 0.526221
delta_x = 7.09316 delta_h = 0.516802
U_c = [[-0.01460038]] U_f = [[ 0.]] b_c = [ 0.27682772] b_f = [ 0.10498204]
incx.max(), incx.min(), incx.mean() 18.6052 0.276828 4.67279
fgtx.max(), fgtx.min(), fgtx.mean() 19.4728 0.0 4.67026
delta mean, abs_mean, abs_mean+, abs_mean-: 0.417549 7.09316 5.90159 9.17812
W_c max, min, mean, abs_mean: 0.271484 0.265302 0.268548 0.268548
W_f max, min, mean, abs_mean: 0.288447 0.281835 0.285308 0.285308
        shijiazhuang 8536.4887      0.87  0.05  0.83      0.88  0.04  0.85      0.89  0.02  0.87
forget mean min: 0.916425 0.526221
delta_x = 7.48255 delta_h = 1.23241
U_c = [[-0.01460038]] U_f = [[ 0.]] b_c = [ 0.27682772] b_f = [ 0.10498204]
incx.max(), incx.min(), incx.mean() 13.5567 0.276828 4.51699
fgtx.max(), fgtx.min(), fgtx.mean() 14.1086 0.0 4.50457
delta mean, abs_mean, abs_mean+, abs_mean-: -0.834464 7.48255 4.92923 12.77
W_c max, min, mean, abs_mean: 0.271484 0.265302 0.268548 0.268548
W_f max, min, mean, abs_mean: 0.288447 0.281835 0.285308 0.285308
Epoch 50/300
0s - loss: 878.5398 - val_loss: 9564.5814
Epoch 00049: val_loss did not improve
Epoch 51/300
0s - loss: 873.5093 - val_loss: 8708.3715
Epoch 00050: val_loss did not improve
Epoch 52/300
0s - loss: 871.4866 - val_loss: 8892.1659
Epoch 00051: val_loss did not improve
Epoch 53/300
0s - loss: 870.9186 - val_loss: 9557.3747
Epoch 00052: val_loss did not improve
Epoch 54/300
0s - loss: 864.7377 - val_loss: 8787.6980
Epoch 00053: val_loss did not improve
Epoch 55/300
0s - loss: 862.3416 - val_loss: 8746.0469
Epoch 00054: val_loss did not improve
Epoch 56/300
0s - loss: 862.0478 - val_loss: 9275.5976
Epoch 00055: val_loss did not improve
Epoch 57/300
0s - loss: 861.3480 - val_loss: 8578.6357
Epoch 00056: val_loss did not improve
Epoch 58/300
0s - loss: 853.6321 - val_loss: 8742.4036
Epoch 00057: val_loss did not improve
Epoch 59/300
0s - loss: 854.6755 - val_loss: 8221.7313
Epoch 00058: val_loss improved from 8536.48882 to 8221.73126, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  822.7459      0.76  0.24  0.61      0.80  0.22  0.65      0.80  0.20  0.67
forget mean min: 0.896144 0.500161
delta_x = 7.09516 delta_h = 0.591028
U_c = [[-0.01739131]] U_f = [[ 0.]] b_c = [ 0.32964396] b_f = [ 0.00064346]
incx.max(), incx.min(), incx.mean() 19.0475 0.329644 4.67018
fgtx.max(), fgtx.min(), fgtx.mean() 19.9121 0.0 4.61717
delta mean, abs_mean, abs_mean+, abs_mean-: 0.310065 7.09516 5.9243 9.0465
W_c max, min, mean, abs_mean: 0.296284 0.288509 0.292221 0.292221
W_f max, min, mean, abs_mean: 0.315325 0.305714 0.310848 0.310848
        shijiazhuang 8221.7314      0.88  0.05  0.84      0.88  0.03  0.85      0.89  0.02  0.87
forget mean min: 0.910645 0.500161
delta_x = 7.57342 delta_h = 1.44439
U_c = [[-0.01739131]] U_f = [[ 0.]] b_c = [ 0.32964396] b_f = [ 0.00064346]
incx.max(), incx.min(), incx.mean() 13.8287 0.329644 4.60342
fgtx.max(), fgtx.min(), fgtx.mean() 14.3596 0.0 4.54589
delta mean, abs_mean, abs_mean+, abs_mean-: -0.814151 7.57342 5.1333 12.276
W_c max, min, mean, abs_mean: 0.296284 0.288509 0.292221 0.292221
W_f max, min, mean, abs_mean: 0.315325 0.305714 0.310848 0.310848
Epoch 60/300
0s - loss: 853.7166 - val_loss: 8561.9248
Epoch 00059: val_loss did not improve
Epoch 61/300
0s - loss: 850.7664 - val_loss: 8869.2045
Epoch 00060: val_loss did not improve
Epoch 62/300
0s - loss: 851.4347 - val_loss: 8386.5801
Epoch 00061: val_loss did not improve
Epoch 63/300
0s - loss: 847.7504 - val_loss: 9038.5537
Epoch 00062: val_loss did not improve
Epoch 64/300
0s - loss: 846.6531 - val_loss: 8605.3510
Epoch 00063: val_loss did not improve
Epoch 65/300
0s - loss: 845.5587 - val_loss: 8553.0235
Epoch 00064: val_loss did not improve
Epoch 66/300
0s - loss: 844.5750 - val_loss: 7881.6020
Epoch 00065: val_loss improved from 8221.73126 to 7881.60198, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  847.2612      0.81  0.28  0.61      0.84  0.26  0.64      0.85  0.25  0.66
forget mean min: 0.898542 0.488105
delta_x = 7.46027 delta_h = 0.585759
U_c = [[-0.01597002]] U_f = [[ 0.]] b_c = [ 0.36182317] b_f = [-0.04758763]
incx.max(), incx.min(), incx.mean() 20.1044 0.361823 4.9258
fgtx.max(), fgtx.min(), fgtx.mean() 21.3378 0.0 4.93232
delta mean, abs_mean, abs_mean+, abs_mean-: 0.487066 7.46027 6.20125 9.70618
W_c max, min, mean, abs_mean: 0.311631 0.302458 0.306725 0.306725
W_f max, min, mean, abs_mean: 0.336962 0.325055 0.331486 0.331486
        shijiazhuang 7881.6019      0.89  0.05  0.85      0.90  0.03  0.87      0.90  0.02  0.89
forget mean min: 0.910324 0.488105
delta_x = 7.80955 delta_h = 1.39839
U_c = [[-0.01597002]] U_f = [[ 0.]] b_c = [ 0.36182317] b_f = [-0.04758763]
incx.max(), incx.min(), incx.mean() 14.1912 0.361823 4.80071
fgtx.max(), fgtx.min(), fgtx.mean() 14.9458 0.0 4.79677
delta mean, abs_mean, abs_mean+, abs_mean-: -0.540833 7.80955 5.40742 12.7334
W_c max, min, mean, abs_mean: 0.311631 0.302458 0.306725 0.306725
W_f max, min, mean, abs_mean: 0.336962 0.325055 0.331486 0.331486
Epoch 67/300
0s - loss: 846.6105 - val_loss: 8451.2688
Epoch 00066: val_loss did not improve
Epoch 68/300
0s - loss: 839.2191 - val_loss: 8774.7949
Epoch 00067: val_loss did not improve
Epoch 69/300
0s - loss: 841.2535 - val_loss: 8479.2175
Epoch 00068: val_loss did not improve
Epoch 70/300
0s - loss: 839.3534 - val_loss: 8260.2293
Epoch 00069: val_loss did not improve
Epoch 71/300
0s - loss: 837.7373 - val_loss: 9727.8777
Epoch 00070: val_loss did not improve
Epoch 72/300
0s - loss: 837.7042 - val_loss: 8423.3040
Epoch 00071: val_loss did not improve
Epoch 73/300
0s - loss: 830.1386 - val_loss: 7902.9859
Epoch 00072: val_loss did not improve
Epoch 74/300
0s - loss: 833.9386 - val_loss: 7709.6895
Epoch 00073: val_loss improved from 7881.60198 to 7709.68948, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  848.7508      0.81  0.27  0.62      0.83  0.25  0.65      0.85  0.23  0.68
forget mean min: 0.896668 0.476618
delta_x = 7.53464 delta_h = 0.595968
U_c = [[-0.01617528]] U_f = [[ 0.]] b_c = [ 0.39542565] b_f = [-0.09359627]
incx.max(), incx.min(), incx.mean() 20.3091 0.395426 4.96636
fgtx.max(), fgtx.min(), fgtx.mean() 21.8124 0.0 5.00612
delta mean, abs_mean, abs_mean+, abs_mean-: 0.497945 7.53464 6.23132 9.89783
W_c max, min, mean, abs_mean: 0.324397 0.313306 0.318334 0.318334
W_f max, min, mean, abs_mean: 0.355278 0.340613 0.348652 0.348652
        shijiazhuang 7709.6894      0.89  0.05  0.86      0.90  0.03  0.88      0.91  0.02  0.89
forget mean min: 0.906144 0.476618
delta_x = 8.01797 delta_h = 1.45643
U_c = [[-0.01617528]] U_f = [[ 0.]] b_c = [ 0.39542565] b_f = [-0.09359627]
incx.max(), incx.min(), incx.mean() 14.3327 0.395426 4.90708
fgtx.max(), fgtx.min(), fgtx.mean() 15.2647 0.0 4.94069
delta mean, abs_mean, abs_mean+, abs_mean-: -0.4328 8.01797 5.53235 13.4365
W_c max, min, mean, abs_mean: 0.324397 0.313306 0.318334 0.318334
W_f max, min, mean, abs_mean: 0.355278 0.340613 0.348652 0.348652
Epoch 75/300
0s - loss: 834.3526 - val_loss: 8366.4290
Epoch 00074: val_loss did not improve
Epoch 76/300
0s - loss: 828.9449 - val_loss: 8658.1596
Epoch 00075: val_loss did not improve
Epoch 77/300
0s - loss: 833.5259 - val_loss: 7774.3916
Epoch 00076: val_loss did not improve
Epoch 78/300
0s - loss: 824.4250 - val_loss: 8189.4838
Epoch 00077: val_loss did not improve
Epoch 79/300
0s - loss: 828.6194 - val_loss: 8280.6564
Epoch 00078: val_loss did not improve
Epoch 80/300
0s - loss: 828.9488 - val_loss: 7859.8399
Epoch 00079: val_loss did not improve
Epoch 81/300
0s - loss: 830.4429 - val_loss: 8252.5761
Epoch 00080: val_loss did not improve
Epoch 82/300
0s - loss: 825.9888 - val_loss: 8809.9878
Epoch 00081: val_loss did not improve
Epoch 83/300
0s - loss: 823.2139 - val_loss: 8050.4461
Epoch 00082: val_loss did not improve
Epoch 84/300
0s - loss: 822.7772 - val_loss: 7745.7000
Epoch 00083: val_loss did not improve
Epoch 85/300
0s - loss: 823.2353 - val_loss: 7925.2181
Epoch 00084: val_loss did not improve
Epoch 86/300
0s - loss: 822.1072 - val_loss: 8187.0845
Epoch 00085: val_loss did not improve
Epoch 87/300
0s - loss: 823.7192 - val_loss: 8715.8563
Epoch 00086: val_loss did not improve
Epoch 88/300
0s - loss: 823.0815 - val_loss: 7978.9721
Epoch 00087: val_loss did not improve
Epoch 89/300
0s - loss: 821.2242 - val_loss: 7619.8360
Epoch 00088: val_loss improved from 7709.68948 to 7619.83600, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  811.7037      0.80  0.26  0.62      0.83  0.24  0.66      0.84  0.22  0.68
forget mean min: 0.899913 0.458569
delta_x = 7.51517 delta_h = 0.626596
U_c = [[-0.01775592]] U_f = [[ 0.]] b_c = [ 0.45016092] b_f = [-0.16610311]
incx.max(), incx.min(), incx.mean() 21.0311 0.450161 5.04436
fgtx.max(), fgtx.min(), fgtx.mean() 22.6609 0.0 5.05748
delta mean, abs_mean, abs_mean+, abs_mean-: 0.514613 7.51517 6.24858 9.79175
W_c max, min, mean, abs_mean: 0.344656 0.3288 0.335999 0.335999
W_f max, min, mean, abs_mean: 0.378666 0.358541 0.3699 0.3699
        shijiazhuang 7619.8358      0.89  0.04  0.86      0.90  0.03  0.88      0.91  0.01  0.90
forget mean min: 0.901346 0.458569
delta_x = 7.76851 delta_h = 1.50018
U_c = [[-0.01775592]] U_f = [[ 0.]] b_c = [ 0.45016092] b_f = [-0.16610311]
incx.max(), incx.min(), incx.mean() 13.9797 0.450161 4.83393
fgtx.max(), fgtx.min(), fgtx.mean() 14.8949 0.0 4.82499
delta mean, abs_mean, abs_mean+, abs_mean-: -0.579669 7.76851 5.41522 12.4141
W_c max, min, mean, abs_mean: 0.344656 0.3288 0.335999 0.335999
W_f max, min, mean, abs_mean: 0.378666 0.358541 0.3699 0.3699
Epoch 90/300
0s - loss: 820.8341 - val_loss: 7621.8585
Epoch 00089: val_loss did not improve
Epoch 91/300
0s - loss: 815.8292 - val_loss: 8033.9280
Epoch 00090: val_loss did not improve
Epoch 92/300
0s - loss: 818.0073 - val_loss: 7604.2602
Epoch 00091: val_loss improved from 7619.83600 to 7604.26020, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  798.8365      0.79  0.26  0.62      0.82  0.24  0.65      0.84  0.22  0.68
forget mean min: 0.8955 0.454871
delta_x = 7.61371 delta_h = 0.573213
U_c = [[-0.0159289]] U_f = [[ 0.]] b_c = [ 0.46069247] b_f = [-0.1810105]
incx.max(), incx.min(), incx.mean() 21.5846 0.460692 5.0501
fgtx.max(), fgtx.min(), fgtx.mean() 23.1472 0.0 5.0279
delta mean, abs_mean, abs_mean+, abs_mean-: 0.424675 7.61371 6.29391 9.94568
W_c max, min, mean, abs_mean: 0.350344 0.333323 0.341112 0.341112
W_f max, min, mean, abs_mean: 0.382951 0.361573 0.373724 0.373724
        shijiazhuang 7604.2602      0.89  0.04  0.85      0.90  0.03  0.87      0.90  0.02  0.89
forget mean min: 0.903193 0.454871
delta_x = 7.84889 delta_h = 1.36703
U_c = [[-0.0159289]] U_f = [[ 0.]] b_c = [ 0.46069247] b_f = [-0.1810105]
incx.max(), incx.min(), incx.mean() 14.5346 0.460692 4.88646
fgtx.max(), fgtx.min(), fgtx.mean() 15.4196 0.0 4.84771
delta mean, abs_mean, abs_mean+, abs_mean-: -0.608714 7.84889 5.5267 12.2581
W_c max, min, mean, abs_mean: 0.350344 0.333323 0.341112 0.341112
W_f max, min, mean, abs_mean: 0.382951 0.361573 0.373724 0.373724
Epoch 93/300
0s - loss: 820.3648 - val_loss: 8091.8509
Epoch 00092: val_loss did not improve
Epoch 94/300
0s - loss: 817.9566 - val_loss: 7872.1576
Epoch 00093: val_loss did not improve
Epoch 95/300
0s - loss: 813.1400 - val_loss: 7592.9525
Epoch 00094: val_loss improved from 7604.26020 to 7592.95247, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  790.4801      0.79  0.25  0.62      0.82  0.23  0.65      0.83  0.21  0.68
forget mean min: 0.891223 0.451422
delta_x = 7.52244 delta_h = 0.655646
U_c = [[-0.01831508]] U_f = [[ 0.]] b_c = [ 0.4690893] b_f = [-0.19492717]
incx.max(), incx.min(), incx.mean() 21.2446 0.469089 4.97669
fgtx.max(), fgtx.min(), fgtx.mean() 22.9552 0.0 4.9793
delta mean, abs_mean, abs_mean+, abs_mean-: 0.395823 7.52244 6.22881 9.77902
W_c max, min, mean, abs_mean: 0.352447 0.334061 0.342539 0.342539
W_f max, min, mean, abs_mean: 0.388036 0.36545 0.378408 0.378408
        shijiazhuang 7592.9525      0.89  0.05  0.85      0.90  0.03  0.87      0.90  0.02  0.89
forget mean min: 0.900399 0.451422
delta_x = 7.84358 delta_h = 1.55056
U_c = [[-0.01831508]] U_f = [[ 0.]] b_c = [ 0.4690893] b_f = [-0.19492717]
incx.max(), incx.min(), incx.mean() 14.3471 0.469089 4.87762
fgtx.max(), fgtx.min(), fgtx.mean() 15.3314 0.0 4.86885
delta mean, abs_mean, abs_mean+, abs_mean-: -0.571638 7.84358 5.55094 12.1966
W_c max, min, mean, abs_mean: 0.352447 0.334061 0.342539 0.342539
W_f max, min, mean, abs_mean: 0.388036 0.36545 0.378408 0.378408
Epoch 96/300
0s - loss: 818.6044 - val_loss: 8342.2559
Epoch 00095: val_loss did not improve
Epoch 97/300
0s - loss: 815.4307 - val_loss: 7889.2168
Epoch 00096: val_loss did not improve
Epoch 98/300
0s - loss: 813.9616 - val_loss: 8383.3274
Epoch 00097: val_loss did not improve
Epoch 99/300
0s - loss: 814.1323 - val_loss: 7811.7269
Epoch 00098: val_loss did not improve
Epoch 100/300
0s - loss: 810.6706 - val_loss: 9327.3710
Epoch 00099: val_loss did not improve
Epoch 101/300
0s - loss: 815.6012 - val_loss: 7836.5633
Epoch 00100: val_loss did not improve
Epoch 102/300
0s - loss: 810.7273 - val_loss: 8444.0337
Epoch 00101: val_loss did not improve
Epoch 103/300
0s - loss: 813.1653 - val_loss: 7188.2164
Epoch 00102: val_loss improved from 7592.95247 to 7188.21644, saving model to shijiazhuang_weights.hdf5
        shijiazhuang  790.7395      0.79  0.25  0.62      0.82  0.22  0.66      0.84  0.19  0.70
forget mean min: 0.896856 0.442568
delta_x = 7.58472 delta_h = 0.689991
U_c = [[-0.0195912]] U_f = [[ 0.]] b_c = [ 0.4900116] b_f = [-0.23074624]
incx.max(), incx.min(), incx.mean() 21.5599 0.490012 5.09857
fgtx.max(), fgtx.min(), fgtx.mean() 23.2427 0.0 5.08216
delta mean, abs_mean, abs_mean+, abs_mean-: 0.503711 7.58472 6.24294 10.0527
W_c max, min, mean, abs_mean: 0.364061 0.341812 0.352344 0.352344
W_f max, min, mean, abs_mean: 0.399352 0.373336 0.388591 0.388591
        shijiazhuang 7188.2165      0.90  0.05  0.86      0.91  0.03  0.88      0.92  0.02  0.90
forget mean min: 0.902848 0.442568
delta_x = 7.97425 delta_h = 1.70193
U_c = [[-0.0195912]] U_f = [[ 0.]] b_c = [ 0.4900116] b_f = [-0.23074624]
incx.max(), incx.min(), incx.mean() 14.7689 0.490012 5.04159
fgtx.max(), fgtx.min(), fgtx.mean() 15.7465 0.0 5.01805
delta mean, abs_mean, abs_mean+, abs_mean-: -0.31919 7.97425 5.67481 12.7386
W_c max, min, mean, abs_mean: 0.364061 0.341812 0.352344 0.352344
W_f max, min, mean, abs_mean: 0.399352 0.373336 0.388591 0.388591
Epoch 104/300
0s - loss: 807.2316 - val_loss: 7657.4088
Epoch 00103: val_loss did not improve
Epoch 105/300
0s - loss: 809.2828 - val_loss: 7684.8525
Epoch 00104: val_loss did not improve
Epoch 106/300
0s - loss: 808.5831 - val_loss: 8519.5110
Epoch 00105: val_loss did not improve
Epoch 107/300
0s - loss: 806.2284 - val_loss: 8205.7477
Epoch 00106: val_loss did not improve
Epoch 108/300
0s - loss: 810.1566 - val_loss: 7196.8203
Epoch 00107: val_loss did not improve
Epoch 109/300
0s - loss: 804.5838 - val_loss: 7355.7827
Epoch 00108: val_loss did not improve
Epoch 110/300
0s - loss: 806.2910 - val_loss: 7446.8051
Epoch 00109: val_loss did not improve
Epoch 111/300
0s - loss: 808.7201 - val_loss: 7352.6558
Epoch 00110: val_loss did not improve
Epoch 112/300
0s - loss: 800.8557 - val_loss: 9358.8118
Epoch 00111: val_loss did not improve
Epoch 113/300
0s - loss: 807.5893 - val_loss: 9189.2704
Epoch 00112: val_loss did not improve
Epoch 114/300
0s - loss: 802.1786 - val_loss: 8002.0269
Epoch 00113: val_loss did not improve
Epoch 115/300
0s - loss: 802.5053 - val_loss: 8121.2054
Epoch 00114: val_loss did not improve
Epoch 116/300
0s - loss: 801.7564 - val_loss: 8608.5861
Epoch 00115: val_loss did not improve
Epoch 117/300
0s - loss: 798.9663 - val_loss: 7979.0830
Epoch 00116: val_loss did not improve
Epoch 118/300
0s - loss: 803.3084 - val_loss: 7917.3390
Epoch 00117: val_loss did not improve
Epoch 119/300
0s - loss: 802.2536 - val_loss: 8386.0252
Epoch 00118: val_loss did not improve
Epoch 120/300
0s - loss: 798.3079 - val_loss: 8692.7136
Epoch 00119: val_loss did not improve
Epoch 121/300
0s - loss: 794.9789 - val_loss: 7271.4270
Epoch 00120: val_loss did not improve
Epoch 122/300
0s - loss: 797.4822 - val_loss: 7746.4786
Epoch 00121: val_loss did not improve
Epoch 123/300
0s - loss: 794.9466 - val_loss: 7911.3575
Epoch 00122: val_loss did not improve
Epoch 124/300
0s - loss: 793.7237 - val_loss: 7794.9728
Epoch 00123: val_loss did not improve
X_train[0].shape = (4688, 40, 23)

training xingtai+handan
Train on 4688 samples, validate on 928 samples
Before training:
      xingtai+handan 5959.4548      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 4.03135 delta_h = 2.64033
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -4.03135 4.03135 nan 4.03135
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
      xingtai+handan36023.8026      0.06  -nan  0.05      0.06  -nan  0.06      0.06  -nan  0.06
forget mean min: 0.731058 0.731059
delta_x = 8.5357 delta_h = 4.83842
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -8.5357 8.5357 nan 8.5357
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 4213.2116 - val_loss: 16423.8979
Epoch 00000: val_loss improved from inf to 16423.89792, saving model to xingtai+handan_weights.hdf5
      xingtai+handan 2085.4997      0.19  0.22  0.17      0.19  0.18  0.18      0.19  0.14  0.18
forget mean min: 0.933006 0.78331
delta_x = 2.79378 delta_h = 2.10404
U_c = [[-0.11610345]] U_f = [[ 0.]] b_c = [ 0.0812029] b_f = [ 1.07976556]
incx.max(), incx.min(), incx.mean() 4.28413 0.293087 2.0421
fgtx.max(), fgtx.min(), fgtx.mean() 4.07212 0.205298 1.89987
delta mean, abs_mean, abs_mean+, abs_mean-: -1.39476 2.79378 1.63879 3.65393
W_c max, min, mean, abs_mean: 0.110818 0.108165 0.110309 0.110309
W_f max, min, mean, abs_mean: 0.107372 0.106344 0.106879 0.106879
      xingtai+handan16423.8979      0.74  0.22  0.62      0.74  0.18  0.64      0.74  0.15  0.66
forget mean min: 0.946438 0.785773
delta_x = 3.73039 delta_h = 3.77556
U_c = [[-0.11610345]] U_f = [[ 0.]] b_c = [ 0.0812029] b_f = [ 1.07976556]
incx.max(), incx.min(), incx.mean() 3.79016 0.308121 2.13261
fgtx.max(), fgtx.min(), fgtx.mean() 3.59353 0.219864 1.98757
delta mean, abs_mean, abs_mean+, abs_mean-: -3.36838 3.73039 1.04413 4.29373
W_c max, min, mean, abs_mean: 0.110818 0.108165 0.110309 0.110309
W_f max, min, mean, abs_mean: 0.107372 0.106344 0.106879 0.106879
Epoch 2/300
0s - loss: 1575.8437 - val_loss: 10608.0308
Epoch 00001: val_loss improved from 16423.89792 to 10608.03080, saving model to xingtai+handan_weights.hdf5
      xingtai+handan 1383.1592      0.72  0.33  0.53      0.75  0.29  0.57      0.75  0.28  0.58
forget mean min: 0.951749 0.797673
delta_x = 4.21449 delta_h = 1.74106
U_c = [[-0.06194975]] U_f = [[ 0.]] b_c = [ 0.099324] b_f = [ 1.08611977]
incx.max(), incx.min(), incx.mean() 7.17408 0.394312 3.23493
fgtx.max(), fgtx.min(), fgtx.mean() 6.85159 0.285691 3.0367
delta mean, abs_mean, abs_mean+, abs_mean-: 0.612356 4.21449 3.74216 5.07241
W_c max, min, mean, abs_mean: 0.137903 0.135309 0.137411 0.137411
W_f max, min, mean, abs_mean: 0.133503 0.132563 0.133079 0.133079
      xingtai+handan10608.0309      0.92  0.19  0.76      0.93  0.14  0.81      0.94  0.12  0.83
forget mean min: 0.974072 0.797673
delta_x = 5.05603 delta_h = 3.02808
U_c = [[-0.06194975]] U_f = [[ 0.]] b_c = [ 0.099324] b_f = [ 1.08611977]
incx.max(), incx.min(), incx.mean() 7.07803 0.394312 3.86991
fgtx.max(), fgtx.min(), fgtx.mean() 6.75857 0.285691 3.65165
delta mean, abs_mean, abs_mean+, abs_mean-: 0.65241 5.05603 3.81866 8.71799
W_c max, min, mean, abs_mean: 0.137903 0.135309 0.137411 0.137411
W_f max, min, mean, abs_mean: 0.133503 0.132563 0.133079 0.133079
Epoch 3/300
0s - loss: 1351.7093 - val_loss: 10267.4787
Epoch 00002: val_loss improved from 10608.03080 to 10267.47868, saving model to xingtai+handan_weights.hdf5
      xingtai+handan 1315.7873      0.72  0.31  0.54      0.75  0.28  0.58      0.76  0.26  0.60
forget mean min: 0.953299 0.796948
delta_x = 4.07273 delta_h = 1.54843
U_c = [[-0.05421477]] U_f = [[ 0.]] b_c = [ 0.0946857] b_f = [ 1.07687652]
incx.max(), incx.min(), incx.mean() 6.67238 0.356248 3.00738
fgtx.max(), fgtx.min(), fgtx.mean() 7.30407 0.290454 3.23434
delta mean, abs_mean, abs_mean+, abs_mean-: 0.500797 4.07273 3.50871 5.12823
W_c max, min, mean, abs_mean: 0.13241 0.129788 0.131898 0.131898
W_f max, min, mean, abs_mean: 0.146715 0.145923 0.146466 0.146466
      xingtai+handan10267.4786      0.94  0.18  0.78      0.95  0.14  0.82      0.95  0.12  0.84
forget mean min: 0.977965 0.796948
delta_x = 4.8182 delta_h = 2.73218
U_c = [[-0.05421477]] U_f = [[ 0.]] b_c = [ 0.0946857] b_f = [ 1.07687652]
incx.max(), incx.min(), incx.mean() 6.51266 0.356248 3.66052
fgtx.max(), fgtx.min(), fgtx.mean() 7.12671 0.290454 3.95962
delta mean, abs_mean, abs_mean+, abs_mean-: 0.766084 4.8182 3.67611 8.42564
W_c max, min, mean, abs_mean: 0.13241 0.129788 0.131898 0.131898
W_f max, min, mean, abs_mean: 0.146715 0.145923 0.146466 0.146466
Epoch 4/300
0s - loss: 1293.3666 - val_loss: 10020.8417
Epoch 00003: val_loss improved from 10267.47868 to 10020.84170, saving model to xingtai+handan_weights.hdf5
      xingtai+handan 1262.6183      0.74  0.30  0.56      0.77  0.26  0.61      0.78  0.24  0.62
forget mean min: 0.952104 0.783676
delta_x = 4.23409 delta_h = 1.47562
U_c = [[-0.05021866]] U_f = [[ 0.]] b_c = [ 0.09574272] b_f = [ 1.04687405]
incx.max(), incx.min(), incx.mean() 7.64906 0.307204 3.05894
fgtx.max(), fgtx.min(), fgtx.mean() 8.58477 0.240345 3.36787
delta mean, abs_mean, abs_mean+, abs_mean-: 0.491008 4.23409 3.61718 5.39576
W_c max, min, mean, abs_mean: 0.137021 0.134367 0.136486 0.136486
W_f max, min, mean, abs_mean: 0.155553 0.154522 0.155128 0.155128
      xingtai+handan10020.8418      0.95  0.18  0.79      0.95  0.14  0.83      0.96  0.11  0.85
forget mean min: 0.979107 0.783676
delta_x = 4.9878 delta_h = 2.6526
U_c = [[-0.05021866]] U_f = [[ 0.]] b_c = [ 0.09574272] b_f = [ 1.04687405]
incx.max(), incx.min(), incx.mean() 6.6179 0.307204 3.78284
fgtx.max(), fgtx.min(), fgtx.mean() 7.41285 0.240345 4.19063
delta mean, abs_mean, abs_mean+, abs_mean-: 0.955837 4.9878 3.82357 9.04985
W_c max, min, mean, abs_mean: 0.137021 0.134367 0.136486 0.136486
W_f max, min, mean, abs_mean: 0.155553 0.154522 0.155128 0.155128
Epoch 5/300
0s - loss: 1245.9967 - val_loss: 9887.2350
Epoch 00004: val_loss improved from 10020.84170 to 9887.23503, saving model to xingtai+handan_weights.hdf5
      xingtai+handan 1221.8248      0.74  0.29  0.57      0.78  0.25  0.62      0.78  0.23  0.63
forget mean min: 0.950454 0.768688
delta_x = 4.42014 delta_h = 1.41911
U_c = [[-0.04744815]] U_f = [[ 0.]] b_c = [ 0.09946569] b_f = [ 1.01605916]
incx.max(), incx.min(), incx.mean() 9.10853 0.261705 3.13366
fgtx.max(), fgtx.min(), fgtx.mean() 10.2649 0.18486 3.45718
delta mean, abs_mean, abs_mean+, abs_mean-: 0.475173 4.42014 3.72755 5.74464
W_c max, min, mean, abs_mean: 0.144381 0.141687 0.143821 0.143821
W_f max, min, mean, abs_mean: 0.164447 0.163235 0.163873 0.163873
      xingtai+handan 9887.2350      0.95  0.18  0.78      0.95  0.14  0.83      0.95  0.11  0.85
forget mean min: 0.978182 0.768688
delta_x = 5.37365 delta_h = 2.62539
U_c = [[-0.04744815]] U_f = [[ 0.]] b_c = [ 0.09946569] b_f = [ 1.01605916]
incx.max(), incx.min(), incx.mean() 7.40728 0.261705 3.9359
fgtx.max(), fgtx.min(), fgtx.mean() 8.32655 0.18486 4.37126
delta mean, abs_mean, abs_mean+, abs_mean-: 0.960403 5.37365 4.04014 10.2107
W_c max, min, mean, abs_mean: 0.144381 0.141687 0.143821 0.143821
W_f max, min, mean, abs_mean: 0.164447 0.163235 0.163873 0.163873
Epoch 6/300
0s - loss: 1210.2874 - val_loss: 9565.1843
Epoch 00005: val_loss improved from 9887.23503 to 9565.18432, saving model to xingtai+handan_weights.hdf5
      xingtai+handan 1187.4345      0.75  0.28  0.58      0.79  0.24  0.63      0.80  0.23  0.65
forget mean min: 0.947287 0.749561
delta_x = 4.77095 delta_h = 1.41164
U_c = [[-0.04606779]] U_f = [[ 0.]] b_c = [ 0.10426096] b_f = [ 0.98223883]
incx.max(), incx.min(), incx.mean() 10.7992 0.206232 3.30794
fgtx.max(), fgtx.min(), fgtx.mean() 11.9595 0.114031 3.5825
delta mean, abs_mean, abs_mean+, abs_mean-: 0.478822 4.77095 4.08952 5.9922
W_c max, min, mean, abs_mean: 0.153933 0.151162 0.15333 0.15333
W_f max, min, mean, abs_mean: 0.172135 0.170818 0.171462 0.171462
      xingtai+handan 9565.1844      0.95  0.17  0.79      0.95  0.13  0.83      0.96  0.11  0.86
forget mean min: 0.977705 0.749561
delta_x = 5.59738 delta_h = 2.60085
U_c = [[-0.04606779]] U_f = [[ 0.]] b_c = [ 0.10426096] b_f = [ 0.98223883]
incx.max(), incx.min(), incx.mean() 8.38688 0.206232 4.10584
fgtx.max(), fgtx.min(), fgtx.mean() 9.26198 0.114031 4.47476
delta mean, abs_mean, abs_mean+, abs_mean-: 1.04423 5.59738 4.25915 10.3334
W_c max, min, mean, abs_mean: 0.153933 0.151162 0.15333 0.15333
W_f max, min, mean, abs_mean: 0.172135 0.170818 0.171462 0.171462
Epoch 7/300
0s - loss: 1179.7664 - val_loss: 9579.9759
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 1154.0220 - val_loss: 9216.9571
Epoch 00007: val_loss improved from 9565.18432 to 9216.95710, saving model to xingtai+handan_weights.hdf5
      xingtai+handan 1131.5717      0.75  0.27  0.59      0.79  0.23  0.64      0.80  0.21  0.66
forget mean min: 0.944394 0.716308
delta_x = 5.18431 delta_h = 1.31666
U_c = [[-0.04311967]] U_f = [[ 0.]] b_c = [ 0.11063778] b_f = [ 0.9262225]
incx.max(), incx.min(), incx.mean() 13.2516 0.110638 3.51531
fgtx.max(), fgtx.min(), fgtx.mean() 14.6078 0.0 3.78472
delta mean, abs_mean, abs_mean+, abs_mean-: 0.455531 5.18431 4.37325 6.65671
W_c max, min, mean, abs_mean: 0.171005 0.168019 0.170259 0.170259
W_f max, min, mean, abs_mean: 0.190175 0.18845 0.189266 0.189266
      xingtai+handan 9216.9570      0.95  0.16  0.80      0.95  0.12  0.84      0.95  0.10  0.86
forget mean min: 0.97458 0.716308
delta_x = 6.09149 delta_h = 2.53565
U_c = [[-0.04311967]] U_f = [[ 0.]] b_c = [ 0.11063778] b_f = [ 0.9262225]
incx.max(), incx.min(), incx.mean() 9.78885 0.110638 4.26924
fgtx.max(), fgtx.min(), fgtx.mean() 10.7585 0.0 4.62283
delta mean, abs_mean, abs_mean+, abs_mean-: 0.878823 6.09149 4.54916 11.1434
W_c max, min, mean, abs_mean: 0.171005 0.168019 0.170259 0.170259
W_f max, min, mean, abs_mean: 0.190175 0.18845 0.189266 0.189266
Epoch 9/300
0s - loss: 1130.4607 - val_loss: 9374.9883
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 1110.3751 - val_loss: 8947.4036
Epoch 00009: val_loss improved from 9216.95710 to 8947.40357, saving model to xingtai+handan_weights.hdf5
      xingtai+handan 1087.4135      0.77  0.27  0.60      0.81  0.23  0.66      0.82  0.20  0.68
forget mean min: 0.943138 0.704851
delta_x = 5.55401 delta_h = 1.206
U_c = [[-0.03902963]] U_f = [[ 0.]] b_c = [ 0.11080707] b_f = [ 0.87050718]
incx.max(), incx.min(), incx.mean() 14.8867 0.110807 3.71527
fgtx.max(), fgtx.min(), fgtx.mean() 16.4178 0.0 4.00504
delta mean, abs_mean, abs_mean+, abs_mean-: 0.482544 5.55401 4.68594 7.1251
W_c max, min, mean, abs_mean: 0.184636 0.18148 0.18378 0.18378
W_f max, min, mean, abs_mean: 0.205306 0.2031 0.204206 0.204206
      xingtai+handan 8947.4035      0.95  0.16  0.80      0.95  0.12  0.85      0.95  0.10  0.86
forget mean min: 0.973304 0.704851
delta_x = 6.34727 delta_h = 2.30755
U_c = [[-0.03902963]] U_f = [[ 0.]] b_c = [ 0.11080707] b_f = [ 0.87050718]
incx.max(), incx.min(), incx.mean() 10.7632 0.110807 4.35447
fgtx.max(), fgtx.min(), fgtx.mean() 11.8361 0.0 4.71529
delta mean, abs_mean, abs_mean+, abs_mean-: 0.744007 6.34727 4.72684 11.2114
W_c max, min, mean, abs_mean: 0.184636 0.18148 0.18378 0.18378
W_f max, min, mean, abs_mean: 0.205306 0.2031 0.204206 0.204206
Epoch 11/300
0s - loss: 1094.5959 - val_loss: 8990.1956
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 1079.6708 - val_loss: 9027.9532
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 1069.0576 - val_loss: 8709.3946
Epoch 00012: val_loss improved from 8947.40357 to 8709.39456, saving model to xingtai+handan_weights.hdf5
      xingtai+handan 1069.9980      0.81  0.29  0.61      0.85  0.24  0.67      0.86  0.22  0.69
forget mean min: 0.942091 0.686683
delta_x = 6.10428 delta_h = 1.14202
U_c = [[-0.03462986]] U_f = [[ 0.]] b_c = [ 0.10630932] b_f = [ 0.78465933]
incx.max(), incx.min(), incx.mean() 17.0289 0.106309 4.01218
fgtx.max(), fgtx.min(), fgtx.mean() 19.5527 0.0 4.51296
delta mean, abs_mean, abs_mean+, abs_mean-: 0.622472 6.10428 5.16218 7.86579
W_c max, min, mean, abs_mean: 0.2012 0.197784 0.200213 0.200213
W_f max, min, mean, abs_mean: 0.232617 0.229977 0.231334 0.231334
      xingtai+handan 8709.3946      0.95  0.16  0.81      0.95  0.12  0.85      0.95  0.09  0.86
forget mean min: 0.972828 0.686683
delta_x = 6.87664 delta_h = 2.17471
U_c = [[-0.03462986]] U_f = [[ 0.]] b_c = [ 0.10630932] b_f = [ 0.78465933]
incx.max(), incx.min(), incx.mean() 11.9556 0.106309 4.59403
fgtx.max(), fgtx.min(), fgtx.mean() 13.691 0.0 5.18528
delta mean, abs_mean, abs_mean+, abs_mean-: 0.873693 6.87664 5.12638 12.2974
W_c max, min, mean, abs_mean: 0.2012 0.197784 0.200213 0.200213
W_f max, min, mean, abs_mean: 0.232617 0.229977 0.231334 0.231334
Epoch 14/300
0s - loss: 1060.0973 - val_loss: 8890.2463
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 1050.7992 - val_loss: 9193.6572
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 1048.1020 - val_loss: 8995.2140
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 1037.4661 - val_loss: 9089.7107
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 1032.2201 - val_loss: 9331.8466
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 1026.8745 - val_loss: 8867.3899
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 1017.8855 - val_loss: 8966.5580
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 1012.2359 - val_loss: 8872.3494
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 1003.6416 - val_loss: 9382.5053
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 998.7825 - val_loss: 9139.7561
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 994.6574 - val_loss: 9071.0902
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 985.7270 - val_loss: 8722.1650
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 977.7491 - val_loss: 9133.6957
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 970.3445 - val_loss: 9198.8285
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 967.9761 - val_loss: 9171.6235
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 959.0220 - val_loss: 9243.7110
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 951.2210 - val_loss: 9269.7514
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 945.5023 - val_loss: 9035.4125
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 938.5131 - val_loss: 9239.4987
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 931.0542 - val_loss: 9306.1740
Epoch 00032: val_loss did not improve
Epoch 34/300
0s - loss: 927.9680 - val_loss: 9217.3933
Epoch 00033: val_loss did not improve
X_train[0].shape = (2930, 40, 23)

training jinan
Train on 2930 samples, validate on 580 samples
Before training:
               jinan 8715.5537      0.02  -nan  0.02      0.02  -nan  0.02      0.01  -nan  0.01
forget mean min: 0.731058 0.731059
delta_x = 4.97181 delta_h = 3.17364
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -4.97181 4.97181 nan 4.97181
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
               jinan21458.7413      0.04  -nan  0.04      0.04  -nan  0.04      0.03  -nan  0.03
forget mean min: 0.731058 0.731059
delta_x = 7.36854 delta_h = 4.8035
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -7.36854 7.36854 nan 7.36854
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 7341.2014 - val_loss: 13780.7382
Epoch 00000: val_loss improved from inf to 13780.73817, saving model to jinan_weights.hdf5
               jinan 5191.8898      0.06  -nan  0.05      0.06  -nan  0.05      0.06  -nan  0.05
forget mean min: 0.863584 0.762858
delta_x = 4.99281 delta_h = 4.05863
U_c = [[-0.10266504]] U_f = [[ 0.]] b_c = [ 0.05591762] b_f = [ 1.05687523]
incx.max(), incx.min(), incx.mean() 1.73272 0.166449 0.879106
fgtx.max(), fgtx.min(), fgtx.mean() 1.69179 0.111539 0.830571
delta mean, abs_mean, abs_mean+, abs_mean-: -4.99281 4.99281 0.0442863 4.99285
W_c max, min, mean, abs_mean: 0.0799596 0.0753443 0.0789388 0.0789388
W_f max, min, mean, abs_mean: 0.0801968 0.0770197 0.0796546 0.0796546
               jinan13780.7384      0.10  -nan  0.10      0.11  -nan  0.10      0.11  -nan  0.11
forget mean min: 0.865089 0.763461
delta_x = 7.73788 delta_h = 6.40565
U_c = [[-0.10266504]] U_f = [[ 0.]] b_c = [ 0.05591762] b_f = [ 1.05687523]
incx.max(), incx.min(), incx.mean() 1.45211 0.169757 0.868469
fgtx.max(), fgtx.min(), fgtx.mean() 1.4087 0.114877 0.819838
delta mean, abs_mean, abs_mean+, abs_mean-: -7.73788 7.73788 nan 7.73788
W_c max, min, mean, abs_mean: 0.0799596 0.0753443 0.0789388 0.0789388
W_f max, min, mean, abs_mean: 0.0801968 0.0770197 0.0796546 0.0796546
Epoch 2/300
0s - loss: 3476.4535 - val_loss: 6947.5702
Epoch 00001: val_loss improved from 13780.73817 to 6947.57019, saving model to jinan_weights.hdf5
               jinan 2487.5876      0.61  0.29  0.48      0.61  0.26  0.51      0.62  0.22  0.53
forget mean min: 0.956868 0.792246
delta_x = 3.01067 delta_h = 2.0952
U_c = [[-0.11705168]] U_f = [[ 0.]] b_c = [ 0.09505298] b_f = [ 1.08734334]
incx.max(), incx.min(), incx.mean() 5.54277 0.364145 2.82203
fgtx.max(), fgtx.min(), fgtx.mean() 5.08456 0.251172 2.54522
delta mean, abs_mean, abs_mean+, abs_mean-: -0.10879 3.01067 2.29129 4.25275
W_c max, min, mean, abs_mean: 0.126814 0.12227 0.125771 0.125771
W_f max, min, mean, abs_mean: 0.117969 0.114866 0.117393 0.117393
               jinan 6947.5701      0.94  0.29  0.68      0.94  0.25  0.71      0.94  0.22  0.75
forget mean min: 0.965424 0.792246
delta_x = 2.65034 delta_h = 2.48244
U_c = [[-0.11705168]] U_f = [[ 0.]] b_c = [ 0.09505298] b_f = [ 1.08734334]
incx.max(), incx.min(), incx.mean() 4.99358 0.364145 2.8438
fgtx.max(), fgtx.min(), fgtx.mean() 4.57201 0.251172 2.56554
delta mean, abs_mean, abs_mean+, abs_mean-: -0.830372 2.65034 1.66378 3.84134
W_c max, min, mean, abs_mean: 0.126814 0.12227 0.125771 0.125771
W_f max, min, mean, abs_mean: 0.117969 0.114866 0.117393 0.117393
Epoch 3/300
0s - loss: 2227.5698 - val_loss: 5228.7802
Epoch 00002: val_loss improved from 6947.57019 to 5228.78019, saving model to jinan_weights.hdf5
               jinan 2030.4233      0.76  0.33  0.55      0.77  0.29  0.58      0.78  0.27  0.61
forget mean min: 0.957919 0.791129
delta_x = 4.43459 delta_h = 2.40026
U_c = [[-0.09263808]] U_f = [[ 0.]] b_c = [ 0.11643209] b_f = [ 1.07512677]
incx.max(), incx.min(), incx.mean() 8.52732 0.444235 3.86139
fgtx.max(), fgtx.min(), fgtx.mean() 6.58417 0.256618 2.93161
delta mean, abs_mean, abs_mean+, abs_mean-: 0.920483 4.43459 3.82977 5.84007
W_c max, min, mean, abs_mean: 0.157084 0.152598 0.15606 0.15606
W_f max, min, mean, abs_mean: 0.122745 0.119615 0.12217 0.12217
               jinan 5228.7801      0.95  0.20  0.76      0.95  0.17  0.79      0.95  0.14  0.82
forget mean min: 0.963477 0.791129
delta_x = 5.23262 delta_h = 3.29871
U_c = [[-0.09263808]] U_f = [[ 0.]] b_c = [ 0.11643209] b_f = [ 1.07512677]
incx.max(), incx.min(), incx.mean() 8.36907 0.444235 4.13722
fgtx.max(), fgtx.min(), fgtx.mean() 6.46029 0.256618 3.14753
delta mean, abs_mean, abs_mean+, abs_mean-: 0.562673 5.23262 3.96867 8.65219
W_c max, min, mean, abs_mean: 0.157084 0.152598 0.15606 0.15606
W_f max, min, mean, abs_mean: 0.122745 0.119615 0.12217 0.12217
Epoch 4/300
0s - loss: 1934.1955 - val_loss: 4684.9021
Epoch 00003: val_loss improved from 5228.78019 to 4684.90209, saving model to jinan_weights.hdf5
               jinan 1848.0965      0.77  0.33  0.56      0.79  0.29  0.59      0.80  0.26  0.62
forget mean min: 0.94485 0.772651
delta_x = 5.2528 delta_h = 2.5018
U_c = [[-0.08715066]] U_f = [[ 0.]] b_c = [ 0.13120678] b_f = [ 1.04304051]
incx.max(), incx.min(), incx.mean() 11.6066 0.442396 4.59249
fgtx.max(), fgtx.min(), fgtx.mean() 6.64879 0.180304 2.58484
delta mean, abs_mean, abs_mean+, abs_mean-: 0.807148 5.2528 4.59521 6.52577
W_c max, min, mean, abs_mean: 0.184012 0.179587 0.183036 0.183036
W_f max, min, mean, abs_mean: 0.106559 0.103437 0.106052 0.106052
               jinan 4684.9021      0.94  0.18  0.78      0.94  0.14  0.81      0.93  0.11  0.84
forget mean min: 0.950842 0.772651
delta_x = 6.59904 delta_h = 3.90227
U_c = [[-0.08715066]] U_f = [[ 0.]] b_c = [ 0.13120678] b_f = [ 1.04304051]
incx.max(), incx.min(), incx.mean() 10.9422 0.442396 5.18033
fgtx.max(), fgtx.min(), fgtx.mean() 6.26383 0.180304 2.92543
delta mean, abs_mean, abs_mean+, abs_mean-: 0.752495 6.59904 5.20717 9.93989
W_c max, min, mean, abs_mean: 0.184012 0.179587 0.183036 0.183036
W_f max, min, mean, abs_mean: 0.106559 0.103437 0.106052 0.106052
Epoch 5/300
0s - loss: 1807.7242 - val_loss: 4480.2797
Epoch 00004: val_loss improved from 4684.90209 to 4480.27967, saving model to jinan_weights.hdf5
               jinan 1762.2074      0.79  0.34  0.56      0.81  0.30  0.60      0.83  0.28  0.63
forget mean min: 0.937136 0.759349
delta_x = 5.97478 delta_h = 2.68805
U_c = [[-0.08653822]] U_f = [[ 0.]] b_c = [ 0.1464621] b_f = [ 1.01683176]
incx.max(), incx.min(), incx.mean() 14.3828 0.443883 5.48986
fgtx.max(), fgtx.min(), fgtx.mean() 6.33195 0.132284 2.37661
delta mean, abs_mean, abs_mean+, abs_mean-: 1.05573 5.97478 5.37977 7.09659
W_c max, min, mean, abs_mean: 0.209806 0.205383 0.208832 0.208832
W_f max, min, mean, abs_mean: 0.0933953 0.0901932 0.0928838 0.0928838
               jinan 4480.2796      0.94  0.17  0.79      0.94  0.13  0.82      0.93  0.11  0.84
forget mean min: 0.946658 0.759349
delta_x = 7.38246 delta_h = 4.27062
U_c = [[-0.08653822]] U_f = [[ 0.]] b_c = [ 0.1464621] b_f = [ 1.01683176]
incx.max(), incx.min(), incx.mean() 13.0148 0.443883 6.32547
fgtx.max(), fgtx.min(), fgtx.mean() 5.72352 0.132284 2.74826
delta mean, abs_mean, abs_mean+, abs_mean-: 1.30744 7.38246 6.2436 9.9887
W_c max, min, mean, abs_mean: 0.209806 0.205383 0.208832 0.208832
W_f max, min, mean, abs_mean: 0.0933953 0.0901932 0.0928838 0.0928838
Epoch 6/300
0s - loss: 1729.7270 - val_loss: 4456.7411
Epoch 00005: val_loss improved from 4480.27967 to 4456.74107, saving model to jinan_weights.hdf5
               jinan 1694.2653      0.77  0.31  0.57      0.79  0.27  0.61      0.80  0.24  0.64
forget mean min: 0.925811 0.74797
delta_x = 6.17008 delta_h = 2.7043
U_c = [[-0.09123771]] U_f = [[ 0.]] b_c = [ 0.15657461] b_f = [ 0.993411]
incx.max(), incx.min(), incx.mean() 16.1925 0.4276 6.02693
fgtx.max(), fgtx.min(), fgtx.mean() 5.58598 0.0944062 2.0449
delta mean, abs_mean, abs_mean+, abs_mean-: 0.765749 6.17008 5.63975 7.01691
W_c max, min, mean, abs_mean: 0.229877 0.225459 0.228909 0.228909
W_f max, min, mean, abs_mean: 0.0802765 0.0769897 0.079739 0.079739
               jinan 4456.7410      0.94  0.17  0.79      0.95  0.13  0.83      0.93  0.10  0.84
forget mean min: 0.939706 0.74797
delta_x = 7.26217 delta_h = 4.31822
U_c = [[-0.09123771]] U_f = [[ 0.]] b_c = [ 0.15657461] b_f = [ 0.993411]
incx.max(), incx.min(), incx.mean() 14.8267 0.4276 7.03224
fgtx.max(), fgtx.min(), fgtx.mean() 5.11023 0.0944062 2.39509
delta mean, abs_mean, abs_mean+, abs_mean-: 1.07492 7.26217 6.32258 9.08047
W_c max, min, mean, abs_mean: 0.229877 0.225459 0.228909 0.228909
W_f max, min, mean, abs_mean: 0.0802765 0.0769897 0.079739 0.079739
Epoch 7/300
0s - loss: 1674.0784 - val_loss: 4300.6235
Epoch 00006: val_loss improved from 4456.74107 to 4300.62346, saving model to jinan_weights.hdf5
               jinan 1638.0633      0.79  0.31  0.58      0.81  0.27  0.62      0.83  0.24  0.65
forget mean min: 0.921418 0.741361
delta_x = 6.67024 delta_h = 2.82445
U_c = [[-0.09093016]] U_f = [[ 0.]] b_c = [ 0.16638696] b_f = [ 0.97545904]
incx.max(), incx.min(), incx.mean() 18.4181 0.424957 6.71071
fgtx.max(), fgtx.min(), fgtx.mean() 5.47738 0.077593 1.96397
delta mean, abs_mean, abs_mean+, abs_mean-: 0.982652 6.67024 6.25537 7.32383
W_c max, min, mean, abs_mean: 0.248532 0.244123 0.247576 0.247576
W_f max, min, mean, abs_mean: 0.0748688 0.0715019 0.0742985 0.0742985
               jinan 4300.6235      0.96  0.17  0.80      0.96  0.12  0.84      0.94  0.10  0.85
forget mean min: 0.937878 0.741361
delta_x = 7.65331 delta_h = 4.43929
U_c = [[-0.09093016]] U_f = [[ 0.]] b_c = [ 0.16638696] b_f = [ 0.97545904]
incx.max(), incx.min(), incx.mean() 16.8339 0.424957 7.90224
fgtx.max(), fgtx.min(), fgtx.mean() 5.00198 0.077593 2.32155
delta mean, abs_mean, abs_mean+, abs_mean-: 1.43472 7.65331 7.00566 8.84882
W_c max, min, mean, abs_mean: 0.248532 0.244123 0.247576 0.247576
W_f max, min, mean, abs_mean: 0.0748688 0.0715019 0.0742985 0.0742985
Epoch 8/300
0s - loss: 1629.1040 - val_loss: 4297.8215
Epoch 00007: val_loss improved from 4300.62346 to 4297.82149, saving model to jinan_weights.hdf5
               jinan 1600.2064      0.77  0.30  0.58      0.79  0.25  0.63      0.80  0.21  0.66
forget mean min: 0.91336 0.734549
delta_x = 6.82095 delta_h = 2.79158
U_c = [[-0.09241565]] U_f = [[ 0.]] b_c = [ 0.17272094] b_f = [ 0.95791572]
incx.max(), incx.min(), incx.mean() 19.7603 0.40407 7.11627
fgtx.max(), fgtx.min(), fgtx.mean() 5.07308 0.0599124 1.79835
delta mean, abs_mean, abs_mean+, abs_mean-: 0.772417 6.82095 6.44951 7.35254
W_c max, min, mean, abs_mean: 0.263083 0.258638 0.26211 0.26211
W_f max, min, mean, abs_mean: 0.0685009 0.0650425 0.0678851 0.0678851
               jinan 4297.8216      0.96  0.16  0.81      0.96  0.12  0.85      0.94  0.10  0.85
forget mean min: 0.933098 0.734549
delta_x = 7.72109 delta_h = 4.34663
U_c = [[-0.09241565]] U_f = [[ 0.]] b_c = [ 0.17272094] b_f = [ 0.95791572]
incx.max(), incx.min(), incx.mean() 18.0196 0.40407 8.49403
fgtx.max(), fgtx.min(), fgtx.mean() 4.62226 0.0599124 2.15518
delta mean, abs_mean, abs_mean+, abs_mean-: 1.27737 7.72109 7.25531 8.48147
W_c max, min, mean, abs_mean: 0.263083 0.258638 0.26211 0.26211
W_f max, min, mean, abs_mean: 0.0685009 0.0650425 0.0678851 0.0678851
Epoch 9/300
0s - loss: 1590.6241 - val_loss: 4205.2794
Epoch 00008: val_loss improved from 4297.82149 to 4205.27939, saving model to jinan_weights.hdf5
               jinan 1559.8947      0.79  0.30  0.59      0.82  0.26  0.63      0.84  0.23  0.67
forget mean min: 0.910688 0.729521
delta_x = 7.20605 delta_h = 2.79908
U_c = [[-0.08724355]] U_f = [[ 0.]] b_c = [ 0.17994432] b_f = [ 0.94275671]
incx.max(), incx.min(), incx.mean() 21.4742 0.391406 7.71514
fgtx.max(), fgtx.min(), fgtx.mean() 4.97877 0.0494347 1.76179
delta mean, abs_mean, abs_mean+, abs_mean-: 0.996963 7.20605 6.97369 7.53786
W_c max, min, mean, abs_mean: 0.280045 0.275598 0.279082 0.279082
W_f max, min, mean, abs_mean: 0.0659017 0.0623641 0.0652517 0.0652517
               jinan 4205.2794      0.96  0.16  0.81      0.96  0.12  0.85      0.95  0.09  0.86
forget mean min: 0.931011 0.729521
delta_x = 8.185 delta_h = 4.32871
U_c = [[-0.08724355]] U_f = [[ 0.]] b_c = [ 0.17994432] b_f = [ 0.94275671]
incx.max(), incx.min(), incx.mean() 19.2019 0.391406 9.23133
fgtx.max(), fgtx.min(), fgtx.mean() 4.4475 0.0494347 2.1163
delta mean, abs_mean, abs_mean+, abs_mean-: 1.55724 8.185 7.93052 8.59017
W_c max, min, mean, abs_mean: 0.280045 0.275598 0.279082 0.279082
W_f max, min, mean, abs_mean: 0.0659017 0.0623641 0.0652517 0.0652517
Epoch 10/300
0s - loss: 1558.0847 - val_loss: 4377.2287
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 1530.8601 - val_loss: 4267.7930
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 1503.9681 - val_loss: 4477.8945
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 1482.2340 - val_loss: 4546.2855
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 1461.0349 - val_loss: 4372.2183
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 1441.7229 - val_loss: 4501.2006
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 1420.9447 - val_loss: 4449.4695
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 1401.9875 - val_loss: 4486.1289
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 1389.8214 - val_loss: 4449.7356
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 1373.5485 - val_loss: 4274.7904
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 1360.3532 - val_loss: 4320.4667
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 1347.0936 - val_loss: 4621.4693
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 1333.0588 - val_loss: 4488.6807
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 1322.9067 - val_loss: 4474.2090
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 1306.7649 - val_loss: 4427.3890
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 1293.1217 - val_loss: 4489.5567
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 1279.4218 - val_loss: 4482.3168
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 1266.1063 - val_loss: 4342.7504
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 1253.4563 - val_loss: 4351.0474
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 1239.2655 - val_loss: 4440.8472
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 1225.4920 - val_loss: 4361.7398
Epoch 00029: val_loss did not improve
X_train[0].shape = (7032, 40, 23)

training xian
Train on 7032 samples, validate on 1392 samples
Before training:
                xian 3305.8251      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.2568 delta_h = 2.14914
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.2568 3.2568 nan 3.2568
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
                xian14473.9814      0.03  -nan  0.03      0.03  -nan  0.03      0.01  -nan  0.01
forget mean min: 0.731059 0.731059
delta_x = 4.79727 delta_h = 2.65739
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -4.79727 4.79727 nan 4.79727
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 1811.7263 - val_loss: 4779.4113
Epoch 00000: val_loss improved from inf to 4779.41134, saving model to xian_weights.hdf5
                xian  896.5349      0.44  0.42  0.34      0.48  0.41  0.36      0.48  0.40  0.37
forget mean min: 0.941798 0.796199
delta_x = 3.02922 delta_h = 1.86188
U_c = [[-0.10425284]] U_f = [[ 0.]] b_c = [ 0.09722013] b_f = [ 1.09379315]
incx.max(), incx.min(), incx.mean() 6.50243 0.387994 2.65753
fgtx.max(), fgtx.min(), fgtx.mean() 5.92344 0.268912 2.36773
delta mean, abs_mean, abs_mean+, abs_mean-: 0.164624 3.02922 2.79096 3.34788
W_c max, min, mean, abs_mean: 0.128565 0.125133 0.127651 0.127651
W_f max, min, mean, abs_mean: 0.118671 0.115551 0.118052 0.118052
                xian 4779.4114      0.58  0.15  0.53      0.58  0.14  0.53      0.58  0.12  0.54
forget mean min: 0.960889 0.804447
delta_x = 3.7333 delta_h = 2.51024
U_c = [[-0.10425284]] U_f = [[ 0.]] b_c = [ 0.09722013] b_f = [ 1.09379315]
incx.max(), incx.min(), incx.mean() 6.48431 0.443813 3.24573
fgtx.max(), fgtx.min(), fgtx.mean() 5.90668 0.320533 2.91169
delta mean, abs_mean, abs_mean+, abs_mean-: 0.718014 3.7333 3.23538 4.83085
W_c max, min, mean, abs_mean: 0.128565 0.125133 0.127651 0.127651
W_f max, min, mean, abs_mean: 0.118671 0.115551 0.118052 0.118052
Epoch 2/300
1s - loss: 824.4949 - val_loss: 3693.1189
Epoch 00001: val_loss improved from 4779.41134 to 3693.11895, saving model to xian_weights.hdf5
                xian  781.1864      0.48  0.38  0.37      0.52  0.37  0.40      0.54  0.35  0.42
forget mean min: 0.943504 0.79284
delta_x = 2.61475 delta_h = 1.15055
U_c = [[-0.05682727]] U_f = [[ 0.]] b_c = [ 0.10024323] b_f = [ 1.08625233]
incx.max(), incx.min(), incx.mean() 6.04876 0.40205 2.71318
fgtx.max(), fgtx.min(), fgtx.mean() 5.04314 0.25588 2.21526
delta mean, abs_mean, abs_mean+, abs_mean-: 0.204448 2.61475 2.36746 2.97867
W_c max, min, mean, abs_mean: 0.138169 0.134789 0.137298 0.137298
W_f max, min, mean, abs_mean: 0.117251 0.113938 0.116403 0.116403
                xian 3693.1190      0.73  0.12  0.67      0.75  0.09  0.70      0.75  0.08  0.70
forget mean min: 0.960233 0.79284
delta_x = 3.3717 delta_h = 1.74725
U_c = [[-0.05682727]] U_f = [[ 0.]] b_c = [ 0.10024323] b_f = [ 1.08625233]
incx.max(), incx.min(), incx.mean() 5.95678 0.40205 3.26265
fgtx.max(), fgtx.min(), fgtx.mean() 4.96517 0.25588 2.68109
delta mean, abs_mean, abs_mean+, abs_mean-: 0.393659 3.3717 2.58381 5.48737
W_c max, min, mean, abs_mean: 0.138169 0.134789 0.137298 0.137298
W_f max, min, mean, abs_mean: 0.117251 0.113938 0.116403 0.116403
Epoch 3/300
1s - loss: 766.7128 - val_loss: 3562.7182
Epoch 00002: val_loss improved from 3693.11895 to 3562.71820, saving model to xian_weights.hdf5
                xian  748.0994      0.48  0.36  0.38      0.53  0.35  0.41      0.54  0.34  0.43
forget mean min: 0.939823 0.783819
delta_x = 2.6347 delta_h = 0.982664
U_c = [[-0.04766252]] U_f = [[ 0.]] b_c = [ 0.10133374] b_f = [ 1.06636608]
incx.max(), incx.min(), incx.mean() 6.13727 0.387354 2.82365
fgtx.max(), fgtx.min(), fgtx.mean() 4.67835 0.221696 2.11003
delta mean, abs_mean, abs_mean+, abs_mean-: 0.122765 2.6347 2.41222 2.93151
W_c max, min, mean, abs_mean: 0.147893 0.144452 0.147017 0.147017
W_f max, min, mean, abs_mean: 0.114897 0.111403 0.113952 0.113952
                xian 3562.7182      0.74  0.10  0.68      0.76  0.08  0.71      0.76  0.07  0.72
forget mean min: 0.956924 0.783819
delta_x = 3.5541 delta_h = 1.49552
U_c = [[-0.04766252]] U_f = [[ 0.]] b_c = [ 0.10133374] b_f = [ 1.06636608]
incx.max(), incx.min(), incx.mean() 6.01396 0.387354 3.40213
fgtx.max(), fgtx.min(), fgtx.mean() 4.58277 0.221696 2.5584
delta mean, abs_mean, abs_mean+, abs_mean-: 0.183981 3.5541 2.70933 5.4331
W_c max, min, mean, abs_mean: 0.147893 0.144452 0.147017 0.147017
W_f max, min, mean, abs_mean: 0.114897 0.111403 0.113952 0.113952
Epoch 4/300
1s - loss: 740.1830 - val_loss: 3368.6983
Epoch 00003: val_loss improved from 3562.71820 to 3368.69828, saving model to xian_weights.hdf5
                xian  724.5450      0.53  0.38  0.40      0.58  0.37  0.44      0.60  0.36  0.45
forget mean min: 0.940594 0.773964
delta_x = 2.73653 delta_h = 0.862779
U_c = [[-0.04065982]] U_f = [[ 0.]] b_c = [ 0.09896747] b_f = [ 1.04372859]
incx.max(), incx.min(), incx.mean() 6.96945 0.352292 2.986
fgtx.max(), fgtx.min(), fgtx.mean() 5.0743 0.187101 2.13228
delta mean, abs_mean, abs_mean+, abs_mean-: 0.193877 2.73653 2.56296 2.96819
W_c max, min, mean, abs_mean: 0.156968 0.153379 0.156045 0.156045
W_f max, min, mean, abs_mean: 0.116267 0.112628 0.115251 0.115251
                xian 3368.6983      0.76  0.11  0.70      0.79  0.08  0.74      0.79  0.07  0.75
forget mean min: 0.958813 0.773964
delta_x = 3.67294 delta_h = 1.29988
U_c = [[-0.04065982]] U_f = [[ 0.]] b_c = [ 0.09896747] b_f = [ 1.04372859]
incx.max(), incx.min(), incx.mean() 6.61109 0.352292 3.57921
fgtx.max(), fgtx.min(), fgtx.mean() 4.80963 0.187101 2.5704
delta mean, abs_mean, abs_mean+, abs_mean-: 0.229891 3.67294 2.8873 5.31109
W_c max, min, mean, abs_mean: 0.156968 0.153379 0.156045 0.156045
W_f max, min, mean, abs_mean: 0.116267 0.112628 0.115251 0.115251
Epoch 5/300
1s - loss: 718.5885 - val_loss: 3703.0549
Epoch 00004: val_loss did not improve
Epoch 6/300
1s - loss: 702.8594 - val_loss: 3573.8064
Epoch 00005: val_loss did not improve
Epoch 7/300
1s - loss: 692.9474 - val_loss: 3451.2689
Epoch 00006: val_loss did not improve
Epoch 8/300
1s - loss: 684.7151 - val_loss: 3538.7449
Epoch 00007: val_loss did not improve
Epoch 9/300
1s - loss: 675.6290 - val_loss: 3249.7267
Epoch 00008: val_loss improved from 3368.69828 to 3249.72670, saving model to xian_weights.hdf5
                xian  677.7733      0.62  0.40  0.44      0.68  0.40  0.47      0.70  0.39  0.49
forget mean min: 0.937354 0.714845
delta_x = 3.15343 delta_h = 0.703288
U_c = [[-0.02983417]] U_f = [[ 0.]] b_c = [ 0.05768929] b_f = [ 0.91903192]
incx.max(), incx.min(), incx.mean() 9.02879 0.0576893 3.17967
fgtx.max(), fgtx.min(), fgtx.mean() 6.64478 0.0 2.31244
delta mean, abs_mean, abs_mean+, abs_mean-: 0.228609 3.15343 2.88639 3.53121
W_c max, min, mean, abs_mean: 0.18153 0.177441 0.180315 0.180315
W_f max, min, mean, abs_mean: 0.135226 0.130967 0.13356 0.13356
                xian 3249.7267      0.79  0.13  0.71      0.81  0.10  0.74      0.82  0.09  0.76
forget mean min: 0.957549 0.714845
delta_x = 4.20909 delta_h = 1.02546
U_c = [[-0.02983417]] U_f = [[ 0.]] b_c = [ 0.05768929] b_f = [ 0.91903192]
incx.max(), incx.min(), incx.mean() 7.88391 0.0576893 3.79989
fgtx.max(), fgtx.min(), fgtx.mean() 5.79698 0.0 2.77183
delta mean, abs_mean, abs_mean+, abs_mean-: 0.146381 4.20909 3.26519 6.09932
W_c max, min, mean, abs_mean: 0.18153 0.177441 0.180315 0.180315
W_f max, min, mean, abs_mean: 0.135226 0.130967 0.13356 0.13356
Epoch 10/300
1s - loss: 670.6053 - val_loss: 3190.6282
Epoch 00009: val_loss improved from 3249.72670 to 3190.62822, saving model to xian_weights.hdf5
                xian  672.1589      0.63  0.41  0.44      0.69  0.40  0.47      0.72  0.39  0.49
forget mean min: 0.939234 0.710193
delta_x = 3.18755 delta_h = 0.747682
U_c = [[-0.03223368]] U_f = [[ 0.]] b_c = [ 0.04890879] b_f = [ 0.8963207]
incx.max(), incx.min(), incx.mean() 9.23937 0.0489088 3.22563
fgtx.max(), fgtx.min(), fgtx.mean() 6.90751 0.0 2.38764
delta mean, abs_mean, abs_mean+, abs_mean-: 0.294569 3.18755 2.92353 3.57631
W_c max, min, mean, abs_mean: 0.186106 0.181921 0.184808 0.184808
W_f max, min, mean, abs_mean: 0.140713 0.136374 0.138904 0.138904
                xian 3190.6282      0.80  0.12  0.72      0.82  0.09  0.76      0.83  0.08  0.78
forget mean min: 0.958374 0.710193
delta_x = 4.2225 delta_h = 1.09897
U_c = [[-0.03223368]] U_f = [[ 0.]] b_c = [ 0.04890879] b_f = [ 0.8963207]
incx.max(), incx.min(), incx.mean() 8.0555 0.0489088 3.82585
fgtx.max(), fgtx.min(), fgtx.mean() 6.01775 0.0 2.83876
delta mean, abs_mean, abs_mean+, abs_mean-: 0.24681 4.2225 3.33554 6.02293
W_c max, min, mean, abs_mean: 0.186106 0.181921 0.184808 0.184808
W_f max, min, mean, abs_mean: 0.140713 0.136374 0.138904 0.138904
Epoch 11/300
1s - loss: 664.4001 - val_loss: 3298.5415
Epoch 00010: val_loss did not improve
Epoch 12/300
1s - loss: 656.9311 - val_loss: 3614.7161
Epoch 00011: val_loss did not improve
Epoch 13/300
1s - loss: 651.7339 - val_loss: 3720.2377
Epoch 00012: val_loss did not improve
Epoch 14/300
1s - loss: 645.8073 - val_loss: 3530.7880
Epoch 00013: val_loss did not improve
Epoch 15/300
1s - loss: 638.7174 - val_loss: 3420.3743
Epoch 00014: val_loss did not improve
Epoch 16/300
1s - loss: 633.9835 - val_loss: 3905.3891
Epoch 00015: val_loss did not improve
Epoch 17/300
1s - loss: 627.3302 - val_loss: 3417.1690
Epoch 00016: val_loss did not improve
Epoch 18/300
1s - loss: 622.0168 - val_loss: 3500.5747
Epoch 00017: val_loss did not improve
Epoch 19/300
1s - loss: 615.4998 - val_loss: 3472.9876
Epoch 00018: val_loss did not improve
Epoch 20/300
1s - loss: 611.6603 - val_loss: 3616.7800
Epoch 00019: val_loss did not improve
Epoch 21/300
1s - loss: 606.0137 - val_loss: 3551.8375
Epoch 00020: val_loss did not improve
Epoch 22/300
1s - loss: 601.4231 - val_loss: 3761.8084
Epoch 00021: val_loss did not improve
Epoch 23/300
1s - loss: 595.6181 - val_loss: 3594.7138
Epoch 00022: val_loss did not improve
Epoch 24/300
1s - loss: 593.1268 - val_loss: 3852.1927
Epoch 00023: val_loss did not improve
Epoch 25/300
1s - loss: 590.6723 - val_loss: 3823.1788
Epoch 00024: val_loss did not improve
Epoch 26/300
1s - loss: 586.4543 - val_loss: 3542.1474
Epoch 00025: val_loss did not improve
Epoch 27/300
1s - loss: 581.1357 - val_loss: 3851.5883
Epoch 00026: val_loss did not improve
Epoch 28/300
1s - loss: 579.9099 - val_loss: 3452.7618
Epoch 00027: val_loss did not improve
Epoch 29/300
1s - loss: 577.6268 - val_loss: 3608.6567
Epoch 00028: val_loss did not improve
Epoch 30/300
1s - loss: 574.4685 - val_loss: 3727.1983
Epoch 00029: val_loss did not improve
Epoch 31/300
1s - loss: 569.3272 - val_loss: 3912.0600
Epoch 00030: val_loss did not improve
X_train[0].shape = (5274, 40, 23)

training nanjing
Train on 5274 samples, validate on 1044 samples
Before training:
             nanjing 2761.3354      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 2.74329 delta_h = 1.7857
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -2.74329 2.74329 nan 2.74329
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
             nanjing 5594.5706      0.01  -nan  0.01      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 3.82527 delta_h = 2.38944
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.82527 3.82527 nan 3.82527
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 1763.7577 - val_loss: 1871.0760
Epoch 00000: val_loss improved from inf to 1871.07601, saving model to nanjing_weights.hdf5
             nanjing  809.1972      0.22  0.43  0.19      0.24  0.41  0.21      0.26  0.33  0.23
forget mean min: 0.922884 0.78784
delta_x = 2.72371 delta_h = 1.99934
U_c = [[-0.11989273]] U_f = [[ 0.]] b_c = [ 0.085871] b_f = [ 1.08605754]
incx.max(), incx.min(), incx.mean() 7.26895 0.319991 2.13966
fgtx.max(), fgtx.min(), fgtx.mean() 6.93045 0.225897 1.98157
delta mean, abs_mean, abs_mean+, abs_mean-: -0.467915 2.72371 2.79123 2.67792
W_c max, min, mean, abs_mean: 0.114058 0.109866 0.113041 0.113041
W_f max, min, mean, abs_mean: 0.109853 0.105669 0.109069 0.109069
             nanjing 1871.0760      0.22  0.47  0.19      0.22  0.48  0.18      0.21  0.43  0.18
forget mean min: 0.94607 0.806831
delta_x = 3.12413 delta_h = 2.09935
U_c = [[-0.11989273]] U_f = [[ 0.]] b_c = [ 0.085871] b_f = [ 1.08605754]
incx.max(), incx.min(), incx.mean() 7.31206 0.441866 2.58538
fgtx.max(), fgtx.min(), fgtx.mean() 6.97205 0.343488 2.41161
delta mean, abs_mean, abs_mean+, abs_mean-: -0.188252 3.12413 2.89689 3.35757
W_c max, min, mean, abs_mean: 0.114058 0.109866 0.113041 0.113041
W_f max, min, mean, abs_mean: 0.109853 0.105669 0.109069 0.109069
Epoch 2/300
0s - loss: 698.5824 - val_loss: 1534.0300
Epoch 00001: val_loss improved from 1871.07601 to 1534.03003, saving model to nanjing_weights.hdf5
             nanjing  646.1360      0.39  0.39  0.31      0.42  0.38  0.34      0.45  0.33  0.37
forget mean min: 0.946144 0.801425
delta_x = 2.70535 delta_h = 1.83389
U_c = [[-0.11621533]] U_f = [[ 0.]] b_c = [ 0.09021593] b_f = [ 1.10196579]
incx.max(), incx.min(), incx.mean() 8.00788 0.407299 2.73218
fgtx.max(), fgtx.min(), fgtx.mean() 7.32253 0.293258 2.44339
delta mean, abs_mean, abs_mean+, abs_mean-: 0.587765 2.70535 3.04182 2.30827
W_c max, min, mean, abs_mean: 0.135757 0.131334 0.134471 0.134471
W_f max, min, mean, abs_mean: 0.12511 0.121083 0.124367 0.124367
             nanjing 1534.0300      0.51  0.48  0.35      0.52  0.47  0.36      0.51  0.46  0.36
forget mean min: 0.969416 0.831368
delta_x = 3.20097 delta_h = 2.38287
U_c = [[-0.11621533]] U_f = [[ 0.]] b_c = [ 0.09021593] b_f = [ 1.10196579]
incx.max(), incx.min(), incx.mean() 7.77045 0.623693 3.48301
fgtx.max(), fgtx.min(), fgtx.mean() 7.10295 0.493387 3.13778
delta mean, abs_mean, abs_mean+, abs_mean-: 1.57496 3.20097 3.56581 2.4613
W_c max, min, mean, abs_mean: 0.135757 0.131334 0.134471 0.134471
W_f max, min, mean, abs_mean: 0.12511 0.121083 0.124367 0.124367
Epoch 3/300
0s - loss: 623.3671 - val_loss: 1525.4744
Epoch 00002: val_loss improved from 1534.03003 to 1525.47436, saving model to nanjing_weights.hdf5
             nanjing  600.9460      0.48  0.37  0.38      0.53  0.35  0.41      0.57  0.30  0.46
forget mean min: 0.940186 0.789612
delta_x = 2.93168 delta_h = 1.56536
U_c = [[-0.09351021]] U_f = [[ 0.]] b_c = [ 0.0781205] b_f = [ 1.08404696]
incx.max(), incx.min(), incx.mean() 8.52671 0.389354 3.00665
fgtx.max(), fgtx.min(), fgtx.mean() 6.47542 0.238544 2.24458
delta mean, abs_mean, abs_mean+, abs_mean-: 0.564783 2.93168 3.16043 2.64849
W_c max, min, mean, abs_mean: 0.154385 0.149728 0.152905 0.152905
W_f max, min, mean, abs_mean: 0.117875 0.113904 0.117195 0.117195
             nanjing 1525.4744      0.64  0.47  0.40      0.64  0.47  0.41      0.64  0.44  0.42
forget mean min: 0.967309 0.806103
delta_x = 3.4802 delta_h = 2.23679
U_c = [[-0.09351021]] U_f = [[ 0.]] b_c = [ 0.0781205] b_f = [ 1.08404696]
incx.max(), incx.min(), incx.mean() 8.11357 0.522814 3.9342
fgtx.max(), fgtx.min(), fgtx.mean() 6.15877 0.340836 2.95548
delta mean, abs_mean, abs_mean+, abs_mean-: 1.7564 3.4802 3.6215 3.11142
W_c max, min, mean, abs_mean: 0.154385 0.149728 0.152905 0.152905
W_f max, min, mean, abs_mean: 0.117875 0.113904 0.117195 0.117195
Epoch 4/300
0s - loss: 592.4815 - val_loss: 1490.0042
Epoch 00003: val_loss improved from 1525.47436 to 1490.00424, saving model to nanjing_weights.hdf5
             nanjing  581.4382      0.45  0.31  0.38      0.49  0.29  0.41      0.53  0.23  0.46
forget mean min: 0.935239 0.777504
delta_x = 2.99123 delta_h = 1.30411
U_c = [[-0.07999005]] U_f = [[ 0.]] b_c = [ 0.06180553] b_f = [ 1.06345809]
incx.max(), incx.min(), incx.mean() 8.63107 0.327871 3.04026
fgtx.max(), fgtx.min(), fgtx.mean() 6.04604 0.187721 2.10148
delta mean, abs_mean, abs_mean+, abs_mean-: 0.379042 2.99123 2.98528 2.99893
W_c max, min, mean, abs_mean: 0.163652 0.158811 0.162085 0.162085
W_f max, min, mean, abs_mean: 0.115119 0.110986 0.114361 0.114361
             nanjing 1490.0042      0.64  0.46  0.41      0.65  0.45  0.42      0.64  0.43  0.43
forget mean min: 0.964169 0.797323
delta_x = 3.47731 delta_h = 1.9237
U_c = [[-0.07999005]] U_f = [[ 0.]] b_c = [ 0.06180553] b_f = [ 1.06345809]
incx.max(), incx.min(), incx.mean() 8.47945 0.495777 3.98903
fgtx.max(), fgtx.min(), fgtx.mean() 5.93916 0.306187 2.77088
delta mean, abs_mean, abs_mean+, abs_mean-: 1.54014 3.47731 3.43174 3.60115
W_c max, min, mean, abs_mean: 0.163652 0.158811 0.162085 0.162085
W_f max, min, mean, abs_mean: 0.115119 0.110986 0.114361 0.114361
Epoch 5/300
0s - loss: 572.7358 - val_loss: 1553.6584
Epoch 00004: val_loss did not improve
Epoch 6/300
0s - loss: 554.9997 - val_loss: 1550.5667
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 539.2390 - val_loss: 1485.4127
Epoch 00006: val_loss improved from 1490.00424 to 1485.41265, saving model to nanjing_weights.hdf5
             nanjing  533.4564      0.46  0.29  0.39      0.50  0.26  0.43      0.54  0.21  0.47
forget mean min: 0.929849 0.735286
delta_x = 3.41931 delta_h = 0.858167
U_c = [[-0.05200017]] U_f = [[ 0.]] b_c = [ 0.00892235] b_f = [ 0.98823833]
incx.max(), incx.min(), incx.mean() 8.92569 0.0564208 3.05039
fgtx.max(), fgtx.min(), fgtx.mean() 6.26576 0.0333701 2.13726
delta mean, abs_mean, abs_mean+, abs_mean-: 0.169666 3.41931 2.99934 4.0448
W_c max, min, mean, abs_mean: 0.184281 0.179008 0.182659 0.182659
W_f max, min, mean, abs_mean: 0.129332 0.124547 0.128355 0.128355
             nanjing 1485.4127      0.64  0.46  0.41      0.64  0.46  0.41      0.64  0.44  0.43
forget mean min: 0.961514 0.761865
delta_x = 3.5574 delta_h = 1.30704
U_c = [[-0.05200017]] U_f = [[ 0.]] b_c = [ 0.00892235] b_f = [ 0.98823833]
incx.max(), incx.min(), incx.mean() 9.0354 0.257523 3.9202
fgtx.max(), fgtx.min(), fgtx.mean() 6.34297 0.174691 2.74846
delta mean, abs_mean, abs_mean+, abs_mean-: 1.16152 3.5574 3.274 4.28856
W_c max, min, mean, abs_mean: 0.184281 0.179008 0.182659 0.182659
W_f max, min, mean, abs_mean: 0.129332 0.124547 0.128355 0.128355
Epoch 8/300
0s - loss: 525.8282 - val_loss: 1546.6425
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 512.9035 - val_loss: 1484.9782
Epoch 00008: val_loss improved from 1485.41265 to 1484.97820, saving model to nanjing_weights.hdf5
             nanjing  500.8049      0.49  0.32  0.40      0.53  0.28  0.44      0.58  0.22  0.50
forget mean min: 0.932605 0.718697
delta_x = 3.9765 delta_h = 0.832711
U_c = [[-0.04953183]] U_f = [[ 0.]] b_c = [-0.02008986] b_f = [ 0.93800819]
incx.max(), incx.min(), incx.mean() 9.47284 -0.0200899 3.20493
fgtx.max(), fgtx.min(), fgtx.mean() 7.15053 0.0 2.42929
delta mean, abs_mean, abs_mean+, abs_mean-: 0.316932 3.9765 3.4182 4.91909
W_c max, min, mean, abs_mean: 0.199986 0.194437 0.198226 0.198226
W_f max, min, mean, abs_mean: 0.150323 0.145258 0.149315 0.149315
             nanjing 1484.9782      0.65  0.49  0.40      0.65  0.49  0.40      0.64  0.46  0.41
forget mean min: 0.964812 0.718697
delta_x = 3.9919 delta_h = 1.30182
U_c = [[-0.04953183]] U_f = [[ 0.]] b_c = [-0.02008986] b_f = [ 0.93800819]
incx.max(), incx.min(), incx.mean() 9.90887 -0.0200899 4.02726
fgtx.max(), fgtx.min(), fgtx.mean() 7.47913 0.0 3.0487
delta mean, abs_mean, abs_mean+, abs_mean-: 1.3744 3.9919 3.66423 4.88806
W_c max, min, mean, abs_mean: 0.199986 0.194437 0.198226 0.198226
W_f max, min, mean, abs_mean: 0.150323 0.145258 0.149315 0.149315
Epoch 10/300
0s - loss: 502.0383 - val_loss: 1441.4889
Epoch 00009: val_loss improved from 1484.97820 to 1441.48890, saving model to nanjing_weights.hdf5
             nanjing  490.5387      0.49  0.31  0.40      0.54  0.28  0.45      0.58  0.22  0.50
forget mean min: 0.933078 0.712281
delta_x = 4.02267 delta_h = 0.771901
U_c = [[-0.04615363]] U_f = [[ 0.]] b_c = [-0.03897254] b_f = [ 0.90648746]
incx.max(), incx.min(), incx.mean() 9.91339 -0.0389725 3.15876
fgtx.max(), fgtx.min(), fgtx.mean() 7.88199 0.0 2.53257
delta mean, abs_mean, abs_mean+, abs_mean-: 0.293002 4.02267 3.39986 5.10472
W_c max, min, mean, abs_mean: 0.204206 0.198567 0.202386 0.202386
W_f max, min, mean, abs_mean: 0.161382 0.156129 0.160286 0.160286
             nanjing 1441.4889      0.64  0.50  0.39      0.64  0.50  0.39      0.63  0.48  0.40
forget mean min: 0.96531 0.712281
delta_x = 3.96045 delta_h = 1.16794
U_c = [[-0.04615363]] U_f = [[ 0.]] b_c = [-0.03897254] b_f = [ 0.90648746]
incx.max(), incx.min(), incx.mean() 10.0577 -0.0389725 3.9058
fgtx.max(), fgtx.min(), fgtx.mean() 7.99648 0.0 3.12419
delta mean, abs_mean, abs_mean+, abs_mean-: 1.26462 3.96045 3.58184 4.98088
W_c max, min, mean, abs_mean: 0.204206 0.198567 0.202386 0.202386
W_f max, min, mean, abs_mean: 0.161382 0.156129 0.160286 0.160286
Epoch 11/300
0s - loss: 494.8160 - val_loss: 1585.9659
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 487.0851 - val_loss: 1449.4874
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 479.7771 - val_loss: 1396.8562
Epoch 00012: val_loss improved from 1441.48890 to 1396.85618, saving model to nanjing_weights.hdf5
             nanjing  474.7846      0.47  0.27  0.40      0.51  0.23  0.44      0.55  0.17  0.49
forget mean min: 0.931783 0.691644
delta_x = 4.08119 delta_h = 0.71893
U_c = [[-0.0437165]] U_f = [[ 0.]] b_c = [-0.09893049] b_f = [ 0.80781829]
incx.max(), incx.min(), incx.mean() 10.4155 -0.0989305 2.96905
fgtx.max(), fgtx.min(), fgtx.mean() 9.53599 0.0 2.78258
delta mean, abs_mean, abs_mean+, abs_mean-: 0.160479 4.08119 3.32455 5.41433
W_c max, min, mean, abs_mean: 0.211941 0.206125 0.209958 0.209958
W_f max, min, mean, abs_mean: 0.191777 0.186085 0.190425 0.190425
             nanjing 1396.8562      0.61  0.50  0.38      0.61  0.50  0.38      0.60  0.47  0.39
forget mean min: 0.966216 0.691644
delta_x = 3.96148 delta_h = 1.05802
U_c = [[-0.0437165]] U_f = [[ 0.]] b_c = [-0.09893049] b_f = [ 0.80781829]
incx.max(), incx.min(), incx.mean() 10.3031 -0.0989305 3.65179
fgtx.max(), fgtx.min(), fgtx.mean() 9.43433 0.0 3.40176
delta mean, abs_mean, abs_mean+, abs_mean-: 1.1214 3.96148 3.44222 5.42651
W_c max, min, mean, abs_mean: 0.211941 0.206125 0.209958 0.209958
W_f max, min, mean, abs_mean: 0.191777 0.186085 0.190425 0.190425
Epoch 14/300
0s - loss: 474.3511 - val_loss: 1527.9244
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 467.6197 - val_loss: 1619.5525
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 461.1651 - val_loss: 1528.8372
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 455.7453 - val_loss: 1704.8869
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 450.3540 - val_loss: 1493.4103
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 444.9225 - val_loss: 1472.9315
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 439.4694 - val_loss: 1524.7714
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 435.2648 - val_loss: 1353.6592
Epoch 00020: val_loss improved from 1396.85618 to 1353.65924, saving model to nanjing_weights.hdf5
             nanjing  421.0668      0.51  0.27  0.43      0.55  0.23  0.47      0.60  0.17  0.53
forget mean min: 0.934153 0.633808
delta_x = 4.55148 delta_h = 0.710641
U_c = [[-0.04022373]] U_f = [[ 0.]] b_c = [-0.23749945] b_f = [ 0.54858965]
incx.max(), incx.min(), incx.mean() 11.0517 -0.237499 2.90373
fgtx.max(), fgtx.min(), fgtx.mean() 13.608 0.0 3.78661
delta mean, abs_mean, abs_mean+, abs_mean-: 0.202786 4.55148 3.55397 6.56637
W_c max, min, mean, abs_mean: 0.238948 0.232719 0.236622 0.236622
W_f max, min, mean, abs_mean: 0.287129 0.280892 0.285236 0.285236
             nanjing 1353.6592      0.69  0.47  0.43      0.68  0.47  0.42      0.67  0.45  0.43
forget mean min: 0.971044 0.633808
delta_x = 4.343 delta_h = 1.0631
U_c = [[-0.04022373]] U_f = [[ 0.]] b_c = [-0.23749945] b_f = [ 0.54858965]
incx.max(), incx.min(), incx.mean() 10.6015 -0.237499 3.52634
fgtx.max(), fgtx.min(), fgtx.mean() 13.0657 0.0 4.53708
delta mean, abs_mean, abs_mean+, abs_mean-: 1.30626 4.343 3.61775 6.92594
W_c max, min, mean, abs_mean: 0.238948 0.232719 0.236622 0.236622
W_f max, min, mean, abs_mean: 0.287129 0.280892 0.285236 0.285236
Epoch 22/300
0s - loss: 431.8148 - val_loss: 1469.1175
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 425.8346 - val_loss: 1437.6510
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 422.4568 - val_loss: 1349.3738
Epoch 00023: val_loss improved from 1353.65924 to 1349.37381, saving model to nanjing_weights.hdf5
             nanjing  409.5247      0.51  0.26  0.43      0.56  0.22  0.48      0.60  0.18  0.53
forget mean min: 0.932296 0.616732
delta_x = 4.69228 delta_h = 0.647556
U_c = [[-0.03594782]] U_f = [[ 0.]] b_c = [-0.27508876] b_f = [ 0.47569788]
incx.max(), incx.min(), incx.mean() 11.5625 -0.275089 2.88171
fgtx.max(), fgtx.min(), fgtx.mean() 15.2026 0.0 4.05434
delta mean, abs_mean, abs_mean+, abs_mean-: 0.148451 4.69228 3.58253 7.00348
W_c max, min, mean, abs_mean: 0.250728 0.244219 0.248177 0.248177
W_f max, min, mean, abs_mean: 0.320699 0.314471 0.318738 0.318738
             nanjing 1349.3738      0.67  0.47  0.42      0.67  0.48  0.42      0.67  0.44  0.44
forget mean min: 0.969774 0.616732
delta_x = 4.52825 delta_h = 0.965485
U_c = [[-0.03594782]] U_f = [[ 0.]] b_c = [-0.27508876] b_f = [ 0.47569788]
incx.max(), incx.min(), incx.mean() 11.0084 -0.275089 3.47581
fgtx.max(), fgtx.min(), fgtx.mean() 14.4914 0.0 4.8173
delta mean, abs_mean, abs_mean+, abs_mean-: 1.20209 4.52825 3.67057 7.57942
W_c max, min, mean, abs_mean: 0.250728 0.244219 0.248177 0.248177
W_f max, min, mean, abs_mean: 0.320699 0.314471 0.318738 0.318738
Epoch 25/300
0s - loss: 419.1149 - val_loss: 1323.9371
Epoch 00024: val_loss improved from 1349.37381 to 1323.93714, saving model to nanjing_weights.hdf5
             nanjing  409.7526      0.51  0.27  0.43      0.56  0.22  0.48      0.60  0.18  0.53
forget mean min: 0.929605 0.611698
delta_x = 4.72833 delta_h = 0.728527
U_c = [[-0.04001179]] U_f = [[ 0.]] b_c = [-0.28783506] b_f = [ 0.4544563]
incx.max(), incx.min(), incx.mean() 11.784 -0.287835 2.85309
fgtx.max(), fgtx.min(), fgtx.mean() 15.7515 0.0 4.09847
delta mean, abs_mean, abs_mean+, abs_mean-: 0.102673 4.72833 3.59874 7.03432
W_c max, min, mean, abs_mean: 0.254494 0.247885 0.251864 0.251864
W_f max, min, mean, abs_mean: 0.330619 0.324402 0.328648 0.328648
             nanjing 1323.9371      0.66  0.47  0.41      0.65  0.47  0.41      0.64  0.45  0.42
forget mean min: 0.968476 0.611698
delta_x = 4.63868 delta_h = 1.04253
U_c = [[-0.04001179]] U_f = [[ 0.]] b_c = [-0.28783506] b_f = [ 0.4544563]
incx.max(), incx.min(), incx.mean() 11.2864 -0.287835 3.47187
fgtx.max(), fgtx.min(), fgtx.mean() 15.1025 0.0 4.90585
delta mean, abs_mean, abs_mean+, abs_mean-: 1.1662 4.63868 3.77212 7.53068
W_c max, min, mean, abs_mean: 0.254494 0.247885 0.251864 0.251864
W_f max, min, mean, abs_mean: 0.330619 0.324402 0.328648 0.328648
Epoch 26/300
0s - loss: 414.7392 - val_loss: 1360.7073
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 409.2697 - val_loss: 1263.5387
Epoch 00026: val_loss improved from 1323.93714 to 1263.53873, saving model to nanjing_weights.hdf5
             nanjing  392.0142      0.55  0.27  0.46      0.60  0.23  0.51      0.63  0.18  0.56
forget mean min: 0.933635 0.601941
delta_x = 4.84021 delta_h = 0.720477
U_c = [[-0.03991097]] U_f = [[ 0.]] b_c = [-0.31085399] b_f = [ 0.41355777]
incx.max(), incx.min(), incx.mean() 12.1922 -0.310854 2.95102
fgtx.max(), fgtx.min(), fgtx.mean() 16.7487 0.0 4.36967
delta mean, abs_mean, abs_mean+, abs_mean-: 0.227659 4.84021 3.67102 7.44571
W_c max, min, mean, abs_mean: 0.267359 0.260482 0.264515 0.264515
W_f max, min, mean, abs_mean: 0.356295 0.350169 0.35435 0.35435
             nanjing 1263.5387      0.64  0.46  0.42      0.65  0.46  0.42      0.65  0.42  0.44
forget mean min: 0.967593 0.601941
delta_x = 4.7499 delta_h = 0.996552
U_c = [[-0.03991097]] U_f = [[ 0.]] b_c = [-0.31085399] b_f = [ 0.41355777]
incx.max(), incx.min(), incx.mean() 11.8086 -0.310854 3.45215
fgtx.max(), fgtx.min(), fgtx.mean() 16.2351 0.0 5.04093
delta mean, abs_mean, abs_mean+, abs_mean-: 1.09692 4.7499 3.722 8.51275
W_c max, min, mean, abs_mean: 0.267359 0.260482 0.264515 0.264515
W_f max, min, mean, abs_mean: 0.356295 0.350169 0.35435 0.35435
Epoch 28/300
0s - loss: 404.7813 - val_loss: 1286.2870
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 400.5989 - val_loss: 1295.3561
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 395.7090 - val_loss: 1335.1252
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 391.6584 - val_loss: 1291.4954
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 388.9497 - val_loss: 1287.9609
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 386.1618 - val_loss: 1397.5854
Epoch 00032: val_loss did not improve
Epoch 34/300
0s - loss: 382.6329 - val_loss: 1415.8988
Epoch 00033: val_loss did not improve
Epoch 35/300
0s - loss: 379.1406 - val_loss: 1433.8561
Epoch 00034: val_loss did not improve
Epoch 36/300
0s - loss: 375.1127 - val_loss: 1488.0682
Epoch 00035: val_loss did not improve
Epoch 37/300
0s - loss: 373.1272 - val_loss: 1520.8476
Epoch 00036: val_loss did not improve
Epoch 38/300
0s - loss: 370.5463 - val_loss: 1501.4287
Epoch 00037: val_loss did not improve
Epoch 39/300
0s - loss: 367.9467 - val_loss: 1567.4556
Epoch 00038: val_loss did not improve
Epoch 40/300
0s - loss: 365.9192 - val_loss: 1631.4773
Epoch 00039: val_loss did not improve
Epoch 41/300
0s - loss: 364.4402 - val_loss: 1606.8901
Epoch 00040: val_loss did not improve
Epoch 42/300
0s - loss: 360.7442 - val_loss: 1631.8093
Epoch 00041: val_loss did not improve
Epoch 43/300
0s - loss: 358.6842 - val_loss: 1670.0495
Epoch 00042: val_loss did not improve
Epoch 44/300
0s - loss: 355.6703 - val_loss: 1652.0701
Epoch 00043: val_loss did not improve
Epoch 45/300
0s - loss: 353.0814 - val_loss: 1719.5837
Epoch 00044: val_loss did not improve
Epoch 46/300
0s - loss: 351.5783 - val_loss: 1672.7615
Epoch 00045: val_loss did not improve
Epoch 47/300
0s - loss: 349.9354 - val_loss: 1710.2695
Epoch 00046: val_loss did not improve
Epoch 48/300
0s - loss: 347.8457 - val_loss: 1817.5604
Epoch 00047: val_loss did not improve
X_train[0].shape = (5274, 40, 23)

training shanghai
Train on 5274 samples, validate on 1044 samples
Before training:
            shanghai 2474.6284      0.01  -nan  0.01      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 2.77301 delta_h = 1.82566
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -2.77301 2.77301 nan 2.77301
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
            shanghai 4685.9556      0.01  -nan  0.01      0.01  -nan  0.01      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 3.79465 delta_h = 2.37907
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.79465 3.79465 nan 3.79465
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 1574.6319 - val_loss: 1396.3051
Epoch 00000: val_loss improved from inf to 1396.30507, saving model to shanghai_weights.hdf5
            shanghai  754.2894      0.08  0.46  0.07      0.08  0.40  0.07      0.09  0.37  0.08
forget mean min: 0.936209 0.794712
delta_x = 1.88302 delta_h = 1.48515
U_c = [[-0.11764418]] U_f = [[ 0.]] b_c = [ 0.08355112] b_f = [ 1.08028078]
incx.max(), incx.min(), incx.mean() 5.89992 0.370914 2.10022
fgtx.max(), fgtx.min(), fgtx.mean() 5.53113 0.273285 1.91777
delta mean, abs_mean, abs_mean+, abs_mean-: -0.325416 1.88302 1.76807 1.97351
W_c max, min, mean, abs_mean: 0.113469 0.110637 0.112822 0.112822
W_f max, min, mean, abs_mean: 0.107561 0.106348 0.107294 0.107294
            shanghai 1396.3051      0.08  0.67  0.07      0.09  0.63  0.08      0.09  0.65  0.07
forget mean min: 0.95515 0.830566
delta_x = 1.89922 delta_h = 1.2003
U_c = [[-0.11764418]] U_f = [[ 0.]] b_c = [ 0.08355112] b_f = [ 1.08028078]
incx.max(), incx.min(), incx.mean() 5.43429 0.61917 2.44368
fgtx.max(), fgtx.min(), fgtx.mean() 5.08832 0.509361 2.24439
delta mean, abs_mean, abs_mean+, abs_mean-: -0.136445 1.89922 1.60469 2.25812
W_c max, min, mean, abs_mean: 0.113469 0.110637 0.112822 0.112822
W_f max, min, mean, abs_mean: 0.107561 0.106348 0.107294 0.107294
Epoch 2/300
0s - loss: 647.2193 - val_loss: 1336.4388
Epoch 00001: val_loss improved from 1396.30507 to 1336.43878, saving model to shanghai_weights.hdf5
            shanghai  572.0235      0.30  0.28  0.27      0.35  0.19  0.31      0.36  0.13  0.34
forget mean min: 0.918123 0.774326
delta_x = 2.73627 delta_h = 1.58141
U_c = [[-0.09825701]] U_f = [[ 0.]] b_c = [ 0.11691069] b_f = [ 1.05579031]
incx.max(), incx.min(), incx.mean() 9.15439 0.433439 3.1293
fgtx.max(), fgtx.min(), fgtx.mean() 5.05675 0.177112 1.68552
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0040981 2.73627 2.79167 2.68318
W_c max, min, mean, abs_mean: 0.16354 0.160654 0.162851 0.162851
W_f max, min, mean, abs_mean: 0.0914951 0.0900868 0.0911217 0.0911217
            shanghai 1336.4388      0.21  0.53  0.17      0.19  0.54  0.16      0.11  0.77  0.08
forget mean min: 0.943062 0.781817
delta_x = 2.83586 delta_h = 1.39417
U_c = [[-0.09825701]] U_f = [[ 0.]] b_c = [ 0.11691069] b_f = [ 1.05579031]
incx.max(), incx.min(), incx.mean() 8.49979 0.510974 3.72057
fgtx.max(), fgtx.min(), fgtx.mean() 4.69049 0.220495 2.01635
delta mean, abs_mean, abs_mean+, abs_mean-: 0.30822 2.83586 2.71229 3.00621
W_c max, min, mean, abs_mean: 0.16354 0.160654 0.162851 0.162851
W_f max, min, mean, abs_mean: 0.0914951 0.0900868 0.0911217 0.0911217
Epoch 3/300
0s - loss: 524.8405 - val_loss: 1458.8153
Epoch 00002: val_loss did not improve
Epoch 4/300
0s - loss: 463.7756 - val_loss: 1539.7526
Epoch 00003: val_loss did not improve
Epoch 5/300
0s - loss: 437.2192 - val_loss: 1546.8255
Epoch 00004: val_loss did not improve
Epoch 6/300
0s - loss: 424.0749 - val_loss: 1482.7534
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 415.6048 - val_loss: 1467.2150
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 409.9427 - val_loss: 1418.3023
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 405.5215 - val_loss: 1474.7602
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 401.3666 - val_loss: 1408.3973
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 397.9088 - val_loss: 1390.3193
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 394.1850 - val_loss: 1323.6230
Epoch 00011: val_loss improved from 1336.43878 to 1323.62304, saving model to shanghai_weights.hdf5
            shanghai  389.6721      0.54  0.29  0.44      0.60  0.23  0.50      0.61  0.21  0.53
forget mean min: 0.874786 0.703397
delta_x = 4.39518 delta_h = 0.715733
U_c = [[-0.0402662]] U_f = [[ 0.]] b_c = [ 0.1072206] b_f = [ 0.86352569]
incx.max(), incx.min(), incx.mean() 18.9106 0.107221 6.04337
fgtx.max(), fgtx.min(), fgtx.mean() 3.91135 0.0 1.23477
delta mean, abs_mean, abs_mean+, abs_mean-: 0.202834 4.39518 4.70365 4.10026
W_c max, min, mean, abs_mean: 0.304081 0.300644 0.302997 0.302997
W_f max, min, mean, abs_mean: 0.0638374 0.0611506 0.0630272 0.0630272
            shanghai 1323.6230      0.28  0.34  0.24      0.29  0.21  0.25      0.30  0.14  0.27
forget mean min: 0.893218 0.703397
delta_x = 4.43698 delta_h = 0.625834
U_c = [[-0.0402662]] U_f = [[ 0.]] b_c = [ 0.1072206] b_f = [ 0.86352569]
incx.max(), incx.min(), incx.mean() 15.5578 0.107221 6.75248
fgtx.max(), fgtx.min(), fgtx.mean() 3.21395 0.0 1.38229
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0123359 4.43698 4.47176 4.40293
W_c max, min, mean, abs_mean: 0.304081 0.300644 0.302997 0.302997
W_f max, min, mean, abs_mean: 0.0638374 0.0611506 0.0630272 0.0630272
Epoch 13/300
0s - loss: 391.5605 - val_loss: 1346.5913
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 387.0264 - val_loss: 1336.2577
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 383.7457 - val_loss: 1344.2689
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 380.0773 - val_loss: 1328.9436
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 376.6127 - val_loss: 1269.9539
Epoch 00016: val_loss improved from 1323.62304 to 1269.95389, saving model to shanghai_weights.hdf5
            shanghai  368.7381      0.55  0.28  0.45      0.61  0.22  0.52      0.63  0.20  0.55
forget mean min: 0.875316 0.690449
delta_x = 4.4196 delta_h = 0.566253
U_c = [[-0.03139152]] U_f = [[ 0.]] b_c = [ 0.08503979] b_f = [ 0.8022173]
incx.max(), incx.min(), incx.mean() 19.3979 0.0850398 5.8377
fgtx.max(), fgtx.min(), fgtx.mean() 4.4379 0.0 1.32187
delta mean, abs_mean, abs_mean+, abs_mean-: 0.127745 4.4196 4.68078 4.17289
W_c max, min, mean, abs_mean: 0.322586 0.319078 0.321192 0.321192
W_f max, min, mean, abs_mean: 0.0752119 0.0714974 0.0738061 0.0738061
            shanghai 1269.9539      0.29  0.36  0.25      0.30  0.26  0.27      0.31  0.19  0.28
forget mean min: 0.897871 0.693255
delta_x = 4.43425 delta_h = 0.489854
U_c = [[-0.03139152]] U_f = [[ 0.]] b_c = [ 0.08503979] b_f = [ 0.8022173]
incx.max(), incx.min(), incx.mean() 15.6571 0.142399 6.65127
fgtx.max(), fgtx.min(), fgtx.mean() 3.57806 0.0131626 1.50884
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0371749 4.43425 4.51293 4.35701
W_c max, min, mean, abs_mean: 0.322586 0.319078 0.321192 0.321192
W_f max, min, mean, abs_mean: 0.0752119 0.0714974 0.0738061 0.0738061
Epoch 18/300
0s - loss: 372.3992 - val_loss: 1238.4814
Epoch 00017: val_loss improved from 1269.95389 to 1238.48144, saving model to shanghai_weights.hdf5
            shanghai  363.9169      0.55  0.27  0.46      0.62  0.21  0.53      0.63  0.19  0.55
forget mean min: 0.874552 0.687497
delta_x = 4.45946 delta_h = 0.565511
U_c = [[-0.03153303]] U_f = [[ 0.]] b_c = [ 0.0820036] b_f = [ 0.78844506]
incx.max(), incx.min(), incx.mean() 19.5224 0.0820036 5.81277
fgtx.max(), fgtx.min(), fgtx.mean() 4.52416 0.0 1.33362
delta mean, abs_mean, abs_mean+, abs_mean-: 0.1092 4.45946 4.68407 4.24565
W_c max, min, mean, abs_mean: 0.328301 0.324798 0.326841 0.326841
W_f max, min, mean, abs_mean: 0.0775981 0.0736736 0.0760616 0.0760616
            shanghai 1238.4814      0.30  0.34  0.26      0.32  0.26  0.28      0.33  0.20  0.30
forget mean min: 0.897491 0.693938
delta_x = 4.48289 delta_h = 0.504766
U_c = [[-0.03153303]] U_f = [[ 0.]] b_c = [ 0.0820036] b_f = [ 0.78844506]
incx.max(), incx.min(), incx.mean() 15.9842 0.211649 6.64171
fgtx.max(), fgtx.min(), fgtx.mean() 3.70048 0.0301495 1.52655
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0433017 4.48289 4.57683 4.39101
W_c max, min, mean, abs_mean: 0.328301 0.324798 0.326841 0.326841
W_f max, min, mean, abs_mean: 0.0775981 0.0736736 0.0760616 0.0760616
Epoch 19/300
0s - loss: 369.5117 - val_loss: 1231.8447
Epoch 00018: val_loss improved from 1238.48144 to 1231.84465, saving model to shanghai_weights.hdf5
            shanghai  360.3270      0.57  0.27  0.47      0.64  0.22  0.55      0.65  0.20  0.56
forget mean min: 0.873815 0.684798
delta_x = 4.5099 delta_h = 0.50803
U_c = [[-0.02753805]] U_f = [[ 0.]] b_c = [ 0.07842702] b_f = [ 0.77590895]
incx.max(), incx.min(), incx.mean() 19.5308 0.078427 5.77983
fgtx.max(), fgtx.min(), fgtx.mean() 4.59398 0.0 1.34644
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0932702 4.5099 4.71662 4.3129
W_c max, min, mean, abs_mean: 0.333375 0.329781 0.331843 0.331843
W_f max, min, mean, abs_mean: 0.0800298 0.0758969 0.0783693 0.0783693
            shanghai 1231.8446      0.32  0.37  0.26      0.34  0.29  0.29      0.35  0.23  0.31
forget mean min: 0.898189 0.702677
delta_x = 4.604 delta_h = 0.455353
U_c = [[-0.02753805]] U_f = [[ 0.]] b_c = [ 0.07842702] b_f = [ 0.77590895]
incx.max(), incx.min(), incx.mean() 16.2771 0.434946 6.66511
fgtx.max(), fgtx.min(), fgtx.mean() 3.82529 0.0841689 1.55553
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0611743 4.604 4.7087 4.50122
W_c max, min, mean, abs_mean: 0.333375 0.329781 0.331843 0.331843
W_f max, min, mean, abs_mean: 0.0800298 0.0758969 0.0783693 0.0783693
Epoch 20/300
0s - loss: 365.0211 - val_loss: 1179.3586
Epoch 00019: val_loss improved from 1231.84465 to 1179.35861, saving model to shanghai_weights.hdf5
            shanghai  374.4226      0.63  0.32  0.49      0.70  0.28  0.55      0.73  0.27  0.58
forget mean min: 0.880027 0.682587
delta_x = 4.72538 delta_h = 0.49188
U_c = [[-0.02555262]] U_f = [[ 0.]] b_c = [ 0.07787375] b_f = [ 0.7656855]
incx.max(), incx.min(), incx.mean() 20.3439 0.0778738 5.97468
fgtx.max(), fgtx.min(), fgtx.mean() 4.93466 0.0 1.43579
delta mean, abs_mean, abs_mean+, abs_mean-: 0.256364 4.72538 4.89647 4.54823
W_c max, min, mean, abs_mean: 0.340644 0.336913 0.339008 0.339008
W_f max, min, mean, abs_mean: 0.0843314 0.0799888 0.0825458 0.0825458
            shanghai 1179.3586      0.38  0.46  0.29      0.39  0.41  0.30      0.41  0.34  0.33
forget mean min: 0.904479 0.717011
delta_x = 4.72241 delta_h = 0.450562
U_c = [[-0.02555262]] U_f = [[ 0.]] b_c = [ 0.07787375] b_f = [ 0.7656855]
incx.max(), incx.min(), incx.mean() 16.7917 0.751505 6.85383
fgtx.max(), fgtx.min(), fgtx.mean() 4.06939 0.163999 1.64988
delta mean, abs_mean, abs_mean+, abs_mean-: 0.273862 4.72241 4.88675 4.55055
W_c max, min, mean, abs_mean: 0.340644 0.336913 0.339008 0.339008
W_f max, min, mean, abs_mean: 0.0843314 0.0799888 0.0825458 0.0825458
Epoch 21/300
0s - loss: 362.7579 - val_loss: 1243.3378
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 360.0552 - val_loss: 1281.3230
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 357.1521 - val_loss: 1244.3428
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 353.8151 - val_loss: 1259.1255
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 350.9330 - val_loss: 1252.4315
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 348.7443 - val_loss: 1279.0531
Epoch 00025: val_loss did not improve
Epoch 27/300
0s - loss: 346.0102 - val_loss: 1277.4966
Epoch 00026: val_loss did not improve
Epoch 28/300
0s - loss: 343.9596 - val_loss: 1260.0976
Epoch 00027: val_loss did not improve
Epoch 29/300
0s - loss: 340.1748 - val_loss: 1249.1936
Epoch 00028: val_loss did not improve
Epoch 30/300
0s - loss: 337.4555 - val_loss: 1295.9444
Epoch 00029: val_loss did not improve
Epoch 31/300
0s - loss: 334.7434 - val_loss: 1274.3998
Epoch 00030: val_loss did not improve
Epoch 32/300
0s - loss: 331.0669 - val_loss: 1290.5172
Epoch 00031: val_loss did not improve
Epoch 33/300
0s - loss: 328.3880 - val_loss: 1366.3642
Epoch 00032: val_loss did not improve
Epoch 34/300
0s - loss: 324.7966 - val_loss: 1358.1763
Epoch 00033: val_loss did not improve
Epoch 35/300
0s - loss: 323.3123 - val_loss: 1324.4886
Epoch 00034: val_loss did not improve
Epoch 36/300
0s - loss: 321.4799 - val_loss: 1321.5094
Epoch 00035: val_loss did not improve
Epoch 37/300
0s - loss: 318.7462 - val_loss: 1367.5008
Epoch 00036: val_loss did not improve
Epoch 38/300
0s - loss: 316.2350 - val_loss: 1363.5234
Epoch 00037: val_loss did not improve
Epoch 39/300
0s - loss: 314.5957 - val_loss: 1423.7953
Epoch 00038: val_loss did not improve
Epoch 40/300
0s - loss: 313.8914 - val_loss: 1383.3649
Epoch 00039: val_loss did not improve
Epoch 41/300
0s - loss: 312.2941 - val_loss: 1389.2109
Epoch 00040: val_loss did not improve
X_train[0].shape = (9962, 40, 23)

training chongqing
Train on 9962 samples, validate on 1972 samples
Before training:
           chongqing 1656.1707      0.00  -nan  0.00      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 2.61047 delta_h = 1.73258
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -2.61047 2.61047 nan 2.61047
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
           chongqing 3481.1377      0.00  -nan  0.00      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731059 0.731059
delta_x = 3.04701 delta_h = 1.87149
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.04701 3.04701 nan 3.04701
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
1s - loss: 683.5368 - val_loss: 752.1343
Epoch 00000: val_loss improved from inf to 752.13435, saving model to chongqing_weights.hdf5
           chongqing  324.7261      0.05  0.61  0.04      0.07  0.61  0.06      0.07  0.64  0.06
forget mean min: 0.949214 0.80001
delta_x = 1.761 delta_h = 1.17139
U_c = [[-0.09547757]] U_f = [[ 0.]] b_c = [ 0.08098745] b_f = [ 1.09693289]
incx.max(), incx.min(), incx.mean() 5.21013 0.289738 1.72717
fgtx.max(), fgtx.min(), fgtx.mean() 7.1108 0.289426 2.28219
delta mean, abs_mean, abs_mean+, abs_mean-: -0.171629 1.761 1.66748 1.84615
W_c max, min, mean, abs_mean: 0.0944472 0.0909804 0.0934313 0.0934313
W_f max, min, mean, abs_mean: 0.130092 0.127967 0.129535 0.129535
           chongqing  752.1343      0.06  -nan  0.06      0.07  -nan  0.06      0.08  -nan  0.08
forget mean min: 0.959578 0.858134
delta_x = 1.76907 delta_h = 0.884877
U_c = [[-0.09547757]] U_f = [[ 0.]] b_c = [ 0.08098745] b_f = [ 1.09693289]
incx.max(), incx.min(), incx.mean() 4.3526 0.588025 1.85078
fgtx.max(), fgtx.min(), fgtx.mean() 5.92194 0.702946 2.45356
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0372821 1.76907 1.49785 2.1407
W_c max, min, mean, abs_mean: 0.0944472 0.0909804 0.0934313 0.0934313
W_f max, min, mean, abs_mean: 0.130092 0.127967 0.129535 0.129535
Epoch 2/300
1s - loss: 293.0239 - val_loss: 634.6765
Epoch 00001: val_loss improved from 752.13435 to 634.67655, saving model to chongqing_weights.hdf5
           chongqing  271.8190      0.07  0.57  0.06      0.09  0.60  0.07      0.10  0.63  0.08
forget mean min: 0.960881 0.780251
delta_x = 1.82674 delta_h = 0.982373
U_c = [[-0.0734789]] U_f = [[ 0.]] b_c = [ 0.06918589] b_f = [ 1.04128742]
incx.max(), incx.min(), incx.mean() 4.50101 0.154307 1.34348
fgtx.max(), fgtx.min(), fgtx.mean() 11.757 0.225841 3.38054
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0416798 1.82674 1.46619 2.38772
W_c max, min, mean, abs_mean: 0.068479 0.0647134 0.0669776 0.0669776
W_f max, min, mean, abs_mean: 0.179024 0.17606 0.177691 0.177691
           chongqing  634.6765      0.10  0.04  0.09      0.10  0.03  0.10      0.11  0.02  0.10
forget mean min: 0.971202 0.795585
delta_x = 1.86806 delta_h = 0.759129
U_c = [[-0.0734789]] U_f = [[ 0.]] b_c = [ 0.06918589] b_f = [ 1.04128742]
incx.max(), incx.min(), incx.mean() 4.1961 0.18891 1.44976
fgtx.max(), fgtx.min(), fgtx.mean() 10.9482 0.317636 3.66249
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0987305 1.86806 1.485 2.61906
W_c max, min, mean, abs_mean: 0.068479 0.0647134 0.0669776 0.0669776
W_f max, min, mean, abs_mean: 0.179024 0.17606 0.177691 0.177691
Epoch 3/300
1s - loss: 259.7126 - val_loss: 637.2807
Epoch 00002: val_loss did not improve
Epoch 4/300
1s - loss: 241.0566 - val_loss: 648.3171
Epoch 00003: val_loss did not improve
Epoch 5/300
1s - loss: 229.0116 - val_loss: 735.5464
Epoch 00004: val_loss did not improve
Epoch 6/300
1s - loss: 219.8637 - val_loss: 759.6568
Epoch 00005: val_loss did not improve
Epoch 7/300
1s - loss: 211.9009 - val_loss: 829.9066
Epoch 00006: val_loss did not improve
Epoch 8/300
1s - loss: 207.0110 - val_loss: 864.1438
Epoch 00007: val_loss did not improve
Epoch 9/300
1s - loss: 202.3503 - val_loss: 904.2909
Epoch 00008: val_loss did not improve
Epoch 10/300
1s - loss: 198.6267 - val_loss: 958.1984
Epoch 00009: val_loss did not improve
Epoch 11/300
1s - loss: 195.5588 - val_loss: 957.0209
Epoch 00010: val_loss did not improve
Epoch 12/300
1s - loss: 192.6294 - val_loss: 939.2105
Epoch 00011: val_loss did not improve
Epoch 13/300
1s - loss: 191.0510 - val_loss: 948.6251
Epoch 00012: val_loss did not improve
Epoch 14/300
1s - loss: 189.3203 - val_loss: 937.1896
Epoch 00013: val_loss did not improve
Epoch 15/300
1s - loss: 187.7244 - val_loss: 963.9824
Epoch 00014: val_loss did not improve
Epoch 16/300
1s - loss: 185.7042 - val_loss: 914.9463
Epoch 00015: val_loss did not improve
Epoch 17/300
1s - loss: 184.6468 - val_loss: 1007.2511
Epoch 00016: val_loss did not improve
Epoch 18/300
1s - loss: 183.1873 - val_loss: 971.5226
Epoch 00017: val_loss did not improve
Epoch 19/300
1s - loss: 182.4490 - val_loss: 975.5538
Epoch 00018: val_loss did not improve
Epoch 20/300
1s - loss: 181.1925 - val_loss: 992.7671
Epoch 00019: val_loss did not improve
Epoch 21/300
1s - loss: 180.1900 - val_loss: 1017.2822
Epoch 00020: val_loss did not improve
Epoch 22/300
1s - loss: 179.0818 - val_loss: 988.3414
Epoch 00021: val_loss did not improve
Epoch 23/300
1s - loss: 178.1023 - val_loss: 1024.7146
Epoch 00022: val_loss did not improve
X_train[0].shape = (4102, 40, 23)

training chengdu
Train on 4102 samples, validate on 812 samples
Before training:
             chengdu 2474.8902      0.01  -nan  0.01      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 2.94023 delta_h = 1.96695
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -2.94023 2.94023 nan 2.94023
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
             chengdu 3395.3869      0.00  -nan  0.00      0.00  -nan  0.00      0.00  -nan  0.00
forget mean min: 0.731058 0.731059
delta_x = 3.21237 delta_h = 1.96225
U_c = [[-0.05]] U_f = [[ 0.]] b_c = [ 0.] b_f = [ 1.]
incx.max(), incx.min(), incx.mean() 0.0 0.0 0.0
fgtx.max(), fgtx.min(), fgtx.mean() 0.0 0.0 0.0
delta mean, abs_mean, abs_mean+, abs_mean-: -3.21237 3.21237 nan 3.21237
W_c max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
W_f max, min, mean, abs_mean: 0.0 0.0 0.0 0.0
Epoch 1/300
0s - loss: 1700.7936 - val_loss: 1562.5692
Epoch 00000: val_loss improved from inf to 1562.56920, saving model to chengdu_weights.hdf5
             chengdu  812.6007      0.12  0.33  0.11      0.13  0.27  0.12      0.14  0.15  0.13
forget mean min: 0.899369 0.77458
delta_x = 2.96503 delta_h = 2.1084
U_c = [[-0.10854932]] U_f = [[ 0.]] b_c = [ 0.07095878] b_f = [ 1.07080793]
incx.max(), incx.min(), incx.mean() 5.77729 0.239679 1.64621
fgtx.max(), fgtx.min(), fgtx.mean() 5.53075 0.163548 1.52679
delta mean, abs_mean, abs_mean+, abs_mean-: -1.54933 2.96503 2.13148 3.37949
W_c max, min, mean, abs_mean: 0.0982667 0.0951973 0.0974095 0.0974095
W_f max, min, mean, abs_mean: 0.094699 0.0935732 0.0944197 0.0944197
             chengdu 1562.5692      0.03  -nan  0.03      0.03  -nan  0.03      0.02  -nan  0.02
forget mean min: 0.879003 0.77458
delta_x = 3.31241 delta_h = 2.16064
U_c = [[-0.10854932]] U_f = [[ 0.]] b_c = [ 0.07095878] b_f = [ 1.07080793]
incx.max(), incx.min(), incx.mean() 4.56616 0.239679 1.3103
fgtx.max(), fgtx.min(), fgtx.mean() 4.35689 0.163548 1.20121
delta mean, abs_mean, abs_mean+, abs_mean-: -2.44516 3.31241 1.91569 3.72106
W_c max, min, mean, abs_mean: 0.0982667 0.0951973 0.0974095 0.0974095
W_f max, min, mean, abs_mean: 0.094699 0.0935732 0.0944197 0.0944197
Epoch 2/300
0s - loss: 650.4304 - val_loss: 949.3571
Epoch 00001: val_loss improved from 1562.56920 to 949.35714, saving model to chengdu_weights.hdf5
             chengdu  572.4045      0.34  0.35  0.28      0.37  0.30  0.32      0.39  0.20  0.35
forget mean min: 0.934186 0.79863
delta_x = 2.75846 delta_h = 1.46094
U_c = [[-0.07683063]] U_f = [[ 0.]] b_c = [ 0.09051214] b_f = [ 1.10018933]
incx.max(), incx.min(), incx.mean() 7.04359 0.344589 2.13204
fgtx.max(), fgtx.min(), fgtx.mean() 7.59519 0.277565 2.23007
delta mean, abs_mean, abs_mean+, abs_mean-: -0.299854 2.75846 2.76929 2.74981
W_c max, min, mean, abs_mean: 0.109663 0.106513 0.108775 0.108775
W_f max, min, mean, abs_mean: 0.119257 0.118067 0.118827 0.118827
             chengdu  949.3571      0.13  0.44  0.11      0.14  0.40  0.12      0.14  0.26  0.12
forget mean min: 0.929997 0.79863
delta_x = 2.65647 delta_h = 1.23939
U_c = [[-0.07683063]] U_f = [[ 0.]] b_c = [ 0.09051214] b_f = [ 1.10018933]
incx.max(), incx.min(), incx.mean() 5.77172 0.344589 1.91832
fgtx.max(), fgtx.min(), fgtx.mean() 6.20585 0.277565 1.99662
delta mean, abs_mean, abs_mean+, abs_mean-: -0.795341 2.65647 2.26555 2.92896
W_c max, min, mean, abs_mean: 0.109663 0.106513 0.108775 0.108775
W_f max, min, mean, abs_mean: 0.119257 0.118067 0.118827 0.118827
Epoch 3/300
0s - loss: 544.2444 - val_loss: 719.0332
Epoch 00002: val_loss improved from 949.35714 to 719.03322, saving model to chengdu_weights.hdf5
             chengdu  530.9278      0.60  0.35  0.45      0.64  0.31  0.50      0.69  0.23  0.57
forget mean min: 0.94438 0.812452
delta_x = 2.86879 delta_h = 1.00273
U_c = [[-0.04807815]] U_f = [[ 0.]] b_c = [ 0.10405856] b_f = [ 1.11537504]
incx.max(), incx.min(), incx.mean() 7.39693 0.400525 2.30567
fgtx.max(), fgtx.min(), fgtx.mean() 8.62511 0.35065 2.6038
delta mean, abs_mean, abs_mean+, abs_mean-: 0.104307 2.86879 2.83481 2.90626
W_c max, min, mean, abs_mean: 0.113165 0.10985 0.112211 0.112211
W_f max, min, mean, abs_mean: 0.133217 0.132059 0.132716 0.132716
             chengdu  719.0332      0.25  0.50  0.20      0.28  0.49  0.22      0.31  0.47  0.24
forget mean min: 0.948705 0.812452
delta_x = 2.60985 delta_h = 0.837322
U_c = [[-0.04807815]] U_f = [[ 0.]] b_c = [ 0.10405856] b_f = [ 1.11537504]
incx.max(), incx.min(), incx.mean() 6.46597 0.400525 2.2009
fgtx.max(), fgtx.min(), fgtx.mean() 7.52408 0.35065 2.47989
delta mean, abs_mean, abs_mean+, abs_mean-: -0.103576 2.60985 2.43855 2.79093
W_c max, min, mean, abs_mean: 0.113165 0.10985 0.112211 0.112211
W_f max, min, mean, abs_mean: 0.133217 0.132059 0.132716 0.132716
Epoch 4/300
0s - loss: 514.8274 - val_loss: 693.1520
Epoch 00003: val_loss improved from 719.03322 to 693.15197, saving model to chengdu_weights.hdf5
             chengdu  509.8358      0.41  0.27  0.35      0.45  0.21  0.40      0.47  0.15  0.42
forget mean min: 0.942148 0.812639
delta_x = 2.65349 delta_h = 0.914665
U_c = [[-0.04822219]] U_f = [[ 0.]] b_c = [ 0.10717209] b_f = [ 1.11270559]
incx.max(), incx.min(), incx.mean() 6.40652 0.387337 2.038
fgtx.max(), fgtx.min(), fgtx.mean() 7.97112 0.354543 2.44326
delta mean, abs_mean, abs_mean+, abs_mean-: -0.179933 2.65349 2.34773 2.99389
W_c max, min, mean, abs_mean: 0.108024 0.104555 0.107006 0.107006
W_f max, min, mean, abs_mean: 0.135975 0.134679 0.135411 0.135411
             chengdu  693.1520      0.19  0.41  0.16      0.22  0.39  0.18      0.23  0.31  0.20
forget mean min: 0.94862 0.812639
delta_x = 2.33645 delta_h = 0.717806
U_c = [[-0.04822219]] U_f = [[ 0.]] b_c = [ 0.10717209] b_f = [ 1.11270559]
incx.max(), incx.min(), incx.mean() 5.6649 0.387337 1.98529
fgtx.max(), fgtx.min(), fgtx.mean() 7.03269 0.354543 2.37656
delta mean, abs_mean, abs_mean+, abs_mean-: -0.28556 2.33645 2.06002 2.61044
W_c max, min, mean, abs_mean: 0.108024 0.104555 0.107006 0.107006
W_f max, min, mean, abs_mean: 0.135975 0.134679 0.135411 0.135411
Epoch 5/300
0s - loss: 497.9730 - val_loss: 676.1360
Epoch 00004: val_loss improved from 693.15197 to 676.13596, saving model to chengdu_weights.hdf5
             chengdu  494.5996      0.61  0.34  0.47      0.66  0.30  0.51      0.71  0.23  0.58
forget mean min: 0.945132 0.812052
delta_x = 3.00153 delta_h = 0.808019
U_c = [[-0.03835423]] U_f = [[ 0.]] b_c = [ 0.11706408] b_f = [ 1.10228586]
incx.max(), incx.min(), incx.mean() 7.39487 0.406244 2.29996
fgtx.max(), fgtx.min(), fgtx.mean() 9.08773 0.361116 2.72577
delta mean, abs_mean, abs_mean+, abs_mean-: 0.0919974 3.00153 2.75138 3.32272
W_c max, min, mean, abs_mean: 0.115421 0.111795 0.114342 0.114342
W_f max, min, mean, abs_mean: 0.143351 0.141986 0.142782 0.142782
             chengdu  676.1360      0.26  0.52  0.20      0.30  0.51  0.22      0.32  0.49  0.24
forget mean min: 0.952164 0.812052
delta_x = 2.65177 delta_h = 0.664233
U_c = [[-0.03835423]] U_f = [[ 0.]] b_c = [ 0.11706408] b_f = [ 1.10228586]
incx.max(), incx.min(), incx.mean() 6.54061 0.406244 2.22222
fgtx.max(), fgtx.min(), fgtx.mean() 8.02103 0.361116 2.62869
delta mean, abs_mean, abs_mean+, abs_mean-: -0.0419356 2.65177 2.37817 2.98443
W_c max, min, mean, abs_mean: 0.115421 0.111795 0.114342 0.114342
W_f max, min, mean, abs_mean: 0.143351 0.141986 0.142782 0.142782
Epoch 6/300
0s - loss: 483.5794 - val_loss: 685.5477
Epoch 00005: val_loss did not improve
Epoch 7/300
0s - loss: 470.8863 - val_loss: 702.6833
Epoch 00006: val_loss did not improve
Epoch 8/300
0s - loss: 457.9406 - val_loss: 766.4691
Epoch 00007: val_loss did not improve
Epoch 9/300
0s - loss: 447.4671 - val_loss: 778.8777
Epoch 00008: val_loss did not improve
Epoch 10/300
0s - loss: 438.4171 - val_loss: 779.8639
Epoch 00009: val_loss did not improve
Epoch 11/300
0s - loss: 431.7033 - val_loss: 796.9760
Epoch 00010: val_loss did not improve
Epoch 12/300
0s - loss: 423.8997 - val_loss: 790.2411
Epoch 00011: val_loss did not improve
Epoch 13/300
0s - loss: 416.3318 - val_loss: 826.2675
Epoch 00012: val_loss did not improve
Epoch 14/300
0s - loss: 409.5745 - val_loss: 790.3732
Epoch 00013: val_loss did not improve
Epoch 15/300
0s - loss: 403.0800 - val_loss: 836.2630
Epoch 00014: val_loss did not improve
Epoch 16/300
0s - loss: 397.7868 - val_loss: 862.9247
Epoch 00015: val_loss did not improve
Epoch 17/300
0s - loss: 392.2031 - val_loss: 838.5201
Epoch 00016: val_loss did not improve
Epoch 18/300
0s - loss: 386.7807 - val_loss: 909.8745
Epoch 00017: val_loss did not improve
Epoch 19/300
0s - loss: 383.5903 - val_loss: 879.8702
Epoch 00018: val_loss did not improve
Epoch 20/300
0s - loss: 380.8266 - val_loss: 881.2034
Epoch 00019: val_loss did not improve
Epoch 21/300
0s - loss: 376.0338 - val_loss: 799.0508
Epoch 00020: val_loss did not improve
Epoch 22/300
0s - loss: 373.1440 - val_loss: 817.1674
Epoch 00021: val_loss did not improve
Epoch 23/300
0s - loss: 371.2685 - val_loss: 802.1273
Epoch 00022: val_loss did not improve
Epoch 24/300
0s - loss: 369.2706 - val_loss: 910.5845
Epoch 00023: val_loss did not improve
Epoch 25/300
0s - loss: 366.2103 - val_loss: 826.3220
Epoch 00024: val_loss did not improve
Epoch 26/300
0s - loss: 363.8103 - val_loss: 812.8250
Epoch 00025: val_loss did not improve

beijing
             beijing 1225.7640      0.89  0.19  0.73      0.90  0.16  0.76      0.90  0.13  0.80
forget mean min: 0.869962 0.512862
delta_x = 7.75671 delta_h = 0.904572
U_c = [[-0.01699352]] U_f = [[ 0.]] b_c = [ 0.24056761] b_f = [ 0.05145952]
incx.max(), incx.min(), incx.mean() 18.9141 0.240568 4.38887
fgtx.max(), fgtx.min(), fgtx.mean() 33.1613 0.0 7.36669
             beijing 6244.0905      0.85  0.09  0.79      0.85  0.06  0.81      0.87  0.05  0.84
forget mean min: 0.884572 0.512862
delta_x = 9.66795 delta_h = 1.55983
U_c = [[-0.01699352]] U_f = [[ 0.]] b_c = [ 0.24056761] b_f = [ 0.05145952]
incx.max(), incx.min(), incx.mean() 18.4137 0.240568 4.81211
fgtx.max(), fgtx.min(), fgtx.mean() 32.2724 0.0 8.11822

tianjin
             tianjin  887.8304      0.82  0.23  0.66      0.85  0.18  0.71      0.84  0.15  0.73
forget mean min: 0.914116 0.631704
delta_x = 6.06704 delta_h = 1.95185
U_c = [[-0.05885543]] U_f = [[ 0.]] b_c = [ 0.08147578] b_f = [ 0.53953248]
incx.max(), incx.min(), incx.mean() 14.5522 0.0814758 4.44115
fgtx.max(), fgtx.min(), fgtx.mean() 10.7218 0.0 3.23024
             tianjin 4277.6030      0.92  0.23  0.72      0.92  0.22  0.73      0.93  0.20  0.75
forget mean min: 0.938282 0.631704
delta_x = 7.5455 delta_h = 2.90209
U_c = [[-0.05885543]] U_f = [[ 0.]] b_c = [ 0.08147578] b_f = [ 0.53953248]
incx.max(), incx.min(), incx.mean() 13.4746 0.0814758 5.38752
fgtx.max(), fgtx.min(), fgtx.mean() 9.92357 0.0 3.93156

tangshan
            tangshan 1150.9202      0.82  0.26  0.63      0.86  0.23  0.68      0.89  0.21  0.72
forget mean min: 0.928667 0.724362
delta_x = 6.4652 delta_h = 3.0006
U_c = [[-0.07689725]] U_f = [[ 0.]] b_c = [ 0.09852207] b_f = [ 0.95228159]
incx.max(), incx.min(), incx.mean() 13.0741 0.116749 4.55946
fgtx.max(), fgtx.min(), fgtx.mean() 9.90857 0.0139191 3.40651
            tangshan 4929.1587      0.93  0.12  0.83      0.95  0.09  0.86      0.94  0.09  0.86
forget mean min: 0.933716 0.724362
delta_x = 7.18433 delta_h = 3.38853
U_c = [[-0.07689725]] U_f = [[ 0.]] b_c = [ 0.09852207] b_f = [ 0.95228159]
incx.max(), incx.min(), incx.mean() 11.6732 0.116749 4.49219
fgtx.max(), fgtx.min(), fgtx.mean() 8.83875 0.0139191 3.35515

baoding
             baoding 1005.7835      0.90  0.21  0.72      0.94  0.19  0.76      0.94  0.18  0.77
forget mean min: 0.918968 0.567836
delta_x = 8.72252 delta_h = 0.880168
U_c = [[-0.01798533]] U_f = [[ 0.]] b_c = [ 0.13175687] b_f = [ 0.27302802]
incx.max(), incx.min(), incx.mean() 22.6999 0.131757 5.10267
fgtx.max(), fgtx.min(), fgtx.mean() 34.398 0.0 7.5766
             baoding11442.8718      0.97  0.13  0.84      0.96  0.09  0.88      0.96  0.07  0.89
forget mean min: 0.966497 0.567836
delta_x = 10.6313 delta_h = 1.47538
U_c = [[-0.01798533]] U_f = [[ 0.]] b_c = [ 0.13175687] b_f = [ 0.27302802]
incx.max(), incx.min(), incx.mean() 20.8798 0.131757 6.10627
fgtx.max(), fgtx.min(), fgtx.mean() 31.6238 0.0 9.10629

shijiazhuang
        shijiazhuang  790.7395      0.79  0.25  0.62      0.82  0.22  0.66      0.84  0.19  0.70
forget mean min: 0.896856 0.442568
delta_x = 7.58472 delta_h = 0.689991
U_c = [[-0.0195912]] U_f = [[ 0.]] b_c = [ 0.4900116] b_f = [-0.23074624]
incx.max(), incx.min(), incx.mean() 21.5599 0.490012 5.09857
fgtx.max(), fgtx.min(), fgtx.mean() 23.2427 0.0 5.08216
        shijiazhuang 7188.2165      0.90  0.05  0.86      0.91  0.03  0.88      0.92  0.02  0.90
forget mean min: 0.902848 0.442568
delta_x = 7.97425 delta_h = 1.70193
U_c = [[-0.0195912]] U_f = [[ 0.]] b_c = [ 0.4900116] b_f = [-0.23074624]
incx.max(), incx.min(), incx.mean() 14.7689 0.490012 5.04159
fgtx.max(), fgtx.min(), fgtx.mean() 15.7465 0.0 5.01805

xingtai+handan
      xingtai+handan 1069.9980      0.81  0.29  0.61      0.85  0.24  0.67      0.86  0.22  0.69
forget mean min: 0.942091 0.686683
delta_x = 6.10428 delta_h = 1.14202
U_c = [[-0.03462986]] U_f = [[ 0.]] b_c = [ 0.10630932] b_f = [ 0.78465933]
incx.max(), incx.min(), incx.mean() 17.0289 0.106309 4.01218
fgtx.max(), fgtx.min(), fgtx.mean() 19.5527 0.0 4.51296
      xingtai+handan 8709.3946      0.95  0.16  0.81      0.95  0.12  0.85      0.95  0.09  0.86
forget mean min: 0.972828 0.686683
delta_x = 6.87664 delta_h = 2.17471
U_c = [[-0.03462986]] U_f = [[ 0.]] b_c = [ 0.10630932] b_f = [ 0.78465933]
incx.max(), incx.min(), incx.mean() 11.9556 0.106309 4.59403
fgtx.max(), fgtx.min(), fgtx.mean() 13.691 0.0 5.18528

jinan
               jinan 1559.8947      0.79  0.30  0.59      0.82  0.26  0.63      0.84  0.23  0.67
forget mean min: 0.910688 0.729521
delta_x = 7.20605 delta_h = 2.79908
U_c = [[-0.08724355]] U_f = [[ 0.]] b_c = [ 0.17994432] b_f = [ 0.94275671]
incx.max(), incx.min(), incx.mean() 21.4742 0.391406 7.71514
fgtx.max(), fgtx.min(), fgtx.mean() 4.97877 0.0494347 1.76179
               jinan 4205.2794      0.96  0.16  0.81      0.96  0.12  0.85      0.95  0.09  0.86
forget mean min: 0.931011 0.729521
delta_x = 8.185 delta_h = 4.32871
U_c = [[-0.08724355]] U_f = [[ 0.]] b_c = [ 0.17994432] b_f = [ 0.94275671]
incx.max(), incx.min(), incx.mean() 19.2019 0.391406 9.23133
fgtx.max(), fgtx.min(), fgtx.mean() 4.4475 0.0494347 2.1163

xian
                xian  672.1589      0.63  0.41  0.44      0.69  0.40  0.47      0.72  0.39  0.49
forget mean min: 0.939234 0.710193
delta_x = 3.18755 delta_h = 0.747682
U_c = [[-0.03223368]] U_f = [[ 0.]] b_c = [ 0.04890879] b_f = [ 0.8963207]
incx.max(), incx.min(), incx.mean() 9.23937 0.0489088 3.22563
fgtx.max(), fgtx.min(), fgtx.mean() 6.90751 0.0 2.38764
                xian 3190.6282      0.80  0.12  0.72      0.82  0.09  0.76      0.83  0.08  0.78
forget mean min: 0.958374 0.710193
delta_x = 4.2225 delta_h = 1.09897
U_c = [[-0.03223368]] U_f = [[ 0.]] b_c = [ 0.04890879] b_f = [ 0.8963207]
incx.max(), incx.min(), incx.mean() 8.0555 0.0489088 3.82585
fgtx.max(), fgtx.min(), fgtx.mean() 6.01775 0.0 2.83876

nanjing
             nanjing  392.0142      0.55  0.27  0.46      0.60  0.23  0.51      0.63  0.18  0.56
forget mean min: 0.933635 0.601941
delta_x = 4.84021 delta_h = 0.720477
U_c = [[-0.03991097]] U_f = [[ 0.]] b_c = [-0.31085399] b_f = [ 0.41355777]
incx.max(), incx.min(), incx.mean() 12.1922 -0.310854 2.95102
fgtx.max(), fgtx.min(), fgtx.mean() 16.7487 0.0 4.36967
             nanjing 1263.5387      0.64  0.46  0.42      0.65  0.46  0.42      0.65  0.42  0.44
forget mean min: 0.967593 0.601941
delta_x = 4.7499 delta_h = 0.996552
U_c = [[-0.03991097]] U_f = [[ 0.]] b_c = [-0.31085399] b_f = [ 0.41355777]
incx.max(), incx.min(), incx.mean() 11.8086 -0.310854 3.45215
fgtx.max(), fgtx.min(), fgtx.mean() 16.2351 0.0 5.04093

shanghai
            shanghai  374.4226      0.63  0.32  0.49      0.70  0.28  0.55      0.73  0.27  0.58
forget mean min: 0.880027 0.682587
delta_x = 4.72538 delta_h = 0.49188
U_c = [[-0.02555262]] U_f = [[ 0.]] b_c = [ 0.07787375] b_f = [ 0.7656855]
incx.max(), incx.min(), incx.mean() 20.3439 0.0778738 5.97468
fgtx.max(), fgtx.min(), fgtx.mean() 4.93466 0.0 1.43579
            shanghai 1179.3586      0.38  0.46  0.29      0.39  0.41  0.30      0.41  0.34  0.33
forget mean min: 0.904479 0.717011
delta_x = 4.72241 delta_h = 0.450562
U_c = [[-0.02555262]] U_f = [[ 0.]] b_c = [ 0.07787375] b_f = [ 0.7656855]
incx.max(), incx.min(), incx.mean() 16.7917 0.751505 6.85383
fgtx.max(), fgtx.min(), fgtx.mean() 4.06939 0.163999 1.64988

chongqing
           chongqing  271.8190      0.07  0.57  0.06      0.09  0.60  0.07      0.10  0.63  0.08
forget mean min: 0.960881 0.780251
delta_x = 1.82674 delta_h = 0.982373
U_c = [[-0.0734789]] U_f = [[ 0.]] b_c = [ 0.06918589] b_f = [ 1.04128742]
incx.max(), incx.min(), incx.mean() 4.50101 0.154307 1.34348
fgtx.max(), fgtx.min(), fgtx.mean() 11.757 0.225841 3.38054
           chongqing  634.6765      0.10  0.04  0.09      0.10  0.03  0.10      0.11  0.02  0.10
forget mean min: 0.971202 0.795585
delta_x = 1.86806 delta_h = 0.759129
U_c = [[-0.0734789]] U_f = [[ 0.]] b_c = [ 0.06918589] b_f = [ 1.04128742]
incx.max(), incx.min(), incx.mean() 4.1961 0.18891 1.44976
fgtx.max(), fgtx.min(), fgtx.mean() 10.9482 0.317636 3.66249

chengdu
             chengdu  494.5996      0.61  0.34  0.47      0.66  0.30  0.51      0.71  0.23  0.58
forget mean min: 0.945132 0.812052
delta_x = 3.00153 delta_h = 0.808019
U_c = [[-0.03835423]] U_f = [[ 0.]] b_c = [ 0.11706408] b_f = [ 1.10228586]
incx.max(), incx.min(), incx.mean() 7.39487 0.406244 2.29996
fgtx.max(), fgtx.min(), fgtx.mean() 9.08773 0.361116 2.72577
             chengdu  676.1360      0.26  0.52  0.20      0.30  0.51  0.22      0.32  0.49  0.24
forget mean min: 0.952164 0.812052
delta_x = 2.65177 delta_h = 0.664233
U_c = [[-0.03835423]] U_f = [[ 0.]] b_c = [ 0.11706408] b_f = [ 1.10228586]
incx.max(), incx.min(), incx.mean() 6.54061 0.406244 2.22222
fgtx.max(), fgtx.min(), fgtx.mean() 8.02103 0.361116 2.62869
